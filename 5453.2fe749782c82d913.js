"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5453],{1814:(he,Ct,f)=>{f.d(Ct,{In:()=>ut,MA:()=>A,Mo:()=>C,NV:()=>b,S3:()=>K,dt:()=>X,h8:()=>c,k0:()=>E});const K={fill:"transparent",stroke:"#129bff",strokeWidth:1},b={stroke:"#5F6CE1",strokeWidth:1,strokeLinecap:"round",strokeDasharrays:[4,2,1,2]},ut={fill:"#FFFFFF",stroke:"#5F6CE1",strokeWidth:1,width:7,height:7},C={fill:"transparent",stroke:"transparent",strokeWidth:1},X={fill:"none",stroke:"#5F6CE1",strokeWidth:1},c={stroke:"#129bff",strokeWidth:1,strokeLinecap:"round",strokeDasharray:8},A={fill:"transparent"},E={fill:"none",stroke:"#999",strokeWidth:1,strokeDasharray:2}},9942:(he,Ct,f)=>{f.d(Ct,{w:()=>it,I:()=>k});var K=f(4981),b=f(9054),ut=f(5811),C=/^#[a-fA-F0-9]+$/i,X=/^rgba\((\d+),(\d+),(\d+),(\d+)\)$/i,c=/^rgb\((\d+),(\d+),(\d+)\)$/i;const A=U=>{let Q=null,st=null;if(U)if("transparent"==U)Q="#000000",st=0;else if(U.match(C))Q=U;else{let P=(U=U.replace(/\s+/g,"")).match(X);if(P)Q="#"+(256|P[1]).toString(16).slice(1)+(256|P[2]).toString(16).slice(1)+(256|P[3]).toString(16).slice(1),st=(0,ut.q)(parseFloat(P[4]),100);else{let lt=U.match(c);lt&&(Q="#"+(256|lt[1]).toString(16).slice(1)+(256|lt[2]).toString(16).slice(1)+(256|lt[3]).toString(16).slice(1))}}return{hex:Q,alpha:st}},k=U=>w(null==U?void 0:U.url,null==U?void 0:U.path,null==U?void 0:U.src);var w=(U,Q,st)=>{var P,lt;let gt,_t,ct,tt;var j,Kt;return U&&(gt=U.replace(/\\/g,"/")),Q&&(_t=Q.replace(/\\/g,"/")),st&&(ct=st.replace(/\\/g,"/")),_t&&!gt&&(gt=(null===(j=K.icdt.config)||void 0===j?void 0:j.readfileuploadurl)+_t),!ct||_t||gt||(_t=ct.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),gt=(null===(Kt=K.icdt.config)||void 0===Kt?void 0:Kt.readfileuploadurl)+_t),tt=(null!==(P=gt)&&void 0!==P?P:"").split("/").pop()||(null!==(lt=_t)&&void 0!==lt?lt:"").split("/").pop()||"",{url:gt,path:_t,name:tt}};const it=U=>{let Q={x:0,y:0,width:U.screen.w,height:U.screen.h},st=[];return U.data.forEach((P,lt)=>{var gt,_t;let ct={id:"number"==typeof P.id?P.id:K.icdt.data.newSlideId,code:null===(gt=P.id)||void 0===gt?void 0:gt.toString(),name:"string"==typeof P.id?P.id:`Trang ${lt+1}`,svg:{viewBox:Q,nodes:[]},test:(tt=P.test2,tt?(tt.audiotrue&&(tt.audiotrue=k({path:tt.audiotrue.path})),tt.audiofalse&&(tt.audiofalse=k({path:tt.audiofalse.path})),tt.effecttrue&&(tt.effecttrue=k({path:tt.effecttrue.path})),tt.effectfalse&&(tt.effectfalse=k({path:tt.effectfalse.path})),tt.icontrue&&(tt.icontrue=k({path:tt.icontrue.path})),tt.iconfalse&&(tt.iconfalse=k({path:tt.iconfalse.path})),tt):{})};var tt;P.background&&ct.svg&&(ct.svg.background=function(U){return U&&(null!==U.match(/#([a-zA-Z0-9]+)/)||null!==U.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==U.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9]+\)/))}(P.background)?{color:P.background}:function(U){return U&&null!==U.match(/data:[^;]+;base64,/)}(P.background)?{base64:P.background}:function(U){return U&&null!==U.match(/http(s)?:\/\//)}(P.background)?w(P.background):w(void 0,P.background)),jQuery(null!==(_t=P.svg)&&void 0!==_t?_t:"").find(".svg-node").each((tt,j)=>{var Kt,Lt;let Dt=jQuery(j).parents(".indexs"),Ht=Dt.attr("data-index"),Mt=Dt.attr("data-time"),Wt=null!==(Kt=j.getAttribute("id"))&&void 0!==Kt?Kt:"0",ht={id:parseInt(Wt),code:`${j.nodeName}-${j.getAttribute("id")}`,name:j.nodeName,idx:Ht?parseInt(Ht):0,time:Mt?parseFloat(Mt):0,type:(()=>{switch(j.nodeName){case"polygon":return b.$.POLYGON;case"circle":return b.$.CIRCLE;case"ellipse":return b.$.ELLIPSE;case"line":return b.$.LINE;case"rect":return b.$.RECT;case"foreignObject":return b.$.FOREIGNOBJECT}return 0})(),size:(nt=>{let Et=0,St=0,Yt=0,mt=0,ne=null,G=null,L=parseFloat((null===(nt=j.getAttribute("transform"))||void 0===nt?void 0:nt.replace("rotate(","").replace(")",""))||"0")||null;switch(j.nodeName){case"polygon":{var h,H;let yt=[],ft=[],Ot=999999999,Ft=999999999,jt=0,xt=0;ne=JSON.parse(j.getAttribute("ratios")||"[]"),G=null!==(h=null===(H=j.getAttribute("points"))||void 0===H?void 0:H.split(",").map(function(wt){return wt.split(" ").map(function(qt){return parseFloat(qt)})}))&&void 0!==h?h:[],G.forEach(function(wt){yt.push(wt[0]),ft.push(wt[1])}),Ot=Math.min.apply(null,yt),Ft=Math.min.apply(null,ft),jt=Math.max.apply(null,yt),xt=Math.max.apply(null,ft),Et=Ot,St=Ft,Yt=jt-Et,mt=xt-St;break}case"circle":{let yt=parseFloat(j.getAttribute("cx")||"0"),ft=parseFloat(j.getAttribute("cy")||"0"),Ot=parseFloat(j.getAttribute("r")||"0");Et=yt-Ot,St=ft-Ot,Yt=2*Ot,mt=2*Ot;break}case"ellipse":{let yt=parseFloat(j.getAttribute("cx")||"0"),ft=parseFloat(j.getAttribute("cy")||"0"),Ot=parseFloat(j.getAttribute("rx")||"0"),Ft=parseFloat(j.getAttribute("ry")||"0");Et=yt-Ot,St=ft-Ft,Yt=2*Ot,mt=2*Ft;break}case"line":{let yt=parseFloat(j.getAttribute("x1")||"0"),ft=parseFloat(j.getAttribute("y1")||"0"),Ot=parseFloat(j.getAttribute("x2")||"0"),Ft=parseFloat(j.getAttribute("y2")||"0"),jt=999999999,xt=999999999,wt=0,qt=0;jt=Math.min(yt,Ot),xt=Math.min(ft,Ft),wt=Math.max(yt,Ot),qt=Math.max(ft,Ft),Et=jt,St=xt,Yt=wt-Et,mt=qt-St,ne=[[(yt-Et)/(Yt||1),(ft-St)/(mt||1)],[(Ot-Et)/(Yt||1),(Ft-St)/(mt||1)]];break}case"rect":case"foreignObject":Et=parseFloat(j.getAttribute("x")||"0"),St=parseFloat(j.getAttribute("y")||"0"),Yt=parseFloat(j.getAttribute("width")||"0"),mt=parseFloat(j.getAttribute("height")||"0")}return Object.assign({},{x:Et,y:St,width:Yt,height:mt,ratios:ne,points:G,rotate:L})})(),attribute:(()=>{let nt={};switch(j.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var Et,St,Yt,mt,ne,G;let L=null!==(Et=j.getAttribute("fill"))&&void 0!==Et?Et:null,h=null!==(St=j.getAttribute("stroke"))&&void 0!==St?St:null,H=null!==(Yt=parseFloat(j.getAttribute("stroke-width")||"0"))&&void 0!==Yt?Yt:null,yt=null!==(mt=j.getAttribute("stroke-linecap"))&&void 0!==mt?mt:null,ft=null!==(ne=j.getAttribute("stroke-linejoin"))&&void 0!==ne?ne:null,Ot=null!==(G=parseFloat(j.getAttribute("stroke-dasharray")||"0"))&&void 0!==G?G:null;Object.assign(nt,{fill:L,stroke:h,strokeWidth:H,strokeLinecap:yt,strokeLinejoin:ft,strokeDasharray:Ot});break}}return nt})(),style:(()=>{let nt={};switch(j.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let ne=jQuery(j).find(".svg-container");if(ne.length){var Et,St;let L=null!==(Et=parseFloat(ne.css("border-width")||"0"))&&void 0!==Et?Et:null,h=null!==(St=ne.css("border-style"))&&void 0!==St?St:null,H=ne.css("border-color")||null,yt=null,ft=ne.css("background-color")||null,Ot=null;(()=>{let{hex:Ft,alpha:jt}=A(H);H=Ft,yt=jt})(),(()=>{let{hex:Ft,alpha:jt}=A(ft);ft=Ft,Ot=jt})(),Object.assign(nt,{borderWidth:L,borderStyle:h,borderColor:H,borderOpacity:yt,backgroundColor:ft,backgroundOpacity:Ot})}let G=jQuery(j).find(".svg-editor-content");if(G.length){var Yt,mt;let L=JSON.parse((G.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:h,alpha:H}=A(L.TextColor);Object.assign(nt,{fontFamily:null!==(Yt=L.FontFamily)&&void 0!==Yt?Yt:null,fontSize:null!==(mt=L.FontSize)&&void 0!==mt?mt:null,color:h,opacity:H})}break}}return nt})(),source:(()=>{let nt={};switch(j.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(Dt.hasClass("editors")){let xt=jQuery(j).find(".svg-editor-content");if(xt.length){var Et;let wt=xt.html(),qt=null!==(Et=(null!=wt?wt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==Et?Et:[];Object.assign(nt,{type:"html",html:{htmlContent:wt,variableKeywords:qt}})}}else if(Dt.hasClass("inputs")||Dt.hasClass("textareas"))Object.assign(nt,{type:"input",input:{input:!!jQuery(j).find("input").length,textarea:!!jQuery(j).find("textarea").length}});else if(Dt.hasClass("tests")){let xt=jQuery(j).find(".svg-test");if(Dt.hasClass("tests-truefalse")){var St,Yt;let wt=xt.find(".svg-editor-content").html(),qt=null!==(St=(null!=wt?wt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==St?St:[];Object.assign(nt,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(Yt=P.test2.truefalse)||void 0===Yt?void 0:Yt.includes(Wt)}},html:{htmlContent:wt,variableKeywords:qt}})}else if(Dt.hasClass("tests-singlechoice")){var mt,ne;let wt=xt.find(".svg-editor-content").html(),qt=null!==(mt=(null!=wt?wt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==mt?mt:[];Object.assign(nt,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(ne=P.test2.singlechoice)||void 0===ne?void 0:ne.includes(Wt)}},html:{htmlContent:wt,variableKeywords:qt}})}else if(Dt.hasClass("tests-multichoice")){var G,L;let wt=xt.find(".svg-editor-content").html(),qt=null!==(G=(null!=wt?wt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==G?G:[];Object.assign(nt,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(L=P.test2.multichoice)||void 0===L?void 0:L.includes(Wt)}},html:{htmlContent:wt,variableKeywords:qt}})}else if(Dt.hasClass("tests-fill")){var h,H;let wt=xt.find(".svg-editor-content").html(),qt=null!==(h=(null!=wt?wt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==h?h:[],Rt=null!==(H=(null!=wt?wt:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==H?H:[];Rt=Rt.filter((re,z,d)=>d.indexOf(re)==z),Object.assign(nt,{type:"test",test:{type:"fill",fill:Rt.map(re=>{var z;return{key:re,value:null===(z=P.test2.fill)||void 0===z||null===(z=z.find(d=>d.id==Wt))||void 0===z||null===(z=z.vals)||void 0===z?void 0:z.map(d=>d.text).filter(d=>!["",null,void 0,NaN].includes(d))}})},html:{htmlContent:wt,variableKeywords:qt,fillKeywords:Rt}})}else if(Dt.hasClass("tests-matching")){if(xt.hasClass("svg-test-empty"))Object.assign(nt,{type:"test",test:{type:"matching-empty",matching:{key:xt.attr("data-name")||null}}});else if(xt.hasClass("svg-test-content")){var yt;let wt=xt.find(".svg-editor-content").html(),qt=null!==(yt=(null!=wt?wt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==yt?yt:[];Object.assign(nt,{type:"test",test:{type:"matching-content",matching:{key:xt.attr("data-name")||null}},html:{htmlContent:wt,variableKeywords:qt}})}}else if(Dt.hasClass("tests-speech")){var ft;Object.assign(nt,{type:"speech",speech:{value:null===(ft=P.test2.speech)||void 0===ft||null===(ft=ft.find(wt=>wt.id==Wt))||void 0===ft||null===(ft=ft.vals)||void 0===ft?void 0:ft.map(wt=>wt.text).filter(wt=>!["",null,void 0,NaN].includes(wt))}})}else if(Dt.hasClass("tests-submit")){let wt=jQuery(j).find(".svg-container img");Object.assign(nt,{type:"test",test:{type:"submit"},image:w(wt.attr("url"),wt.attr("path"),wt.attr("src"))})}}else if(Dt.hasClass("images")){let xt=jQuery(j).find(".svg-editor-content img");if(xt.length)Object.assign(nt,{type:"image",image:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))});else{let wt=jQuery(j).find("iframe");Object.assign(nt,{type:"iframe",iframe:w(wt.attr("url"),wt.attr("path"),wt.attr("src"))})}}else if(Dt.hasClass("sounds")){let xt=jQuery(j).find(".svg-editor-content img");xt.length&&Object.assign(nt,{type:"image",image:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))})}else if(Dt.hasClass("htmls")){let xt=jQuery(j).find("iframe");xt.length&&Object.assign(nt,{type:"iframe",iframe:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))})}else if(Dt.hasClass("svgs")){let xt=jQuery(j).find("svg");var Ot,Ft;xt.length&&Object.assign(nt,{type:"svg",svg:Object.assign(w(xt.attr("url"),xt.attr("path"),xt.attr("src")),{svgContent:null!==(Ot=null===(Ft=xt.get(0))||void 0===Ft?void 0:Ft.outerHTML)&&void 0!==Ot?Ot:null})})}else if(Dt.hasClass("medias")){let xt=jQuery(j).find(".media-item");if(xt.length)switch(xt.attr("type")){case"audio":Object.assign(nt,{type:"audio",audio:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))});break;case"video":Object.assign(nt,{type:"video",video:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))});break;case"file":Object.assign(nt,{type:"file",file:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))});break;default:var jt;Object.assign(nt,{type:"link",link:{url:null!==(jt=xt.attr("url"))&&void 0!==jt?jt:null}})}let wt=jQuery(j).find("img");wt.length&&(Object.assign(nt,{image:w(wt.attr("url"),wt.attr("path"),wt.attr("src"))}),nt.type||Object.assign(nt,{type:"image"}))}}return nt})(),animate:(nt=>{let Et={},St=null===(nt=P.animates)||void 0===nt?void 0:nt.find(Yt=>Yt.elementId==Wt);return St&&Object.assign(Et,{value:St.value}),Et})(),interactive:(()=>{let nt={},Et=P.actions.show.filter(Yt=>Yt.elementId==Wt&&Yt.active);Et.length&&(nt.show={},Et.forEach(Yt=>{let{source:mt}=Yt;switch(null==mt?void 0:mt.type){case"work":var ne,G,L,h,H;nt.show.action={},Object.assign(nt.show.action,{value:null!==(ne=mt.value)&&void 0!==ne?ne:null,iteration:null!==(G=mt.iteration)&&void 0!==G?G:null,finish:null!==(L=mt.end)&&void 0!==L?L:null,time:null!==(h=mt.time)&&void 0!==h?h:null,points:null!==(H=mt.points)&&void 0!==H?H:null});break;case"audio":var yt,ft,Ot;nt.show.audio={},Object.assign(nt.show.audio,{source:w(null,null,mt.url),iteration:null!==(yt=mt.iteration)&&void 0!==yt?yt:null,finish:null!==(ft=mt.end)&&void 0!==ft?ft:null,time:null!==(Ot=mt.time)&&void 0!==Ot?Ot:null,async:-1==mt.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Ft,jt,xt,wt,qt,Rt,re,z,d,O,F,J,W,I,Z;mt.options.includes("show")&&(nt.show.triggershow={},Object.assign(nt.show.triggershow,{id:null!==(Ft=parseInt(null!==(jt=mt.id)&&void 0!==jt?jt:"0"))&&void 0!==Ft?Ft:null,ids:null===(xt=mt.ids)||void 0===xt?void 0:xt.map(M=>parseInt(M)),async:null!==(wt=mt.async)&&void 0!==wt?wt:null,time:null!==(qt=mt.time)&&void 0!==qt?qt:null})),mt.options.includes("run")&&(nt.show.triggerrun={},Object.assign(nt.show.triggerrun,{id:null!==(Rt=parseInt(null!==(re=mt.id)&&void 0!==re?re:"0"))&&void 0!==Rt?Rt:null,ids:null===(z=mt.ids)||void 0===z?void 0:z.map(M=>parseInt(M)),async:null!==(d=mt.async)&&void 0!==d?d:null,time:null!==(O=mt.time)&&void 0!==O?O:null})),mt.options.includes("hide")&&(nt.show.triggerhide={},Object.assign(nt.show.triggerhide,{id:null!==(F=parseInt(null!==(J=mt.id)&&void 0!==J?J:"0"))&&void 0!==F?F:null,ids:null===(W=mt.ids)||void 0===W?void 0:W.map(M=>parseInt(M)),async:null!==(I=mt.async)&&void 0!==I?I:null,time:null!==(Z=mt.time)&&void 0!==Z?Z:null}))}}));let St=P.actions.click.filter(Yt=>Yt.elementId==Wt&&Yt.active);return St&&(nt.click={},St.forEach(Yt=>{let{source:mt}=Yt;switch(null==mt?void 0:mt.type){case"work":var ne,G,L,h,H;nt.click.action={},Object.assign(nt.click.action,{value:null!==(ne=mt.value)&&void 0!==ne?ne:null,iteration:null!==(G=mt.iteration)&&void 0!==G?G:null,finish:null!==(L=mt.end)&&void 0!==L?L:null,time:null!==(h=mt.time)&&void 0!==h?h:null,points:null!==(H=mt.points)&&void 0!==H?H:null});break;case"audio":var yt,ft,Ot;nt.click.audio={},Object.assign(nt.click.audio,{source:w(null,null,mt.url),iteration:null!==(yt=mt.iteration)&&void 0!==yt?yt:null,finish:null!==(ft=mt.end)&&void 0!==ft?ft:null,time:null!==(Ot=mt.time)&&void 0!==Ot?Ot:null,async:-1==mt.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Ft,jt,xt,wt,qt,Rt,re,z,d,O,F,J,W,I,Z;mt.options.includes("show")&&(nt.click.triggershow={},Object.assign(nt.click.triggershow,{id:null!==(Ft=parseInt(null!==(jt=mt.id)&&void 0!==jt?jt:"0"))&&void 0!==Ft?Ft:null,ids:null===(xt=mt.ids)||void 0===xt?void 0:xt.map(Y=>parseInt(Y)),async:null!==(wt=mt.async)&&void 0!==wt?wt:null,time:null!==(qt=mt.time)&&void 0!==qt?qt:null})),mt.options.includes("run")&&(nt.click.triggerrun={},Object.assign(nt.click.triggerrun,{id:null!==(Rt=parseInt(null!==(re=mt.id)&&void 0!==re?re:"0"))&&void 0!==Rt?Rt:null,ids:null===(z=mt.ids)||void 0===z?void 0:z.map(Y=>parseInt(Y)),async:null!==(d=mt.async)&&void 0!==d?d:null,time:null!==(O=mt.time)&&void 0!==O?O:null})),mt.options.includes("hide")&&(nt.click.triggerhide={},Object.assign(nt.click.triggerhide,{id:null!==(F=parseInt(null!==(J=mt.id)&&void 0!==J?J:"0"))&&void 0!==F?F:null,ids:null===(W=mt.ids)||void 0===W?void 0:W.map(Y=>parseInt(Y)),async:null!==(I=mt.async)&&void 0!==I?I:null,time:null!==(Z=mt.time)&&void 0!==Z?Z:null}));break;case"slide":var M;nt.click.slide={},Object.assign(nt.click.slide,{id:parseInt(null!==(M=mt.id)&&void 0!==M?M:"0")||mt.num||null,code:mt.id})}})),nt})(),variable:(nt=>{let Et={};var St;j.getAttribute("data-variable")&&(Et.input={},Object.assign(Et.input,{variable:null!==(St=j.getAttribute("data-variable"))&&void 0!==St?St:null}));let Yt=null===(nt=P.nodes)||void 0===nt||null===(nt=nt.find(h=>h.id==Wt))||void 0===nt?void 0:nt.variable;var mt,ne,G,L;return Yt&&(Et.click={},Object.assign(Et.click,{variable:null!==(mt=Yt.variable)&&void 0!==mt?mt:null,operator:null!==(ne=Yt.operator)&&void 0!==ne?ne:null,valuetype:null!==(G=Yt.valuetype)&&void 0!==G?G:null,value:null!==(L=Yt.value)&&void 0!==L?L:null})),Et})()};null===(Lt=ct.svg)||void 0===Lt||Lt.nodes.push(ht)}),st.push(ct)}),console.log(st),{screen:{width:U.screen.w,height:U.screen.h},data:{slides:st},variable:U.variable}}},644:(he,Ct,f)=>{f.d(Ct,{Dx:()=>c,aY:()=>q,qp:()=>E,qz:()=>X,sV:()=>A,yR:()=>m});var K=f(5861),b=f(9422);b.config({driver:[b.INDEXEDDB,b.LOCALSTORAGE,b.WEBSQL],name:"_localDataDB",version:1});const C={create:(k=(0,K.Z)(function*(){return b}),function(){return k.apply(this,arguments)}),get:function(){var k=(0,K.Z)(function*(w){return b.getItem(w)});return function(it){return k.apply(this,arguments)}}(),set:function(){var k=(0,K.Z)(function*(w,it){return b.setItem(w,it)});return function(it,U){return k.apply(this,arguments)}}()},X=function(){var k=(0,K.Z)(function*(w){yield C.create();var it=(yield C.get("icdt-data"))||[];"function"==typeof w.callback&&w.callback(it)});return function(it){return k.apply(this,arguments)}}(),c=function(){var k=(0,K.Z)(function*(w){yield C.create(),w.params=w.params||{};try{yield C.set("icdt-data",w.params),"function"==typeof w.callback&&w.callback(w.params)}catch(it){"function"==typeof w.callback&&w.callback(null),console.error(it)}});return function(it){return k.apply(this,arguments)}}(),A=function(){var k=(0,K.Z)(function*(w){yield C.create();try{var it=(yield C.get("icdt-config"))||{};"function"==typeof w.callback&&w.callback(it)}catch(U){"function"==typeof w.callback&&w.callback(null),console.error(U)}});return function(it){return k.apply(this,arguments)}}(),E=function(){var k=(0,K.Z)(function*(w){yield C.create(),w.params=w.params||{};try{yield C.set("icdt-config",w.params),"function"==typeof w.callback&&w.callback(w.params)}catch(it){"function"==typeof w.callback&&w.callback(null),console.error(it)}});return function(it){return k.apply(this,arguments)}}(),q=function(){var k=(0,K.Z)(function*(w){yield C.create();try{var it=(yield C.get("icdt-clipboard"))||{};"function"==typeof w.callback&&w.callback(it)}catch(U){"function"==typeof w.callback&&w.callback(null),console.error(U)}});return function(it){return k.apply(this,arguments)}}(),m=function(){var k=(0,K.Z)(function*(w){yield C.create(),w.params=w.params||{};try{yield C.set("icdt-clipboard",w.params),"function"==typeof w.callback&&w.callback(w.params)}catch(it){"function"==typeof w.callback&&w.callback(null),console.error(it)}});return function(it){return k.apply(this,arguments)}}();var k},1687:(he,Ct,f)=>{f.d(Ct,{O:()=>K});const K={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"}},9125:(he,Ct,f)=>{f.d(Ct,{D:()=>K});const K={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3}},968:(he,Ct,f)=>{f.d(Ct,{_:()=>K});const K={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8}},4714:(he,Ct,f)=>{f.d(Ct,{D:()=>K});const K={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306}},9054:(he,Ct,f)=>{f.d(Ct,{$:()=>K});const K={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,PATH:8}},4981:(he,Ct,f)=>{f.d(Ct,{icdt:()=>bt});var K=f(968),b=f(4080),ut=f(1687),C=f(9054),X=f(4318),c=f(6816),A=f(666),E=f(2966);const k=T=>{var i,n,r,a,s;let g=(null===(i=T.mouseEvent)||void 0===i?void 0:i.target)||(null===(n=T.touchEvent)||void 0===n?void 0:n.target),v=(null==g?void 0:g.getAttribute("id"))||"",p=null==g?void 0:g.nodeName,S=(null==g||null===(r=g.parentNode)||void 0===r?void 0:r.getAttribute("id"))||"";var x,N;if([ut.O.RESIZE_GROUP,ut.O.SELECT_GROUP].includes(S))return null===(x=T.mouseEvent)||void 0===x||x.stopPropagation(),void(null===(N=T.mouseEvent)||void 0===N||N.preventDefault());if(null!==(a=T.mouseEvent)&&void 0!==a&&a.altKey||null!==(s=T.touchEvent)&&void 0!==s&&s.altKey||!v||v.match(/[^0-9]/)||!bt.dataSelect.nodeName.includes(p)){var B;bt.dataSelect.ids.length&&(bt.dataSelect.ids=[]),(0==(null===(B=T.mouseEvent)||void 0===B?void 0:B.button)||T.touchEvent)&&(T=>{let s=(0,b.g1)(ut.O.SCAN_GROUP,"g"),g=(0,X.bH)(0,0,1,1);(0,b.vl)(s,g),((T,i,n)=>{(0,c.A)(T,{start:s=>{},move:(s,g)=>{((s,g,v,p)=>{i=(0,X.bH)(s,g,v,p),(0,b.vl)(n,i)})(g[0][0],g[0][1],s.x,s.y)},end:(s,g)=>{null==n||n.remove(),bt.dataSelect.ids=bt.data.getNodeInArea(Math.min(g[0][0],s.x),Math.min(g[0][1],s.y),Math.max(g[0][0],s.x),Math.max(g[0][1],s.y));let v=bt.dataSelect.nodes;1==v.length?(0,A.y)(v[0]):v.length>1&&(0,E.Q)(v)}})})(T,g,s)})(T)}else{var V,ot;let at=parseFloat(v||"0");bt.dataSelect.ids=null!==(V=T.mouseEvent)&&void 0!==V&&V.shiftKey||null!==(ot=T.touchEvent)&&void 0!==ot&&ot.shiftKey?[at].concat(bt.dataSelect.ids).filter((oe,ce,pe)=>pe.indexOf(oe)==ce):[at];let Ut=bt.dataSelect.nodes;Ut.length>1||1==Ut.length&&Ut[0].type==C.$.PATH?(0,E.Q)(Ut):1==Ut.length&&(0,A.y)(Ut[0])}};class it{constructor(){let{x:i,y:n}=bt.screen.dislocation;var r=(a,s,g,v)=>{bt.screen.move({x:i,y:n},{x:g-a,y:v-s})};return{start:a=>{},move:(a,s)=>{r(s[0][0],s[0][1],a.x,a.y)},end:(a,s)=>{r(s[0][0],s[0][1],a.x,a.y)}}}}var U=f(4714);const Q=[{name:"tam gi\xe1c vu\xf4ng",type:U.D.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:U.D.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:U.D.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:U.D.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:U.D.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:U.D.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:U.D.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:U.D.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:U.D.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:U.D.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:U.D.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:U.D.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:U.D.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}];var st=f(8619),P=f(5811);class lt{constructor(){let i=(0,b.g1)(ut.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:s}=(0,st._)(Math.ceil(1e9*Math.random())),g=(v,p,S,x)=>{s=(0,X.bH)(v,p,S,x,{ratio:1}),s.x=(0,P.q)(s.x),s.y=(0,P.q)(s.y),s.width=(0,P.q)(s.width),s.height=(0,P.q)(s.height),Object.assign(a,(0,X.sg)(C.$.CIRCLE,s)),(0,b.__)(r,a),(0,b.g$)(i,s)};return{start:v=>{r.setAttribute("cx",v.x.toString()),r.setAttribute("cy",v.y.toString()),r.setAttribute("r","1")},move:(v,p)=>{g(p[0][0],p[0][1],v.x,v.y)},end:(v,p)=>{g(p[0][0],p[0][1],v.x,v.y),bt.data.node=Object.assign({id:n,type:C.$.CIRCLE,name:"Circle"},{size:s,attribute:a}),null==i||i.remove()}}}}var gt=f(8785);class _t{constructor(){let i=(0,b.g1)(ut.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:s}=(0,gt.r)(Math.ceil(1e9*Math.random()));var g=(v,p,S,x)=>{s=(0,X.bH)(v,p,S,x),s.x=(0,P.q)(s.x),s.y=(0,P.q)(s.y),s.width=(0,P.q)(s.width),s.height=(0,P.q)(s.height),Object.assign(a,(0,X.sg)(C.$.ELLIPSE,s)),(0,b.__)(r,a),(0,b.g$)(i,s)};return{start:v=>{r.setAttribute("cx",v.x.toString()),r.setAttribute("cy",v.y.toString()),r.setAttribute("rx","1"),r.setAttribute("ry","1")},move:(v,p)=>{g(p[0][0],p[0][1],v.x,v.y)},end:(v,p)=>{g(p[0][0],p[0][1],v.x,v.y),bt.data.node=Object.assign({id:n,type:C.$.ELLIPSE,name:"Ellipse"},{size:s,attribute:a}),null==i||i.remove()}}}}var ct=f(8054);class tt{constructor(){let i=(0,b.g1)(ut.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:s}=(0,ct.f)(Math.ceil(1e9*Math.random()));var g=(v,p,S,x)=>{s=(0,X.bH)(v,p,S,x),s.x=(0,P.q)(s.x),s.y=(0,P.q)(s.y),s.width=(0,P.q)(s.width),s.height=(0,P.q)(s.height),Object.assign(a,(0,X.sg)(C.$.RECT,s)),(0,b.__)(r,a),(0,b.g$)(i,s)};return{start:v=>{g(v.x,v.y,v.x+s.width,v.y+s.height)},move:(v,p)=>{g(p[0][0],p[0][1],v.x,v.y)},end:(v,p)=>{s.width>=10&&s.height>=10?bt.data.node=Object.assign({id:n,type:C.$.RECT,name:"Rect"},{size:s,attribute:a}):null==r||r.remove(),null==i||i.remove()}}}}var j=f(2282);class Kt{constructor(i){let n=(0,b.g1)(ut.O.CREATE_GROUP,"g"),r=i||[[0,0],[1,1],[0,1]],{nodeId:a,element:s,attribute:g,size:v}=(0,j.l)(Math.ceil(1e9*Math.random()));v.ratios=r;var p=(S,x,N,B)=>{v=(0,X.bH)(S,x,N,B,{ratios:r}),v.x=(0,P.q)(v.x),v.y=(0,P.q)(v.y),v.width=(0,P.q)(v.width),v.height=(0,P.q)(v.height),Object.assign(g,(0,X.sg)(C.$.POLYGON,v)),(0,b.__)(s,g),(0,b.g$)(n,v)};return{start:S=>{},move:(S,x)=>{p(x[0][0],x[0][1],S.x,S.y)},end:(S,x)=>{p(x[0][0],x[0][1],S.x,S.y),bt.data.node=Object.assign({id:a,type:C.$.POLYGON,name:"Polygon"},{size:v,attribute:g}),null==n||n.remove()}}}}var Lt=f(4921);class Dt{constructor(){let i=(0,b.g1)(ut.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:s}=(0,Lt.W)(Math.ceil(1e9*Math.random()));var g=(v,p,S,x)=>{s=(0,X.bH)(v,p,S,x),s.x=(0,P.q)(s.x),s.y=(0,P.q)(s.y),s.width=(0,P.q)(s.width),s.height=(0,P.q)(s.height),Object.assign(a,(0,X.sg)(C.$.LINE,s)),(0,b.__)(r,a),(0,b.g$)(i,s)};return{start:v=>{},move:(v,p)=>{g(p[0][0],p[0][1],v.x,v.y)},end:(v,p)=>{g(p[0][0],p[0][1],v.x,v.y),bt.data.node=Object.assign({id:n,type:C.$.LINE,name:"Line"},{size:s,attribute:a}),null==i||i.remove()}}}}var Ht=f(8419);class Mt{constructor(){let{nodeId:i,element:n,attribute:r,size:a}=(0,Ht.G)(Math.ceil(1e9*Math.random())),g="";var v=(p,S)=>{g+=` ${p} ${S}`,n.setAttribute("d",g)};return{start:p=>{g=`M ${p.x} ${p.y} L ${p.x} ${p.y}`},move:(p,S)=>{v(p.x,p.y)},end:(p,S)=>{v(p.x,p.y),(p=>{let S=9999,x=9999,N=-9999,B=-9999;p.forEach(V=>{S=Math.min(S,V[0]),x=Math.min(x,V[1]),N=Math.max(N,V[0]),B=Math.max(B,V[1])}),a=(0,X.bH)(S,x,N,B,{points:p}),Object.assign(r,(0,X.sg)(C.$.PATH,a)),(0,b.__)(n,r)})(S),bt.data.node=Object.assign({id:i,type:C.$.PATH,name:"Path"},{size:a,attribute:r})}}}}var Wt=f(2875);class ht{constructor(){let i=(0,b.g1)(ut.O.CREATE_GROUP,"g"),{nodeId:n,element:r,size:a,attribute:s,style:g,source:v}=(0,Wt.e)(Math.ceil(1e9*Math.random()));var p=(S,x,N,B)=>{a=(0,X.bH)(S,x,N,B),a.x=(0,P.q)(a.x),a.y=(0,P.q)(a.y),a.width=(0,P.q)(a.width),a.height=(0,P.q)(a.height),Object.assign(s,(0,X.sg)(C.$.FOREIGNOBJECT,a)),(0,b.__)(r,s),(0,b.g$)(i,a)};return{start:S=>{p(S.x,S.y,S.x+a.width,S.y+a.height)},move:(S,x)=>{p(x[0][0],x[0][1],S.x,S.y)},end:(S,x)=>{a.width>=10&&a.height>=10?bt.data.node=Object.assign({id:n,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:s,style:g,source:v}):null==r||r.remove(),null==i||i.remove()}}}}var nt=f(7210);class Et{constructor(){var i,n;let r=(0,b.g1)(ut.O.CREATE_GROUP,"g"),{nodeId:a,element:s,size:g,attribute:v,source:p}=(0,nt.G)(Math.ceil(1e9*Math.random())),S=1;(N=>{if(!N)return;let B=new Image;B.onload=()=>{S=(0,P.q)(B.naturalWidth/B.naturalHeight,100)},B.onerror=V=>{console.error(`ImgSrc load failed -> ${N}`,V)},B.src=N})(null!==(i=null===(n=p.image)||void 0===n?void 0:n.url)&&void 0!==i?i:"");var x=(N,B,V,ot)=>{g=(0,X.bH)(N,B,V,ot,{ratio:S}),g.x=(0,P.q)(g.x),g.y=(0,P.q)(g.y),g.width=(0,P.q)(g.width),g.height=(0,P.q)(g.height),Object.assign(v,(0,X.sg)(C.$.IMAGE,g)),(0,b.__)(s,v),(0,b.g$)(r,g)};return{start:N=>{x(N.x,N.y,N.x+g.width,N.y+g.height)},move:(N,B)=>{x(B[0][0],B[0][1],N.x,N.y)},end:(N,B)=>{g.width>=10&&g.height>=10?bt.data.node=Object.assign({id:a,type:C.$.IMAGE,name:"Image"},{size:g,attribute:v,source:p}):null==s||s.remove(),null==r||r.remove()}}}}var Yt=f(4578),mt=f(9623);function L(T,i,n,r){return Math.sqrt(Math.pow(n-T,2)+Math.pow(r-i,2))}function h(T,i,n,r,a){return L(T,i,n,r)<a?1:0}function yt(T,i,n,r,a,s,g){var v=[];return v.push(h(T,i,n,r,g)),v.push(h(T,i,a,s,g)),v.push(function H(T,i,n,r,a,s,g){var v=[a-n,s-r],p=[T-n,i-r],S=[-v[1],v[0]],x=Math.sqrt(Math.pow(S[0],2)+Math.pow(S[1],2)),N=[S[0]/x,S[1]/x],B=Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2)),V=[v[0]/B,v[1]/B],ot=p[0]*V[0]+p[1]*V[1];if(ot<=0||ot>=B)return 0;var at=p[0]*N[0]+p[1]*N[1];return at>=g||at<=-g?0:1}(T,i,n,r,a,s,g)),v}function ft(T,i,n,r,a){var s=[n-T,r-i],g=[-s[1],s[0]],v=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),p=[g[0]/v,g[1]/v];return[[T+a*p[0],i+a*p[1]],[T-a*p[0],i-a*p[1]],[n-a*p[0],r-a*p[1]],[n+a*p[0],r+a*p[1]]]}function Ot(T,i,n,r,a,s,g){var ot,v=[a-T,s-i],p=[n-T,r-i],S=Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2)),x=[p[0]/S,p[1]/S],N=v[0]*x[0]+v[1]*x[1],B=[T+N*x[0],i+N*x[1]],V=Math.sqrt(Math.pow(a-B[0],2)+Math.pow(s-B[1],2));ot=0===V?g:Math.sqrt(Math.pow(g,2)-Math.pow(V,2));var at=[T+N*x[0]+ot*x[0],i+N*x[1]+ot*x[1]];return at[0]===T&&at[1]===i?null:at}function Ft(T,i,n,r,a,s,g){var v=[a-T,s-i],p=[n-T,r-i],S=[-p[1],p[0]],x=Math.sqrt(Math.pow(S[0],2)+Math.pow(S[1],2)),N=[S[0]/x,S[1]/x],B=v[0]*N[0]+v[1]*N[1],V=re([T,i],[n,r],[a,s]);if(qt([V[0]-a,V[1]-s])>=g)return null;var at=Math.sqrt(Math.pow(g,2)-Math.pow(B,2)),Ut=[a-B*N[0],s-B*N[1]],oe=Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2)),ce=[p[0]/oe,p[1]/oe],pe=[[Ut[0]-ce[0]*at,Ut[1]-ce[1]*at],[Ut[0]+ce[0]*at,Ut[1]+ce[1]*at]];return pe[0][0]===T&&pe[0][1]===i?null:pe}function jt(T,i,n,r,a,s,g,v){var p,S,x,N,B,V;return-(x=g-a)*(S=r-i)+(p=n-T)*(N=v-s)==0?null:(V=(x*(i-s)-N*(T-a))/(-x*S+p*N),(B=(-S*(T-a)+p*(i-s))/(-x*S+p*N))>=0&&B<=1&&V>=0&&V<=1?[T+V*p,i+V*S]:null)}function xt(T,i,n,r,a,s,g,v,p,S){var x=ft(s,g,v,p,S),N=[];if(n[0]&&!n[1])N.push(Ot(T,i,r,a,s,g,S)),N.push(jt(T,i,r,a,x[0][0],x[0][1],x[3][0],x[3][1])),N.push(jt(T,i,r,a,x[1][0],x[1][1],x[2][0],x[2][1])),(B=Ft(T,i,r,a,v,p,S))&&N.push(B[0],B[1]);else if(!n[0]&&n[1])N.push(Ot(T,i,r,a,v,p,S)),N.push(jt(T,i,r,a,x[0][0],x[0][1],x[3][0],x[3][1])),N.push(jt(T,i,r,a,x[1][0],x[1][1],x[2][0],x[2][1])),(B=Ft(T,i,r,a,s,g,S))&&N.push(B[0],B[1]);else if(n[0]&&n[1])N.push(Ot(T,i,r,a,s,g,S)),N.push(jt(T,i,r,a,x[0][0],x[0][1],x[3][0],x[3][1])),N.push(jt(T,i,r,a,x[1][0],x[1][1],x[2][0],x[2][1])),N.push(Ot(T,i,r,a,v,p,S));else{var B=Ft(T,i,r,a,v,p,S),V=Ft(T,i,r,a,s,g,S);B&&N.push(B[0],B[1]),V&&N.push(V[0],V[1]),N.push(jt(T,i,r,a,x[0][0],x[0][1],x[3][0],x[3][1])),N.push(jt(T,i,r,a,x[1][0],x[1][1],x[2][0],x[2][1]))}for(var ot=[T,i],at=0;at<N.length;at++)N[at]&&L(N[at][0],N[at][1],r,a)<L(ot[0],ot[1],r,a)&&(ot=N[at]);return ot[0]===T&&ot[1]===i?null:ot}function wt(T,i,n,r,a,s,g,v,p){var S=ft(a,s,g,v,p),x=[],N=Ft(T,i,n,r,a,s,p);N&&x.push(N[0],N[1]),(N=Ft(T,i,n,r,g,v,p))&&x.push(N[0],N[1]),x.push(jt(T,i,n,r,S[0][0],S[0][1],S[3][0],S[3][1])),x.push(jt(T,i,n,r,S[1][0],S[1][1],S[2][0],S[2][1]));for(var B=[n,r],V=[T,i],ot=0;ot<x.length;ot++)x[ot]&&L(x[ot][0],x[ot][1],T,i)<L(B[0],B[1],T,i)&&(B=x[ot]);for(var at=0;at<x.length;at++)x[at]&&L(x[at][0],x[at][1],n,r)<L(V[0],V[1],n,r)&&(V=x[at]);return B[0]===n&&B[1]===r||V[0]===T&&V[1]===i?null:[B,V]}var qt=function(T){return Math.sqrt(T[0]*T[0]+T[1]*T[1])},re=function(T,i,n){var r=[i[0]-T[0],i[1]-T[1]],a=qt(r);if(a<1e-6)return T;var s=[n[0]-T[0],n[1]-T[1]],g=(r[0]*s[0]+r[1]*s[1])/a;return g<0?T:g>a?i:[T[0]+r[0]*g/a,T[1]+r[1]*g/a]};class z{constructor(){let{element:r,size:s}=(0,Ht.G)(Math.ceil(1e9*Math.random()));(0,b.__)(r,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let g="";return{start:S=>{g=`M ${S.x} ${S.y} L ${S.x} ${S.y}`},move:(S,x)=>{((S,x)=>{g+=` ${S} ${x}`,r.setAttribute("d",g)})(S.x,S.y)},end:(S,x)=>{r.remove(),(S=>{let x=9999,N=9999,B=-9999,V=-9999;S.forEach(at=>{x=Math.min(x,at[0]),N=Math.min(N,at[1]),B=Math.max(B,at[0]),V=Math.max(V,at[1])}),s=(0,X.bH)(x,N,B,V,{points:S}),bt.data.getNodeInArea(0,0,1920,1920,C.$.PATH).forEach(at=>{let oe=((T,i,n)=>{n=n||20;var r=[],a=function(x){var N=i[0][0],B=i[0][1],V=0,ot=0;if(1!==x.length||h(x[0][0],x[0][1],N,B,n)){for(var at;V<x.length-1;){var Ut=x[V],oe=x[V+1],ce=h(Ut[0],Ut[1],N,B,n),pe=h(oe[0],oe[1],N,B,n);if(ce&&pe)ot=++V;else if(ce&&!pe)(be=Ot(Ut[0],Ut[1],oe[0],oe[1],N,B,n))?(x[V]=be,ot=V):V++;else if(!ce&&pe){var be;(be=Ot(oe[0],oe[1],Ut[0],Ut[1],N,B,n))&&((at=x.slice(ot,V+1)).push(be),r.push(at)),ot=++V}else{var me=Ft(Ut[0],Ut[1],oe[0],oe[1],N,B,n);me?(((at=x.slice(ot,V+1))[at.length-1][0]!==me[0][0]||at[at.length-1][1]!==me[0][1])&&at.push(me[0]),at.length>1&&r.push(at),x[V]=me[1],x[V+1]&&x[V+1][0]==me[1][0]&&x[V+1][1]==me[1][1]&&V++,ot=V):V++}}ot!==V&&(at=x.slice(ot,x.length))&&r.push(at)}else r.push(x)},s=function(x,N){var oe,B=i[N],V=i[N+1],ot=0,at=0;if(1!==x.length||-1!==(Ut=yt(x[0][0],x[0][1],B[0],B[1],V[0],V[1],n)).indexOf(1)){for(;ot<x.length-1;){var ce=x[ot],pe=x[ot+1],Ut=yt(ce[0],ce[1],B[0],B[1],V[0],V[1],n),be=yt(pe[0],pe[1],B[0],B[1],V[0],V[1],n);if(-1!==Ut.indexOf(1)&&-1!==be.indexOf(1))at=++ot;else if(-1!==Ut.indexOf(1)&&-1===be.indexOf(1))(me=xt(ce[0],ce[1],Ut,pe[0],pe[1],B[0],B[1],V[0],V[1],n))?(x[ot]=me,at=ot):ot++;else if(-1===Ut.indexOf(1)&&-1!==be.indexOf(1)){var me;(me=xt(pe[0],pe[1],be,ce[0],ce[1],B[0],B[1],V[0],V[1],n))?((oe=x.slice(at,ot+1)).push(me),r.push(oe),at=++ot):ot++}else{var ke=wt(ce[0],ce[1],pe[0],pe[1],B[0],B[1],V[0],V[1],n);ke?(((oe=x.slice(at,ot+1))[oe.length-1][0]!==ke[0][0]||oe[oe.length-1][1]!==ke[0][1])&&oe.push(ke[0]),oe.length>1&&r.push(oe),x[ot]=ke[1],x[ot+1]&&x[ot+1][0]==ke[1][0]&&x[ot+1][1]==ke[1][1]&&ot++,at=ot):ot++}}at!==ot&&(oe=x.slice(at,x.length))&&r.push(oe)}else r.push(x)};if(i=function G(T){var i=[];if(1===T.length)i=T;else{for(var n=0;n<T.length-1;)(T[n][0]!==T[n+1][0]||T[n][1]!==T[n+1][1])&&i.push(T[n]),n++;0!==T.length&&0===i.length&&i.push(T[0]),(T[T.length-1][0]!==T[i.length-1][0]||T[T.length-1][1]!==T[i.length-1][1])&&i.push(T[n])}return i}(i),1===i.length){for(var g=0;g<T.length;g++)a(T[g]);T=r}else for(var v=0;v<i.length-1;v++){for(g=0;g<T.length;g++)s(T[g],v);T=r,r=[]}for(var p=0;p<T.length;p++)for(var S=0;S<T[p].length;S++)T[p][S][0]=Math.round(T[p][S][0]),T[p][S][1]=Math.round(T[p][S][1]);return T})(bt.data.getNode(at).size.points,S,2);console.log(oe)})})(x)}}}}var O=f(1105);class F{constructor(){let i=(0,b.g1)(ut.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:s,source:g}=(0,O.$)(Math.ceil(1e9*Math.random())),v=(p,S,x,N)=>{s=(0,X.bH)(p,S,x,N),s.x=(0,P.q)(s.x),s.y=(0,P.q)(s.y),s.width=(0,P.q)(s.width),s.height=(0,P.q)(s.height),Object.assign(a,(0,X.sg)(C.$.TEXT,s)),(0,b.__)(r,a),(0,b.g$)(i,s)};return{start:p=>{v(p.x,p.y,p.x+s.width,p.y+s.height)},move:(p,S)=>{v(S[0][0],S[0][1],p.x,p.y)},end:(p,S)=>{s.width>=10&&s.height>=10?bt.data.node=Object.assign({id:n,type:C.$.TEXT,name:"Text"},{size:s,attribute:a,source:g}):null==r||r.remove(),null==i||i.remove()}}}}var Z=f(4113),M=f(9125),Y=f(7797);var Nt=f(6358);class It{constructor(){this._nodeName=["circle","ellipse","line","polygon","rect","text","path","foreignObject","image"],this._selected_Ids=[],this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(i){this._selected_Ids=i,this.change(this.ids)}get nodes(){return this._selected_Ids.map(i=>bt.data.getNode(i)).filter(i=>!i.isfake)}set onchange(i){this._fnChanges.push(i)}change(i){var n,r,a,s,g;null===(n=window.document.getElementById(ut.O.RESIZE_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(ut.O.SELECT_GROUP))||void 0===r||r.remove(),null===(a=window.document.getElementById(ut.O.SCAN_GROUP))||void 0===a||a.remove(),null===(s=window.document.getElementById(ut.O.CREATE_GROUP))||void 0===s||s.remove(),null===(g=window.document.getElementById(ut.O.INTERACTIVE_GROUP))||void 0===g||g.remove(),jQuery('[id^="icdt-temp-"]').remove(),this._fnChanges.forEach(v=>v(i))}deleteNode(){for(let i of this._selected_Ids){let n=bt.data.deleteNode(i);bt.history.push([{type:"delete",from:{id:n},to:{id:n}}])}bt.dataSelect.ids=[]}groupNode(){let i=[];if(bt.dataSelect.ids.length>=2){let n=bt.data.getNode(bt.dataSelect.ids[0]),{nodeId:r,attribute:a,size:s}=(0,Nt.m)(Math.ceil(1e9*Math.random()),void 0,n.pid?window.document.getElementById(n.pid):null);bt.data.node=Object.assign({id:r,type:C.$.GROUP,name:"G"},{size:s,attribute:a});for(let g of bt.dataSelect.ids)i.push(bt.data.addGroup(g,r))}if(i.length){bt.dataSelect.ids=i;let n=bt.dataSelect.nodes;1==n.length?(0,A.y)(n[0]):n.length>1&&(0,E.Q)(n)}}ungroupNode(){let i=[];for(let n of bt.dataSelect.ids)i.push(bt.data.unGroup(n));if(i.length){bt.dataSelect.ids=i;let n=bt.dataSelect.nodes;1==n.length?(0,A.y)(n[0]):n.length>1&&(0,E.Q)(n)}}}var Jt=f(9942);class zt{createNodeImage(i,n){var r,a,s,g;let{nodeId:v,element:p,size:S,attribute:x,source:N}=(0,nt.G)(Math.ceil(1e9*Math.random()),{size:{x:null!==(r=null==n?void 0:n.x)&&void 0!==r?r:0,y:null!==(a=null==n?void 0:n.y)&&void 0!==a?a:0,width:100,height:100},source:{type:"image",image:(0,Jt.I)(i)}});(B=>{if(!B)return;let V=new Image;V.onload=()=>{let ot=(0,P.q)(V.naturalWidth/V.naturalHeight,100);ot>=1?(S.width=Math.min(V.naturalWidth,512),S.height=(0,P.q)(S.width/ot,100)):(S.height=Math.min(V.naturalHeight,512),S.width=(0,P.q)(S.height*ot,100)),S.x=(0,P.q)(S.x-S.width/2,100),S.y=(0,P.q)(S.y-S.height/2,100),Object.assign(x,(0,X.sg)(C.$.IMAGE,S)),(0,b.__)(p,x),bt.data.node=Object.assign({id:v,type:C.$.IMAGE,name:"Image"},{size:S,attribute:x,source:N})},V.onerror=ot=>{console.error(`ImgSrc load failed -> ${B}`,ot),null==p||p.remove()},V.src=B})(null!==(s=null===(g=N.image)||void 0===g?void 0:g.url)&&void 0!==s?s:"")}createNodeIframe(i,n){var r,a;let{nodeId:s,element:g,size:v,attribute:p,style:S,source:x}=(0,Wt.e)(Math.ceil(1e9*Math.random()),{size:{x:null!==(r=null==n?void 0:n.x)&&void 0!==r?r:0,y:null!==(a=null==n?void 0:n.y)&&void 0!==a?a:0,width:100,height:100},style:{},source:{type:"iframe",iframe:(0,Jt.I)(i)}});(N=>{let B=(null===(N=bt.data.slide)||void 0===N||null===(N=N.svg)||void 0===N?void 0:N.viewBox)||{x:0,y:0,width:100,height:100},V=(0,P.q)(B.width/B.height,100);V>=1?(v.width=Math.min(B.width,512),v.height=(0,P.q)(v.width/V,100)):(v.height=Math.min(B.height,512),v.width=(0,P.q)(v.height*V,100)),v.x=(0,P.q)(v.x-v.width/2,100),v.y=(0,P.q)(v.y-v.height/2,100),Object.assign(p,(0,X.sg)(C.$.IMAGE,v)),(0,b.__)(g,p),bt.data.node=Object.assign({id:s,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:v,attribute:p,style:S,source:x})})()}createNodeEmbed(i,n){var r,a;let{nodeId:s,element:g,size:v,attribute:p,style:S,source:x}=(0,Wt.e)(Math.ceil(1e9*Math.random()),{size:{x:null!==(r=null==n?void 0:n.x)&&void 0!==r?r:0,y:null!==(a=null==n?void 0:n.y)&&void 0!==a?a:0,width:100,height:100},style:{},source:{type:"embed",embed:Object.assign(i,(0,Jt.I)(i))}});(N=>{let B=(null===(N=bt.data.slide)||void 0===N||null===(N=N.svg)||void 0===N?void 0:N.viewBox)||{x:0,y:0,width:100,height:100},V=(0,P.q)(B.width/B.height,100);V>=1?(v.width=Math.min(B.width,512),v.height=(0,P.q)(v.width/V,100)):(v.height=Math.min(B.height,512),v.width=(0,P.q)(v.height*V,100)),v.x=(0,P.q)(v.x-v.width/2,100),v.y=(0,P.q)(v.y-v.height/2,100),Object.assign(p,(0,X.sg)(C.$.IMAGE,v)),(0,b.__)(g,p),bt.data.node=Object.assign({id:s,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:v,attribute:p,style:S,source:x})})()}createNodeMedia(i,n){var r,a,s,g;let{nodeId:v,element:p,size:S,attribute:x,source:N}=(0,nt.G)(Math.ceil(1e9*Math.random()),{size:{x:null!==(r=null==n?void 0:n.x)&&void 0!==r?r:0,y:null!==(a=null==n?void 0:n.y)&&void 0!==a?a:0,width:100,height:100},source:{type:"image",image:(0,Jt.I)(i.cover)}}),B={click:{media:i.media}};(V=>{if(!V)return;let ot=new Image;ot.onload=()=>{let at=(0,P.q)(ot.naturalWidth/ot.naturalHeight,100);at>=1?(S.width=Math.min(ot.naturalWidth,512),S.height=(0,P.q)(S.width/at,100)):(S.height=Math.min(ot.naturalHeight,512),S.width=(0,P.q)(S.height*at,100)),S.x=(0,P.q)(S.x-S.width/2,100),S.y=(0,P.q)(S.y-S.height/2,100),Object.assign(x,(0,X.sg)(C.$.IMAGE,S)),(0,b.__)(p,x),bt.data.node=Object.assign({id:v,type:C.$.IMAGE,name:"Image"},{size:S,attribute:x,source:N,interactive:B})},ot.onerror=at=>{console.error(`ImgSrc load failed -> ${V}`,at),null==p||p.remove()},ot.src=V})(null!==(s=null===(g=N.image)||void 0===g?void 0:g.url)&&void 0!==s?s:"")}insert(i){var n;if(bt.data.insertSlide(bt.data.slideId,1),i.title){let{nodeId:r,size:a,attribute:s,style:g,source:v}=(0,Wt.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${i.title}</span>`}}});bt.data.node=Object.assign({id:r,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:s,style:g,source:v})}if(i.description){let{nodeId:r,size:a,attribute:s,style:g,source:v}=(0,Wt.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${i.description.replace(/\n/g,"<br/>")}</span>`}}});bt.data.node=Object.assign({id:r,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:s,style:g,source:v})}null!==(n=i.media)&&void 0!==n&&n.prompt&&((()=>{let{nodeId:r,size:a,attribute:s}=(0,ct.f)(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});bt.data.node=Object.assign({id:r,type:C.$.RECT,name:"Rect"},{size:a,attribute:s})})(),(r=>{let{nodeId:a,size:s,attribute:g,style:v,source:p}=(0,Wt.e)(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(r=i.media)||void 0===r?void 0:r.prompt}</i></span>`}}});bt.data.node=Object.assign({id:a,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:s,attribute:g,style:v,source:p})})())}}var Gt=f(5226);class Vt{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:bt.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var i;let n=null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((s,g)=>g==this._slideIdx),r=null==n?void 0:n.svg,a=s=>{let g=[];return s.filter(v=>!v.isdeleted).forEach(v=>{v.type==C.$.GROUP?g=g.concat(a(v.nodes||[])):g.push(v.id)}),g};return a((null==r?void 0:r.nodes)||[])}}get get(){var i;let n=r=>{var a,s;return null===(a=r)||void 0===a||a.filter(g=>g.type==C.$.GROUP).forEach(g=>{var v;g.nodes=n(null===(v=g.nodes)||void 0===v?void 0:v.filter(p=>!p.isdeleted))}),(r=null===(s=r)||void 0===s?void 0:s.filter(g=>{var v,p;return g.type!=C.$.GROUP||(null!==(v=null===(p=g.nodes)||void 0===p?void 0:p.length)&&void 0!==v?v:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(s=>!s.isdeleted)))}),this._dataSource}get getResource(){var i;let n=[];return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a,s,g,v,p,S,x,N;n.push(null===(a=r.svg)||void 0===a||null===(a=a.background)||void 0===a?void 0:a.path),null===(s=r.svg)||void 0===s||s.nodes.forEach(B=>{var V,ot,at,Ut,oe,ce,pe,be,me,ke;n.push(null===(V=B.source)||void 0===V||null===(V=V.image)||void 0===V?void 0:V.path),n.push(null===(ot=B.source)||void 0===ot||null===(ot=ot.audio)||void 0===ot?void 0:ot.path),n.push(null===(at=B.source)||void 0===at||null===(at=at.video)||void 0===at?void 0:at.path),n.push(null===(Ut=B.source)||void 0===Ut||null===(Ut=Ut.file)||void 0===Ut?void 0:Ut.path),n.push(null===(oe=B.source)||void 0===oe||null===(oe=oe.iframe)||void 0===oe?void 0:oe.path),n.push(null===(ce=B.source)||void 0===ce||null===(ce=ce.track)||void 0===ce?void 0:ce.path),n.push(null===(pe=B.interactive)||void 0===pe||null===(pe=pe.show)||void 0===pe||null===(pe=pe.audio)||void 0===pe||null===(pe=pe.source)||void 0===pe?void 0:pe.path),n.push(null===(be=B.interactive)||void 0===be||null===(be=be.click)||void 0===be||null===(be=be.audio)||void 0===be||null===(be=be.source)||void 0===be?void 0:be.path),n.push(null===(me=B.interactive)||void 0===me||null===(me=me.click)||void 0===me||null===(me=me.image)||void 0===me||null===(me=me.source)||void 0===me?void 0:me.path),n.push(null===(ke=B.interactive)||void 0===ke||null===(ke=ke.click)||void 0===ke||null===(ke=ke.video)||void 0===ke||null===(ke=ke.source)||void 0===ke?void 0:ke.path)}),n.push(null===(g=r.test)||void 0===g||null===(g=g.audiotrue)||void 0===g?void 0:g.path),n.push(null===(v=r.test)||void 0===v||null===(v=v.audiofalse)||void 0===v?void 0:v.path),n.push(null===(p=r.test)||void 0===p||null===(p=p.effecttrue)||void 0===p?void 0:p.path),n.push(null===(S=r.test)||void 0===S||null===(S=S.effectfalse)||void 0===S?void 0:S.path),n.push(null===(x=r.test)||void 0===x||null===(x=x.icontrue)||void 0===x?void 0:x.path),n.push(null===(N=r.test)||void 0===N||null===(N=N.iconfalse)||void 0===N?void 0:N.path)}),n.filter(r=>r).map(r=>r.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((r,a,s)=>s.indexOf(r)==a)}set set(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,b.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var i;let n=r=>{var a,s;return null===(a=r)||void 0===a||a.filter(g=>g.type==C.$.GROUP).forEach(g=>{var v;g.nodes=n(null===(v=g.nodes)||void 0===v?void 0:v.filter(p=>!p.isdeleted))}),(r=null===(s=r)||void 0===s?void 0:s.filter(g=>{var v,p;return g.type!=C.$.GROUP||(null!==(v=null===(p=g.nodes)||void 0===p?void 0:p.length)&&void 0!==v?v:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(s=>!s.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,b.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var i,n;return null!==(i=null===(n=this.slide)||void 0===n?void 0:n.id)&&void 0!==i?i:0}get slideIdx(){return this._slideIdx}get slide(){var i;return null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((n,r)=>r==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var i,n;this._slideIdx<(null!==(i=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==i?i:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}openSlide(i,n){var r,a,s,g;if(i)for(let N=0,B=null!==(v=null===(p=this._dataSource.slides)||void 0===p?void 0:p.length)&&void 0!==v?v:0;N<B;N++){var v,p,S;if((null!==(S=this._dataSource.slides)&&void 0!==S?S:[])[N].id==i){this._slideIdx=N;break}}else if(n&&n>=0&&n<(null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.length)&&void 0!==r?r:0))this._slideIdx=null!=n?n:0;else{var x;this._slideIdx=0,null!==(x=this._dataSource.slides)&&void 0!==x&&x.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}(0,b.wM)(),(0,Gt.E)(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(s=null===(g=this._dataSource.slides)||void 0===g?void 0:g.length)&&void 0!==s?s:0,this.slide)}addSlide(){var i,n,r;null===(i=this._dataSource.slides)||void 0===i||i.push(this._defaultSlide),this._slideIdx=(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1,this.openSlide(void 0,this._slideIdx)}insertSlide(i,n,r){var a,s,g,v,p;let S=null!==(a=null===(s=this._dataSource.slides)||void 0===s?void 0:s.find(B=>B.id==i))&&void 0!==a?a:this._defaultSlide,x=(null!==(g=null===(v=this._dataSource.slides)||void 0===v?void 0:v.indexOf(S))&&void 0!==g?g:0)+n;var N;r?(r.id=this.newSlideId,r.code=void 0,r.name="Trang m\u1edbi",null!==(N=r.svg)&&void 0!==N&&N.viewBox||r.svg&&(r.svg.viewBox=bt.screen.frameSize)):r=this._defaultSlide,null===(p=this._dataSource.slides)||void 0===p||p.splice(x,0,r),this._slideIdx=x,this.openSlide(void 0,this._slideIdx)}copySlide(i){var n,r,a,s,g,v,p;let S=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(B=>B.id==i))&&void 0!==n?n:this._defaultSlide,x=(null!==(a=null===(s=this._dataSource.slides)||void 0===s?void 0:s.indexOf(S))&&void 0!==a?a:0)+1,N=Object.assign(JSON.parse(JSON.stringify(S)),{id:this.newSlideId,code:void 0,name:`${S.name} + (Copy)`});null===(g=this._dataSource.slides)||void 0===g||g.splice(x,0,N),this.changeSlide(this.slides,this.slideIdx,null!==(v=null===(p=this._dataSource.slides)||void 0===p?void 0:p.length)&&void 0!==v?v:0,this.slide)}moveSlide(i,n){var r,a,s,g,v,p;let S=null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(N=>N.id==i))&&void 0!==r?r:this._defaultSlide,x=null!==(s=null===(g=this._dataSource.slides)||void 0===g?void 0:g.indexOf(S))&&void 0!==s?s:0;null===(v=this._dataSource.slides)||void 0===v||v.splice(x+n,0,null===(p=this._dataSource.slides)||void 0===p?void 0:p.splice(x,1)[0])}deleteSlide(i){var n,r,a,s,g,v;let p=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(B=>B.id==i))&&void 0!==n?n:this._defaultSlide,S=null!==(a=null===(s=this._dataSource.slides)||void 0===s?void 0:s.indexOf(p))&&void 0!==a?a:0;if(null===(g=this._dataSource.slides)||void 0===g||g.splice(S,1),null!==(v=this._dataSource.slides)&&void 0!==v&&v.length)if(S<this._slideIdx){var x,N;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(x=null===(N=this._dataSource.slides)||void 0===N?void 0:N.length)&&void 0!==x?x:0,this.slide)}else S==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(i){var n,r,a,s,g;let v=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(S=>S.id==i))&&void 0!==n?n:this._defaultSlide,p=null!==(a=null===(s=this._dataSource.slides)||void 0===s?void 0:s.indexOf(v))&&void 0!==a?a:0;if(v.isdeleted=!0,null!==(g=this._dataSource.slides)&&void 0!==g&&null!==(g=g.filter(S=>!S.isdeleted))&&void 0!==g&&g.length){let S=!0;for(;v.isdeleted;)S?p++:p--,this._dataSource.slides[p]?v=this._dataSource.slides[p]:S=!S;this.openSlide(v.id)}else this.addSlide()}set onChangeSlide(i){this._fnChangeSlides.push(i)}changeSlide(i,n,r,a){this._fnChangeSlides.forEach(s=>s(i,n,r,a))}set node(i){var n,r;let a=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((g,v)=>v==this._slideIdx),s=null==a?void 0:a.svg;null!=s&&s.nodes&&(null==s||s.nodes.push(i)),bt.history.push([{type:"add",from:{id:i.id},to:{id:i.id}}]),(0,Gt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id)}findNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((B,V)=>V==this._slideIdx),a=null==r?void 0:r.svg,s=(B,V)=>{let ot=null==B?void 0:B.find(oe=>oe.id==i);if(ot)return ot.pid=V,ot;let at=0,Ut=B.length||0;for(;at<Ut&&!ot&&(ot=s(B[at].nodes||[],B[at].id),!ot);)at++;return ot},g=s((null==a?void 0:a.nodes)||[]);var v,p,S,x,N;return g?(g.style=null!==(v=g.style)&&void 0!==v?v:{},g.source=null!==(p=g.source)&&void 0!==p?p:{},g.animate=null!==(S=g.animate)&&void 0!==S?S:{},g.interactive=null!==(x=g.interactive)&&void 0!==x?x:{},g.variable=null!==(N=g.variable)&&void 0!==N?N:{},g):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((v,p)=>p==this._slideIdx),a=null==r?void 0:r.svg,g=v=>{let p=(null==v?void 0:v.find(ot=>ot.id==i))||(v=>{let p=null,S=0,x=v.length||0;for(;S<x&&!p;){if(p=g(v[S].nodes),p){p.pid=v[S].id;break}S++}var N,B,V,ot,at;return p&&(p.style=null!==(N=p.style)&&void 0!==N?N:{},p.source=null!==(B=p.source)&&void 0!==B?B:{},p.animate=null!==(V=p.animate)&&void 0!==V?V:{},p.interactive=null!==(ot=p.interactive)&&void 0!==ot?ot:{},p.variable=null!==(at=p.variable)&&void 0!==at?at:{}),p})((null==v?void 0:v.filter(ot=>ot.type==C.$.GROUP))||[]);var S,x,N,B,V;return p&&(p.style=null!==(S=p.style)&&void 0!==S?S:{},p.source=null!==(x=p.source)&&void 0!==x?x:{},p.animate=null!==(N=p.animate)&&void 0!==N?N:{},p.interactive=null!==(B=p.interactive)&&void 0!==B?B:{},p.variable=null!==(V=p.variable)&&void 0!==V?V:{}),p};return g((null==a?void 0:a.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(i,n,r,a,s){var g;let v=null===(g=this._dataSource.slides)||void 0===g?void 0:g.find((x,N)=>N==this._slideIdx),p=null==v?void 0:v.svg,S=x=>{let N=[];return x.filter(B=>!B.isdeleted).forEach(B=>{B.type==C.$.GROUP?N=N.concat(S(B.nodes||[])):i>B.size.x||n>B.size.y||r<B.size.x+B.size.width||a<B.size.y+B.size.height||(s?B.type==s&&N.push(B.id):N.push(B.id))}),N};return S((null==p?void 0:p.nodes)||[])}getNodeOnArea(i,n,r,a,s){var g;let v=null===(g=this._dataSource.slides)||void 0===g?void 0:g.find((x,N)=>N==this._slideIdx),p=null==v?void 0:v.svg,S=x=>{let N=[];return x.filter(B=>!B.isdeleted).forEach(B=>{B.type==C.$.GROUP?N=N.concat(S(B.nodes||[])):B.size.x+B.size.width<i||B.size.y+B.size.height<n||B.size.x>r||B.size.y>a||(s?B.type==s&&N.push(B.id):N.push(B.id))}),N};return S((null==p?void 0:p.nodes)||[])}deleteNode(i,n){var r;return this.getNode(i).isdeleted=null==n||n,(0,Gt.E)(this.slide),(0,Gt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),i}unGroup(i){var n,r;let a=this.getNode(i),s=Math.ceil(1e9*Math.random());return null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:s})),Object.assign(a,{isdeleted:!0}),(0,Gt.E)(this.slide),(0,Gt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),s}addGroup(i,n){var r;let a=this.getNode(i),s=this.getNode(n);s.nodes=s.nodes||[];let g=Math.ceil(1e9*Math.random());return s.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:g})),Object.assign(a,{isdeleted:!0}),(0,Gt.E)(this.slide),(0,Gt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),g}setNodeP(i,n){var r;let a=null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r?void 0:r.nodes.find(s=>s.id==i);a&&(a.pid=n||null)}bringToFront(i){var n,r,a;let s=i.map(V=>bt.data.getNode(V)).filter(V=>!V.isfake),{x1:g,y1:v,x2:p,y2:S}=ae(s),x=this.getNodeOnArea(g,v,p,S);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((V,ot)=>{V.index=ot+1});let N=x.map(V=>{var ot,at;return null!==(ot=null===(at=this.slide)||void 0===at||null===(at=at.svg)||void 0===at||null===(at=at.nodes.find(Ut=>Ut.id==V))||void 0===at?void 0:at.index)&&void 0!==ot?ot:0}),B=Math.max.apply(null,N);i.forEach((V,ot)=>{var at;null===(at=this.slide)||void 0===at||null===(at=at.svg)||void 0===at||at.nodes.filter(Ut=>Ut.id==V).forEach(Ut=>{Ut.index=B+(ot+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((V,ot)=>{var at,Ut;return(null!==(at=V.index)&&void 0!==at?at:0)-(null!==(Ut=ot.index)&&void 0!==Ut?Ut:0)}),(0,Gt.T)(this.slide),null===(a=window.document.getElementById(ut.O.SELECT_GROUP))||void 0===a||a.remove(),(0,E.Q)(s)}sendToBack(i){var n,r,a;let s=i.map(V=>bt.data.getNode(V)).filter(V=>!V.isfake),{x1:g,y1:v,x2:p,y2:S}=ae(s),x=this.getNodeOnArea(g,v,p,S);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((V,ot)=>{V.index=ot+1});let N=x.map(V=>{var ot,at;return null!==(ot=null===(at=this.slide)||void 0===at||null===(at=at.svg)||void 0===at||null===(at=at.nodes.find(Ut=>Ut.id==V))||void 0===at?void 0:at.index)&&void 0!==ot?ot:0}),B=Math.min.apply(null,N)-1;i.forEach((V,ot)=>{var at;null===(at=this.slide)||void 0===at||null===(at=at.svg)||void 0===at||at.nodes.filter(Ut=>Ut.id==V).forEach(Ut=>{Ut.index=B+(ot+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((V,ot)=>{var at,Ut;return(null!==(at=V.index)&&void 0!==at?at:0)-(null!==(Ut=ot.index)&&void 0!==Ut?Ut:0)}),(0,Gt.T)(this.slide),null===(a=window.document.getElementById(ut.O.SELECT_GROUP))||void 0===a||a.remove(),(0,E.Q)(s)}}const ae=T=>{let i=999999,n=999999,r=-999999,a=-999999;return T.forEach(s=>{i=Math.min(i,s.size.x),n=Math.min(n,s.size.y),r=Math.max(r,s.size.x+s.size.width),a=Math.max(a,s.size.y+s.size.height)}),{x1:i,y1:n,x2:r,y2:a}};class ye{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":bt.data.deleteNode(n.from.id);break;case"edit":break;case"delete":bt.data.deleteNode(n.from.id,!1);break;case"size":{let{id:r,type:a,size:s,attribute:g}=bt.data.getNode(n.from.id);Object.assign(s,n.from.size),Object.assign(g,(0,X.sg)(a,s)),(0,b.__)(window.document.getElementById(r),g);break}case"attribute":{let{id:r,attribute:a}=bt.data.getNode(n.from.id);Object.assign(a,n.from.attribute),(0,b.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=bt.data.getNode(n.from.id);Object.assign(null!=a?a:{},n.from.style),(0,b.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:s}=bt.data.getNode(n.from.id);Object.assign(null!=s?s:{},n.from.source),(0,b.QI)(window.document.getElementById(r),a,null!=s?s:{});break}case"animate":{let{animate:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.animate);break}case"interactive":{let{interactive:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.interactive);break}case"variable":{let{variable:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.variable);break}}}),bt.dataSelect.ids=[]},this.redoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":bt.data.deleteNode(n.to.id,!1);break;case"edit":break;case"delete":bt.data.deleteNode(n.to.id,!0);break;case"size":{let{id:r,type:a,size:s,attribute:g}=bt.data.getNode(n.to.id);Object.assign(s,n.to.size),Object.assign(g,(0,X.sg)(a,s)),(0,b.__)(window.document.getElementById(r),g);break}case"attribute":{let{id:r,attribute:a}=bt.data.getNode(n.to.id);Object.assign(a,n.to.attribute),(0,b.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=bt.data.getNode(n.to.id);Object.assign(null!=a?a:{},n.to.style),(0,b.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:s}=bt.data.getNode(n.to.id);Object.assign(null!=s?s:{},n.to.source),(0,b.QI)(window.document.getElementById(r),a,null!=s?s:{});break}case"animate":{let{animate:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.animate);break}case"interactive":{let{interactive:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.interactive);break}case"variable":{let{variable:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.variable);break}}}),bt.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(i){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:i}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:i})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(i){this._fnChanges.push(i)}change(){this._fnChanges.forEach(i=>i(this.index,this.total))}}class Ee{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(i){this._actived=i}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(i){var n,r;this._frameSize.width=null!==(n=null==i?void 0:i.width)&&void 0!==n?n:1080,this._frameSize.height=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}get frameSize(){return this._frameSize}set frameSize(i){this._frameSize.x=i.x,this._frameSize.y=i.y,this._frameSize.width=i.width,this._frameSize.height=i.height,this.reset()}set screen(i){this._offset=i.offset,this._width=i.width,this._height=i.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(i,n,r){var a;if(!(i<.1||i>10)){if(n=null!==(a=n)&&void 0!==a?a:{x:this._width/2,y:this._height/2},r)this._dislocation.x=this._width/i/2-n.x,this._dislocation.y=this._height/i/2-n.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var s={x:Math.max(0,Math.min((0,P.q)(n.x/this._width,1e3),1)),y:Math.max(0,Math.min((0,P.q)(n.y/this._height,1e3),1))},g={x:(this._width/i-this._width/this._scale)*s.x,y:(this._height/i-this._height/this._scale)*s.y};this._dislocation.x+=g.x,this._dislocation.y+=g.y}this._scale=i,this.change(),this.zoomChange(this.scale)}}set zoomTo(i){"fit"==i?this.scaleTo(Math.min((this._width-60)/this._frameSize.width,(this._height-60)/this._frameSize.height),void 0,!0):"number"==typeof i&&this.scaleTo(i/100,void 0,!0)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(i,n){this._dislocation.x=i.x+n.x/this._scale,this._dislocation.y=i.y+n.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(0,b.eb)()}set onZoomChange(i){this._fnZoomChanges.push(i)}zoomChange(i){this._fnZoomChanges.forEach(n=>n(i))}}var fe=f(644);class ve{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){(0,fe.sV)({callback:i=>{this._fill=(null==i?void 0:i.fill)||this._fill,this._stroke=(null==i?void 0:i.stroke)||this._stroke,this._strokeWidth=(null==i?void 0:i.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==i?void 0:i.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==i?void 0:i.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){(0,fe.qp)({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(i){this._fill=i,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(i){this._stroke=i,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(i){this._strokeWidth=i,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(i){this._strokeLinecap=i}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(i){this._strokeLinejoin=i}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(i){this._fnChangeFills.push(i)}changeFill(i){this._fnChangeFills.forEach(n=>n(i)),this.saveConfig()}set onchangestroke(i){this._fnChangeStrokes.push(i)}changeStroke(i){this._fnChangeStrokes.forEach(n=>n(i)),this.saveConfig()}set onchangestrokewidth(i){this._fnChangeStrokeWidths.push(i)}changeStrokeWidth(i){this._fnChangeStrokeWidths.forEach(n=>n(i)),this.saveConfig()}}var Oe=f(1690),ni=f(5973),ri=f(4787),Ae=function(T){return T&&JSON.parse(JSON.stringify(T))},Ge=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],Ze=[],ai={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},oi={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class ti{constructor(){this._data_variables=Ae(Ge).concat(Ae(Ze)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=i=>{"function"==typeof i&&this.GetActionExecuteds.push(i)},this.OnGetActionExecuted=i=>{this.GetActionExecuteds.forEach(n=>{n(i)})},this.SetActionExecutings=[],this.FuncSetExecutings=i=>{"function"==typeof i&&this.SetActionExecutings.push(i)},this.OnSetActionExecuting=i=>{this.SetActionExecutings.forEach(n=>{n(i)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=i=>{"function"==typeof i&&this.SetActionExecuteds.push(i)},this.OnSetActionExecuted=i=>{for(var n of(this.SetActionExecuteds.forEach(r=>{r(i)}),this.getCondition(i.key)||[]))n.if&&n.if.length>0&&(this.checkValueConditions(n.if)?this.setValueOperators(n.then||[]):this.setValueOperators(n.else||[]))}}renew(){this._data_variables=Ae(Ge).concat(Ae(Ze)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(i){if(!i)return;let n={};"string"==typeof i?n=JSON.parse(i):"object"==typeof i&&(n=i),this._data_variables=n.variables||[],this._data_conditions=n.conditions||(r=>(this._data_variables.map(a=>a.change||[]).forEach(a=>{r=r.concat(a)}),r))([]),Ge.forEach(r=>{var a=this._data_variables.filter(s=>s.key==r.key);a.length?a.forEach(function(s,g,v){s.type=r.type,s.readonly=r.readonly,s.system=r.system}):this._data_variables.push(r)})}getVariableTemp(){return Ae(ai)}getConditionTemp(){return Ae(oi)}getKeys(){return this._data_variables.map(function(i){return i.key}).sort(function(i,n){return i.localeCompare(n)})}getVariableAll(){return this._data_variables.length?Ae((T=this._data_variables,i="key",function(n){for(var r of T.map(function(a){return a[i]}).sort())T.filter(function(a){return a[i]==r}).forEach(function(a){n.push(a)}),T=T.filter(function(a){return a[i]!=r});return n}([]))):Ae(Ge).concat(Ae(Ze));var T,i}setVariableAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_variables=i),Ge.forEach(n=>{var r=this._data_variables.filter(a=>a.key==n.key);r.length?r.forEach((a,s,g)=>{a.type=n.type,a.readonly=n.readonly,a.system=n.system}):this._data_variables.push(n)}))}getVariable(i){return i?Ae(this._data_variables.filter(n=>n.key==i)[0]||{}):{}}setVariable(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(s=>s.key==i)[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(s=>s.key==i);a.length?a.forEach(function(s,g,v){s.value=n,s.type=r}):this._data_variables.push({key:i,value:n,type:r})}}getValue(i,n){if(!i)return"";var r=this._data_variables.filter(function(g){return g.key==i});if(r.length){var s,a=r[0]||{};switch(this.OnGetActionExecuting(a),n||(n=a.type||null),n){case"string":s=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":"string"==typeof a.value?a.value||"":a.value.toString().trim();break;case"number":s=[null,void 0,NaN,1/0].indexOf(a.value)>=0?0:"number"==typeof a.value?a.value||0:parseFloat(a.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(a.value)>=0?s=!1:"boolean"==typeof a.value?s=a.value:(s=(a.value+"").toLowerCase(),s="1"==a.value||"true"==a.value||"yes"==a.value||"dung"==a.value);break;case"audio-src":s=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></audio>`:"";break;case"video-src":s=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></video>`:"";break;case"img-src":s=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<img style="width:100%;vertical-align:middle;" src="${a.value}"/>`:"";break;default:s=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value}return this.OnGetActionExecuted(a),s}return null}setValue(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(function(g){return g.key==i})[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(function(g){return g.key==i});if(a.length){var s=a[0];this.OnSetActionExecuting(s),s&&(s.value=n),this.OnSetActionExecuted(s)}}}getConditionAll(){return Ae(this._data_conditions.sort(function(i,n){return i.idx-n.idx}))}setConditionAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_conditions=i))}getCondition(i){return i?Ae(this._data_conditions.filter(n=>n.variable==i||(n.variables||[]).indexOf(i)>=0).sort(function(n,r){return n.idx-r.idx})):{}}switchCondition(i,n,r){switch(i){case"==":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,s){return a+s})>0):n==r;case"!=":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),0==r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,s){return a+s})):n!=r;case">=":return n>=r;case"<=":return n<=r;case">":return n>r;case"<":return n<r;case"\u2208":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,s){return a+s})>0;case"\u2209":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),0==r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,s){return a+s});default:return!1}}switchOperator(i,n,r){switch(i){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return n/r;case"=":return r;case"=!":return!r;case"==":return n==r;case"!=":return n!=r}}switchFormula(i,n){switch(i){case"sum":return n.reduce(function(a,s){return a+s});case"sub":return n.reduce(function(a,s){return a-s});case"pro":return n.reduce(function(a,s){return a*s});case"div":return n.reduce(function(a,s){return a/s});case"avg":var r=n.reduce(function(a,s){return a+s})/(n.length||1);return Math.round(1e4*(r+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,n);case"max":return Math.max.apply(null,n);case"and":return n.reduce(function(a,s){return a&&s});case"or":return n.reduce(function(a,s){return a||s});default:return 0}}switchValueType_Condition(i){switch(i.valuetype){case"value":return this.switchCondition(i.condition,this.getValue(i.variable),i.value);case"variable":return this.switchCondition(i.condition,this.getValue(i.variable),this.getValue(i.value));default:return 0}}switchValueType_Operator(i){switch(i.valuetype){case"value":return this.switchOperator(i.operator,this.getValue(i.variable),i.value);case"variable":return this.switchOperator(i.operator,this.getValue(i.variable),this.getValue(i.value));case"variables":var n=this.switchFormula(i.valueformula,i.value.map(r=>this.getValue(r)));return this.switchOperator(i.operator,this.getValue(i.variable),n)}}checkValueCondition(i){return this.switchValueType_Condition(i)}getValueOperator(i){return this.switchValueType_Operator(i)}setValueOperator(i){null!=i&&i.variable&&this.setValue(i.variable,this.getValueOperator(i))}checkValueConditions(i){return 0==i.map(n=>{switch(n.type){case"variable":return this.switchValueType_Condition(n)?0:1;case"variables":return 0==n.variables.map(r=>this.switchValueType_Condition(Object.assign(Ae(n),{variable:r}))?0:1).reduce(function(r,a){return r+a})?0:1;default:return 0}}).reduce((n,r)=>(null!=n?n:0)+(null!=r?r:0))}setValueOperators(i){for(var n of i)switch(n.type){case"variable":this.setValue(n.variable,this.getValueOperator(n));break;case"variables":for(var r of n.variables)this.setValue(r,this.getValueOperator(Object.assign(Ae(n),{variable:r})));break;case"slide":Oe.$.runSlide(void 0,void 0,n.slide);break;case"node":{var a;(0,ri.L5)({id:n.node,nodeStatus:Oe.$.nodeStatus,slideStatus:Oe.$.slideStatus});let s=Oe.$.findNode(n.node);null!=s&&null!==(a=s.interactive)&&void 0!==a&&a.click&&(0,ni.F)(s,Oe.$.nodeStatus,Oe.$.slideStatus);break}}}FuncGetExecutings(i){"function"==typeof i&&this.GetActionExecutings.push(i)}OnGetActionExecuting(i){this.GetActionExecutings.forEach(n=>{n(i)})}}class Xe{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(i,n,r){if(this._pointer_type=i,n)switch(i){case K._.PEN:this._pen_type=n;break;case K._.SHAPE:this._shape_type=n,r&&n===C.$.POLYGON&&(this._polygon_type=r)}}get pointer_type(){return this._pointer_type}set pointer_type(i){this._pointer_type=i,this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(i){this._pointer_type_temp=i,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(i){this._pen_type=i,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(i){this._shape_type=i,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(i){this._polygon_type=i,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(i){this._fnChangePointerTypes.push(i)}changePointerType(i,n,r){this._fnChangePointerTypes.forEach(a=>a(i,n,r))}set onchangePointerTypeTemp(i){this._fnChangePointerTypeTemps.push(i)}changePointerTypeTemp(i,n,r){this._fnChangePointerTypeTemps.forEach(a=>a(i,n,r))}set onchangePenType(i){this._fnChangePenTypes.push(i)}changePenType(i,n,r){this._fnChangePenTypes.forEach(a=>a(i,n,r))}set onchangeShapeType(i){this._fnChangeShapeTypes.push(i)}changeShapeType(i,n,r){this._fnChangeShapeTypes.forEach(a=>a(i,n,r))}set onchangePolygonType(i){this._fnChangePolygonTypes.push(i)}changePolygonType(i,n,r){this._fnChangePolygonTypes.forEach(a=>a(i,n,r))}set onchange(i){this._fnChanges.push(i)}change(i,n,r){this._fnChanges.forEach(a=>a(i,n,r))}}const bt=new class si{constructor(){this._container="",this._svg="",this._screen=Ee.prototype,this._data=Vt.prototype,this._dataSelect=It.prototype,this._slide=zt.prototype,this._history=ye.prototype,this._attribute=ve.prototype,this._pointer=Xe.prototype,this._variable=ti.prototype,this._data=new Vt,this._dataSelect=new It,this._slide=new zt,this._history=new ye,this._attribute=new ve,this._pointer=new Xe,this._variable=new ti,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._pointer.onchangePointerTypeTemp=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(i){this._config=i}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,resources:this._data.getResource,variable:this._variable.get,info:{}}}set dataSource(i){this._screen.set=i.screen||{width:1080,height:1080},this._data.set=i.data||{},this._variable.set=i.variable||{}}get container(){return this._container}set container(i){this._container=i}get svg(){return this._svg}set svg(i){this._svg=i}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var i,n,r,a,s;this._screen.screen=(i=jQuery(this._container).offset(),n=jQuery(this._container).width(),r=jQuery(this._container).height(),console.log("reloadView",JSON.stringify({offset:i,width:n,height:r})),{offset:{x:null!==(a=null==i?void 0:i.left)&&void 0!==a?a:0,y:null!==(s=null==i?void 0:i.top)&&void 0!==s?s:0},width:null!=n?n:0,height:null!=r?r:0})}init(i){this._container=i.container,this._svg=i.target,this._screen=new Ee,(T=>{new b.Mh(T.container,T.target),bt.pointer.onchange=(r,a,s)=>{switch(r){case K._.POINTER:jQuery(T.target).css({cursor:"auto"});break;case K._.HAND:jQuery(T.target).css({cursor:"grab"});break;case K._.PEN:switch(a){case M.D.DRAW:jQuery(T.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case M.D.HIGHTLIGH:jQuery(T.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case K._.ERASER:jQuery(T.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case K._.SHAPE:jQuery(T.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case K._.TEXT:case K._.FOREIGNOBJECT:jQuery(T.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}},jQuery(T.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{bt.pointer.pointer_type==K._.HAND&&jQuery(T.target).css({cursor:"grabbing"})}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{bt.pointer.pointer_type==K._.HAND&&jQuery(T.target).css({cursor:"grab"})}),jQuery(T.container).off("mousewheel.icdt-init").on("mousewheel.icdt-init",r=>{var a;r.preventDefault();var s=bt.screen.scale,g=(null!==(a=r.originalEvent)&&void 0!==a?a:r).deltaY>0?1:-1;bt.screen.scaleTo(s-.04*s*g,(0,Y.p)({x:r.clientX,y:r.clientY},1,{x:0,y:0},bt.screen.offset))}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{bt.screen.actived=!!jQuery(r.target).parents("app-main").length}),jQuery(T.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{bt.screen.actived=!0}),jQuery(T.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{bt.screen.actived=!1}),jQuery(T.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(T.container.includes("#")&&T.container.includes(r.target.getAttribute("id"))||T.container.includes(".")&&T.container.includes(r.target.getAttribute("class"))||T.container.includes(r.target.nodeName))&&(bt.pointer.pointer_type_temp||bt.pointer.pointer_type)===K._.POINTER&&(bt.dataSelect.ids=[])}),jQuery(T.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const i=r=>{switch(bt.pointer.pointer_type_temp||bt.pointer.pointer_type){case K._.POINTER:k(r);break;case K._.HAND:(T=>{(0,c.A)(T,new it,1,{x:0,y:0})})(r);break;case K._.PEN:(0,mt.i)(r);break;case K._.SHAPE:(T=>{var i=null;switch(bt.pointer.shape_type){case C.$.CIRCLE:i=new lt;break;case C.$.ELLIPSE:i=new _t;break;case C.$.LINE:i=new Dt;break;case C.$.RECT:i=new tt;break;case C.$.POLYGON:var n;i=new Kt(null===(n=Q.find(r=>r.type==bt.pointer.polygon_type))||void 0===n?void 0:n.ratios);break;case C.$.FOREIGNOBJECT:i=new ht;break;case C.$.IMAGE:i=new Et;break;case C.$.TEXT:case C.$.PATH:i=new Mt}i&&(0,c.A)(T,i)})(r);break;case K._.FOREIGNOBJECT:(T=>{(0,c.A)(T,new ht)})(r);break;case K._.IMAGE:(T=>{(0,c.A)(T,new Et)})(r);break;case K._.TEXT:(T=>{(0,c.A)(T,new F)})(r);break;case K._.ERASER:(T=>{(0,c.A)(T,new z)})(r);break;case K._.INDEX:(0,Z.s)(r)}};let n=!1;jQuery(T.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,i({touchEvent:r})}),jQuery(T.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);i({mouseEvent:r})}}),T.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{bt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Yt.t)(r))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{bt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Yt.t)(r))}))})({container:i.container,target:i.target,iskeyboard:i.iskeyboard})}}},4113:(he,Ct,f)=>{f.d(Ct,{s:()=>E,Q:()=>m});var K=f(1687),b=f(4981),ut=f(4318),C=f(6816),X=f(4080);const E=k=>{var w,it,U,Q;let st=(null===(w=k.mouseEvent)||void 0===w?void 0:w.target)||(null===(it=k.touchEvent)||void 0===it?void 0:it.target),P=(null==st?void 0:st.getAttribute("id"))||"",lt=null==st?void 0:st.nodeName,gt=jQuery(st).parents("g[id]").attr("id")||"";if(![K.O.INDEX_GROUP].includes(gt))if(null!==(U=k.mouseEvent)&&void 0!==U&&U.altKey||null!==(Q=k.touchEvent)&&void 0!==Q&&Q.altKey||!P||P.match(/[^0-9]/)||!b.icdt.dataSelect.nodeName.includes(lt)){var _t;b.icdt.dataSelect.ids.length&&(b.icdt.dataSelect.ids=[]),(0==(null===(_t=k.mouseEvent)||void 0===_t?void 0:_t.button)||k.touchEvent)&&((k,w)=>{let P=(0,X.g1)(K.O.SCAN_GROUP,"g"),lt=(0,ut.bH)(0,0,1,1);(0,X.vl)(P,lt),((k,w,it,U)=>{(0,C.A)(k,{start:P=>{},move:(P,lt)=>{((P,lt,gt,_t)=>{w=(0,ut.bH)(P,lt,gt,_t),(0,X.vl)(it,w)})(lt[0][0],lt[0][1],P.x,P.y)},end:(P,lt)=>{null==it||it.remove(),b.icdt.dataSelect.ids=b.icdt.data.getNodeInArea(Math.min(lt[0][0],P.x),Math.min(lt[0][1],P.y),Math.max(lt[0][0],P.x),Math.max(lt[0][1],P.y)),U(b.icdt.dataSelect.nodes)}})})(k,lt,P,w)})(k,q)}else{var ct,tt;let j=parseFloat(P||"0");b.icdt.dataSelect.ids=null!==(ct=k.mouseEvent)&&void 0!==ct&&ct.shiftKey||null!==(tt=k.touchEvent)&&void 0!==tt&&tt.shiftKey?[j].concat(b.icdt.dataSelect.ids).filter((Lt,Dt,Ht)=>Ht.indexOf(Lt)==Dt):[j],q(b.icdt.dataSelect.nodes)}},q=k=>{var w,it;let U=1;var Q,st;if(k.length&&(U=Math.max.apply(null,null!==(Q=null===(st=b.icdt.data.slide)||void 0===st||null===(st=st.svg)||void 0===st?void 0:st.nodes.map(lt=>{var gt;return null!==(gt=lt.idx)&&void 0!==gt?gt:0}))&&void 0!==Q?Q:[0])+1),1==k.length)k[0].idx||(k[0].idx=U,k[0].time=0);else if(k.length>=0){let lt=k.map(_t=>{var ct;return null!==(ct=_t.idx)&&void 0!==ct?ct:0}).filter(_t=>_t>0),gt=lt.length?Math.min.apply(null,lt):U;k.forEach(_t=>{var ct;_t.idx=gt,_t.time=null!==(ct=_t.time)&&void 0!==ct?ct:0})}let P=(0,X.g1)(K.O.INDEX_GROUP,"g");(0,X.mo)(P,null!==(w=null===(it=b.icdt.data.slide)||void 0===it||null===(it=it.svg)||void 0===it?void 0:it.nodes)&&void 0!==w?w:[])},m=k=>{var w,it,U;null!=k&&null!==(w=k.svg)&&void 0!==w&&w.nodes&&k.svg.nodes.forEach(st=>{st.idx=0,st.time=null});let Q=(0,X.g1)(K.O.INDEX_GROUP,"g");(0,X.mo)(Q,null!==(it=null===(U=b.icdt.data.slide)||void 0===U||null===(U=U.svg)||void 0===U?void 0:U.nodes)&&void 0!==it?it:[])}},4578:(he,Ct,f)=>{f.d(Ct,{h:()=>w,t:()=>it});var K=f(644),b=f(7308),ut=f(968),C=f(4981),X=f(666),c=f(2966),A=f(5226),E=f(3423),q=f(5811),m=f(3385);const w=new class k{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:b.s.Escape,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.ids=[])}},this.onchange={type:"keydown",key:b.s.Delete,fn:()=>{C.icdt.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:b.s.Space,fn:()=>{C.icdt.pointer.pointer_type_temp=ut._.HAND}},this.onchange={type:"keyup",key:b.s.Space,fn:()=>{C.icdt.pointer.pointer_type_temp=ut._.POINTER}},this.onchange={type:"keydown",key:b.s.ArrowLeft,fn:()=>{C.icdt.dataSelect.ids.length||C.icdt.data.backSlide()}},this.onchange={type:"keydown",key:b.s.ArrowRight,fn:()=>{C.icdt.dataSelect.ids.length||C.icdt.data.nextSlide()}},this.onchange={type:"keydown",key:b.s.ArrowLeft,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(Q=>{(0,m.k6)(Q,(0,q.q)(Q.size.x-(0,E.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,X.y)(C.icdt.dataSelect.nodes[0]):(0,c.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:b.s.ArrowRight,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(Q=>{(0,m.k6)(Q,(0,q.q)(Q.size.x+(0,E.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,X.y)(C.icdt.dataSelect.nodes[0]):(0,c.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:b.s.ArrowUp,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(Q=>{(0,m.co)(Q,(0,q.q)(Q.size.y-(0,E.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,X.y)(C.icdt.dataSelect.nodes[0]):(0,c.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:b.s.ArrowDown,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(Q=>{(0,m.co)(Q,(0,q.q)(Q.size.y+(0,E.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,X.y)(C.icdt.dataSelect.nodes[0]):(0,c.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:b.s.Digit1,fn:Q=>{Q.shiftKey&&(C.icdt.reloadView(),C.icdt.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:b.s.KeyA,fn:Q=>{if(Q.ctrlKey){C.icdt.dataSelect.ids=C.icdt.data.getNodeAll();let st=C.icdt.dataSelect.nodes;1==st.length?(0,X.y)(st[0]):st.length>1&&(0,c.Q)(st)}}},this.onchange={type:"keydown",key:b.s.KeyC,fn:Q=>{if(Q.ctrlKey){let st=C.icdt.dataSelect.nodes;st&&(0,K.yR)({params:{type:"nodes",nodes:st}})}}},this.onchange={type:"keydown",key:b.s.KeyV,fn:Q=>{Q.ctrlKey&&(0,K.aY)({callback:st=>{var P,lt;"nodes"==(null==st?void 0:st.type)&&null!=st&&null!==(P=st.nodes)&&void 0!==P&&P.length&&(null==st||null===(lt=st.nodes)||void 0===lt||lt.forEach(gt=>{gt.id=Math.ceil(1e9*Math.random()),C.icdt.data.node=gt}),(0,A.E)(C.icdt.data.slide))}})}},this.onchange={type:"keydown",key:b.s.KeyZ,fn:Q=>{Q.ctrlKey&&Q.shiftKey?C.icdt.history.redo():Q.ctrlKey&&C.icdt.history.undo()}}}set onchange(Q){let st=this._fnChanges.find(P=>P.eventType==Q.type&&P.eventKey==Q.key);st?st.fns.push(Q.fn):this._fnChanges.push({eventType:Q.type,eventKey:Q.key,fns:[Q.fn]})}change(Q,st,P){var lt;null===(lt=this._fnChanges.find(gt=>gt.eventType==Q&&gt.eventKey==st))||void 0===lt||lt.fns.forEach(gt=>gt(P))}},it=U=>{w.change(U.type,U.keyCode||U.which||U.charCode||0,U)}},410:(he,Ct,f)=>{f.d(Ct,{a:()=>E});var K=f(4318),b=f(8419),ut=f(9054),C=f(4080),X=f(511),c=f(3423),A=f(1687);class E{constructor(m){var k;let w={stroke:"#FF0000",strokeWidth:(0,c.v)(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,c.v)(8)},{element:U,attribute:Q,size:st}=(0,b.G)(Math.ceil(1e9*Math.random()),{size:m});window.document.getElementById(A.O.INTERACTIVE_GROUP).querySelectorAll("path").forEach(ct=>null==ct?void 0:ct.remove()),null===(k=window.document.getElementById(A.O.INTERACTIVE_GROUP))||void 0===k||k.appendChild(U),(0,C.__)(U,w);let lt="";return{start:ct=>{lt=`M ${ct.x} ${ct.y} L ${ct.x} ${ct.y}`},move:(ct,tt)=>{((ct,tt)=>{lt+=` ${ct} ${tt}`,U.setAttribute("d",lt)})(ct.x,ct.y)},end:(ct,tt)=>{(ct=>{let j=X.jvg().x(Kt=>Kt[0]).y(Kt=>Kt[1]).curve(X.$0Z)(ct);U.setAttribute("d",j),ct.length>=2&&(window.interactivePoints=ct)})(tt),(ct=>{let tt=9999,j=9999,Kt=-9999,Lt=-9999;ct.forEach(Dt=>{tt=Math.min(tt,Dt[0]),j=Math.min(j,Dt[1]),Kt=Math.max(Kt,Dt[0]),Lt=Math.max(Lt,Dt[1])}),st=(0,K.bH)(tt,j,Kt,Lt,{points:ct}),Object.assign(Q,(0,K.sg)(ut.$.PATH,st),w)})(tt)}}}}},9623:(he,Ct,f)=>{f.d(Ct,{U:()=>U,i:()=>it});var K=f(1687),b=f(9125),ut=f(4981),C=f(6816),X=f(4080),c=f(4318),A=f(8419),E=f(9054),q=f(511);class m{constructor(){let st={strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:P,element:lt,attribute:gt,size:_t}=(0,A.G)(Math.ceil(1e9*Math.random()));(0,X.__)(lt,gt);let tt="";return{start:Lt=>{tt=`M ${Lt.x} ${Lt.y} L ${Lt.x} ${Lt.y}`},move:(Lt,Dt)=>{((Lt,Dt)=>{tt+=` ${Lt} ${Dt}`,lt.setAttribute("d",tt)})(Lt.x,Lt.y)},end:(Lt,Dt)=>{(Lt=>{let Ht=q.jvg().x(Mt=>Mt[0]).y(Mt=>Mt[1]).curve(q.$0Z)(Lt);lt.setAttribute("d",Ht)})(Dt),(Lt=>{let Dt=9999,Ht=9999,Mt=-9999,Wt=-9999;Lt.forEach(ht=>{Dt=Math.min(Dt,ht[0]),Ht=Math.min(Ht,ht[1]),Mt=Math.max(Mt,ht[0]),Wt=Math.max(Wt,ht[1])}),_t=(0,c.bH)(Dt,Ht,Mt,Wt,{points:Lt}),Object.assign(gt,(0,c.sg)(E.$.PATH,_t),st)})(Dt),ut.icdt.data.node=Object.assign({id:P,type:E.$.PATH,name:"Path"},{size:_t,attribute:gt})}}}}class k{constructor(){let st={strokeOpacity:.4,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:P,element:lt,attribute:gt,size:_t}=(0,A.G)(Math.ceil(1e9*Math.random()));(0,X.__)(lt,gt);let tt="";var j=(Kt,Lt)=>{tt+=` ${Kt} ${Lt}`,lt.setAttribute("d",tt)};return{start:Kt=>{tt=`M ${Kt.x} ${Kt.y} L ${Kt.x} ${Kt.y}`},move:(Kt,Lt)=>{j(Kt.x,Kt.y)},end:(Kt,Lt)=>{j(Kt.x,Kt.y),(Kt=>{let Lt=9999,Dt=9999,Ht=-9999,Mt=-9999;Kt.forEach(Wt=>{Lt=Math.min(Lt,Wt[0]),Dt=Math.min(Dt,Wt[1]),Ht=Math.max(Ht,Wt[0]),Mt=Math.max(Mt,Wt[1])}),_t=(0,c.bH)(Lt,Dt,Ht,Mt,{points:Kt}),Object.assign(gt,(0,c.sg)(E.$.PATH,_t),st)})(Lt),ut.icdt.data.node=Object.assign({id:P,type:E.$.PATH,name:"Path"},{size:_t,attribute:gt})}}}}var w=f(410);const it=Q=>{switch(ut.icdt.pointer.pen_type){case b.D.DRAW:(0,C.A)(Q,new m);break;case b.D.HIGHTLIGH:(0,C.A)(Q,new k);break;case b.D.INTERACTIVE:U(Q)}},U=Q=>{var st,P;let lt=(0,X.g1)(K.O.INTERACTIVE_GROUP,"g"),gt=null!==(st=null===(P=ut.icdt.data.slide)||void 0===P||null===(P=P.svg)||void 0===P?void 0:P.viewBox)&&void 0!==st?st:(()=>{let{width:_t,height:ct}=ut.icdt.screen.get;return{x:0,y:0,width:_t,height:ct}})();(0,X.XH)(lt,gt),Q&&(0,C.A)(Q,new w.a)}},666:(he,Ct,f)=>{f.d(Ct,{y:()=>A});var K=f(1687),b=f(4981),ut=f(4318),C=f(6816),X=f(4080),c=f(5811);const A=m=>{let k=(0,X.g1)(K.O.RESIZE_GROUP,"g");(0,X.hJ)(k,m).forEach(w=>{E(w.element,w.posType,m,k)})},E=(m,k,w,it)=>{let U=!1;null==m||m.addEventListener("touchstart",Q=>{U=!0,q({touchEvent:Q},k,w,it)}),null==m||m.addEventListener("mousedown",Q=>{if(0==Q.button){if(U)return void(U=!1);q({mouseEvent:Q},k,w,it)}})},q=(m,k,w,it)=>{let j,{id:U,type:Q,size:st,attribute:P}=w,{x:lt,y:gt,width:_t,height:ct}=st,tt=(_t||1)/(ct||1),Lt=null,Mt=!1;(0,C.A)(m,{start:ht=>{Lt=JSON.parse(JSON.stringify({id:U,size:st,attribute:P}))},move:(ht,nt)=>{((ht,nt,Et,St)=>{switch(k){case"rect-center":var Yt,mt;j=null!==(Yt=m.mouseEvent)&&void 0!==Yt&&Yt.shiftKey||null!==(mt=m.touchEvent)&&void 0!==mt&&mt.shiftKey?Math.abs(Et-ht)>=Math.abs(St-nt)?{x:lt+Et-ht,y:gt,width:_t,height:ct}:{x:lt,y:gt+St-nt,width:_t,height:ct}:{x:lt+Et-ht,y:gt+St-nt,width:_t,height:ct};break;case"rect-top-left":var ne,G,L,h,H,yt,ft,Ot;j=(null!==(ne=m.mouseEvent)&&void 0!==ne&&ne.shiftKey||null!==(G=m.touchEvent)&&void 0!==G&&G.shiftKey)&&(null!==(L=m.mouseEvent)&&void 0!==L&&L.altKey||null!==(h=m.touchEvent)&&void 0!==h&&h.altKey)?tt>=1?{x:lt+(Et-ht),y:gt+(Et-ht)/tt,width:_t-2*(Et-ht),height:ct-2*(Et-ht)/tt}:{x:lt+(St-nt)*tt,y:gt+(St-nt),width:_t-2*(St-nt)*tt,height:ct-2*(St-nt)}:null!==(H=m.mouseEvent)&&void 0!==H&&H.shiftKey||null!==(yt=m.touchEvent)&&void 0!==yt&&yt.shiftKey?tt>=1?{x:lt+(Et-ht),y:gt+(Et-ht)/tt,width:_t-(Et-ht),height:ct-(Et-ht)/tt}:{x:lt+(St-nt)*tt,y:gt+(St-nt),width:_t-(St-nt)*tt,height:ct-(St-nt)}:null!==(ft=m.mouseEvent)&&void 0!==ft&&ft.altKey||null!==(Ot=m.touchEvent)&&void 0!==Ot&&Ot.altKey?{x:lt+(Et-ht),y:gt+(St-nt),width:_t-2*(Et-ht),height:ct-2*(St-nt)}:{x:lt+(Et-ht),y:gt+(St-nt),width:_t-(Et-ht),height:ct-(St-nt)};break;case"rect-top-right":var Ft,jt,xt,wt,qt,Rt,re,z;j=(null!==(Ft=m.mouseEvent)&&void 0!==Ft&&Ft.shiftKey||null!==(jt=m.touchEvent)&&void 0!==jt&&jt.shiftKey)&&(null!==(xt=m.mouseEvent)&&void 0!==xt&&xt.altKey||null!==(wt=m.touchEvent)&&void 0!==wt&&wt.altKey)?tt>=1?{x:lt-(Et-ht),y:gt-(Et-ht)/tt,width:_t+2*(Et-ht),height:ct+2*(Et-ht)/tt}:{x:lt+(St-nt)*tt,y:gt+(St-nt),width:_t-2*(St-nt)*tt,height:ct-2*(St-nt)}:null!==(qt=m.mouseEvent)&&void 0!==qt&&qt.shiftKey||null!==(Rt=m.touchEvent)&&void 0!==Rt&&Rt.shiftKey?tt>=1?{x:lt,y:gt-(Et-ht)/tt,width:_t+(Et-ht),height:ct+(Et-ht)/tt}:{x:lt,y:gt+(St-nt),width:_t-(St-nt)*tt,height:ct-(St-nt)}:null!==(re=m.mouseEvent)&&void 0!==re&&re.altKey||null!==(z=m.touchEvent)&&void 0!==z&&z.altKey?{x:lt-(Et-ht),y:gt+(St-nt),width:_t+2*(Et-ht),height:ct-2*(St-nt)}:{x:lt,y:gt+(St-nt),width:_t+(Et-ht),height:ct-(St-nt)};break;case"rect-bottom-left":var d,O,F,J,W,I,Z,M;j=(null!==(d=m.mouseEvent)&&void 0!==d&&d.shiftKey||null!==(O=m.touchEvent)&&void 0!==O&&O.shiftKey)&&(null!==(F=m.mouseEvent)&&void 0!==F&&F.altKey||null!==(J=m.touchEvent)&&void 0!==J&&J.altKey)?tt>=1?{x:lt+(Et-ht),y:gt+(Et-ht)/tt,width:_t-2*(Et-ht),height:ct-2*(Et-ht)/tt}:{x:lt-(St-nt)*tt,y:gt-(St-nt),width:_t+2*(St-nt)*tt,height:ct+2*(St-nt)}:null!==(W=m.mouseEvent)&&void 0!==W&&W.shiftKey||null!==(I=m.touchEvent)&&void 0!==I&&I.shiftKey?tt>=1?{x:lt+(Et-ht),y:gt,width:_t-(Et-ht),height:ct-(Et-ht)/tt}:{x:lt-(St-nt)*tt,y:gt,width:_t+(St-nt)*tt,height:ct+(St-nt)}:null!==(Z=m.mouseEvent)&&void 0!==Z&&Z.altKey||null!==(M=m.touchEvent)&&void 0!==M&&M.altKey?{x:lt+(Et-ht),y:gt-(St-nt),width:_t-2*(Et-ht),height:ct+2*(St-nt)}:{x:lt+(Et-ht),y:gt,width:_t-(Et-ht),height:ct+(St-nt)};break;case"rect-bottom-right":var Y,pt,Nt,It,Jt,zt,Gt,Vt;j=(null!==(Y=m.mouseEvent)&&void 0!==Y&&Y.shiftKey||null!==(pt=m.touchEvent)&&void 0!==pt&&pt.shiftKey)&&(null!==(Nt=m.mouseEvent)&&void 0!==Nt&&Nt.altKey||null!==(It=m.touchEvent)&&void 0!==It&&It.altKey)?tt>=1?{x:lt-(Et-ht),y:gt-(Et-ht)/tt,width:_t+2*(Et-ht),height:ct+2*(Et-ht)/tt}:{x:lt-(St-nt)*tt,y:gt-(St-nt),width:_t+2*(St-nt)*tt,height:ct+2*(St-nt)}:null!==(Jt=m.mouseEvent)&&void 0!==Jt&&Jt.shiftKey||null!==(zt=m.touchEvent)&&void 0!==zt&&zt.shiftKey?tt>=1?{x:lt,y:gt,width:_t+(Et-ht),height:ct+(Et-ht)/tt}:{x:lt,y:gt,width:_t+(St-nt)*tt,height:ct+(St-nt)}:null!==(Gt=m.mouseEvent)&&void 0!==Gt&&Gt.altKey||null!==(Vt=m.touchEvent)&&void 0!==Vt&&Vt.altKey?{x:lt-(Et-ht),y:gt-(St-nt),width:_t+2*(Et-ht),height:ct+2*(St-nt)}:{x:lt,y:gt,width:_t+(Et-ht),height:ct+(St-nt)};break;default:j={x:lt+Et-ht,y:gt+St-nt,width:_t,height:ct}}j.width<0&&(j.width=0),j.height<0&&(j.height=0),j.x=(0,c.q)(j.x),j.y=(0,c.q)(j.y),j.width=(0,c.q)(j.width),j.height=(0,c.q)(j.height),Object.assign(st,j),Object.assign(P,(0,ut.sg)(Q,st)),(0,X.__)(window.document.getElementById(U),P),(0,X.hJ)(it,w)})(nt[0][0],nt[0][1],ht.x,ht.y),Mt=!0},end:(ht,nt)=>{Mt&&Lt&&b.icdt.history.push([{type:"size",from:Lt,to:JSON.parse(JSON.stringify({id:U,size:st,attribute:P}))}])}})}},2966:(he,Ct,f)=>{f.d(Ct,{Q:()=>E});var K=f(1687),b=f(4981),ut=f(4318),C=f(6816),X=f(4080),c=f(3423),A=f(5811);const E=k=>{let w=999999,it=999999,U=-999999,Q=-999999;null==k||k.forEach(lt=>{w=Math.min(w,lt.size.x),it=Math.min(it,lt.size.y),U=Math.max(U,lt.size.x+lt.size.width),Q=Math.max(Q,lt.size.y+lt.size.height)});let st=(0,X.g1)(K.O.SELECT_GROUP,"g"),P=(0,ut.bH)(w,it,U,Q);(0,X.yD)(st,k,P).forEach(lt=>{q(lt.element,lt.posType,P,k,st)})},q=(k,w,it,U,Q)=>{let st=!1;null==k||k.addEventListener("touchstart",P=>{st=!0,m({touchEvent:P},w,it,U,Q)}),null==k||k.addEventListener("mousedown",P=>{if(0==P.button){if(st)return void(st=!1);m({mouseEvent:P},w,it,U,Q)}})},m=(k,w,it,U,Q)=>{let{x:st,y:P,width:lt,height:gt}=it,_t=U.map(Dt=>Object.assign({},Dt.size)),tt=[];(0,C.A)(k,{start:Dt=>{U.forEach((Dt,Ht)=>{let{id:Mt,size:ht,attribute:nt}=Dt;tt.push(JSON.parse(JSON.stringify({id:Mt,size:ht,attribute:nt})))})},move:(Dt,Ht)=>{((Dt,Ht,Mt,Wt)=>{(()=>{let ht;ht="rect-center"===w?{x:st+Mt-Dt,y:P+Wt-Ht,width:lt,height:gt}:{x:st,y:P,width:lt,height:gt},(0,c.v)(b.icdt.screen.width),(0,c.v)(b.icdt.screen.height),ht.width<0&&(ht.width=0),ht.height<0&&(ht.height=0),Object.assign(it,ht),(0,X.yD)(Q,U,it)})(),U.forEach((ht,nt)=>{let H,{x:Et,y:St,width:Yt,height:mt}=_t[nt],{id:ne,type:G,size:L,attribute:h}=ht;H="rect-center"===w?{x:Et+Mt-Dt,y:St+Wt-Ht,width:Yt,height:mt}:{x:Et,y:St,width:Yt,height:mt},(0,c.v)(b.icdt.screen.width),(0,c.v)(b.icdt.screen.height),H.width<0&&(H.width=0),H.height<0&&(H.height=0),H.x=(0,A.q)(H.x),H.y=(0,A.q)(H.y),H.width=(0,A.q)(H.width),H.height=(0,A.q)(H.height),Object.assign(L,H),Object.assign(h,(0,ut.sg)(G,L)),(0,X.__)(window.document.getElementById(ne),h)})})(Ht[0][0],Ht[0][1],Dt.x,Dt.y)},end:(Dt,Ht)=>{tt.length&&b.icdt.history.push(U.map((Dt,Ht)=>{let{id:Mt,size:ht,attribute:nt}=Dt;return{type:"size",from:tt[Ht],to:JSON.parse(JSON.stringify({id:Mt,size:ht,attribute:nt}))}}))}})}},5226:(he,Ct,f)=>{f.d(Ct,{E:()=>Q,T:()=>st});var K=f(1687),b=f(8619),ut=f(8785),C=f(2282),X=f(8054),c=f(4921),A=f(6358),E=f(9054),q=f(8419),m=f(1105),k=f(2875),w=f(7210),it=f(4981),U=f(4080);const Q=(P,lt)=>{var gt;if(lt&&!window.document.getElementById(lt))return;if(lt){let ct=window.document.getElementById(lt);jQuery(ct).find("#"+K.O.BACKGROUND_GROUP).empty();let tt=(0,U.g1)(K.O.BACKGROUND_GROUP,"g",void 0,ct);(0,U.x0)(tt,P)}else{jQuery(it.icdt.target).find("#"+K.O.BACKGROUND_GROUP).empty();let ct=(0,U.g1)(K.O.BACKGROUND_GROUP,"g",void 0,it.icdt.target);(0,U.x0)(ct,P)}let _t=(ct,tt)=>{tt=tt?parseFloat(`${lt}0${tt}`):lt,null==ct||ct.forEach(j=>{let Kt=lt?parseFloat(`${lt}0${j.id}`):j.id;var Lt;if(j.isdeleted)null===(Lt=window.document.getElementById(Kt))||void 0===Lt||Lt.remove();else switch(j.type){case E.$.GROUP:(0,A.m)(Kt,{},tt?window.document.getElementById(tt):null),_t(j.nodes,j.id);break;case E.$.CIRCLE:(0,b._)(Kt,{size:j.size,attribute:j.attribute},tt?window.document.getElementById(tt):null);break;case E.$.ELLIPSE:(0,ut.r)(Kt,{size:j.size,attribute:j.attribute},tt?window.document.getElementById(tt):null);break;case E.$.LINE:(0,c.W)(Kt,{size:j.size,attribute:j.attribute},tt?window.document.getElementById(tt):null);break;case E.$.RECT:(0,X.f)(Kt,{size:j.size,attribute:j.attribute},tt?window.document.getElementById(tt):null);break;case E.$.POLYGON:(0,C.l)(Kt,{size:j.size,attribute:j.attribute},tt?window.document.getElementById(tt):null);break;case E.$.FOREIGNOBJECT:(0,k.e)(Kt,{size:j.size,attribute:j.attribute,style:j.style,source:j.source},tt?window.document.getElementById(tt):null);break;case E.$.IMAGE:(0,w.G)(Kt,{size:j.size,attribute:j.attribute,source:j.source},tt?window.document.getElementById(tt):null);break;case E.$.TEXT:(0,m.$)(Kt,{size:j.size,attribute:j.attribute,source:j.source},tt?window.document.getElementById(tt):null);break;case E.$.PATH:(0,q.G)(Kt,{size:j.size,attribute:j.attribute},tt?window.document.getElementById(tt):null)}})};_t(null==P||null===(gt=P.svg)||void 0===gt?void 0:gt.nodes)},st=(P,lt)=>{var gt;if(lt&&!window.document.getElementById(lt))return;let _t=(ct,tt)=>{tt=tt?parseFloat(`${lt}0${tt}`):lt,null==ct||ct.forEach(j=>{let Kt=lt?parseFloat(`${lt}0${j.id}`):j.id;jQuery("#"+Kt).appendTo(tt?window.document.getElementById(tt):it.icdt.target),j.type==E.$.GROUP&&_t(j.nodes,j.id)})};_t(null==P||null===(gt=P.svg)||void 0===gt?void 0:gt.nodes)}},8619:(he,Ct,f)=>{f.d(Ct,{_:()=>X});var K=f(9054),b=f(4981),ut=f(4318),C=f(4080);const X=(c,A,E)=>{let q=(null==A?void 0:A.size)||{x:0,y:0,width:10,height:10},m=(null==A?void 0:A.attribute)||{fill:b.icdt.attribute.fill,stroke:b.icdt.attribute.stroke,strokeWidth:b.icdt.attribute.strokeWidth};return Object.assign(m,(0,ut.sg)(K.$.CIRCLE,q)),{nodeId:c,element:(0,C.it)(c,K.$.CIRCLE,"circle",{size:q,attribute:m},E),size:q,attribute:m}}},8785:(he,Ct,f)=>{f.d(Ct,{r:()=>X});var K=f(9054),b=f(4981),ut=f(4318),C=f(4080);const X=(c,A,E)=>{let q=(null==A?void 0:A.size)||{x:0,y:0,width:10,height:10},m=(null==A?void 0:A.attribute)||{fill:b.icdt.attribute.fill,stroke:b.icdt.attribute.stroke,strokeWidth:b.icdt.attribute.strokeWidth};return Object.assign(m,(0,ut.sg)(K.$.ELLIPSE,q)),{nodeId:c,element:(0,C.it)(c,K.$.ELLIPSE,"ellipse",{size:q,attribute:m},E),size:q,attribute:m}}},2875:(he,Ct,f)=>{f.d(Ct,{e:()=>C});var K=f(9054),b=f(4318),ut=f(4080);const C=(X,c,A)=>{let E=(null==c?void 0:c.size)||{x:0,y:0,width:180,height:180},q=(null==c?void 0:c.attribute)||{};Object.assign(q,(0,b.sg)(K.$.FOREIGNOBJECT,E));let m=(null==c?void 0:c.source)||{type:"html",html:{htmlContent:'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>'}},k=(null==c?void 0:c.style)||{};return{nodeId:X,element:(0,ut.it)(X,K.$.FOREIGNOBJECT,"foreignObject",{size:E,attribute:q,style:k,source:m},A),size:E,attribute:q,style:k,source:m}}},6358:(he,Ct,f)=>{f.d(Ct,{m:()=>C});var K=f(9054),b=f(4318),ut=f(4080);const C=(X,c,A)=>{let E=(null==c?void 0:c.size)||{x:0,y:0,width:10,height:10},q=(null==c?void 0:c.attribute)||{};return Object.assign(q,(0,b.sg)(K.$.GROUP,E)),{nodeId:X,element:(0,ut.it)(X,K.$.GROUP,"g",{size:E,attribute:q},A),size:E,attribute:q}}},7210:(he,Ct,f)=>{f.d(Ct,{G:()=>C});var K=f(9054),b=f(4318),ut=f(4080);const C=(X,c,A)=>{let E=(null==c?void 0:c.size)||{x:0,y:0,width:100,height:100},q=(null==c?void 0:c.attribute)||{preserveAspectRatio:"none"};Object.assign(q,(0,b.sg)(K.$.IMAGE,E));let m=(null==c?void 0:c.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:X,element:(0,ut.it)(X,K.$.IMAGE,"image",{size:E,attribute:q,source:m},A),size:E,attribute:q,source:m}}},4921:(he,Ct,f)=>{f.d(Ct,{W:()=>X});var K=f(9054),b=f(4981),ut=f(4318),C=f(4080);const X=(c,A,E)=>{let q=(null==A?void 0:A.size)||{x:0,y:0,width:10,height:10},m=(null==A?void 0:A.attribute)||{stroke:b.icdt.attribute.stroke,strokeWidth:b.icdt.attribute.strokeWidth,strokeLinecap:b.icdt.attribute.strokeLinecap};return Object.assign(m,(0,ut.sg)(K.$.LINE,q)),{nodeId:c,element:(0,C.it)(c,K.$.LINE,"line",{size:q,attribute:m},E),size:q,attribute:m}}},8419:(he,Ct,f)=>{f.d(Ct,{G:()=>X});var K=f(9054),b=f(4981),ut=f(4318),C=f(4080);const X=(c,A,E)=>{let q=(null==A?void 0:A.size)||{x:0,y:0,width:10,height:10},m=(null==A?void 0:A.attribute)||{stroke:b.icdt.attribute.stroke,strokeWidth:b.icdt.attribute.strokeWidth};return Object.assign(m,(0,ut.sg)(K.$.PATH,q)),{nodeId:c,element:(0,C.it)(c,K.$.PATH,"path",{size:q,attribute:m},E),size:q,attribute:m}}},2282:(he,Ct,f)=>{f.d(Ct,{l:()=>X});var K=f(9054),b=f(4981),ut=f(4318),C=f(4080);const X=(c,A,E)=>{let q=(null==A?void 0:A.size)||{x:0,y:0,width:10,height:10},m=(null==A?void 0:A.attribute)||{fill:b.icdt.attribute.fill,stroke:b.icdt.attribute.stroke,strokeWidth:b.icdt.attribute.strokeWidth};return Object.assign(m,(0,ut.sg)(K.$.POLYGON,q)),{nodeId:c,element:(0,C.it)(c,K.$.POLYGON,"polygon",{size:q,attribute:m},E),size:q,attribute:m}}},8054:(he,Ct,f)=>{f.d(Ct,{f:()=>X});var K=f(9054),b=f(4981),ut=f(4318),C=f(4080);const X=(c,A,E)=>{let q=(null==A?void 0:A.size)||{x:0,y:0,width:10,height:10},m=(null==A?void 0:A.attribute)||{fill:b.icdt.attribute.fill,stroke:b.icdt.attribute.stroke,strokeWidth:b.icdt.attribute.strokeWidth};return Object.assign(m,(0,ut.sg)(K.$.RECT,q)),{nodeId:c,element:(0,C.it)(c,K.$.RECT,"rect",{size:q,attribute:m},E),size:q,attribute:m}}},1105:(he,Ct,f)=>{f.d(Ct,{$:()=>X});var K=f(9054),b=f(4981),ut=f(4318),C=f(4080);const X=(c,A,E)=>{let q=(null==A?void 0:A.size)||{x:0,y:0,width:100,height:50},m=(null==A?void 0:A.attribute)||{fill:b.icdt.attribute.stroke,fontFamily:b.icdt.attribute.fontFamily,fontSize:b.icdt.attribute.fontSize,textLength:b.icdt.attribute.textLength};Object.assign(m,(0,ut.sg)(K.$.TEXT,q));let k=(null==A?void 0:A.source)||{type:"text",text:{textContent:"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!"}};return{nodeId:c,element:(0,C.it)(c,K.$.TEXT,"text",{size:q,attribute:m,source:k},E),size:q,attribute:m,source:k}}},4318:(he,Ct,f)=>{f.d(Ct,{bH:()=>b,sg:()=>ut});var K=f(9054);const b=(X,c,A,E,q)=>{let m={x:Math.min(X,A),y:Math.min(c,E),width:Math.abs(A-X)||1,height:Math.abs(E-c)||1};return null!=q&&q.ratio&&(m.width<=m.height?m.height=m.width*(null==q?void 0:q.ratio):m.width=m.height/(null==q?void 0:q.ratio)),Object.assign(m,{ratios:(null==q?void 0:q.ratios)||[[(X-m.x)/(m.width||1),(c-m.y)/(m.height||1)],[(A-m.x)/(m.width||1),(E-m.y)/(m.height||1)]]}),null!=q&&q.points&&(m.points=null==q?void 0:q.points),m},ut=(X,c,A)=>{var E=(()=>{switch(X){case K.$.CIRCLE:return{cx:c.x+c.width/2,cy:c.y+c.height/2,r:Math.min(c.width/2,c.height/2)};case K.$.ELLIPSE:return{cx:c.x+c.width/2,cy:c.y+c.height/2,rx:c.width/2,ry:c.height/2};case K.$.LINE:{var q;let w={};return null===(q=c.ratios)||void 0===q||q.forEach((it,U)=>{w[`x${U+1}`]=c.x+c.width*it[0],w[`y${U+1}`]=c.y+c.height*it[1]}),w}case K.$.RECT:return{x:c.x,y:c.y,width:c.width,height:c.height};case K.$.POLYGON:var m;return{points:((null===(m=c.ratios)||void 0===m?void 0:m.map(w=>[c.x+c.width*w[0],c.y+c.height*w[1]]))||[]).map(w=>w.join(" ")).join(",")};case K.$.FOREIGNOBJECT:case K.$.IMAGE:return{x:c.x,y:c.y,width:c.width,height:c.height};case K.$.TEXT:return{x:c.x,y:c.y};case K.$.PATH:{var k;let w=null!==(k=c.points)&&void 0!==k?k:[];return w.length?{d:`M ${w[0][0]} ${w[0][1]} L `+(w.map(it=>[it[0],it[1]])||[]).map(it=>it.join(" ")).join(" ")}:{d:""}}}return{}})();return c.rotate?(E.transform=`rotate(${c.rotate})`,E.transformOrigin=`${c.x+c.width/2} ${c.y+c.height/2}`):(E.transform=null,E.transformOrigin=null),E}},5811:(he,Ct,f)=>{f.d(Ct,{q:()=>K});const K=(b,ut)=>{var C;return ut=null!==(C=ut)&&void 0!==C?C:100,Math.round((b+Number.EPSILON)*ut)/ut}},3423:(he,Ct,f)=>{f.d(Ct,{v:()=>ut});var K=f(4981),b=f(5811);const ut=C=>(0,b.q)(C/K.icdt.screen.scale)},3385:(he,Ct,f)=>{f.d(Ct,{Vs:()=>E,co:()=>c,k6:()=>X,lO:()=>A,mr:()=>q});var K=f(4981),b=f(4080),ut=f(4318),C=f(5811);const X=(m,k)=>{let{id:w,type:it,size:U,attribute:Q}=m,st=JSON.parse(JSON.stringify({id:w,size:U,attribute:Q}));U.x=(0,C.q)(k),Object.assign(Q,(0,ut.sg)(it,U)),(0,b.__)(window.document.getElementById(w),Q),K.icdt.history.push([{type:"size",from:st,to:JSON.parse(JSON.stringify({id:w,size:U,attribute:Q}))}])},c=(m,k)=>{let{id:w,type:it,size:U,attribute:Q}=m,st=JSON.parse(JSON.stringify({id:w,size:U,attribute:Q}));U.y=(0,C.q)(k),Object.assign(Q,(0,ut.sg)(it,U)),(0,b.__)(window.document.getElementById(w),Q),K.icdt.history.push([{type:"size",from:st,to:JSON.parse(JSON.stringify({id:w,size:U,attribute:Q}))}])},A=(m,k,w)=>{let{id:it,type:U,size:Q,attribute:st}=m,P=JSON.parse(JSON.stringify({id:it,size:Q,attribute:st}));w&&(Q.height=(0,C.q)(k*Q.height/Q.width)),Q.width=(0,C.q)(k),Object.assign(st,(0,ut.sg)(U,Q)),(0,b.__)(window.document.getElementById(it),st),K.icdt.history.push([{type:"size",from:P,to:JSON.parse(JSON.stringify({id:it,size:Q,attribute:st}))}])},E=(m,k,w)=>{let{id:it,type:U,size:Q,attribute:st}=m,P=JSON.parse(JSON.stringify({id:it,size:Q,attribute:st}));w&&(Q.width=(0,C.q)(k*Q.width/Q.height)),Q.height=(0,C.q)(k),Object.assign(st,(0,ut.sg)(U,Q)),(0,b.__)(window.document.getElementById(it),st),K.icdt.history.push([{type:"size",from:P,to:JSON.parse(JSON.stringify({id:it,size:Q,attribute:st}))}])},q=(m,k)=>{let{id:w,type:it,size:U,attribute:Q}=m,st=JSON.parse(JSON.stringify({id:w,size:U,attribute:Q}));U.rotate=(0,C.q)(k),Object.assign(Q,(0,ut.sg)(it,U)),(0,b.__)(window.document.getElementById(w),Q),K.icdt.history.push([{type:"size",from:st,to:JSON.parse(JSON.stringify({id:w,size:U,attribute:Q}))}])}},6816:(he,Ct,f)=>{f.d(Ct,{A:()=>c});var K=f(968),b=f(4981);class ut{constructor(E){this._points=[],this._options=E}start(E){this._points.length=0,this._points.push([E.x,E.y]),this._options.start(E)}move(E){this._points.push([E.x,E.y]),this._options.move(E,this._points)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(E=this._points[0])[0],y:E[1]}:{x:0,y:0};var E}get offsetLast(){return this._points.length>=1?{x:(E=this._points[this._points.length-1])[0],y:E[1]}:{x:0,y:0};var E}}var C=f(7797);const c=(A,E,q,m,k)=>{var w,it,U;let Q=null,st=0,P=0;A.mouseEvent?(Q=A.mouseEvent.target,st=A.mouseEvent.offsetX,P=A.mouseEvent.offsetY):A.touchEvent&&(Q=A.touchEvent.target,A.touchEvent.touches.length&&(st=A.touchEvent.touches[0].clientX,P=A.touchEvent.touches[0].clientY));let lt=null!=q?q:b.icdt.screen.scale,gt=null!=m?m:b.icdt.screen.dislocation,_t=null!=k?k:b.icdt.screen.offset,ct=()=>{};var tt=new ut({start:null!==(w=null==E?void 0:E.start)&&void 0!==w?w:ct,move:null!==(it=null==E?void 0:E.move)&&void 0!==it?it:ct,end:null!==(U=null==E?void 0:E.end)&&void 0!==U?U:ct});A.mouseEvent?tt.start((0,C.p)({x:st,y:P},lt,gt,{x:0,y:0})):A.touchEvent&&tt.start((0,C.p)({x:st,y:P},lt,gt,_t));let j=ht=>{tt.move((0,C.p)({x:ht.clientX,y:ht.clientY},lt,gt,_t))},Kt=ht=>{tt.end(),[K._.SHAPE,K._.FOREIGNOBJECT,K._.IMAGE,K._.TEXT].includes(b.icdt.pointer.pointer_type)&&(ht.shiftKey||(b.icdt.pointer.pointer_type=K._.POINTER))},Lt=ht=>{ht.touches.length&&j({clientX:ht.touches[0].clientX,clientY:ht.touches[0].clientY})},Dt=ht=>{Kt({shiftKey:ht.shiftKey,ctrlKey:ht.ctrlKey,altKey:ht.altKey}),window.removeEventListener("touchmove",Lt,!1),window.removeEventListener("touchend",Dt,!1)},Ht=ht=>{0==ht.button&&j({clientX:ht.clientX,clientY:ht.clientY})},Mt=ht=>{0==ht.button&&(Kt({shiftKey:ht.shiftKey,ctrlKey:ht.ctrlKey,altKey:ht.altKey}),window.removeEventListener("mousemove",Ht,!1),window.removeEventListener("mouseup",Mt,!1))};if(A.mouseEvent)window.addEventListener("mousemove",Ht,!1),window.addEventListener("mouseup",Mt,!1);else if(A.touchEvent){var Wt;window.addEventListener("touchmove",Lt,!1),window.addEventListener("touchend",Dt,!1),null===(Wt=Q)||void 0===Wt||Wt.addEventListener("touchmove",function(ht){ht.preventDefault()})}}},7797:(he,Ct,f)=>{f.d(Ct,{p:()=>b});var K=f(5811);const b=(ut,C,X,c)=>(ut.x-=c.x,ut.y-=c.y,ut.x/=C,ut.y/=C,ut.x-=X.x,ut.y-=X.y,ut.x=(0,K.q)(ut.x),ut.y=(0,K.q)(ut.y),ut)},1690:(he,Ct,f)=>{f.d(Ct,{$:()=>Rt,U:()=>re});var K=f(1687),b=f(4981),ut=f(9054),C=f(5973),X=f(2336),c=f(861),A=f(157),E=f(4787),m=f(1105),k=f(6358);const lt=function(z){var d,O,F=jQuery("#"+z),J=null===(d=F.attr("class"))||void 0===d?void 0:d.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),W=null===(O=F.attr("class"))||void 0===O?void 0:O.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);J&&J.forEach(function(Z){jQuery(F).removeClass(Z)}),W&&W.forEach(function(Z){jQuery(F).removeClass(Z)});let I=F.attr("data-class");I&&(F.attr("class",I),F.removeAttr("data-class")),jQuery(F).data("animation-running",!1)};var gt=f(7210),_t=f(5811);const ct=(z,d,O)=>{var F,J,W,I;let Z=1,M=new Image;M.onload=()=>{var Y,pt,Nt,It;Z=(0,_t.q)(M.naturalWidth/M.naturalHeight,100);let Jt=0,zt=0,Gt=0,Vt=0;var ae,ye,Ee,fe;Z>=1?(Gt=Math.min(M.naturalWidth,null!==(ae=null===(ye=Rt.slide.svg)||void 0===ye||null===(ye=ye.viewBox)||void 0===ye?void 0:ye.width)&&void 0!==ae?ae:0),Vt=Gt/Z):(Vt=Math.min(M.naturalHeight,null!==(Ee=null===(fe=Rt.slide.svg)||void 0===fe||null===(fe=fe.viewBox)||void 0===fe?void 0:fe.height)&&void 0!==Ee?Ee:0),Gt=Vt/Z),Jt=((null!==(Y=null===(pt=Rt.slide.svg)||void 0===pt||null===(pt=pt.viewBox)||void 0===pt?void 0:pt.width)&&void 0!==Y?Y:0)-Gt)/2,zt=((null!==(Nt=null===(It=Rt.slide.svg)||void 0===It||null===(It=It.viewBox)||void 0===It?void 0:It.height)&&void 0!==Nt?Nt:0)-Vt)/2,d.size={x:Jt,y:zt,width:Gt,height:Vt},tt(d,O)},M.onerror=Y=>{console.error(`ImgSrc load failed -> ${JSON.stringify(d.source)}`,Y)},M.src=null!==(F=null!==(J=null===(W=d.source)||void 0===W?void 0:W.url)&&void 0!==J?J:null===(I=d.source)||void 0===I?void 0:I.path)&&void 0!==F?F:""},tt=(z,d)=>{if(z.slideStatus!=Rt.slideStatus)return void d();let{element:O}=(0,gt.G)(Math.ceil(1e9*Math.random()),{size:z.size,source:{type:"image",image:null==z?void 0:z.source}});setTimeout(()=>{null==O||O.remove(),d()},3e3)},j=(z,d,O)=>{var F,J,W,I;let Z=new Image;Z.onload=()=>{Kt(z,{width:Z.naturalWidth,height:Z.naturalHeight},d,O)},Z.onerror=M=>{console.error(`ImgSrc load failed -> ${JSON.stringify(d.source)}`,M),O()},Z.src=null!==(F=null!==(J=null===(W=d.source)||void 0===W?void 0:W.url)&&void 0!==J?J:null===(I=d.source)||void 0===I?void 0:I.path)&&void 0!==F?F:""},Kt=(z,d,O,F)=>{if(O.slideStatus!=Rt.slideStatus)return void F();let J=(0,_t.q)(d.width/d.height,100),W=0,I=0,Z=0,M=0;J>=1?(Z=d.width,Z=Math.max(Z,40),Z=Math.min(Z,100),M=Z/J):(M=d.height,M=Math.max(M,40),M=Math.min(M,100),Z=M/J);let{size:Y}=z;W=Y.x+Y.width/2-Z/2,I=Y.y+Y.height/2-M/2;let{element:pt}=(0,gt.G)(Math.ceil(1e9*Math.random()),{size:{x:W,y:I,width:Z,height:M},source:{type:"image",image:null==O?void 0:O.source}});setTimeout(()=>{null==pt||pt.remove(),F()},3e3)};var Lt=f(4080);const Dt=(z,d,O)=>{var F,J,W;if(d.slideStatus!=Rt.slideStatus)return void O();if(null===(F=d.source)||void 0===F||!F.url)return console.warn(`${z.id} -> audio no source!`),void O();var I=jQuery("#"+z.id);let Z=null!==(J=d.iteration)&&void 0!==J?J:0;if(Z<0&&(O(),O=function(){}),!(I.data("audio-running")&&Z<0)){I.data("audio-running",!0);var M=new Audio;return M.autoplay=!0,M.loop=0!=Z,M.preload="auto",M.controls=!0,M.setAttributeNode(document.createAttribute("playsinline")),M.addEventListener("canplay",function(){var Y=M.play();Y&&Y.then(function(pt){I.data("audio-running",!0)}).catch(function(pt){I.data("audio-running",!1),d.slideStatus===Rt.slideStatus&&O()})}),M.addEventListener("timeupdate",function(){var pt;d.slideStatus!==Rt.slideStatus&&((pt=this).pause(),pt.remove(),I.data("audio-running",!1))}),M.addEventListener("canplaythrough",function(){this.loop&&(Z>0?Z--:0==Z&&(this.loop=!1))}),M.addEventListener("play",function(){}),M.addEventListener("pause",function(){}),M.addEventListener("ended",function(){this.remove(),I.data("audio-running",!1),d.slideStatus===Rt.slideStatus&&O()}),M.onerror=function(){this.remove(),I.data("audio-running",!1),d.slideStatus===Rt.slideStatus&&O()},M.src=(null===(W=d.source)||void 0===W?void 0:W.url)||"",M}};var Ht=f(9942);const Yt=(z,d,O)=>{var F;null===(F=d.test)||void 0===F||null===(F=F.answer)||void 0===F||null===(F=F.matching)||void 0===F||F.filter(J=>J.value==O.key).forEach(J=>J.value="")},ne=(z,d,O,F,J,W)=>{var I,Z,M,Y,pt,Nt,It,Jt,zt,Gt,Vt,ae;J.iscorrect?(null!==(I=d.test)&&void 0!==I&&null!==(I=I.audiotrue)&&void 0!==I&&I.path&&Dt(z,{source:(0,Ht.I)(null===(Y=d.test)||void 0===Y?void 0:Y.audiotrue),iteration:0,nodeStatus:O,slideStatus:F},W),null!==(Z=d.test)&&void 0!==Z&&null!==(Z=Z.icontrue)&&void 0!==Z&&Z.path&&j(z,{source:(0,Ht.I)(null===(pt=d.test)||void 0===pt?void 0:pt.icontrue),iteration:0,nodeStatus:O,slideStatus:F},W),null!==(M=d.test)&&void 0!==M&&null!==(M=M.effecttrue)&&void 0!==M&&M.path&&ct(0,{source:(0,Ht.I)(null===(Nt=d.test)||void 0===Nt?void 0:Nt.effecttrue),iteration:0,nodeStatus:O,slideStatus:F},W)):(null!==(It=d.test)&&void 0!==It&&null!==(It=It.audiofalse)&&void 0!==It&&It.path&&Dt(z,{source:(0,Ht.I)(null===(Gt=d.test)||void 0===Gt?void 0:Gt.audiofalse),iteration:0,nodeStatus:O,slideStatus:F},W),null!==(Jt=d.test)&&void 0!==Jt&&null!==(Jt=Jt.iconfalse)&&void 0!==Jt&&Jt.path&&j(z,{source:(0,Ht.I)(null===(Vt=d.test)||void 0===Vt?void 0:Vt.iconfalse),iteration:0,nodeStatus:O,slideStatus:F},W),null!==(zt=d.test)&&void 0!==zt&&null!==(zt=zt.effectfalse)&&void 0!==zt&&zt.path&&ct(0,{source:(0,Ht.I)(null===(ae=d.test)||void 0===ae?void 0:ae.effectfalse),iteration:0,nodeStatus:O,slideStatus:F},W))},G=(z,d,O,F)=>{var J,W,I,Z,M,Y,pt,Nt,It;null!==(J=d.animate)&&void 0!==J&&J.value&&((z,d,O)=>{var F;let{value:W}=null!==(F=z.animate)&&void 0!==F?F:{};((z,d,O)=>{var F;let J=jQuery("#"+z),W="",I=null!==(F=d.iteration)&&void 0!==F?F:0,Z=[];(d.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?Z.push(d.value):d.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(d.value)?(Z.push("animation"),Z.push(`animation-${d.value}`)):(Z.push("animate__animated"),Z.push(`animate__${d.value}`)):(Z.push("animation"),Z.push("animation-fadein")),I<0?(Z.push("animation-iteration-infinite"),O(),O=function(){}):I>0&&Z.push("animation-iteration-"+(I+1)),W=Z.join(" "),function(Y){let pt=function(){J.data("animate-running")?J.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){J.data("animate-running",!1),setTimeout(function(){Y()},100)}):Y()};J.hasClass("animation")?setTimeout(function(){pt()}):pt()}(function(){var Y;lt(z),(I>0||I<0)&&J.one("animationiteration",function(){d.slideStatus===Rt.slideStatus||(J.data("animate-running",!1),lt(z),d.slideStatus===Rt.slideStatus&&O())}),J.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(J.data("animate-running",!1),lt(z),d.finish){default:case 0:case 1:break;case 2:J.addClass("hide")}d.slideStatus===Rt.slideStatus&&O()}),J.attr("data-class",null!==(Y=J.attr("class"))&&void 0!==Y?Y:""),J.addClass(W),J.data("animate-running",!0)})})(z.id,{value:W,nodeStatus:d,slideStatus:O},()=>{})})(d,O.nodeStatus,O.slideStatus),null!==(W=d.interactive)&&void 0!==W&&W.show?((z,d,O,F)=>{var J,W,I;console.log("icdt_Run_Interactive_NodeShow",z,d,O);let Z={total:0,counter:0},{triggershow:M,triggerrun:Y,triggerhide:pt,action:Nt,audio:It}=null!==(J=null===(W=z.interactive)||void 0===W?void 0:W.show)&&void 0!==J?J:{};if(M){let{id:zt,ids:Gt,time:Vt,async:ae}=M;"asynctrue"==ae?setTimeout(()=>{(0,E.L5)({id:zt,ids:Gt,nodeStatus:d,slideStatus:O})}):"time"==ae&&setTimeout(()=>{(0,E.L5)({id:zt,ids:Gt,nodeStatus:d,slideStatus:O})},1e3*(null!=Vt?Vt:0))}if(Y){let{id:zt,ids:Gt,time:Vt,async:ae}=Y;"asynctrue"==ae?setTimeout(()=>{(0,E.Ar)({id:zt,ids:Gt,nodeStatus:d,slideStatus:O})}):"time"==ae&&setTimeout(()=>{(0,E.Ar)({id:zt,ids:Gt,nodeStatus:d,slideStatus:O})},1e3*(null!=Vt?Vt:0))}if(pt){let{id:zt,ids:Gt,time:Vt,async:ae}=pt;"asynctrue"==ae?setTimeout(()=>{(0,E.WT)({id:zt,ids:Gt,nodeStatus:d,slideStatus:O})}):"time"==ae&&setTimeout(()=>{(0,E.WT)({id:zt,ids:Gt,nodeStatus:d,slideStatus:O})},1e3*(null!=Vt?Vt:0))}let Jt=()=>{setTimeout(()=>{if(Z.counter>=Z.total){if(F&&F(),M){let{id:zt,ids:Gt,async:Vt}=M;"asyncfalse"==Vt&&(0,E.L5)({id:zt,ids:Gt,nodeStatus:d,slideStatus:O})}if(Y){let{id:zt,ids:Gt,async:Vt}=Y;"asyncfalse"==Vt&&(0,E.Ar)({id:zt,ids:Gt,nodeStatus:d,slideStatus:O})}if(pt){let{id:zt,ids:Gt,async:Vt}=pt;"asyncfalse"==Vt&&(0,E.WT)({id:zt,ids:Gt,nodeStatus:d,slideStatus:O})}}})};if(null!=Nt&&Nt.value){Z.total+=1;let zt=()=>{Z.counter+=1,Jt()};switch(null==Nt?void 0:Nt.value){case"hide":jQuery("#"+z.id).addClass("hide"),zt();break;case"points":{let{points:Gt,time:Vt,iteration:ae,finish:ye}=Nt;(0,c.G)(z.id,{points:Gt,time:Vt,iteration:ae,finish:ye,nodeStatus:d,slideStatus:O},zt);break}default:{let{value:Gt,time:Vt,iteration:ae,finish:ye}=Nt;(0,X.Q)(z.id,{value:Gt,time:Vt,iteration:ae,finish:ye,nodeStatus:d,slideStatus:O},zt);break}}}if(null!=It&&null!==(I=It.source)&&void 0!==I&&I.path){Z.total+=1;let zt=()=>{Z.counter+=1,Jt()};(0,A.R)(z.id,It,Z,{nodeStatus:d,slideStatus:O},zt)}Z.total||Jt()})(d,O.nodeStatus,O.slideStatus,F):F&&F(),null!==(I=d.interactive)&&void 0!==I&&I.click&&(Object.keys(null!==(pt=null===(Nt=d.interactive)||void 0===Nt?void 0:Nt.click)&&void 0!==pt?pt:{}).length&&jQuery("#"+d.id).addClass("interactive-click"),jQuery("#"+d.id).click(Jt=>{Jt.preventDefault(),O.nodeStatus=Rt.refreshNodeStatus(),(0,C.F)(d,O.nodeStatus,O.slideStatus)})),null!==(Z=d.variable)&&void 0!==Z&&Z.input&&jQuery("#"+d.id).on("change","input,textarea",Jt=>{Jt.preventDefault(),((z,d,O)=>{var F,J;b.icdt.variable.setValue(null!==(F=null===(J=d.variable)||void 0===J||null===(J=J.input)||void 0===J?void 0:J.variable)&&void 0!==F?F:"",z),(z=>{var d;let O=(F,J)=>{null==F||F.forEach(W=>{switch(W.type){case ut.$.GROUP:(0,k.m)(W.id,{},J?window.document.getElementById(J):null),O(W.nodes,W.id);break;case ut.$.POLYGON:break;case ut.$.TEXT:(0,m.$)(W.id,{size:W.size,attribute:W.attribute,source:W.source},J?window.document.getElementById(J):null)}})};O(null===(d=z.svg)||void 0===d?void 0:d.nodes)})(O)})(Jt.target.value,d,z)}),null!==(M=d.variable)&&void 0!==M&&M.click&&(null!==(It=d.variable)&&void 0!==It&&null!==(It=It.click)&&void 0!==It&&It.variable&&jQuery("#"+d.id).addClass("variable-click"),jQuery("#"+d.id).click(Jt=>{Jt.preventDefault(),((z,d)=>{var O;b.icdt.variable.setValueOperator(null===(O=z.variable)||void 0===O?void 0:O.click),(z=>{var d;let O=(F,J)=>{null==F||F.forEach(W=>{switch(W.type){case ut.$.GROUP:(0,k.m)(W.id,{},J?window.document.getElementById(J):null),O(W.nodes,W.id);break;case ut.$.POLYGON:break;case ut.$.TEXT:(0,m.$)(W.id,{size:W.size,attribute:W.attribute,source:W.source},J?window.document.getElementById(J):null)}})};O(null===(d=z.svg)||void 0===d?void 0:d.nodes)})(d)})(d,z)})),"test"==(null===(Y=d.source)||void 0===Y?void 0:Y.type)&&((z,d)=>{var O;let F=()=>{};switch(null===(O=z.source)||void 0===O||null===(O=O.test)||void 0===O?void 0:O.type){case"truefalse":var J;if(jQuery("#"+z.id).click(M=>{M.preventDefault(),((z,d,O,F,J)=>{var W,I;let Z=null===(W=z.source)||void 0===W||null===(W=W.test)||void 0===W||null===(W=W.truefalse)||void 0===W?void 0:W.iscorrect;if(null!==(I=d.svg)&&void 0!==I&&I.nodes.find(M=>{var Y;return"submit"==(null===(Y=M.source)||void 0===Y||null===(Y=Y.test)||void 0===Y?void 0:Y.type)})||ne(z,d,O,F,{iscorrect:Z},J),d.test?d.test.answer?d.test.answer.truefalse={value:z.id,iscorrect:Z}:d.test.answer={truefalse:{value:z.id,iscorrect:Z}}:d.test={answer:{truefalse:{value:z.id,iscorrect:Z}}},d.test.showselection){let M=(0,Lt.g1)(K.O.TEST_GROUP,"g",void 0,b.icdt.target);(0,Lt.Yw)(M,d)}console.log("node source ->",z.source),console.log("slide test ->",d.test)})(z,d,Rt.nodeStatus,Rt.slideStatus,F)}),null!==(J=d.test)&&void 0!==J&&J.showselection){let M=(0,Lt.g1)(K.O.TEST_GROUP,"g",void 0,b.icdt.target);(0,Lt.Yw)(M,d)}break;case"singlechoice":var W;if(jQuery("#"+z.id).click(M=>{M.preventDefault(),((z,d,O,F,J)=>{var W,I;let Z=null===(W=z.source)||void 0===W||null===(W=W.test)||void 0===W||null===(W=W.singlechoice)||void 0===W?void 0:W.iscorrect;if(null!==(I=d.svg)&&void 0!==I&&I.nodes.find(M=>{var Y;return"submit"==(null===(Y=M.source)||void 0===Y||null===(Y=Y.test)||void 0===Y?void 0:Y.type)})||ne(z,d,O,F,{iscorrect:Z},J),d.test?d.test.answer?d.test.answer.singlechoice={value:z.id,iscorrect:Z}:d.test.answer={singlechoice:{value:z.id,iscorrect:Z}}:d.test={answer:{singlechoice:{value:z.id,iscorrect:Z}}},d.test.showselection){let M=(0,Lt.g1)(K.O.TEST_GROUP,"g",void 0,b.icdt.target);(0,Lt.Yw)(M,d)}console.log("node source ->",z.source),console.log("slide test ->",d.test)})(z,d,Rt.nodeStatus,Rt.slideStatus,F)}),null!==(W=d.test)&&void 0!==W&&W.showselection){let M=(0,Lt.g1)(K.O.TEST_GROUP,"g",void 0,b.icdt.target);(0,Lt.Yw)(M,d)}break;case"multichoice":var I;if(jQuery("#"+z.id).click(M=>{M.preventDefault(),((z,d,O,F,J)=>{var W,I;let M,Z=null===(W=z.source)||void 0===W||null===(W=W.test)||void 0===W||null===(W=W.multichoice)||void 0===W?void 0:W.iscorrect;if(null!==(I=d.svg)&&void 0!==I&&I.nodes.find(Y=>{var pt;return"submit"==(null===(pt=Y.source)||void 0===pt||null===(pt=pt.test)||void 0===pt?void 0:pt.type)})||ne(z,d,O,F,{iscorrect:Z},J),d.test?d.test.answer?d.test.answer.multichoice?d.test.answer.multichoice.find(Y=>Y.value==z.id)?(d.test.answer.multichoice=d.test.answer.multichoice.filter(Y=>Y.value!=z.id),M=!0):d.test.answer.multichoice.push({value:z.id,iscorrect:Z}):d.test.answer.multichoice=[{value:z.id,iscorrect:Z}]:d.test.answer={multichoice:[{value:z.id,iscorrect:Z}]}:d.test={answer:{multichoice:[{value:z.id,iscorrect:Z}]}},d.test.showselection){let Y=(0,Lt.g1)(K.O.TEST_GROUP,"g",void 0,b.icdt.target);(0,Lt.Yw)(Y,d)}console.log("node source ->",z.source),console.log("slide test ->",d.test)})(z,d,Rt.nodeStatus,Rt.slideStatus,F)}),null!==(I=d.test)&&void 0!==I&&I.showselection){let M=(0,Lt.g1)(K.O.TEST_GROUP,"g",void 0,b.icdt.target);(0,Lt.Yw)(M,d)}break;case"fill":var Z;jQuery("#"+z.id).on("keyup",'input[type="text"]',M=>{var Y;let pt=jQuery("<div/>").css({"font-size":jQuery(M.target).css("font-size"),visibility:"hidden",float:"left"}).text(M.target.value).appendTo(window.document.body);jQuery(M.target).css({width:(null!==(Y=pt.width())&&void 0!==Y?Y:0)+30})}).on("keypress",'input[type="text"]',M=>{13===(M.keyCode||M.charCode||M.which)&&(M.preventDefault(),M.stopPropagation(),jQuery(M.target).blur())}).on("change",'input[type="text"]',M=>{var Y,pt;let Nt=Rt.nodeStatus,It=Rt.slideStatus,Jt=null===(Y=M.target)||void 0===Y?void 0:Y.getAttribute("data-key"),zt=null===(pt=M.target)||void 0===pt||null===(pt=pt.value)||void 0===pt||null===(pt=pt.toLowerCase())||void 0===pt?void 0:pt.trim();((z,d,O,F,J,W)=>{var I,Z,M;let{value:Y}=null!==(I=null===(Z=z.source)||void 0===Z||null===(Z=Z.test)||void 0===Z||null===(Z=Z.fill)||void 0===Z?void 0:Z.find(Nt=>Nt.key==`[[${J.key}]]`))&&void 0!==I?I:{},pt=Y&&Y.includes(J.value);null!==(M=d.svg)&&void 0!==M&&M.nodes.find(Nt=>{var It;return"submit"==(null===(It=Nt.source)||void 0===It||null===(It=It.test)||void 0===It?void 0:It.type)})||ne(z,d,O,F,{iscorrect:pt},W),J.iscorrect=pt,d.test?d.test.answer?d.test.answer.fill?d.test.answer.fill.find(Nt=>Nt.key==J.key)?d.test.answer.fill.filter(Nt=>Nt.key==J.key).forEach(Nt=>{Nt.value=J.value,Nt.iscorrect=J.iscorrect}):d.test.answer.fill.push(J):d.test.answer.fill=[J]:d.test.answer={fill:[J]}:d.test={answer:{fill:[J]}},console.log("node source ->",z.source),console.log("slide test ->",d.test)})(z,d,Nt,It,{key:Jt,value:zt},F),jQuery("#"+z.id).find(`input[type="text"][data-key="${Jt}"]`).val(zt)}),null!==(Z=d.test)&&void 0!==Z&&Z.showselection||jQuery("#"+z.id).addClass("hide-selection");break;case"matching-empty":jQuery("#"+z.id).on("touchmove",".ondrag-item",function(M){M.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(M){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${z.size.height/z.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${M.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(M){var Y;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(Y=d.test)&&void 0!==Y&&Y.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(M){},dragend:function(M){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${z.id} .ondrop-here`).kendoDropTarget({dragenter:function(M){M.dropTarget.hasClass("actived")&&M.dropTarget.addClass("focused")},dragleave:function(M){M.dropTarget.hasClass("actived")&&M.dropTarget.removeClass("focused")},drop:function(M){if(!M.dropTarget.hasClass("actived"))return;M.dropTarget.removeClass("focused");let Y=M.dropTarget,pt=M.draggable.currentTarget;Y.is(":empty")||Y.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),pt.appendTo(Y),((z,d,O,F,J,W)=>{var I,Z,M;let{key:Y}=null!==(I=null===(Z=z.source)||void 0===Z||null===(Z=Z.test)||void 0===Z?void 0:Z.matching)&&void 0!==I?I:{key:"KIEN"},pt=J.key==Y;null!==(M=d.svg)&&void 0!==M&&M.nodes.find(It=>{var Jt;return"submit"==(null===(Jt=It.source)||void 0===Jt||null===(Jt=Jt.test)||void 0===Jt?void 0:Jt.type)})||ne(z,d,O,F,{iscorrect:pt},W),Yt(z,d,J);let Nt={key:null!=Y?Y:"",value:J.key};d.test?d.test.answer?d.test.answer.matching?d.test.answer.matching.find(It=>It.key==Y)?d.test.answer.matching.filter(It=>It.key==Y).forEach(It=>It.value=Nt.value):d.test.answer.matching.push(Nt):d.test.answer.matching=[Nt]:d.test.answer={matching:[Nt]}:d.test={answer:{matching:[Nt]}},console.log("node source ->",z.source),console.log("slide test ->",d.test)})(z,d,Rt.nodeStatus,Rt.slideStatus,{key:pt.data("key")},F)}});break;case"matching-content":jQuery("#"+z.id).on("touchmove",".ondrag-item",function(M){M.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(M){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${z.size.height/z.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${M.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(M){var Y;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(Y=d.test)&&void 0!==Y&&Y.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(M){},dragend:function(M){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${z.id} .ondrop-here`).kendoDropTarget({dragenter:function(M){M.dropTarget.hasClass("actived")&&M.dropTarget.addClass("focused")},dragleave:function(M){M.dropTarget.hasClass("actived")&&M.dropTarget.removeClass("focused")},drop:function(M){if(!M.dropTarget.hasClass("actived"))return;M.dropTarget.removeClass("focused");let pt=M.draggable.currentTarget;pt.appendTo(M.dropTarget),Yt(z,d,{key:pt.data("key")})}});break;case"speech":break;case"submit":jQuery("#"+z.id).click(M=>{M.preventDefault(),((z,d,O,F,J)=>{var W,I,Z,M,Y;let pt;var Nt;if(null!=d&&null!==(W=d.test)&&void 0!==W&&null!==(W=W.answer)&&void 0!==W&&W.truefalse)pt=null==d||null===(Nt=d.test)||void 0===Nt||null===(Nt=Nt.answer)||void 0===Nt||null===(Nt=Nt.truefalse)||void 0===Nt?void 0:Nt.iscorrect;else if(null!=d&&null!==(I=d.test)&&void 0!==I&&null!==(I=I.answer)&&void 0!==I&&I.singlechoice){var It;pt=null==d||null===(It=d.test)||void 0===It||null===(It=It.answer)||void 0===It||null===(It=It.singlechoice)||void 0===It?void 0:It.iscorrect}else if(null!=d&&null!==(Z=d.test)&&void 0!==Z&&null!==(Z=Z.answer)&&void 0!==Z&&Z.multichoice){var Jt,zt,Gt;pt=1==[null==d||null===(Jt=d.test)||void 0===Jt||null===(Jt=Jt.answer)||void 0===Jt||null===(Jt=Jt.multichoice)||void 0===Jt?void 0:Jt.length,null==d||null===(zt=d.test)||void 0===zt||null===(zt=zt.answer)||void 0===zt||null===(zt=zt.multichoice)||void 0===zt||null===(zt=zt.map(fe=>fe.iscorrect?1:0))||void 0===zt?void 0:zt.reduce((fe,ve)=>fe+ve),null==d||null===(Gt=d.svg)||void 0===Gt||null===(Gt=Gt.nodes)||void 0===Gt||null===(Gt=Gt.filter(fe=>{var ve,Oe;return"multichoice"==(null===(ve=fe.source)||void 0===ve||null===(ve=ve.test)||void 0===ve?void 0:ve.type)&&(null===(Oe=fe.source)||void 0===Oe||null===(Oe=Oe.test)||void 0===Oe||null===(Oe=Oe.multichoice)||void 0===Oe?void 0:Oe.iscorrect)}))||void 0===Gt?void 0:Gt.length].filter((fe,ve,Oe)=>Oe.indexOf(fe)==ve).length}else if(null!=d&&null!==(M=d.test)&&void 0!==M&&null!==(M=M.answer)&&void 0!==M&&M.fill){var Vt,ae;pt=(null==d||null===(Vt=d.test)||void 0===Vt||null===(Vt=Vt.answer)||void 0===Vt||null===(Vt=Vt.fill)||void 0===Vt||null===(Vt=Vt.map(fe=>fe.iscorrect?1:0))||void 0===Vt?void 0:Vt.reduce((fe,ve)=>fe+ve))==(null===(ae=d.svg)||void 0===ae||null===(ae=ae.nodes)||void 0===ae||null===(ae=ae.filter(fe=>{var ve;return"fill"==(null===(ve=fe.source)||void 0===ve||null===(ve=ve.test)||void 0===ve?void 0:ve.type)}))||void 0===ae?void 0:ae.length)}else if(null!=d&&null!==(Y=d.test)&&void 0!==Y&&null!==(Y=Y.answer)&&void 0!==Y&&Y.matching){var ye,Ee;pt=(null===(ye=d.svg)||void 0===ye||null===(ye=ye.nodes)||void 0===ye||null===(ye=ye.filter(fe=>{var ve;return"matching-empty"==(null===(ve=fe.source)||void 0===ve||null===(ve=ve.test)||void 0===ve?void 0:ve.type)}))||void 0===ye?void 0:ye.length)==((null==d||null===(Ee=d.test)||void 0===Ee||null===(Ee=Ee.answer)||void 0===Ee?void 0:Ee.matching)||[]).map(fe=>fe.key==fe.value?1:0).reduce((fe,ve)=>fe+ve)}ne(z,d,O,F,{iscorrect:pt},J),console.log("node source ->",z.source),console.log("slide test ->",d.test)})(z,d,Rt.nodeStatus,Rt.slideStatus,F)})}})(d,z)};var L=f(8619),h=f(8785),H=f(4921),yt=f(8054),ft=f(2282),Ot=f(2875),Ft=f(8419);const xt=(z,d,O)=>{if(O.slideStatus!=Rt.slideStatus||!d.length)return;let F=d.shift(),J=z.filter(M=>M.idx==F);if(!J.length)return;let W=Math.max.apply(null,J.map(M=>{var Y;return null!==(Y=M.time)&&void 0!==Y?Y:0})),I=!1,Z=W<.5?0:setTimeout(()=>{I||(I=!0,xt(z,d,O))},1e3*W);wt(z,d,J,0,O,{idx:F,total:J.length,counter:0,isRecursive:I,timeoutRecursive:Z,maxTimeCoundown:W,uid:Math.floor(1e9*Math.random())})},wt=(z,d,O,F,J,W)=>{if(J.slideStatus!=Rt.slideStatus)return;let I=O[F];if(I){switch(I.type){case ut.$.GROUP:break;case ut.$.CIRCLE:(0,L._)(I.id,{size:I.size,attribute:I.attribute},I.pid?window.document.getElementById(I.pid):null);break;case ut.$.ELLIPSE:(0,h.r)(I.id,{size:I.size,attribute:I.attribute},I.pid?window.document.getElementById(I.pid):null);break;case ut.$.LINE:(0,H.W)(I.id,{size:I.size,attribute:I.attribute},I.pid?window.document.getElementById(I.pid):null);break;case ut.$.RECT:(0,yt.f)(I.id,{size:I.size,attribute:I.attribute},I.pid?window.document.getElementById(I.pid):null);break;case ut.$.POLYGON:(0,ft.l)(I.id,{size:I.size,attribute:I.attribute},I.pid?window.document.getElementById(I.pid):null);break;case ut.$.FOREIGNOBJECT:(0,Ot.e)(I.id,{size:I.size,attribute:I.attribute,style:I.style,source:I.source},I.pid?window.document.getElementById(I.pid):null);break;case ut.$.IMAGE:(0,gt.G)(I.id,{size:I.size,attribute:I.attribute,source:I.source},I.pid?window.document.getElementById(I.pid):null);break;case ut.$.TEXT:(0,m.$)(I.id,{size:I.size,attribute:I.attribute,source:I.source},I.pid?window.document.getElementById(I.pid):null);break;case ut.$.PATH:(0,Ft.G)(I.id,{size:I.size,attribute:I.attribute},I.pid?window.document.getElementById(I.pid):null)}G(J.slide,I,J,()=>{W.counter+=1,W.maxTimeCoundown<.5&&W.counter>=W.total&&(W.total=W.counter=0,W.isRecursive||(clearTimeout(W.timeoutRecursive),W.isRecursive=!0,setTimeout(()=>{xt(z,d,J)},250)))}),wt(z,d,O,++F,J,W)}},Rt=new class qt{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(d){this._dataSource=d.data||{},b.icdt.variable.set=d.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var d,O;return null!==(d=null===(O=this._dataSource)||void 0===O||null===(O=O.slides)||void 0===O?void 0:O.length)&&void 0!==d?d:0}get slides(){var d;return(null===(d=this._dataSource)||void 0===d?void 0:d.slides)||[]}get slide(){var d;return((null===(d=this._dataSource)||void 0===d?void 0:d.slides)||[])[this._slideIdx]||{}}findNode(d){var O;let F=null===(O=this._dataSource)||void 0===O||null===(O=O.slides)||void 0===O?void 0:O.find((It,Jt)=>Jt==this._slideIdx),J=null==F?void 0:F.svg,W=(It,Jt)=>{let zt=null==It?void 0:It.find(ae=>ae.id==d);if(zt)return zt.pid=Jt,zt;let Gt=0,Vt=It.length||0;for(;Gt<Vt&&!zt&&(zt=W(It[Gt].nodes||[],It[Gt].id),!zt);)Gt++;return zt},I=W((null==J?void 0:J.nodes)||[]);var Z,M,Y,pt,Nt;return I?(I.style=null!==(Z=I.style)&&void 0!==Z?Z:{},I.source=null!==(M=I.source)&&void 0!==M?M:{},I.animate=null!==(Y=I.animate)&&void 0!==Y?Y:{},I.interactive=null!==(pt=I.interactive)&&void 0!==pt?pt:{},I.variable=null!==(Nt=I.variable)&&void 0!==Nt?Nt:{},I):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(d,O,F){var J;let W;var I,Z;if(this.refreshNodeStatus(),this.refreshSlideStatus(),F)W=null===(I=this._dataSource)||void 0===I||null===(I=I.slides)||void 0===I?void 0:I.find(Nt=>Nt.code==F||Nt.id==F),W&&(this._slideIdx=(null===(Z=this._dataSource)||void 0===Z||null===(Z=Z.slides)||void 0===Z?void 0:Z.indexOf(W))||0);else if(O){var M,Y;W=null===(M=this._dataSource)||void 0===M||null===(M=M.slides)||void 0===M?void 0:M.find(Nt=>Nt.id==O),W&&(this._slideIdx=(null===(Y=this._dataSource)||void 0===Y||null===(Y=Y.slides)||void 0===Y?void 0:Y.indexOf(W))||0)}else this._slideIdx=Math.min(Math.max(d||0,0),this.slideTotal-1),W=this.slide;if(W){var pt;re(b.icdt.container,b.icdt.svg,W,!0),null===(pt=jQuery(b.icdt.svg).find("#"+K.O.BACKGROUND_GROUP))||void 0===pt||pt.empty();let Nt=(0,Lt.g1)(K.O.BACKGROUND_GROUP,"g",void 0,b.icdt.svg);(0,Lt.x0)(Nt,W),(z=>{var d,O,F,J;let W=Rt.nodeStatus,I=Rt.slideStatus;null===(d=z.svg)||void 0===d||d.nodes.forEach(M=>{M.pid=Math.ceil(1e9*Math.random()),(0,k.m)(M.pid)});let Z=null===(O=z.svg)||void 0===O||null===(O=O.nodes)||void 0===O?void 0:O.map(M=>M.idx).filter((M,Y,pt)=>pt.indexOf(M)==Y).sort((M,Y)=>(null!=M?M:0)-(null!=Y?Y:0));xt(null!==(F=null===(J=z.svg)||void 0===J?void 0:J.nodes)&&void 0!==F?F:[],null!=Z?Z:[],{slide:z,nodeStatus:W,slideStatus:I})})(W)}this.changeSlide(this.slides,null===(J=this.slide)||void 0===J?void 0:J.id,this.slideIdx,this.slides.length,W)}set onChangeSlide(d){this._fnChangeSlides.push(d)}changeSlide(d,O,F,J,W){this._fnChangeSlides.forEach(I=>I(d,O,F,J,W))}},re=(z,d,O,F)=>{var J,W,I,Z;let M=window.document.querySelector(d);var Y;M||(M=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(Y=window.document.querySelector(z))||void 0===Y||Y.appendChild(M)),F&&(M.textContent=null);let{x:pt,y:Nt,width:It,height:Jt}=null!==(J=null==O||null===(W=O.svg)||void 0===W?void 0:W.viewBox)&&void 0!==J?J:b.icdt.screen.frameSize;M.setAttributeNS(null,"viewBox",pt+" "+Nt+" "+It+" "+Jt),M.setAttribute("id",d.replace("#",""));var ye,Ee,zt=null!==(I=jQuery(z).width())&&void 0!==I?I:1080,Gt=null!==(Z=jQuery(z).height())&&void 0!==Z?Z:1080,ae=It/Jt;ae>=zt/Gt?Ee=(ye=zt)/ae:ye=(Ee=Gt)*ae,M.setAttributeNS(null,"width",ye.toString()),M.setAttributeNS(null,"height",Ee.toString())}},2336:(he,Ct,f)=>{f.d(Ct,{Q:()=>b});var K=f(1690);const b=(C,X,c)=>{var A;if(!X.value)return void c();let E=jQuery("#"+C),q="",m=null!==(A=X.iteration)&&void 0!==A?A:0,k=[];(X.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?k.push(X.value):(k.push("animation"),k.push(X.value?"animation-"+X.value:"animation-fadein")),m<0?(k.push("animation-iteration-infinite"),c(),c=function(){}):m>0&&k.push("animation-iteration-"+(m+1)),q=k.join(" "),function(it){let U=function(){E.data("animate-running")?E.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){E.data("animate-running",!1),setTimeout(function(){it()},100)}):it()};E.hasClass("animation")?setTimeout(function(){U()}):U()}(function(){var it;ut(C),(m>0||m<0)&&E.one("animationiteration",function(){X.slideStatus===K.$.slideStatus||(E.data("animate-running",!1),ut(C),X.slideStatus===K.$.slideStatus&&c())}),E.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(E.data("animate-running",!1),ut(C),X.finish){default:case 0:case 1:break;case 2:E.addClass("hide")}X.slideStatus===K.$.slideStatus&&c()}),E.attr("data-class",null!==(it=E.attr("class"))&&void 0!==it?it:""),E.addClass(q),E.data("animate-running",!0)})},ut=function(C){var X,c=jQuery("#"+C),A=null===(X=c.attr("class"))||void 0===X?void 0:X.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);A&&A.forEach(function(q){jQuery(c).removeClass(q)});let E=c.attr("data-class");E&&(c.attr("class",E),c.removeAttr("data-class")),jQuery(c).data("animation-running",!1)}},861:(he,Ct,f)=>{f.d(Ct,{G:()=>C});var K=f(4318),b=f(1690),ut=f(4080);const C=(c,A,E)=>{var q;if(!A.points||!A.points.length)return void E();let m=jQuery("#"+c),k=function X(c){let A=[];2===c.length&&c.splice(1,0,[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2]);let w,it,U,E=1,q=c.length;for(;E<q;){if(w=c[E-1],it=c[E],U=c[E+1],(Math.abs(w[0]-it[0])>=15||Math.abs(w[1]-it[1])>=15)&&Math.pow(w[0]-it[0],2)+Math.pow(w[1]-it[1],2)>=Math.pow(15,2)&&U&&(Math.abs(w[0]-U[0])<=20||Math.abs(w[1]-U[1])<=20)&&Math.pow(w[0]-U[0],2)+Math.pow(w[1]-U[1],2)<=Math.pow(20,2))A.push(it);else{let st=it[0]-w[0],P=it[1]-w[1],lt=Math.max(Math.abs(st),Math.abs(P));for(var Q=0;Q<lt;Q+=15)A.push([w[0]+st*Q/lt,w[1]+P*Q/lt])}E++}return q>0&&(A.splice(0,0,c[0]),A.push(c[q-1])),A}(A.points||[]),w=null!==(q=A.iteration)&&void 0!==q?q:0;if(w<0&&(E(),E=function(){}),m.data("work-running")&&w<0)return;m.data("work-running",!0);let gt,it=k.length,U=Math.max(20,1e3*(A.time||3)/it),{id:Q,type:st,size:P,attribute:lt}=b.$.findNode(c),_t=function(ct){if(A.slideStatus!==b.$.slideStatus)return m.data("work-running",!1),void(A.slideStatus===b.$.slideStatus&&E());if(ct<it){let tt=k[ct];tt&&(gt=Object.assign({},P,{x:tt[0]-P.width/2,y:tt[1]-P.height/2}),Object.assign(lt,(0,K.sg)(st,gt)),(0,ut.__)(window.document.getElementById(Q),lt),setTimeout(function(){_t(++ct)},U))}else if(w>0)w--,_t(1);else if(w<0)_t(1);else switch(m.data("work-running",!1),A.slideStatus===b.$.slideStatus&&E(),A.finish){default:case 0:break;case 1:Object.assign(lt,(0,K.sg)(st,P)),(0,ut.__)(window.document.getElementById(Q),lt);break;case 2:m.addClass("hide")}};_t(1)}},157:(he,Ct,f)=>{f.d(Ct,{R:()=>b});var K=f(1690);const b=(C,X,c,A,E)=>{var q,m,k;if(A.slideStatus!=K.$.slideStatus)return X.async&&"change-slide"!=X.async?void 0:void E();if(A.nodeStatus!=K.$.nodeStatus&&(!X.async||"change-node"==X.async))return void E();if(null===(q=X.source)||void 0===q||!q.url)return console.warn(`${C} -> audio no source!`),E(),void(E=()=>{});var w=jQuery("#"+C);let it=null!==(m=X.iteration)&&void 0!==m?m:0;if(it<0&&(E(),E=function(){}),!(w.data("audio-running")&&it<0)){w.data("audio-running",!0);var U=function(st){st.pause(),st.remove(),w.data("audio-running",!1)},Q=new Audio;return Q.autoplay=!0,Q.loop=0!=it,Q.preload="auto",Q.controls=!0,Q.setAttributeNode(document.createAttribute("playsinline")),Q.addEventListener("canplay",function(){var st=Q.play();st&&st.then(function(P){var lt;w.data("audio-running",!0),"time"==X.async?setTimeout(()=>{U(Q),E(),E=()=>{}},1e3*(null!==(lt=X.time)&&void 0!==lt?lt:1)):"non-stop"==X.async&&(E(),E=()=>{})}).catch(function(P){w.data("audio-running",!1),A.slideStatus===K.$.slideStatus&&(E(),E=()=>{})})}),Q.addEventListener("timeupdate",function(){switch(X.async){case"time":case"non-stop":break;case"finish-action":c.total>=2&&c.total-c.counter==1&&(U(this),E(),E=()=>{});break;default:case"change-node":A.nodeStatus!==K.$.nodeStatus&&(U(this),E(),E=()=>{});break;case"change-slide":A.slideStatus!==K.$.slideStatus&&(U(this),E(),E=()=>{})}}),Q.addEventListener("canplaythrough",function(){this.loop&&(it>0?it--:0==it&&(this.loop=!1))}),Q.addEventListener("play",function(){}),Q.addEventListener("pause",function(){}),Q.addEventListener("ended",function(){this.remove(),w.data("audio-running",!1),A.slideStatus===K.$.slideStatus&&(E(),E=()=>{})}),Q.onerror=function(){this.remove(),w.data("audio-running",!1),A.slideStatus===K.$.slideStatus&&(E(),E=()=>{})},Q.src=(null===(k=X.source)||void 0===k?void 0:k.url)||"",Q}}},5973:(he,Ct,f)=>{f.d(Ct,{F:()=>E});var K=f(4981),b=f(1690),ut=f(2336),C=f(861),X=f(157),c=f(4787),A=f(370);const E=(q,m,k,w)=>{var it,U,Q;let st={total:0,counter:0},{triggershow:P,triggerrun:lt,triggerhide:gt,action:_t,audio:ct,slide:tt,media:j}=null!==(it=null===(U=q.interactive)||void 0===U?void 0:U.click)&&void 0!==it?it:{};if(P){let{id:Ht,ids:Mt,time:Wt,async:ht}=P;"asynctrue"==ht?(0,c.L5)({id:Ht,ids:Mt,nodeStatus:m,slideStatus:k}):"time"==ht&&setTimeout(()=>{(0,c.L5)({id:Ht,ids:Mt,nodeStatus:m,slideStatus:k})},1e3*(null!=Wt?Wt:0))}if(lt){let{id:Ht,ids:Mt,time:Wt,async:ht}=lt;"asynctrue"==ht?(0,c.Ar)({id:Ht,ids:Mt,nodeStatus:m,slideStatus:k}):"time"==ht&&setTimeout(()=>{(0,c.Ar)({id:Ht,ids:Mt,nodeStatus:m,slideStatus:k})},1e3*(null!=Wt?Wt:0))}if(gt){let{id:Ht,ids:Mt,time:Wt,async:ht}=gt;"asynctrue"==ht?(0,c.WT)({id:Ht,ids:Mt,nodeStatus:m,slideStatus:k}):"time"==ht&&setTimeout(()=>{(0,c.WT)({id:Ht,ids:Mt,nodeStatus:m,slideStatus:k})},1e3*(null!=Wt?Wt:0))}let Kt=()=>{setTimeout(()=>{if(st.counter>=st.total){if(w&&w(),P){let{id:Ht,ids:Mt,async:Wt}=P;"asyncfalse"==Wt&&(0,c.L5)({id:Ht,ids:Mt,nodeStatus:m,slideStatus:k})}if(lt){let{id:Ht,ids:Mt,async:Wt}=lt;"asyncfalse"==Wt&&(0,c.Ar)({id:Ht,ids:Mt,nodeStatus:m,slideStatus:k})}if(gt){let{id:Ht,ids:Mt,async:Wt}=gt;"asyncfalse"==Wt&&(0,c.WT)({id:Ht,ids:Mt,nodeStatus:m,slideStatus:k})}}})};if(null!=_t&&_t.value){st.total+=1;let Ht=()=>{st.counter+=1,Kt()};switch(_t.value){case"hide":jQuery("#"+q.id).addClass("hide"),Ht();break;case"points":{let{points:Mt,time:Wt,iteration:ht,finish:nt}=_t;Mt&&(0,C.G)(q.id,{points:Mt,time:Wt,iteration:ht,finish:nt,nodeStatus:m,slideStatus:k},Ht);break}default:{let{value:Mt,time:Wt,iteration:ht,finish:nt}=_t;(0,ut.Q)(q.id,{value:Mt,time:Wt,iteration:ht,finish:nt,nodeStatus:m,slideStatus:k},Ht);break}}}if(null!=ct&&null!==(Q=ct.source)&&void 0!==Q&&Q.path){st.total+=1;let Ht=()=>{st.counter+=1,Kt()};(0,X.R)(q.id,ct,st,{nodeStatus:m,slideStatus:k},Ht)}if(st.total||Kt(),null!=tt&&tt.id)switch(console.log(`InteractiveNode #${q.id} slide(undefined,${tt.id},${tt.code}) success!`),tt.id){case-1:b.$.runSlide(b.$.slideIdx-1);break;case-2:b.$.runSlide(b.$.slideIdx+1);break;default:var Lt;b.$.runSlide(void 0,tt.id,null===(Lt=tt.code)||void 0===Lt?void 0:Lt.toString())}if(null!=j&&j.type){var Dt;let Mt=`<div class="popup-media-viewer"><iframe src="${(0,A.e)({readfileuploadurl:null===(Dt=K.icdt.config)||void 0===Dt?void 0:Dt.readfileuploadurl,type:null==j?void 0:j.type,oss:null==j?void 0:j.oss,path:null==j?void 0:j.path,pathExtract:null==j?void 0:j.pathExtract,url:null==j?void 0:j.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,Wt=jQuery(Mt).appendTo(window.document.body);Wt.find(".btn-close").click(function(ht){ht.preventDefault(),Wt.remove()})}}},4787:(he,Ct,f)=>{f.d(Ct,{Ar:()=>C,L5:()=>ut,WT:()=>X});var K=f(1690),b=f(5973);const ut=c=>{console.log("icdt_Run_Interactive_TriggerShow",c),c.id?jQuery("#"+c.id).removeClass("hide"):c.ids&&c.ids.forEach(A=>{jQuery("#"+A).removeClass("hide")})},C=c=>{console.log("icdt_Run_Interactive_TriggerRun",c),c.id?(jQuery("#"+c.id).removeClass("hide"),(0,b.F)(K.$.findNode(c.id),c.nodeStatus,c.slideStatus)):c.ids&&c.ids.forEach(A=>{jQuery("#"+A).removeClass("hide"),(0,b.F)(K.$.findNode(A),c.nodeStatus,c.slideStatus)})},X=c=>{console.log("icdt_Run_Interactive_TriggerHide",c),c.id?jQuery("#"+c.id).addClass("hide"):c.ids&&c.ids.forEach(A=>{jQuery("#"+A).addClass("hide")})}},4080:(he,Ct,f)=>{f.d(Ct,{Mh:()=>gt,wM:()=>tt,xo:()=>_t,it:()=>j,g1:()=>Mt,__:()=>Kt,QI:()=>Dt,DB:()=>Lt,eb:()=>ct,x0:()=>mt,g$:()=>Wt,mo:()=>Yt,XH:()=>St,hJ:()=>ht,vl:()=>Et,yD:()=>nt,Yw:()=>ne});var K=f(9054),b=f(1687),X=/^#?[a-fA-F0-9]+$/;const E=(G,L)=>{var h;if("none"==(G=null!==(h=G)&&void 0!==h?h:""))return"none";if("transparent"==G)return"rgba(0,0,0,0)";if(G.includes("rgba("))return G;if(G.includes("rgb(")&&(G=((G,L)=>{if(!G)return"";let h=G.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),H=(h&&h[4]||"").trim(),yt=h?(256|h[1]).toString(16).slice(1)+(256|h[2]).toString(16).slice(1)+(256|h[3]).toString(16).slice(1):G;return"0"==H?"transparent":`#${yt}`})(G)),!(G=G.replace(/[^0-9a-fA-F]/g,"")))return"";if(!X.test(G))return console.error(`hex2rgba -> ${G}: first argument has invalid hexadecimal characters`),"";if("#"===G[0]&&(G=G.slice(1)),3===G.length){let yt=G.split("");yt.splice(2,0,G[2]),yt.splice(1,0,G[1]),yt.splice(0,0,G[0]),G=yt.join("")}if(6!==G.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var H=[parseInt(G.slice(0,2),16),parseInt(G.slice(2,4),16),parseInt(G.slice(4,6),16)];return L="number"==typeof L?L:parseFloat(L),H.push(L>=0&&L<=1?L:1),"rgba("+H.join(",")+")"};var q=f(370),m=f(1814),k=f(4981),w=f(3423),it=f(8054),U=f(7210),Q=f(8619),st=f(1690),P=f(2875),lt=f(1105);class gt{constructor(L,h){let H=window.document.querySelector(h);var yt;H||(H=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(yt=window.document.querySelector(L))||void 0===yt||yt.appendChild(H));let{svgViewBox:ft,svgSize:Ot}=k.icdt.screen.init();H.setAttributeNS(null,"viewBox",`${ft.x} ${ft.y} ${ft.width} ${ft.height}`),H.setAttribute("id",h.replace("#","")),H.style.display="block",H.style.position="absolute",H.style.left=`${Ot.x}px`,H.style.top=`${Ot.y}px`,H.style.width=`${Ot.width}px`,H.style.height=`${Ot.height}px`,H.style.backgroundColor="#fafafa",H.style.cursor="default"}}const _t=G=>{jQuery(k.icdt.target).find("#"+b.O.BACKGROUND_GROUP).empty();let L=Mt(b.O.BACKGROUND_GROUP,"g",void 0,k.icdt.target);mt(L,G),(()=>{let h=window.document.getElementById(null==G?void 0:G.id);jQuery(h).find("#"+b.O.BACKGROUND_GROUP).empty();let H=Mt(b.O.BACKGROUND_GROUP,"g",void 0,h);mt(H,G)})()},ct=()=>{let G=k.icdt.screen.svgViewBox,L=k.icdt.screen.svgSize;k.icdt.target&&(k.icdt.target.setAttributeNS(null,"viewBox",`${G.x} ${G.y} ${G.width} ${G.height}`),k.icdt.target.style.left=`${L.x}px`,k.icdt.target.style.top=`${L.y}px`,k.icdt.target.style.width=`${L.width}px`,k.icdt.target.style.height=`${L.height}px`)},tt=()=>{jQuery(k.icdt.target).find(">*:not(defs)").remove()},j=(G,L,h,H,yt)=>{let ft;return G?(ft=jQuery(yt||k.icdt.target).find("#"+G).get(0),ft||(ft=window.document.createElementNS("http://www.w3.org/2000/svg",h),ft.setAttribute("id",G),jQuery(ft).appendTo(yt||k.icdt.target))):(ft=window.document.createElementNS("http://www.w3.org/2000/svg",h),jQuery(ft).appendTo(yt||k.icdt.target)),null!=H&&H.attribute&&Kt(ft,null==H?void 0:H.attribute),null!=H&&H.style&&Lt(ft,null==H?void 0:H.style),null!=H&&H.source&&Dt(ft,L,null==H?void 0:H.source),ft},Kt=(G,L)=>{return jQuery(G).attr((h=Object.assign({},L||{}),null===(H=Object.keys(h))||void 0===H||H.forEach(Ot=>{switch(Ot){case"fill":break;case"stroke":var Ft;Object.assign(h,{"stroke-width":null!==(Ft=h.strokeWidth)&&void 0!==Ft?Ft:null,strokeWidth:null});break;case"strokeLinecap":var jt;Object.assign(h,{"stroke-linecap":null!==(jt=h.strokeLinecap)&&void 0!==jt?jt:null,strokeLinecap:null});break;case"strokeLinejoin":var xt;Object.assign(h,{"stroke-linejoin":null!==(xt=h.strokeLinejoin)&&void 0!==xt?xt:null,strokeLinejoin:null});break;case"strokeDasharray":var wt;Object.assign(h,{"stroke-dasharray":null!==(wt=h.strokeDasharray)&&void 0!==wt?wt:null,strokeDasharray:null});break;case"strokeDasharrays":var qt,Rt;Object.assign(h,{"stroke-dasharray":null!==(qt=null===(Rt=h.strokeDasharrays)||void 0===Rt?void 0:Rt.join(" "))&&void 0!==qt?qt:null,strokeDasharrays:null});break;case"fontFamily":var re;Object.assign(h,{"font-family":null!==(re=h.fontFamily)&&void 0!==re?re:null,fontFamily:null});break;case"fontSize":var z;Object.assign(h,{"font-size":null!==(z=h.fontSize)&&void 0!==z?z:null,fontSize:null});break;case"textLength":Object.assign(h,{textLength:h.textLength?`${h.textLength}px`:null});break;case"transformOrigin":var d;Object.assign(h,{"transform-origin":null!==(d=h.transformOrigin)&&void 0!==d?d:null,transformOrigin:null})}}),Object.assign({},null!=h?h:{},{fill:null!=h&&h.fill?E(h.fill,null!==(yt=null==h?void 0:h.fillOpacity)&&void 0!==yt?yt:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=h&&h.stroke?E(h.stroke,null!==(ft=null==h?void 0:h.strokeOpacity)&&void 0!==ft?ft:1):"rgba(0,0,0,0)",strokeOpacity:null}))),G;var h,H,yt,ft},Lt=(G,L)=>{return jQuery(G).css((h=Object.assign({},L||{}),null===(H=Object.keys(h))||void 0===H||H.forEach(yt=>{switch(yt){case"padding":Object.assign(h,{padding:h.padding?`${h.padding}px`:null});break;case"borderWidth":var ft;Object.assign(h,h.borderWidth&&h.borderStyle&&h.borderColor?{"border-width":`${h.borderWidth}px`,"border-style":h.borderStyle,"border-color":E(h.borderColor,null!==(ft=h.borderOpacity)&&void 0!==ft?ft:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(h,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(h,{"border-radius":h.borderRadius?`${h.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var Ot;h.backgroundColor&&Object.assign(h,{"background-color":E(h.backgroundColor,null!==(Ot=h.backgroundOpacity)&&void 0!==Ot?Ot:1)}),Object.assign(h,{backgroundColor:null,backgroundOpacity:null})}}),h)),G;var h,H},Dt=(G,L,h)=>{switch(L){case K.$.TEXT:var H,yt;jQuery(G).text(null!==(H=null==h||null===(yt=h.text)||void 0===yt?void 0:yt.textContent)&&void 0!==H?H:"");break;case K.$.IMAGE:var ft,Ot,Ft,jt,xt,wt,qt;jQuery(G).attr("href",(null==h||null===(ft=h.image)||void 0===ft?void 0:ft.base64)||(null!=h&&null!==(Ot=h.image)&&void 0!==Ot&&Ot.path?`${null!==(Ft=null===(jt=k.icdt.config)||void 0===jt?void 0:jt.readfileuploadurl)&&void 0!==Ft?Ft:""}${null!==(xt=null==h||null===(wt=h.image)||void 0===wt?void 0:wt.path)&&void 0!==xt?xt:""}`:"")||(null==h||null===(qt=h.image)||void 0===qt?void 0:qt.url)||"");break;case K.$.FOREIGNOBJECT:switch(null==h?void 0:h.type){case"text":var Rt,re;if(null!==(Rt=h.text)&&void 0!==Rt&&Rt.variableKeywords&&null!==(re=h.text)&&void 0!==re&&re.variableKeywords.length){var z;let N=k.icdt.variable.getKeys(),B=(null===(z=h.text)||void 0===z?void 0:z.textContent)||"";h.text.variableKeywords.forEach(V=>{var ot=V.replace(/[^a-zA-Z0-9_]/gm,"");if(N.indexOf(ot)>=0){var at=k.icdt.variable.getValue(ot);B=B.replace(V,at)}}),jQuery(G).text(B)}else{var d;jQuery(G).text((null===(d=h.text)||void 0===d?void 0:d.textContent)||"")}break;case"html":{var O,F,J;let N=(null==h||null===(O=h.html)||void 0===O?void 0:O.htmlContent)||"";if(null!==(F=h.html)&&void 0!==F&&F.variableKeywords&&null!==(J=h.html)&&void 0!==J&&J.variableKeywords.length){let B=k.icdt.variable.getKeys();h.html.variableKeywords.forEach(V=>{var ot=V.replace(/[^a-zA-Z0-9_]/gm,"");if(B.indexOf(ot)>=0){var at=k.icdt.variable.getValue(ot);N=N.replace(V,at)}})}jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${N}</div>`).find("img[path],video[path],iframe[path]").each((B,V)=>{var ot,at,Ut;V.setAttribute("src",(null!==(ot=null===(at=k.icdt.config)||void 0===at?void 0:at.readfileuploadurl)&&void 0!==ot?ot:"")+(null!==(Ut=V.getAttribute("path"))&&void 0!==Ut?Ut:"")),V.removeAttribute("path")});break}case"input":var W,I,Z,M;if(null!==(W=h.input)&&void 0!==W&&W.input)jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(Z=null===(M=h.input)||void 0===M?void 0:M.placeholder)&&void 0!==Z?Z:""}" maxlength="100" /></div>`);else if(null!==(I=h.input)&&void 0!==I&&I.textarea){var Y,pt;jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(Y=null===(pt=h.input)||void 0===pt?void 0:pt.placeholder)&&void 0!==Y?Y:""}" maxlength="1000"></textarea></div>`)}break;case"image":var Nt,It,Jt,zt,Gt,Vt,ae;jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(Nt=h.image)||void 0===Nt?void 0:Nt.base64)||(null!==(It=h.image)&&void 0!==It&&It.path?`${null!==(Jt=null===(zt=k.icdt.config)||void 0===zt?void 0:zt.readfileuploadurl)&&void 0!==Jt?Jt:""}${null!==(Gt=null===(Vt=h.image)||void 0===Vt?void 0:Vt.path)&&void 0!==Gt?Gt:""}`:"")||(null===(ae=h.image)||void 0===ae?void 0:ae.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var ye,Ee,fe,ve,Oe,ni,ri;jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${null!==(ye=h.iframe)&&void 0!==ye&&ye.path?`${null!==(Ee=null===(fe=k.icdt.config)||void 0===fe?void 0:fe.readfileuploadurl)&&void 0!==Ee?Ee:""}${null!==(ve=null===(Oe=h.iframe)||void 0===Oe?void 0:Oe.path)&&void 0!==ve?ve:""}`:null!==(ni=null===(ri=h.iframe)||void 0===ri?void 0:ri.url)&&void 0!==ni?ni:""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var vi,Ae,li,Ge,Ze,ai;let N=(0,q.e)({readfileuploadurl:null===(vi=k.icdt.config)||void 0===vi?void 0:vi.readfileuploadurl,type:null===(Ae=h.embed)||void 0===Ae?void 0:Ae.type,oss:null===(li=h.embed)||void 0===li?void 0:li.oss,path:null===(Ge=h.embed)||void 0===Ge?void 0:Ge.path,pathExtract:null===(Ze=h.embed)||void 0===Ze?void 0:Ze.pathExtract,url:null===(ai=h.embed)||void 0===ai?void 0:ai.url});jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${N}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var oi,ti;jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(oi=null===(ti=h.svg)||void 0===ti?void 0:ti.svgContent)&&void 0!==oi?oi:""}</div>`);break;case"test":{var Xe,si,bt,T;let N=(null==h||null===(Xe=h.html)||void 0===Xe?void 0:Xe.htmlContent)||"";if(null!==(si=h.html)&&void 0!==si&&si.variableKeywords&&null!==(bt=h.html)&&void 0!==bt&&bt.variableKeywords.length){let B=k.icdt.variable.getKeys();h.html.variableKeywords.forEach(V=>{var ot=V.replace(/[^a-zA-Z0-9_]/gm,"");if(B.indexOf(ot)>=0){var at=k.icdt.variable.getValue(ot);N=N.replace(V,at)}})}switch(null==h||null===(T=h.test)||void 0===T?void 0:T.type){case"truefalse":case"singlechoice":case"multichoice":jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${N}</div></div></div>`);break;case"matching-empty":jQuery(G).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty"></div>');break;case"matching-content":var i,n;jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content"><div class="ondrag-item" data-key="${null!==(i=null==h||null===(n=h.test)||void 0===n||null===(n=n.matching)||void 0===n?void 0:n.key)&&void 0!==i?i:"KIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${N}</div></div></div></div>`);break;case"fill":var r;((null===(r=h.html)||void 0===r?void 0:r.fillKeywords)||[]).forEach(B=>{var V=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${B.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;N=N.replace(new RegExp(B.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),V)}),jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${N}</div></div></div>`);break;case"speech":jQuery(G).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var a,s,g,v,p,S,x;jQuery(G).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(a=null!==(s=null===(g=h.image)||void 0===g?void 0:g.url)&&void 0!==s?s:`${null!==(v=null===(p=k.icdt.config)||void 0===p?void 0:p.readfileuploadurl)&&void 0!==v?v:""}${null!==(S=null===(x=h.image)||void 0===x?void 0:x.path)&&void 0!==S?S:""}`)&&void 0!==a?a:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(G).find("img[path],video[path],iframe[path]").each((B,V)=>{var ot,at,Ut;V.setAttribute("src",(null!==(ot=null===(at=k.icdt.config)||void 0===at?void 0:at.readfileuploadurl)&&void 0!==ot?ot:"")+(null!==(Ut=V.getAttribute("path"))&&void 0!==Ut?Ut:"")),V.removeAttribute("path")})}}}},Mt=(G,L,h,H)=>{let yt=jQuery(H||k.icdt.target).find("#"+G).get(0);return yt||(yt=window.document.createElementNS("http://www.w3.org/2000/svg",L),yt.setAttribute("id",G),jQuery(yt).appendTo(H||k.icdt.target)),jQuery(yt).attr((null==h?void 0:h.attribute)||{}),jQuery(yt).css((null==h?void 0:h.style)||{}),yt},Wt=(G,L)=>{let h=(0,w.v)(2),H={fill:m.S3.fill,stroke:m.S3.stroke,"stroke-width":(0,w.v)(m.S3.strokeWidth)};return[{element:Mt("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:L.x-h,y:L.y-h,width:L.width+2*h,height:L.height+2*h},H)},G),posType:"rect-center"}]},ht=(G,L)=>{let{size:h}=L,H=(0,w.v)(1),yt=(0,w.v)(2),ft=(0,w.v)(5),Ot={stroke:m.NV.stroke,"stroke-width":(0,w.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},Ft={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,w.v)(m.Mo.strokeWidth)},jt={fill:m.In.fill,stroke:m.In.stroke,"stroke-width":(0,w.v)(m.In.strokeWidth),width:(0,w.v)(m.In.width),height:(0,w.v)(m.In.height)};return Mt("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:h.x-H,y1:h.y,x2:h.x-H,y2:h.y+h.height},Ot)},G),Mt("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:h.x,y1:h.y-H,x2:h.x+h.width,y2:h.y-H},Ot)},G),Mt("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:h.x+h.width+H,y1:h.y,x2:h.x+h.width+H,y2:h.y+h.height},Ot)},G),Mt("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:h.x,y1:h.y+h.height+H,x2:h.x+h.width,y2:h.y+h.height+H},Ot)},G),[{element:Mt("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:h.x,y:h.y,width:h.width,height:h.height},Ft),style:{cursor:"move"}},G),posType:"rect-center"},{element:Mt("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:h.x-ft,y:h.y-ft},jt),style:{cursor:"nw-resize"}},G),posType:"rect-top-left"},{element:Mt("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:h.x+h.width-yt,y:h.y-ft},jt),style:{cursor:"ne-resize"}},G),posType:"rect-top-right"},{element:Mt("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:h.x-ft,y:h.y+h.height-yt},jt),style:{cursor:"sw-resize"}},G),posType:"rect-bottom-left"},{element:Mt("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:h.x+h.width-yt,y:h.y+h.height-yt},jt),style:{cursor:"se-resize"}},G),posType:"rect-bottom-right"}]},nt=(G,L,h)=>{let H=(0,w.v)(1),yt={stroke:m.NV.stroke,"stroke-width":(0,w.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},ft={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,w.v)(m.Mo.strokeWidth)},Ot={fill:m.dt.fill,stroke:m.dt.stroke,"stroke-width":(0,w.v)(m.dt.strokeWidth)},qt=(Mt("icdt-temp-select-line-left","line",{attribute:Object.assign({x1:h.x-H,y1:h.y,x2:h.x-H,y2:h.y+h.height},yt)},G),Mt("icdt-temp-select-line-top","line",{attribute:Object.assign({x1:h.x,y1:h.y-H,x2:h.x+h.width,y2:h.y-H},yt)},G),Mt("icdt-temp-select-line-right","line",{attribute:Object.assign({x1:h.x+h.width+H,y1:h.y,x2:h.x+h.width+H,y2:h.y+h.height},yt)},G),Mt("icdt-temp-select-line-bottom","line",{attribute:Object.assign({x1:h.x,y1:h.y+h.height+H,x2:h.x+h.width,y2:h.y+h.height+H},yt)},G),Mt("icdt-temp-select-rect-center","rect",{attribute:Object.assign({x:h.x,y:h.y,width:h.width,height:h.height},ft)},G));return L.forEach(Rt=>{let{size:re}=Rt;Mt("icdt-temp-select-rect-node-"+Rt.id,"rect",{attribute:Object.assign({x:re.x,y:re.y,width:re.width,height:re.height},Ot)},G)}),[{element:qt,posType:"rect-center"}]},Et=(G,L)=>{let h=(0,w.v)(1),H={stroke:m.NV.stroke,"stroke-width":(0,w.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},yt={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,w.v)(m.Mo.strokeWidth)};return Mt("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:L.x-h,y1:L.y,x2:L.x-h,y2:L.y+L.height},H)},G),Mt("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:L.x,y1:L.y-h,x2:L.x+L.width,y2:L.y-h},H)},G),Mt("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:L.x+L.width+h,y1:L.y,x2:L.x+L.width+h,y2:L.y+L.height},H)},G),Mt("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:L.x,y1:L.y+L.height+h,x2:L.x+L.width,y2:L.y+L.height+h},H)},G),[{element:Mt("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:L.x,y:L.y,width:L.width,height:L.height},yt)},G),posType:"rect-center"}]},St=(G,L)=>{let h=(0,w.v)(-1),H={stroke:m.h8.stroke,"stroke-width":(0,w.v)(m.h8.strokeWidth),"stroke-linecap":m.h8.strokeLinecap,"stroke-dasharray":(0,w.v)(m.h8.strokeDasharray)},yt={fill:m.MA.fill};return Mt("icdt-temp-interactive-line-left","line",{attribute:Object.assign({x1:L.x-h,y1:L.y,x2:L.x-h,y2:L.y+L.height},H)},G),Mt("icdt-temp-interactive-line-top","line",{attribute:Object.assign({x1:L.x,y1:L.y-h,x2:L.x+L.width,y2:L.y-h},H)},G),Mt("icdt-temp-interactive-line-right","line",{attribute:Object.assign({x1:L.x+L.width+h,y1:L.y,x2:L.x+L.width+h,y2:L.y+L.height},H)},G),Mt("icdt-temp-interactive-line-bottom","line",{attribute:Object.assign({x1:L.x,y1:L.y+L.height+h,x2:L.x+L.width,y2:L.y+L.height+h},H)},G),Mt("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:L.x,y:L.y,width:L.width,height:L.height},yt)},G),[]},Yt=(G,L)=>{let h={fill:m.k0.fill,stroke:m.k0.stroke,"stroke-width":(0,w.v)(m.k0.strokeWidth),"stroke-dasharray":(0,w.v)(m.k0.strokeDasharray)};jQuery(G).empty(),L.forEach(H=>{var yt,ft;let{size:Ot}=H;if(!H.idx)return;Mt("icdt-temp-index-rect-node-"+H.id,"rect",{attribute:Object.assign({x:Ot.x-5,y:Ot.y-5,width:Ot.width+10,height:Ot.height+10},h)},G);let{element:Ft}=(0,P.e)(Math.ceil(1e9*Math.random()),{size:{x:Ot.x-76,y:Ot.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(yt=H.idx)&&void 0!==yt?yt:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(ft=H.time)&&void 0!==ft?ft:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},G);Ft.classList.add("node-input"),jQuery(Ft).on("change",'input[name="idx"]',jt=>{var xt;H.idx=parseInt(null!==(xt=jt.target.value)&&void 0!==xt?xt:"0")}).on("change",'input[name="time"]',jt=>{var xt;H.time=parseFloat(null!==(xt=jt.target.value)&&void 0!==xt?xt:"0")}).on("click",'button[name="remove"]',jt=>{H.idx=0,H.time=null,Yt(G,L)})})},mt=(G,L)=>{var h,H,yt,ft,Ot,Ft;let{color:jt,opacity:xt,path:wt,url:qt,base64:Rt}=null!==(h=null==L||null===(H=L.svg)||void 0===H?void 0:H.background)&&void 0!==h?h:{},{x:re,y:z,width:d,height:O}=null!==(yt=null==L||null===(ft=L.svg)||void 0===ft?void 0:ft.viewBox)&&void 0!==yt?yt:{x:0,y:0,width:0,height:0};(0,lt.$)(void 0,{size:{x:0,y:-7,width:d,height:O},attribute:{fill:"#999",fontSize:14,class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(Ot=null!==(Ft=null==L?void 0:L.name)&&void 0!==Ft?Ft:null==L?void 0:L.code)&&void 0!==Ot?Ot:void 0}}},G),(0,it.f)(void 0,{size:{x:re,y:z,width:d,height:O},attribute:{fill:"#fff",stroke:"#999",strokeWidth:1,strokeDasharray:10,class:"hide-on-viewer"}},G),jt&&(0,it.f)(void 0,{size:{x:re,y:z,width:d,height:O},attribute:{fill:jt,fillOpacity:xt}},G),wt&&(0,U.G)(void 0,{size:{x:re,y:z,width:d,height:O},source:{type:"image",image:{path:wt,url:qt,base64:Rt}}},G)},ne=(G,L)=>{var h;switch(jQuery(G).empty(),null===(h=L.test)||void 0===h?void 0:h.type){case"truefalse":{var H,yt,ft;let z=null==L||null===(H=L.test)||void 0===H||null===(H=H.answer)||void 0===H||null===(H=H.truefalse)||void 0===H?void 0:H.value;null===(yt=L.svg)||void 0===yt||yt.nodes.filter(d=>{var O;return"truefalse"==(null===(O=d.source)||void 0===O||null===(O=O.test)||void 0===O?void 0:O.type)&&d.id!=z}).forEach(d=>{var O;let{x:J,y:W,width:I,height:Z}=null!==(O=null==d?void 0:d.size)&&void 0!==O?O:{x:0,y:0,width:0,height:0};(0,Q._)(Math.ceil(1e9*Math.random()),{size:{x:J-.5,y:W-.5,width:I+1,height:Z+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},G)}),null!=L&&null!==(ft=L.test)&&void 0!==ft&&null!==(ft=ft.answer)&&void 0!==ft&&ft.truefalse&&z&&(d=>{let O=st.$.findNode(z),{x:J,y:W,width:I,height:Z}=null!==(d=null==O?void 0:O.size)&&void 0!==d?d:{x:0,y:0,width:0,height:0};(0,Q._)(Math.ceil(1e9*Math.random()),{size:{x:J-2,y:W-2,width:I+4,height:Z+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},G)})();break}case"singlechoice":{var Ot,Ft,jt;let z=null==L||null===(Ot=L.test)||void 0===Ot||null===(Ot=Ot.answer)||void 0===Ot||null===(Ot=Ot.singlechoice)||void 0===Ot?void 0:Ot.value;null===(Ft=L.svg)||void 0===Ft||Ft.nodes.filter(d=>{var O;return"singlechoice"==(null===(O=d.source)||void 0===O||null===(O=O.test)||void 0===O?void 0:O.type)&&d.id!=z}).forEach(d=>{var O;let{x:J,y:W,width:I,height:Z}=null!==(O=null==d?void 0:d.size)&&void 0!==O?O:{x:0,y:0,width:0,height:0};(0,Q._)(Math.ceil(1e9*Math.random()),{size:{x:J-.5,y:W-.5,width:I+1,height:Z+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},G)}),null!=L&&null!==(jt=L.test)&&void 0!==jt&&null!==(jt=jt.answer)&&void 0!==jt&&jt.singlechoice&&z&&(d=>{let O=st.$.findNode(z),{x:J,y:W,width:I,height:Z}=null!==(d=null==O?void 0:O.size)&&void 0!==d?d:{x:0,y:0,width:0,height:0};(0,Q._)(Math.ceil(1e9*Math.random()),{size:{x:J-2,y:W-2,width:I+4,height:Z+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},G)})();break}case"multichoice":{var xt,wt,qt,Rt;let z=null!==(xt=null==L||null===(wt=L.test)||void 0===wt||null===(wt=wt.answer)||void 0===wt||null===(wt=wt.multichoice)||void 0===wt?void 0:wt.map(d=>d.value))&&void 0!==xt?xt:[];var re;null===(qt=L.svg)||void 0===qt||qt.nodes.filter(d=>{var O;return"multichoice"==(null===(O=d.source)||void 0===O||null===(O=O.test)||void 0===O?void 0:O.type)&&!z.includes(d.id)}).forEach(d=>{var O;let{x:J,y:W,width:I,height:Z}=null!==(O=null==d?void 0:d.size)&&void 0!==O?O:{x:0,y:0,width:0,height:0};(0,it.f)(Math.ceil(1e9*Math.random()),{size:{x:J-.5,y:W-.5,width:I+1,height:Z+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},G)}),null!=L&&null!==(Rt=L.test)&&void 0!==Rt&&null!==(Rt=Rt.answer)&&void 0!==Rt&&Rt.multichoice&&z.length&&(null==L||null===(re=L.test)||void 0===re||null===(re=re.answer)||void 0===re||re.multichoice.forEach(d=>{var O;let F=st.$.findNode(d.value),{x:W,y:I,width:Z,height:M}=null!==(O=null==F?void 0:F.size)&&void 0!==O?O:{x:0,y:0,width:0,height:0};(0,it.f)(Math.ceil(1e9*Math.random()),{size:{x:W-2,y:I-2,width:Z+4,height:M+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},G)}));break}}}},370:(he,Ct,f)=>{f.d(Ct,{e:()=>ut});const ut=c=>{switch(null==c?void 0:c.type){case 901:return"assets/iframe/lib/mk-image-viewer/viewer.html?url="+c.readfileuploadurl+c.path;case 902:return"assets/iframe/lib/mk-audio-player/player.html?url="+c.readfileuploadurl+c.path;case 903:return"assets/iframe/lib/mk-video-player/player.html?url="+c.readfileuploadurl+c.path;case 908:return"https://view.officeapps.live.com/op/view.aspx?src="+c.readfileuploadurl+c.path;case 909:return"assets/iframe/lib/PDFReader/web/viewer.html?file="+c.readfileuploadurl+c.path;case 906:case 911:case 910:return""+c.readfileuploadurl+c.path;case 905:var A;return"imsmanifest.xml"==(null===(A=c.pathExtract)||void 0===A||null===(A=A.split("/"))||void 0===A?void 0:A.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+c.readfileuploadurl+c.pathExtract:""+c.readfileuploadurl+c.path;case 907:case 900:return""+c.readfileuploadurl+c.path;case 904:switch(c.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+c.url;case 1002:var E;return null!==(E=C(c.url))&&void 0!==E?E:"";case 1005:var q;return null!==(q=c.url)&&void 0!==q?q:"";default:var m;return null!==(m=c.url)&&void 0!==m?m:""}default:return""+c.readfileuploadurl+c.path}},C=c=>{let A=X(c);return A?"https://www.youtube.com/embed/"+A+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},X=c=>{let A=null==c?void 0:c.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return A&&A.length>=2?A[1]:null}},511:(he,Ct,f)=>{function K(){}function b(t){return null==t?K:function(){return this.querySelector(t)}}function X(){return[]}function c(t){return null==t?X:function(){return this.querySelectorAll(t)}}function q(t){return function(){return this.matches(t)}}function m(t){return function(e){return e.matches(t)}}f.d(Ct,{$0Z:()=>aa,jvg:()=>la});var k=Array.prototype.find;function it(){return this.firstElementChild}var Q=Array.prototype.filter;function st(){return Array.from(this.children)}function _t(t){return new Array(t.length)}function tt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Kt(t,e,l,o,u,y){for(var R,_=0,D=e.length,rt=y.length;_<rt;++_)(R=e[_])?(R.__data__=y[_],o[_]=R):l[_]=new tt(t,y[_]);for(;_<D;++_)(R=e[_])&&(u[_]=R)}function Lt(t,e,l,o,u,y,_){var R,D,Zt,rt=new Map,dt=e.length,At=y.length,Pt=new Array(dt);for(R=0;R<dt;++R)(D=e[R])&&(Pt[R]=Zt=_.call(D,D.__data__,R,e)+"",rt.has(Zt)?u[R]=D:rt.set(Zt,D));for(R=0;R<At;++R)Zt=_.call(t,y[R],R,y)+"",(D=rt.get(Zt))?(o[R]=D,D.__data__=y[R],rt.delete(Zt)):l[R]=new tt(t,y[R]);for(R=0;R<dt;++R)(D=e[R])&&rt.get(Pt[R])===D&&(u[R]=D)}function Dt(t){return t.__data__}function Mt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Yt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}tt.prototype={constructor:tt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var yt="http://www.w3.org/1999/xhtml";const ft={svg:"http://www.w3.org/2000/svg",xhtml:yt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ot(t){var e=t+="",l=e.indexOf(":");return l>=0&&"xmlns"!==(e=t.slice(0,l))&&(t=t.slice(l+1)),ft.hasOwnProperty(e)?{space:ft[e],local:t}:t}function Ft(t){return function(){this.removeAttribute(t)}}function jt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function xt(t,e){return function(){this.setAttribute(t,e)}}function wt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function qt(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttribute(t):this.setAttribute(t,l)}}function Rt(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,l)}}function z(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function d(t){return function(){this.style.removeProperty(t)}}function O(t,e,l){return function(){this.style.setProperty(t,e,l)}}function F(t,e,l){return function(){var o=e.apply(this,arguments);null==o?this.style.removeProperty(t):this.style.setProperty(t,o,l)}}function W(t,e){return t.style.getPropertyValue(e)||z(t).getComputedStyle(t,null).getPropertyValue(e)}function I(t){return function(){delete this[t]}}function Z(t,e){return function(){this[t]=e}}function M(t,e){return function(){var l=e.apply(this,arguments);null==l?delete this[t]:this[t]=l}}function pt(t){return t.trim().split(/^|\s+/)}function Nt(t){return t.classList||new It(t)}function It(t){this._node=t,this._names=pt(t.getAttribute("class")||"")}function Jt(t,e){for(var l=Nt(t),o=-1,u=e.length;++o<u;)l.add(e[o])}function zt(t,e){for(var l=Nt(t),o=-1,u=e.length;++o<u;)l.remove(e[o])}function Gt(t){return function(){Jt(this,t)}}function Vt(t){return function(){zt(this,t)}}function ae(t,e){return function(){(e.apply(this,arguments)?Jt:zt)(this,t)}}function Ee(){this.textContent=""}function fe(t){return function(){this.textContent=t}}function ve(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ni(){this.innerHTML=""}function ri(t){return function(){this.innerHTML=t}}function vi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function li(){this.nextSibling&&this.parentNode.appendChild(this)}function Ze(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function oi(t){return function(){var e=this.ownerDocument,l=this.namespaceURI;return l===yt&&e.documentElement.namespaceURI===yt?e.createElement(t):e.createElementNS(l,t)}}function ti(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Xe(t){var e=Ot(t);return(e.local?ti:oi)(e)}function bt(){return null}function i(){var t=this.parentNode;t&&t.removeChild(this)}function r(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function a(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function S(t){return function(){var e=this.__on;if(e){for(var y,l=0,o=-1,u=e.length;l<u;++l)y=e[l],t.type&&y.type!==t.type||y.name!==t.name?e[++o]=y:this.removeEventListener(y.type,y.listener,y.options);++o?e.length=o:delete this.__on}}}function x(t,e,l){return function(){var u,o=this.__on,y=function v(t){return function(e){t.call(this,e,this.__data__)}}(e);if(o)for(var _=0,R=o.length;_<R;++_)if((u=o[_]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.options),this.addEventListener(u.type,u.listener=y,u.options=l),void(u.value=e);this.addEventListener(t.type,y,l),u={type:t.type,name:t.name,value:e,listener:y,options:l},o?o.push(u):this.__on=[u]}}function B(t,e,l){var o=z(t),u=o.CustomEvent;"function"==typeof u?u=new u(e,l):(u=o.document.createEvent("Event"),l?(u.initEvent(e,l.bubbles,l.cancelable),u.detail=l.detail):u.initEvent(e,!1,!1)),t.dispatchEvent(u)}function V(t,e){return function(){return B(this,t,e)}}function ot(t,e){return function(){return B(this,t,e.apply(this,arguments))}}It.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var oe=[null];function ce(t,e){this._groups=t,this._parents=e}function pe(){return new ce([[document.documentElement]],oe)}ce.prototype=pe.prototype={constructor:ce,select:function ut(t){"function"!=typeof t&&(t=b(t));for(var e=this._groups,l=e.length,o=new Array(l),u=0;u<l;++u)for(var D,rt,y=e[u],_=y.length,R=o[u]=new Array(_),dt=0;dt<_;++dt)(D=y[dt])&&(rt=t.call(D,D.__data__,dt,y))&&("__data__"in D&&(rt.__data__=D.__data__),R[dt]=rt);return new ce(o,this._parents)},selectAll:function E(t){t="function"==typeof t?function A(t){return function(){return function C(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):c(t);for(var e=this._groups,l=e.length,o=[],u=[],y=0;y<l;++y)for(var D,_=e[y],R=_.length,rt=0;rt<R;++rt)(D=_[rt])&&(o.push(t.call(D,D.__data__,rt,_)),u.push(D));return new ce(o,u)},selectChild:function U(t){return this.select(null==t?it:function w(t){return function(){return k.call(this.children,t)}}("function"==typeof t?t:m(t)))},selectChildren:function lt(t){return this.selectAll(null==t?st:function P(t){return function(){return Q.call(this.children,t)}}("function"==typeof t?t:m(t)))},filter:function gt(t){"function"!=typeof t&&(t=q(t));for(var e=this._groups,l=e.length,o=new Array(l),u=0;u<l;++u)for(var D,y=e[u],_=y.length,R=o[u]=[],rt=0;rt<_;++rt)(D=y[rt])&&t.call(D,D.__data__,rt,y)&&R.push(D);return new ce(o,this._parents)},data:function Ht(t,e){if(!arguments.length)return Array.from(this,Dt);var l=e?Lt:Kt,o=this._parents,u=this._groups;"function"!=typeof t&&(t=function j(t){return function(){return t}}(t));for(var y=u.length,_=new Array(y),R=new Array(y),D=new Array(y),rt=0;rt<y;++rt){var dt=o[rt],At=u[rt],Pt=At.length,Zt=Mt(t.call(dt,dt&&dt.__data__,rt,o)),_e=Zt.length,Se=R[rt]=new Array(_e),Tt=_[rt]=new Array(_e);l(dt,At,Se,Tt,D[rt]=new Array(Pt),Zt,e);for(var se,ge,ee=0,Xt=0;ee<_e;++ee)if(se=Se[ee]){for(ee>=Xt&&(Xt=ee+1);!(ge=Tt[Xt])&&++Xt<_e;);se._next=ge||null}}return(_=new ce(_,o))._enter=R,_._exit=D,_},enter:function ct(){return new ce(this._enter||this._groups.map(_t),this._parents)},exit:function Wt(){return new ce(this._exit||this._groups.map(_t),this._parents)},join:function ht(t,e,l){var o=this.enter(),u=this,y=this.exit();return"function"==typeof t?(o=t(o))&&(o=o.selection()):o=o.append(t+""),null!=e&&(u=e(u))&&(u=u.selection()),null==l?y.remove():l(y),o&&u?o.merge(u).order():u},merge:function nt(t){for(var e=t.selection?t.selection():t,l=this._groups,o=e._groups,u=l.length,_=Math.min(u,o.length),R=new Array(u),D=0;D<_;++D)for(var Zt,rt=l[D],dt=o[D],At=rt.length,Pt=R[D]=new Array(At),_e=0;_e<At;++_e)(Zt=rt[_e]||dt[_e])&&(Pt[_e]=Zt);for(;D<u;++D)R[D]=l[D];return new ce(R,this._parents)},selection:function be(){return this},order:function Et(){for(var t=this._groups,e=-1,l=t.length;++e<l;)for(var _,o=t[e],u=o.length-1,y=o[u];--u>=0;)(_=o[u])&&(y&&4^_.compareDocumentPosition(y)&&y.parentNode.insertBefore(_,y),y=_);return this},sort:function St(t){function e(At,Pt){return At&&Pt?t(At.__data__,Pt.__data__):!At-!Pt}t||(t=Yt);for(var l=this._groups,o=l.length,u=new Array(o),y=0;y<o;++y){for(var rt,_=l[y],R=_.length,D=u[y]=new Array(R),dt=0;dt<R;++dt)(rt=_[dt])&&(D[dt]=rt);D.sort(e)}return new ce(u,this._parents).order()},call:function mt(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function ne(){return Array.from(this)},node:function G(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var o=t[e],u=0,y=o.length;u<y;++u){var _=o[u];if(_)return _}return null},size:function L(){let t=0;for(const e of this)++t;return t},empty:function h(){return!this.node()},each:function H(t){for(var e=this._groups,l=0,o=e.length;l<o;++l)for(var R,u=e[l],y=0,_=u.length;y<_;++y)(R=u[y])&&t.call(R,R.__data__,y,u);return this},attr:function re(t,e){var l=Ot(t);if(arguments.length<2){var o=this.node();return l.local?o.getAttributeNS(l.space,l.local):o.getAttribute(l)}return this.each((null==e?l.local?jt:Ft:"function"==typeof e?l.local?Rt:qt:l.local?wt:xt)(l,e))},style:function J(t,e,l){return arguments.length>1?this.each((null==e?d:"function"==typeof e?F:O)(t,e,null==l?"":l)):W(this.node(),t)},property:function Y(t,e){return arguments.length>1?this.each((null==e?I:"function"==typeof e?M:Z)(t,e)):this.node()[t]},classed:function ye(t,e){var l=pt(t+"");if(arguments.length<2){for(var o=Nt(this.node()),u=-1,y=l.length;++u<y;)if(!o.contains(l[u]))return!1;return!0}return this.each(("function"==typeof e?ae:e?Gt:Vt)(l,e))},text:function Oe(t){return arguments.length?this.each(null==t?Ee:("function"==typeof t?ve:fe)(t)):this.node().textContent},html:function Ae(t){return arguments.length?this.each(null==t?ni:("function"==typeof t?vi:ri)(t)):this.node().innerHTML},raise:function Ge(){return this.each(li)},lower:function ai(){return this.each(Ze)},append:function si(t){var e="function"==typeof t?t:Xe(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function T(t,e){var l="function"==typeof t?t:Xe(t),o=null==e?bt:"function"==typeof e?e:b(e);return this.select(function(){return this.insertBefore(l.apply(this,arguments),o.apply(this,arguments)||null)})},remove:function n(){return this.each(i)},clone:function s(t){return this.select(t?a:r)},datum:function g(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function N(t,e,l){var u,_,o=function p(t){return t.trim().split(/^|\s+/).map(function(e){var l="",o=e.indexOf(".");return o>=0&&(l=e.slice(o+1),e=e.slice(0,o)),{type:e,name:l}})}(t+""),y=o.length;if(!(arguments.length<2)){for(R=e?x:S,u=0;u<y;++u)this.each(R(o[u],e,l));return this}var R=this.node().__on;if(R)for(var dt,D=0,rt=R.length;D<rt;++D)for(u=0,dt=R[D];u<y;++u)if((_=o[u]).type===dt.type&&_.name===dt.name)return dt.value},dispatch:function at(t,e){return this.each(("function"==typeof e?ot:V)(t,e))},[Symbol.iterator]:function*Ut(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var _,o=t[e],u=0,y=o.length;u<y;++u)(_=o[u])&&(yield _)}};const me=pe;var ke={value:()=>{}};function vn(){for(var o,t=0,e=arguments.length,l={};t<e;++t){if(!(o=arguments[t]+"")||o in l||/[\s.]/.test(o))throw new Error("illegal type: "+o);l[o]=[]}return new Pi(l)}function Pi(t){this._=t}function ar(t,e){for(var u,l=0,o=t.length;l<o;++l)if((u=t[l]).name===e)return u.value}function gn(t,e,l){for(var o=0,u=t.length;o<u;++o)if(t[o].name===e){t[o]=ke,t=t.slice(0,o).concat(t.slice(o+1));break}return null!=l&&t.push({name:e,value:l}),t}Pi.prototype=vn.prototype={constructor:Pi,on:function(t,e){var u,l=this._,o=function lr(t,e){return t.trim().split(/^|\s+/).map(function(l){var o="",u=l.indexOf(".");if(u>=0&&(o=l.slice(u+1),l=l.slice(0,u)),l&&!e.hasOwnProperty(l))throw new Error("unknown type: "+l);return{type:l,name:o}})}(t+"",l),y=-1,_=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++y<_;)if(u=(t=o[y]).type)l[u]=gn(l[u],t.name,e);else if(null==e)for(u in l)l[u]=gn(l[u],t.name,null);return this}for(;++y<_;)if((u=(t=o[y]).type)&&(u=ar(l[u],t.name)))return u},copy:function(){var t={},e=this._;for(var l in e)t[l]=e[l].slice();return new Pi(t)},call:function(t,e){if((u=arguments.length-2)>0)for(var u,y,l=new Array(u),o=0;o<u;++o)l[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,u=(y=this._[t]).length;o<u;++o)y[o].value.apply(e,l)},apply:function(t,e,l){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var o=this._[t],u=0,y=o.length;u<y;++u)o[u].value.apply(e,l)}};const or=vn;var Ri,Oi,gi=0,xi=0,Ei=0,yn=1e3,Li=0,di=0,Di=0,Si="object"==typeof performance&&performance.now?performance:Date,pn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Xi(){return di||(pn(sr),di=Si.now()+Di)}function sr(){di=0}function ji(){this._call=this._time=this._next=null}function mn(t,e,l){var o=new ji;return o.restart(t,e,l),o}function _n(){di=(Li=Si.now())+Di,gi=xi=0;try{!function dr(){Xi(),++gi;for(var e,t=Ri;t;)(e=di-t._time)>=0&&t._call.call(void 0,e),t=t._next;--gi}()}finally{gi=0,function hr(){for(var t,l,e=Ri,o=1/0;e;)e._call?(o>e._time&&(o=e._time),t=e,e=e._next):(l=e._next,e._next=null,e=t?t._next=l:Ri=l);Oi=t,Yi(o)}(),di=0}}function ur(){var t=Si.now(),e=t-Li;e>yn&&(Di-=e,Li=t)}function Yi(t){gi||(xi&&(xi=clearTimeout(xi)),t-di>24?(t<1/0&&(xi=setTimeout(_n,t-Si.now()-Di)),Ei&&(Ei=clearInterval(Ei))):(Ei||(Li=Si.now(),Ei=setInterval(ur,yn)),gi=1,pn(_n)))}function wn(t,e,l){var o=new ji;return o.restart(u=>{o.stop(),t(u+e)},e=null==e?0:+e,l),o}ji.prototype=mn.prototype={constructor:ji,restart:function(t,e,l){if("function"!=typeof t)throw new TypeError("callback is not a function");l=(null==l?Xi():+l)+(null==e?0:+e),!this._next&&Oi!==this&&(Oi?Oi._next=this:Ri=this,Oi=this),this._call=t,this._time=l,Yi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yi())}};var cr=or("start","end","cancel","interrupt"),fr=[],bn=0,zi=3;function Ki(t,e,l,o,u,y){var _=t.__transition;if(_){if(l in _)return}else t.__transition={};!function vr(t,e,l){var u,o=t.__transition;function _(rt){var dt,At,Pt,Zt;if(1!==l.state)return D();for(dt in o)if((Zt=o[dt]).name===l.name){if(Zt.state===zi)return wn(_);4===Zt.state?(Zt.state=6,Zt.timer.stop(),Zt.on.call("interrupt",t,t.__data__,Zt.index,Zt.group),delete o[dt]):+dt<e&&(Zt.state=6,Zt.timer.stop(),Zt.on.call("cancel",t,t.__data__,Zt.index,Zt.group),delete o[dt])}if(wn(function(){l.state===zi&&(l.state=4,l.timer.restart(R,l.delay,l.time),R(rt))}),l.state=2,l.on.call("start",t,t.__data__,l.index,l.group),2===l.state){for(l.state=zi,u=new Array(Pt=l.tween.length),dt=0,At=-1;dt<Pt;++dt)(Zt=l.tween[dt].value.call(t,t.__data__,l.index,l.group))&&(u[++At]=Zt);u.length=At+1}}function R(rt){for(var dt=rt<l.duration?l.ease.call(null,rt/l.duration):(l.timer.restart(D),l.state=5,1),At=-1,Pt=u.length;++At<Pt;)u[At].call(t,dt);5===l.state&&(l.on.call("end",t,t.__data__,l.index,l.group),D())}function D(){for(var rt in l.state=6,l.timer.stop(),delete o[e],o)return;delete t.__transition}o[e]=l,l.timer=mn(function y(rt){l.state=1,l.timer.restart(_,l.delay,l.time),l.delay<=rt&&_(rt-l.delay)},0,l.time)}(t,l,{name:e,index:o,group:u,on:cr,tween:fr,time:y.time,delay:y.delay,duration:y.duration,ease:y.ease,timer:null,state:bn})}function tn(t,e){var l=Fe(t,e);if(l.state>bn)throw new Error("too late; already scheduled");return l}function He(t,e){var l=Fe(t,e);if(l.state>zi)throw new Error("too late; already running");return l}function Fe(t,e){var l=t.__transition;if(!l||!(l=l[e]))throw new Error("transition not found");return l}function ei(t,e){return t=+t,e=+e,function(l){return t*(1-l)+e*l}}var Wi,On=180/Math.PI,en={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Sn(t,e,l,o,u,y){var _,R,D;return(_=Math.sqrt(t*t+e*e))&&(t/=_,e/=_),(D=t*l+e*o)&&(l-=t*D,o-=e*D),(R=Math.sqrt(l*l+o*o))&&(l/=R,o/=R,D/=R),t*o<e*l&&(t=-t,e=-e,D=-D,_=-_),{translateX:u,translateY:y,rotate:Math.atan2(e,t)*On,skewX:Math.atan(D)*On,scaleX:_,scaleY:R}}function kn(t,e,l,o){function u(rt){return rt.length?rt.pop()+" ":""}return function(rt,dt){var At=[],Pt=[];return rt=t(rt),dt=t(dt),function y(rt,dt,At,Pt,Zt,_e){if(rt!==At||dt!==Pt){var Se=Zt.push("translate(",null,e,null,l);_e.push({i:Se-4,x:ei(rt,At)},{i:Se-2,x:ei(dt,Pt)})}else(At||Pt)&&Zt.push("translate("+At+e+Pt+l)}(rt.translateX,rt.translateY,dt.translateX,dt.translateY,At,Pt),function _(rt,dt,At,Pt){rt!==dt?(rt-dt>180?dt+=360:dt-rt>180&&(rt+=360),Pt.push({i:At.push(u(At)+"rotate(",null,o)-2,x:ei(rt,dt)})):dt&&At.push(u(At)+"rotate("+dt+o)}(rt.rotate,dt.rotate,At,Pt),function R(rt,dt,At,Pt){rt!==dt?Pt.push({i:At.push(u(At)+"skewX(",null,o)-2,x:ei(rt,dt)}):dt&&At.push(u(At)+"skewX("+dt+o)}(rt.skewX,dt.skewX,At,Pt),function D(rt,dt,At,Pt,Zt,_e){if(rt!==At||dt!==Pt){var Se=Zt.push(u(Zt)+"scale(",null,",",null,")");_e.push({i:Se-4,x:ei(rt,At)},{i:Se-2,x:ei(dt,Pt)})}else(1!==At||1!==Pt)&&Zt.push(u(Zt)+"scale("+At+","+Pt+")")}(rt.scaleX,rt.scaleY,dt.scaleX,dt.scaleY,At,Pt),rt=dt=null,function(Zt){for(var Tt,_e=-1,Se=Pt.length;++_e<Se;)At[(Tt=Pt[_e]).i]=Tt.x(Zt);return At.join("")}}}var _r=kn(function pr(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?en:Sn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),wr=kn(function mr(t){return null!=t&&(Wi||(Wi=document.createElementNS("http://www.w3.org/2000/svg","g")),Wi.setAttribute("transform",t),t=Wi.transform.baseVal.consolidate())?Sn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):en},", ",")",")");function br(t,e){var l,o;return function(){var u=He(this,t),y=u.tween;if(y!==l)for(var _=0,R=(o=l=y).length;_<R;++_)if(o[_].name===e){(o=o.slice()).splice(_,1);break}u.tween=o}}function xr(t,e,l){var o,u;if("function"!=typeof l)throw new Error;return function(){var y=He(this,t),_=y.tween;if(_!==o){u=(o=_).slice();for(var R={name:e,value:l},D=0,rt=u.length;D<rt;++D)if(u[D].name===e){u[D]=R;break}D===rt&&u.push(R)}y.tween=u}}function nn(t,e,l){var o=t._id;return t.each(function(){var u=He(this,o);(u.value||(u.value={}))[e]=l.apply(this,arguments)}),function(u){return Fe(u,o).value[e]}}function rn(t,e,l){t.prototype=e.prototype=l,l.constructor=t}function Mn(t,e){var l=Object.create(t.prototype);for(var o in e)l[o]=e[o];return l}function ki(){}var Ui=1/.7,yi="\\s*([+-]?\\d+)\\s*",Ti="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Je="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Or=/^#([0-9a-f]{3,8})$/,Sr=new RegExp(`^rgb\\(${yi},${yi},${yi}\\)$`),kr=new RegExp(`^rgb\\(${Je},${Je},${Je}\\)$`),Mr=new RegExp(`^rgba\\(${yi},${yi},${yi},${Ti}\\)$`),Tr=new RegExp(`^rgba\\(${Je},${Je},${Je},${Ti}\\)$`),Cr=new RegExp(`^hsl\\(${Ti},${Je},${Je}\\)$`),Ar=new RegExp(`^hsla\\(${Ti},${Je},${Je},${Ti}\\)$`),Tn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Cn(){return this.rgb().formatHex()}function An(){return this.rgb().formatRgb()}function Ci(t){var e,l;return t=(t+"").trim().toLowerCase(),(e=Or.exec(t))?(l=e[1].length,e=parseInt(e[1],16),6===l?In(e):3===l?new ze(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===l?Gi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===l?Gi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Sr.exec(t))?new ze(e[1],e[2],e[3],1):(e=kr.exec(t))?new ze(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Mr.exec(t))?Gi(e[1],e[2],e[3],e[4]):(e=Tr.exec(t))?Gi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Cr.exec(t))?Rn(e[1],e[2]/100,e[3]/100,1):(e=Ar.exec(t))?Rn(e[1],e[2]/100,e[3]/100,e[4]):Tn.hasOwnProperty(t)?In(Tn[t]):"transparent"===t?new ze(NaN,NaN,NaN,0):null}function In(t){return new ze(t>>16&255,t>>8&255,255&t,1)}function Gi(t,e,l,o){return o<=0&&(t=e=l=NaN),new ze(t,e,l,o)}function Fi(t,e,l,o){return 1===arguments.length?function Pr(t){return t instanceof ki||(t=Ci(t)),t?new ze((t=t.rgb()).r,t.g,t.b,t.opacity):new ze}(t):new ze(t,e,l,null==o?1:o)}function ze(t,e,l,o){this.r=+t,this.g=+e,this.b=+l,this.opacity=+o}function Nn(){return`#${hi(this.r)}${hi(this.g)}${hi(this.b)}`}function Pn(){const t=Qi(this.opacity);return`${1===t?"rgb(":"rgba("}${ui(this.r)}, ${ui(this.g)}, ${ui(this.b)}${1===t?")":`, ${t})`}`}function Qi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ui(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function hi(t){return((t=ui(t))<16?"0":"")+t.toString(16)}function Rn(t,e,l,o){return o<=0?t=e=l=NaN:l<=0||l>=1?t=e=NaN:e<=0&&(t=NaN),new Qe(t,e,l,o)}function Ln(t){if(t instanceof Qe)return new Qe(t.h,t.s,t.l,t.opacity);if(t instanceof ki||(t=Ci(t)),!t)return new Qe;if(t instanceof Qe)return t;var e=(t=t.rgb()).r/255,l=t.g/255,o=t.b/255,u=Math.min(e,l,o),y=Math.max(e,l,o),_=NaN,R=y-u,D=(y+u)/2;return R?(_=e===y?(l-o)/R+6*(l<o):l===y?(o-e)/R+2:(e-l)/R+4,R/=D<.5?y+u:2-y-u,_*=60):R=D>0&&D<1?0:_,new Qe(_,R,D,t.opacity)}function Qe(t,e,l,o){this.h=+t,this.s=+e,this.l=+l,this.opacity=+o}function Dn(t){return(t=(t||0)%360)<0?t+360:t}function Hi(t){return Math.max(0,Math.min(1,t||0))}function ln(t,e,l){return 255*(t<60?e+(l-e)*t/60:t<180?l:t<240?e+(l-e)*(240-t)/60:e)}function jn(t,e,l,o,u){var y=t*t,_=y*t;return((1-3*t+3*y-_)*e+(4-6*y+3*_)*l+(1+3*t+3*y-3*_)*o+_*u)/6}rn(ki,Ci,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Cn,formatHex:Cn,formatHex8:function Ir(){return this.rgb().formatHex8()},formatHsl:function Nr(){return Ln(this).formatHsl()},formatRgb:An,toString:An}),rn(ze,Fi,Mn(ki,{brighter(t){return t=null==t?Ui:Math.pow(Ui,t),new ze(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new ze(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ze(ui(this.r),ui(this.g),ui(this.b),Qi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Nn,formatHex:Nn,formatHex8:function Rr(){return`#${hi(this.r)}${hi(this.g)}${hi(this.b)}${hi(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Pn,toString:Pn})),rn(Qe,function Lr(t,e,l,o){return 1===arguments.length?Ln(t):new Qe(t,e,l,null==o?1:o)},Mn(ki,{brighter(t){return t=null==t?Ui:Math.pow(Ui,t),new Qe(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Qe(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,l=this.l,o=l+(l<.5?l:1-l)*e,u=2*l-o;return new ze(ln(t>=240?t-240:t+120,u,o),ln(t,u,o),ln(t<120?t+240:t-120,u,o),this.opacity)},clamp(){return new Qe(Dn(this.h),Hi(this.s),Hi(this.l),Qi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qi(this.opacity);return`${1===t?"hsl(":"hsla("}${Dn(this.h)}, ${100*Hi(this.s)}%, ${100*Hi(this.l)}%${1===t?")":`, ${t})`}`}}));const zn=t=>()=>t;function Kn(t,e){var l=e-t;return l?function Bn(t,e){return function(l){return t+l*e}}(t,l):zn(isNaN(t)?e:t)}const Wn=function t(e){var l=function Br(t){return 1==(t=+t)?Kn:function(e,l){return l-e?function zr(t,e,l){return t=Math.pow(t,l),e=Math.pow(e,l)-t,l=1/l,function(o){return Math.pow(t+o*e,l)}}(e,l,t):zn(isNaN(e)?l:e)}}(e);function o(u,y){var _=l((u=Fi(u)).r,(y=Fi(y)).r),R=l(u.g,y.g),D=l(u.b,y.b),rt=Kn(u.opacity,y.opacity);return function(dt){return u.r=_(dt),u.g=R(dt),u.b=D(dt),u.opacity=rt(dt),u+""}}return o.gamma=t,o}(1);function Un(t){return function(e){var _,R,l=e.length,o=new Array(l),u=new Array(l),y=new Array(l);for(_=0;_<l;++_)R=Fi(e[_]),o[_]=R.r||0,u[_]=R.g||0,y[_]=R.b||0;return o=t(o),u=t(u),y=t(y),R.opacity=1,function(D){return R.r=o(D),R.g=u(D),R.b=y(D),R+""}}}Un(function Dr(t){var e=t.length-1;return function(l){var o=l<=0?l=0:l>=1?(l=1,e-1):Math.floor(l*e),u=t[o],y=t[o+1];return jn((l-o/e)*e,o>0?t[o-1]:2*u-y,u,y,o<e-1?t[o+2]:2*y-u)}}),Un(function jr(t){var e=t.length;return function(l){var o=Math.floor(((l%=1)<0?++l:l)*e);return jn((l-o/e)*e,t[(o+e-1)%e],t[o%e],t[(o+1)%e],t[(o+2)%e])}});var an=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,on=new RegExp(an.source,"g");function Ur(t,e){var o,u,y,l=an.lastIndex=on.lastIndex=0,_=-1,R=[],D=[];for(t+="",e+="";(o=an.exec(t))&&(u=on.exec(e));)(y=u.index)>l&&(y=e.slice(l,y),R[_]?R[_]+=y:R[++_]=y),(o=o[0])===(u=u[0])?R[_]?R[_]+=u:R[++_]=u:(R[++_]=null,D.push({i:_,x:ei(o,u)})),l=on.lastIndex;return l<e.length&&(y=e.slice(l),R[_]?R[_]+=y:R[++_]=y),R.length<2?D[0]?function Wr(t){return function(e){return t(e)+""}}(D[0].x):function Kr(t){return function(){return t}}(e):(e=D.length,function(rt){for(var At,dt=0;dt<e;++dt)R[(At=D[dt]).i]=At.x(rt);return R.join("")})}function Gn(t,e){var l;return("number"==typeof e?ei:e instanceof Ci?Wn:(l=Ci(e))?(e=l,Wn):Ur)(t,e)}function Gr(t){return function(){this.removeAttribute(t)}}function Fr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qr(t,e,l){var o,y,u=l+"";return function(){var _=this.getAttribute(t);return _===u?null:_===o?y:y=e(o=_,l)}}function Hr(t,e,l){var o,y,u=l+"";return function(){var _=this.getAttributeNS(t.space,t.local);return _===u?null:_===o?y:y=e(o=_,l)}}function Jr(t,e,l){var o,u,y;return function(){var _,D,R=l(this);return null==R?void this.removeAttribute(t):(_=this.getAttribute(t))===(D=R+"")?null:_===o&&D===u?y:(u=D,y=e(o=_,R))}}function Vr(t,e,l){var o,u,y;return function(){var _,D,R=l(this);return null==R?void this.removeAttributeNS(t.space,t.local):(_=this.getAttributeNS(t.space,t.local))===(D=R+"")?null:_===o&&D===u?y:(u=D,y=e(o=_,R))}}function $r(t,e){var l,o;function u(){var y=e.apply(this,arguments);return y!==o&&(l=(o=y)&&function Yr(t,e){return function(l){this.setAttributeNS(t.space,t.local,e.call(this,l))}}(t,y)),l}return u._value=e,u}function qr(t,e){var l,o;function u(){var y=e.apply(this,arguments);return y!==o&&(l=(o=y)&&function Xr(t,e){return function(l){this.setAttribute(t,e.call(this,l))}}(t,y)),l}return u._value=e,u}function el(t,e){return function(){tn(this,t).delay=+e.apply(this,arguments)}}function il(t,e){return e=+e,function(){tn(this,t).delay=e}}function rl(t,e){return function(){He(this,t).duration=+e.apply(this,arguments)}}function ll(t,e){return e=+e,function(){He(this,t).duration=e}}var wl=me.prototype.constructor;function Fn(t){return function(){this.style.removeProperty(t)}}var zl=0;function Ye(t,e,l,o){this._groups=t,this._parents=e,this._name=l,this._id=o}function Qn(){return++zl}var $e=me.prototype;Ye.prototype=function Bl(t){return me().transition(t)}.prototype={constructor:Ye,select:function ml(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=b(t));for(var o=this._groups,u=o.length,y=new Array(u),_=0;_<u;++_)for(var dt,At,R=o[_],D=R.length,rt=y[_]=new Array(D),Pt=0;Pt<D;++Pt)(dt=R[Pt])&&(At=t.call(dt,dt.__data__,Pt,R))&&("__data__"in dt&&(At.__data__=dt.__data__),rt[Pt]=At,Ki(rt[Pt],e,l,Pt,rt,Fe(dt,l)));return new Ye(y,this._parents,e,l)},selectAll:function _l(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=c(t));for(var o=this._groups,u=o.length,y=[],_=[],R=0;R<u;++R)for(var dt,D=o[R],rt=D.length,At=0;At<rt;++At)if(dt=D[At]){for(var Zt,Pt=t.call(dt,dt.__data__,At,D),_e=Fe(dt,l),Se=0,Tt=Pt.length;Se<Tt;++Se)(Zt=Pt[Se])&&Ki(Zt,e,l,Se,Pt,_e);y.push(Pt),_.push(dt)}return new Ye(y,_,e,l)},selectChild:$e.selectChild,selectChildren:$e.selectChildren,filter:function hl(t){"function"!=typeof t&&(t=q(t));for(var e=this._groups,l=e.length,o=new Array(l),u=0;u<l;++u)for(var D,y=e[u],_=y.length,R=o[u]=[],rt=0;rt<_;++rt)(D=y[rt])&&t.call(D,D.__data__,rt,y)&&R.push(D);return new Ye(o,this._parents,this._name,this._id)},merge:function cl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,l=t._groups,o=e.length,y=Math.min(o,l.length),_=new Array(o),R=0;R<y;++R)for(var Pt,D=e[R],rt=l[R],dt=D.length,At=_[R]=new Array(dt),Zt=0;Zt<dt;++Zt)(Pt=D[Zt]||rt[Zt])&&(At[Zt]=Pt);for(;R<o;++R)_[R]=e[R];return new Ye(_,this._parents,this._name,this._id)},selection:function bl(){return new wl(this._groups,this._parents)},transition:function Dl(){for(var t=this._name,e=this._id,l=Qn(),o=this._groups,u=o.length,y=0;y<u;++y)for(var D,_=o[y],R=_.length,rt=0;rt<R;++rt)if(D=_[rt]){var dt=Fe(D,e);Ki(D,t,l,rt,_,{time:dt.time+dt.delay+dt.duration,delay:0,duration:dt.duration,ease:dt.ease})}return new Ye(o,this._parents,t,l)},call:$e.call,nodes:$e.nodes,node:$e.node,size:$e.size,empty:$e.empty,each:$e.each,on:function gl(t,e){var l=this._id;return arguments.length<2?Fe(this.node(),l).on.on(t):this.each(function vl(t,e,l){var o,u,y=function fl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var l=e.indexOf(".");return l>=0&&(e=e.slice(0,l)),!e||"start"===e})}(e)?tn:He;return function(){var _=y(this,t),R=_.on;R!==o&&(u=(o=R).copy()).on(e,l),_.on=u}}(l,t,e))},attr:function Zr(t,e){var l=Ot(t),o="transform"===l?wr:Gn;return this.attrTween(t,"function"==typeof e?(l.local?Vr:Jr)(l,o,nn(this,"attr."+t,e)):null==e?(l.local?Fr:Gr)(l):(l.local?Hr:Qr)(l,o,e))},attrTween:function tl(t,e){var l="attr."+t;if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==e)return this.tween(l,null);if("function"!=typeof e)throw new Error;var o=Ot(t);return this.tween(l,(o.local?$r:qr)(o,e))},style:function kl(t,e,l){var o="transform"==(t+="")?_r:Gn;return null==e?this.styleTween(t,function xl(t,e){var l,o,u;return function(){var y=W(this,t),_=(this.style.removeProperty(t),W(this,t));return y===_?null:y===l&&_===o?u:u=e(l=y,o=_)}}(t,o)).on("end.style."+t,Fn(t)):"function"==typeof e?this.styleTween(t,function Ol(t,e,l){var o,u,y;return function(){var _=W(this,t),R=l(this),D=R+"";return null==R&&(this.style.removeProperty(t),D=R=W(this,t)),_===D?null:_===o&&D===u?y:(u=D,y=e(o=_,R))}}(t,o,nn(this,"style."+t,e))).each(function Sl(t,e){var l,o,u,R,y="style."+e,_="end."+y;return function(){var D=He(this,t),rt=D.on,dt=null==D.value[y]?R||(R=Fn(e)):void 0;(rt!==l||u!==dt)&&(o=(l=rt).copy()).on(_,u=dt),D.on=o}}(this._id,t)):this.styleTween(t,function El(t,e,l){var o,y,u=l+"";return function(){var _=W(this,t);return _===u?null:_===o?y:y=e(o=_,l)}}(t,o,e),l).on("end.style."+t,null)},styleTween:function Cl(t,e,l){var o="style."+(t+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(null==e)return this.tween(o,null);if("function"!=typeof e)throw new Error;return this.tween(o,function Tl(t,e,l){var o,u;function y(){var _=e.apply(this,arguments);return _!==u&&(o=(u=_)&&function Ml(t,e,l){return function(o){this.style.setProperty(t,e.call(this,o),l)}}(t,_,l)),o}return y._value=e,y}(t,e,null==l?"":l))},text:function Nl(t){return this.tween("text","function"==typeof t?function Il(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(nn(this,"text",t)):function Al(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function Ll(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function Rl(t){var e,l;function o(){var u=t.apply(this,arguments);return u!==l&&(e=(l=u)&&function Pl(t){return function(e){this.textContent=t.call(this,e)}}(u)),e}return o._value=t,o}(t))},remove:function pl(){return this.on("end.remove",function yl(t){return function(){var e=this.parentNode;for(var l in this.__transition)if(+l!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function Er(t,e){var l=this._id;if(t+="",arguments.length<2){for(var _,o=Fe(this.node(),l).tween,u=0,y=o.length;u<y;++u)if((_=o[u]).name===t)return _.value;return null}return this.each((null==e?br:xr)(l,t,e))},delay:function nl(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?el:il)(e,t)):Fe(this.node(),e).delay},duration:function al(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?rl:ll)(e,t)):Fe(this.node(),e).duration},ease:function sl(t){var e=this._id;return arguments.length?this.each(function ol(t,e){if("function"!=typeof e)throw new Error;return function(){He(this,t).ease=e}}(e,t)):Fe(this.node(),e).ease},easeVarying:function ul(t){if("function"!=typeof t)throw new Error;return this.each(function dl(t,e){return function(){var l=e.apply(this,arguments);if("function"!=typeof l)throw new Error;He(this,t).ease=l}}(this._id,t))},end:function jl(){var t,e,l=this,o=l._id,u=l.size();return new Promise(function(y,_){var R={value:_},D={value:function(){0==--u&&y()}};l.each(function(){var rt=He(this,o),dt=rt.on;dt!==t&&((e=(t=dt).copy())._.cancel.push(R),e._.interrupt.push(R),e._.end.push(D)),rt.on=e}),0===u&&y()})},[Symbol.iterator]:$e[Symbol.iterator]};var Wl={time:null,delay:0,duration:250,ease:function Kl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Ul(t,e){for(var l;!(l=t.__transition)||!(l=l[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return l}me.prototype.interrupt=function yr(t){return this.each(function(){!function gr(t,e){var o,u,_,l=t.__transition,y=!0;if(l){for(_ in e=null==e?null:e+"",l)(o=l[_]).name===e?(u=o.state>2&&o.state<5,o.state=6,o.timer.stop(),o.on.call(u?"interrupt":"cancel",t,t.__data__,o.index,o.group),delete l[_]):y=!1;y&&delete t.__transition}}(this,t)})},me.prototype.transition=function Gl(t){var e,l;t instanceof Ye?(e=t._id,t=t._name):(e=Qn(),(l=Wl).time=Xi(),t=null==t?null:t+"");for(var o=this._groups,u=o.length,y=0;y<u;++y)for(var D,_=o[y],R=_.length,rt=0;rt<R;++rt)(D=_[rt])&&Ki(D,t,e,rt,_,l||Ul(D,e));return new Ye(o,this._parents,t,e)};Math;function Ai(t){return{type:t}}function _i(t){return function(){return t}}function Yn(t){this._context=t}function $l(t){return new Yn(t)}["w","e"].map(Ai),["n","s"].map(Ai),["n","w","e","s","nw","ne","sw","se"].map(Ai),Yn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const cn=Math.PI,fn=2*cn,ci=1e-6,ql=fn-ci;function $n(t){this._+=t[0];for(let e=1,l=t.length;e<l;++e)this._+=arguments[e]+t[e]}class Zi{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?$n:function ta(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return $n;const l=10**e;return function(o){this._+=o[0];for(let u=1,y=o.length;u<y;++u)this._+=Math.round(arguments[u]*l)/l+o[u]}}(e)}moveTo(e,l){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,l){this._append`L${this._x1=+e},${this._y1=+l}`}quadraticCurveTo(e,l,o,u){this._append`Q${+e},${+l},${this._x1=+o},${this._y1=+u}`}bezierCurveTo(e,l,o,u,y,_){this._append`C${+e},${+l},${+o},${+u},${this._x1=+y},${this._y1=+_}`}arcTo(e,l,o,u,y){if(e=+e,l=+l,o=+o,u=+u,(y=+y)<0)throw new Error(`negative radius: ${y}`);let _=this._x1,R=this._y1,D=o-e,rt=u-l,dt=_-e,At=R-l,Pt=dt*dt+At*At;if(null===this._x1)this._append`M${this._x1=e},${this._y1=l}`;else if(Pt>ci)if(Math.abs(At*D-rt*dt)>ci&&y){let Zt=o-_,_e=u-R,Se=D*D+rt*rt,Tt=Zt*Zt+_e*_e,kt=Math.sqrt(Se),ee=Math.sqrt(Pt),Xt=y*Math.tan((cn-Math.acos((Se+Pt-Tt)/(2*kt*ee)))/2),se=Xt/ee,ge=Xt/kt;Math.abs(se-1)>ci&&this._append`L${e+se*dt},${l+se*At}`,this._append`A${y},${y},0,0,${+(At*Zt>dt*_e)},${this._x1=e+ge*D},${this._y1=l+ge*rt}`}else this._append`L${this._x1=e},${this._y1=l}`}arc(e,l,o,u,y,_){if(e=+e,l=+l,_=!!_,(o=+o)<0)throw new Error(`negative radius: ${o}`);let R=o*Math.cos(u),D=o*Math.sin(u),rt=e+R,dt=l+D,At=1^_,Pt=_?u-y:y-u;null===this._x1?this._append`M${rt},${dt}`:(Math.abs(this._x1-rt)>ci||Math.abs(this._y1-dt)>ci)&&this._append`L${rt},${dt}`,o&&(Pt<0&&(Pt=Pt%fn+fn),Pt>ql?this._append`A${o},${o},0,1,${At},${e-R},${l-D}A${o},${o},0,1,${At},${this._x1=rt},${this._y1=dt}`:Pt>ci&&this._append`A${o},${o},0,${+(Pt>=cn)},${At},${this._x1=e+o*Math.cos(y)},${this._y1=l+o*Math.sin(y)}`)}rect(e,l,o,u){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}h${o=+o}v${+u}h${-o}Z`}toString(){return this._}}function na(t){return t[0]}function ra(t){return t[1]}function la(t,e){var l=_i(!0),o=null,u=$l,y=null,_=function ia(t){let e=3;return t.digits=function(l){if(!arguments.length)return e;if(null==l)e=null;else{const o=Math.floor(l);if(!(o>=0))throw new RangeError(`invalid digits: ${l}`);e=o}return t},()=>new Zi(e)}(R);function R(D){var rt,At,Zt,dt=(D=function Yl(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(D)).length,Pt=!1;for(null==o&&(y=u(Zt=_())),rt=0;rt<=dt;++rt)!(rt<dt&&l(At=D[rt],rt,D))===Pt&&((Pt=!Pt)?y.lineStart():y.lineEnd()),Pt&&y.point(+t(At,rt,D),+e(At,rt,D));if(Zt)return y=null,Zt+""||null}return t="function"==typeof t?t:void 0===t?na:_i(t),e="function"==typeof e?e:void 0===e?ra:_i(e),R.x=function(D){return arguments.length?(t="function"==typeof D?D:_i(+D),R):t},R.y=function(D){return arguments.length?(e="function"==typeof D?D:_i(+D),R):e},R.defined=function(D){return arguments.length?(l="function"==typeof D?D:_i(!!D),R):l},R.curve=function(D){return arguments.length?(u=D,null!=o&&(y=u(o)),R):u},R.context=function(D){return arguments.length?(null==D?o=y=null:y=u(o=D),R):o},R}function qn(t,e,l){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+l)/6)}function tr(t){this._context=t}function aa(t){return new tr(t)}function wi(t,e,l){this.k=t,this.x=e,this.y=l}tr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:qn(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:qn(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},wi.prototype={constructor:wi,scale:function(t){return 1===t?this:new wi(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new wi(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new wi(1,0,0)}}]);