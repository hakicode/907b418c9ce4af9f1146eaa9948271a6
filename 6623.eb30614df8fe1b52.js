"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6623],{6623:(ol,D,P)=>{P.d(D,{w:()=>sl,I:()=>T});var _=P(5811),ll=/^#[a-fA-F0-9]+$/i,il=/^rgba\((\d+),(\d+),(\d+),(\d+)\)$/i,el=/^rgb\((\d+),(\d+),(\d+)\)$/i;const U=a=>{let N=null,K=null;if(a)if("transparent"==a)N="#000000",K=0;else if(a.match(ll))N=a;else{let u=(a=a.replace(/\s+/g,"")).match(il);if(u)N="#"+(256|u[1]).toString(16).slice(1)+(256|u[2]).toString(16).slice(1)+(256|u[3]).toString(16).slice(1),K=(0,_.q)(parseFloat(u[4]),100);else{let z=a.match(el);z&&(N="#"+(256|z[1]).toString(16).slice(1)+(256|z[2]).toString(16).slice(1)+(256|z[3]).toString(16).slice(1))}}return{hex:N,alpha:K}};var W=P(9054),Q=P(4981);const T=a=>C(null==a?void 0:a.url,null==a?void 0:a.path,null==a?void 0:a.src);var C=(a,N,K)=>{var u,z;let E,x,f,n;var X,G;return a&&(E=a.replace(/\\/g,"/")),N&&(x=N.replace(/\\/g,"/")),K&&(f=K.replace(/\\/g,"/")),x&&!E&&(E=(null===(X=Q.icdt.config)||void 0===X?void 0:X.readfileuploadurl)+x),!f||x||E||(x=f.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),E=(null===(G=Q.icdt.config)||void 0===G?void 0:G.readfileuploadurl)+x),n=(null!==(u=E)&&void 0!==u?u:"").split("/").pop()||(null!==(z=x)&&void 0!==z?z:"").split("/").pop()||"",{url:E,path:x,name:n}};const sl=a=>{let N={x:0,y:0,width:a.screen.w,height:a.screen.h},K=[];return a.data.forEach((u,z)=>{var E;let x={id:Q.icdt.data.newSlideId,code:`${u.id}`||void 0,name:"string"==typeof u.id?u.id:`Trang ${z+1}`,svg:{viewBox:N,nodes:[]},test:(f=u.test2,f?(f.audiotrue&&(f.audiotrue=T({path:f.audiotrue.path})),f.audiofalse&&(f.audiofalse=T({path:f.audiofalse.path})),f.effecttrue&&(f.effecttrue=T({path:f.effecttrue.path})),f.effectfalse&&(f.effectfalse=T({path:f.effectfalse.path})),f.icontrue&&(f.icontrue=T({path:f.icontrue.path})),f.iconfalse&&(f.iconfalse=T({path:f.iconfalse.path})),f):{})};var f;u.background&&x.svg&&(x.svg.background=function(a){return a&&(null!==a.match(/#([a-zA-Z0-9]+)/)||null!==a.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==a.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9]+\)/))}(u.background)?{color:u.background}:function(a){return a&&null!==a.match(/data:[^;]+;base64,/)}(u.background)?{base64:u.background}:function(a){return a&&null!==a.match(/http(s)?:\/\//)}(u.background)?C(u.background):C(void 0,u.background)),$(null!==(E=u.svg)&&void 0!==E?E:"").find(".svg-node").each((f,n)=>{var X,G;let j=$(n).parents(".indexs"),q=j.attr("data-index"),V=j.attr("data-time"),Z=null!==(X=n.getAttribute("id"))&&void 0!==X?X:"0",dl={id:parseInt(Z),code:`${n.nodeName}-${n.getAttribute("id")}`,name:n.nodeName,idx:q?parseInt(q):0,time:V?parseFloat(V):0,type:(()=>{switch(n.nodeName){case"polygon":return W.$.POLYGON;case"circle":return W.$.CIRCLE;case"ellipse":return W.$.ELLIPSE;case"line":return W.$.LINE;case"rect":return W.$.RECT;case"foreignObject":return W.$.FOREIGNOBJECT}return 0})(),size:(i=>{let d=0,r=0,s=0,l=0,g=null,c=null,p=parseFloat((null===(i=n.getAttribute("transform"))||void 0===i?void 0:i.replace("rotate(","").replace(")",""))||"0")||null;switch(n.nodeName){case"polygon":{var y,k;let h=[],o=[],v=999999999,b=999999999,w=0,t=0;g=JSON.parse(n.getAttribute("ratios")||"[]"),c=null!==(y=null===(k=n.getAttribute("points"))||void 0===k?void 0:k.split(",").map(function(e){return e.split(" ").map(function(m){return parseFloat(m)})}))&&void 0!==y?y:[],c.forEach(function(e){h.push(e[0]),o.push(e[1])}),v=Math.min.apply(null,h),b=Math.min.apply(null,o),w=Math.max.apply(null,h),t=Math.max.apply(null,o),d=v,r=b,s=w-d,l=t-r;break}case"circle":{let h=parseFloat(n.getAttribute("cx")||"0"),o=parseFloat(n.getAttribute("cy")||"0"),v=parseFloat(n.getAttribute("r")||"0");d=h-v,r=o-v,s=2*v,l=2*v;break}case"ellipse":{let h=parseFloat(n.getAttribute("cx")||"0"),o=parseFloat(n.getAttribute("cy")||"0"),v=parseFloat(n.getAttribute("rx")||"0"),b=parseFloat(n.getAttribute("ry")||"0");d=h-v,r=o-b,s=2*v,l=2*b;break}case"line":{let h=parseFloat(n.getAttribute("x1")||"0"),o=parseFloat(n.getAttribute("y1")||"0"),v=parseFloat(n.getAttribute("x2")||"0"),b=parseFloat(n.getAttribute("y2")||"0"),w=999999999,t=999999999,e=0,m=0;w=Math.min(h,v),t=Math.min(o,b),e=Math.max(h,v),m=Math.max(o,b),d=w,r=t,s=e-d,l=m-r,g=[[(h-d)/(s||1),(o-r)/(l||1)],[(v-d)/(s||1),(b-r)/(l||1)]];break}case"rect":case"foreignObject":d=parseFloat(n.getAttribute("x")||"0"),r=parseFloat(n.getAttribute("y")||"0"),s=parseFloat(n.getAttribute("width")||"0"),l=parseFloat(n.getAttribute("height")||"0")}return Object.assign({},{x:d,y:r,width:s,height:l,ratios:g,points:c,rotate:p})})(),attribute:(()=>{let i={};switch(n.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var d,r,s,l,g,c;let p=null!==(d=n.getAttribute("fill"))&&void 0!==d?d:null,y=null!==(r=n.getAttribute("stroke"))&&void 0!==r?r:null,k=null!==(s=parseFloat(n.getAttribute("stroke-width")||"0"))&&void 0!==s?s:null,h=null!==(l=n.getAttribute("stroke-linecap"))&&void 0!==l?l:null,o=null!==(g=n.getAttribute("stroke-linejoin"))&&void 0!==g?g:null,v=null!==(c=parseFloat(n.getAttribute("stroke-dasharray")||"0"))&&void 0!==c?c:null;Object.assign(i,{fill:p,stroke:y,strokeWidth:k,strokeLinecap:h,strokeLinejoin:o,strokeDasharray:v});break}}return i})(),style:(()=>{let i={};switch(n.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let g=$(n).find(".svg-container");if(g.length){var d,r;let p=null!==(d=parseFloat(g.css("border-width")||"0"))&&void 0!==d?d:null,y=null!==(r=g.css("border-style"))&&void 0!==r?r:null,k=g.css("border-color")||null,h=null,o=g.css("background-color")||null,v=null;(()=>{let{hex:b,alpha:w}=U(k);k=b,h=w})(),(()=>{let{hex:b,alpha:w}=U(o);o=b,v=w})(),Object.assign(i,{borderWidth:p,borderStyle:y,borderColor:k,borderOpacity:h,backgroundColor:o,backgroundOpacity:v})}let c=$(n).find(".svg-editor-content");if(c.length){var s,l;let p=JSON.parse((c.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:y,alpha:k}=U(p.TextColor);Object.assign(i,{fontFamily:null!==(s=p.FontFamily)&&void 0!==s?s:null,fontSize:null!==(l=p.FontSize)&&void 0!==l?l:null,color:y,opacity:k})}break}}return i})(),source:(()=>{let i={};switch(n.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(j.hasClass("editors")){let t=$(n).find(".svg-editor-content");if(t.length){var d;let e=t.html(),m=null!==(d=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==d?d:[];Object.assign(i,{type:"html",html:{htmlContent:e,variableKeywords:m}})}}else if(j.hasClass("inputs")||j.hasClass("textareas"))Object.assign(i,{type:"input",input:{input:!!$(n).find("input").length,textarea:!!$(n).find("textarea").length}});else if(j.hasClass("tests")){let t=$(n).find(".svg-test");if(j.hasClass("tests-truefalse")){var r,s;let e=t.find(".svg-editor-content").html(),m=null!==(r=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==r?r:[];Object.assign(i,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(s=u.test2.truefalse)||void 0===s?void 0:s.includes(Z)}},html:{htmlContent:e,variableKeywords:m}})}else if(j.hasClass("tests-singlechoice")){var l,g;let e=t.find(".svg-editor-content").html(),m=null!==(l=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==l?l:[];Object.assign(i,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(g=u.test2.singlechoice)||void 0===g?void 0:g.includes(Z)}},html:{htmlContent:e,variableKeywords:m}})}else if(j.hasClass("tests-multichoice")){var c,p;let e=t.find(".svg-editor-content").html(),m=null!==(c=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==c?c:[];Object.assign(i,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(p=u.test2.multichoice)||void 0===p?void 0:p.includes(Z)}},html:{htmlContent:e,variableKeywords:m}})}else if(j.hasClass("tests-fill")){var y,k;let e=t.find(".svg-editor-content").html(),m=null!==(y=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==y?y:[],F=null!==(k=(null!=e?e:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==k?k:[];F=F.filter((I,O,A)=>A.indexOf(I)==O),Object.assign(i,{type:"test",test:{type:"fill",fill:F.map(I=>{var O;return{key:I,value:null===(O=u.test2.fill)||void 0===O||null===(O=O.find(A=>A.id==Z))||void 0===O||null===(O=O.vals)||void 0===O?void 0:O.map(A=>A.text).filter(A=>!["",null,void 0,NaN].includes(A))}})},html:{htmlContent:e,variableKeywords:m,fillKeywords:F}})}else if(j.hasClass("tests-matching")){if(t.hasClass("svg-test-empty"))Object.assign(i,{type:"test",test:{type:"matching-empty",matching:{key:t.attr("data-name")||null}}});else if(t.hasClass("svg-test-content")){var h;let e=t.find(".svg-editor-content").html(),m=null!==(h=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==h?h:[];Object.assign(i,{type:"test",test:{type:"matching-content",matching:{key:t.attr("data-name")||null}},html:{htmlContent:e,variableKeywords:m}})}}else if(j.hasClass("tests-speech")){var o;Object.assign(i,{type:"speech",speech:{value:null===(o=u.test2.speech)||void 0===o||null===(o=o.find(e=>e.id==Z))||void 0===o||null===(o=o.vals)||void 0===o?void 0:o.map(e=>e.text).filter(e=>!["",null,void 0,NaN].includes(e))}})}else if(j.hasClass("tests-submit")){let e=$(n).find(".svg-container img");Object.assign(i,{type:"test",test:{type:"submit"},image:C(e.attr("url"),e.attr("path"),e.attr("src"))})}}else if(j.hasClass("images")){let t=$(n).find(".svg-editor-content img");if(t.length)Object.assign(i,{type:"image",image:C(t.attr("url"),t.attr("path"),t.attr("src"))});else{let e=$(n).find("iframe");Object.assign(i,{type:"iframe",iframe:C(e.attr("url"),e.attr("path"),e.attr("src"))})}}else if(j.hasClass("sounds")){let t=$(n).find(".svg-editor-content img");t.length&&Object.assign(i,{type:"image",image:C(t.attr("url"),t.attr("path"),t.attr("src"))})}else if(j.hasClass("htmls")){let t=$(n).find("iframe");t.length&&Object.assign(i,{type:"iframe",iframe:C(t.attr("url"),t.attr("path"),t.attr("src"))})}else if(j.hasClass("svgs")){let t=$(n).find("svg");var v,b;t.length&&Object.assign(i,{type:"svg",svg:Object.assign(C(t.attr("url"),t.attr("path"),t.attr("src")),{svgContent:null!==(v=null===(b=t.get(0))||void 0===b?void 0:b.outerHTML)&&void 0!==v?v:null})})}else if(j.hasClass("medias")){let t=$(n).find(".media-item");if(t.length)switch(t.attr("type")){case"audio":Object.assign(i,{type:"audio",audio:C(t.attr("url"),t.attr("path"),t.attr("src"))});break;case"video":Object.assign(i,{type:"video",video:C(t.attr("url"),t.attr("path"),t.attr("src"))});break;case"file":Object.assign(i,{type:"file",file:C(t.attr("url"),t.attr("path"),t.attr("src"))});break;default:var w;Object.assign(i,{type:"link",link:{url:null!==(w=t.attr("url"))&&void 0!==w?w:null}})}let e=$(n).find("img");e.length&&(Object.assign(i,{image:C(e.attr("url"),e.attr("path"),e.attr("src"))}),i.type||Object.assign(i,{type:"image"}))}}return i})(),animate:(i=>{let d={},r=null===(i=u.animates)||void 0===i?void 0:i.find(s=>s.elementId==Z);return r&&Object.assign(d,{value:r.value}),d})(),interactive:(()=>{let i={},d=u.actions.show.filter(s=>s.elementId==Z&&s.active);d.length&&(i.show={},d.forEach(s=>{let{source:l}=s;switch(null==l?void 0:l.type){case"work":var g,c,p,y,k;i.show.action={},Object.assign(i.show.action,{value:null!==(g=l.value)&&void 0!==g?g:null,iteration:null!==(c=l.iteration)&&void 0!==c?c:null,finish:null!==(p=l.end)&&void 0!==p?p:null,time:null!==(y=l.time)&&void 0!==y?y:null,points:null!==(k=l.points)&&void 0!==k?k:null});break;case"audio":var h,o,v;i.show.audio={},Object.assign(i.show.audio,{source:C(null,null,l.url),iteration:null!==(h=l.iteration)&&void 0!==h?h:null,finish:null!==(o=l.end)&&void 0!==o?o:null,time:null!==(v=l.time)&&void 0!==v?v:null,async:-1==l.iteration?"change-slide":"change-node"});break;case"node":case"node2":var b,w,t,e,m,F,I,O,A,M,B,L,Y,J,S;l.options.includes("show")&&(i.show.triggershow={},Object.assign(i.show.triggershow,{id:null!==(b=parseInt(null!==(w=l.id)&&void 0!==w?w:"0"))&&void 0!==b?b:null,ids:null===(t=l.ids)||void 0===t?void 0:t.map(R=>parseInt(R)),async:null!==(e=l.async)&&void 0!==e?e:null,time:null!==(m=l.time)&&void 0!==m?m:null})),l.options.includes("run")&&(i.show.triggerrun={},Object.assign(i.show.triggerrun,{id:null!==(F=parseInt(null!==(I=l.id)&&void 0!==I?I:"0"))&&void 0!==F?F:null,ids:null===(O=l.ids)||void 0===O?void 0:O.map(R=>parseInt(R)),async:null!==(A=l.async)&&void 0!==A?A:null,time:null!==(M=l.time)&&void 0!==M?M:null})),l.options.includes("hide")&&(i.show.triggerhide={},Object.assign(i.show.triggerhide,{id:null!==(B=parseInt(null!==(L=l.id)&&void 0!==L?L:"0"))&&void 0!==B?B:null,ids:null===(Y=l.ids)||void 0===Y?void 0:Y.map(R=>parseInt(R)),async:null!==(J=l.async)&&void 0!==J?J:null,time:null!==(S=l.time)&&void 0!==S?S:null}))}}));let r=u.actions.click.filter(s=>s.elementId==Z&&s.active);return r&&(i.click={},r.forEach(s=>{let{source:l}=s;switch(null==l?void 0:l.type){case"work":var g,c,p,y,k;i.click.action={},Object.assign(i.click.action,{value:null!==(g=l.value)&&void 0!==g?g:null,iteration:null!==(c=l.iteration)&&void 0!==c?c:null,finish:null!==(p=l.end)&&void 0!==p?p:null,time:null!==(y=l.time)&&void 0!==y?y:null,points:null!==(k=l.points)&&void 0!==k?k:null});break;case"audio":var h,o,v;i.click.audio={},Object.assign(i.click.audio,{source:C(null,null,l.url),iteration:null!==(h=l.iteration)&&void 0!==h?h:null,finish:null!==(o=l.end)&&void 0!==o?o:null,time:null!==(v=l.time)&&void 0!==v?v:null,async:-1==l.iteration?"change-slide":"change-node"});break;case"node":case"node2":var b,w,t,e,m,F,I,O,A,M,B,L,Y,J,S;l.options.includes("show")&&(i.click.triggershow={},Object.assign(i.click.triggershow,{id:null!==(b=parseInt(null!==(w=l.id)&&void 0!==w?w:"0"))&&void 0!==b?b:null,ids:null===(t=l.ids)||void 0===t?void 0:t.map(H=>parseInt(H)),async:null!==(e=l.async)&&void 0!==e?e:null,time:null!==(m=l.time)&&void 0!==m?m:null})),l.options.includes("run")&&(i.click.triggerrun={},Object.assign(i.click.triggerrun,{id:null!==(F=parseInt(null!==(I=l.id)&&void 0!==I?I:"0"))&&void 0!==F?F:null,ids:null===(O=l.ids)||void 0===O?void 0:O.map(H=>parseInt(H)),async:null!==(A=l.async)&&void 0!==A?A:null,time:null!==(M=l.time)&&void 0!==M?M:null})),l.options.includes("hide")&&(i.click.triggerhide={},Object.assign(i.click.triggerhide,{id:null!==(B=parseInt(null!==(L=l.id)&&void 0!==L?L:"0"))&&void 0!==B?B:null,ids:null===(Y=l.ids)||void 0===Y?void 0:Y.map(H=>parseInt(H)),async:null!==(J=l.async)&&void 0!==J?J:null,time:null!==(S=l.time)&&void 0!==S?S:null}));break;case"slide":var R;i.click.slide={},Object.assign(i.click.slide,{id:parseInt(null!==(R=l.id)&&void 0!==R?R:"0")||l.num||null,code:l.id})}})),i})(),variable:(i=>{let d={};var r;n.getAttribute("data-variable")&&(d.input={},Object.assign(d.input,{variable:null!==(r=n.getAttribute("data-variable"))&&void 0!==r?r:null}));let s=null===(i=u.nodes)||void 0===i||null===(i=i.find(y=>y.id==Z))||void 0===i?void 0:i.variable;var l,g,c,p;return s&&(d.click={},Object.assign(d.click,{variable:null!==(l=s.variable)&&void 0!==l?l:null,operator:null!==(g=s.operator)&&void 0!==g?g:null,valuetype:null!==(c=s.valuetype)&&void 0!==c?c:null,value:null!==(p=s.value)&&void 0!==p?p:null})),d})()};null===(G=x.svg)||void 0===G||G.nodes.push(dl)}),K.push(x)}),console.log(K),{screen:{width:a.screen.w,height:a.screen.h},data:{slides:K},variable:a.variable}}}}]);