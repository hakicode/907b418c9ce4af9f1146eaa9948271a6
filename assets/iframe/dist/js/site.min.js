/*!
 * SureBOARD v3.1.0.2020.01.21 (https://board.surelrn.vn)
 * Copyright 2018, Created by Middle Kien. All rights reserved.
 *
 * SureBOARD commercial licenses may be obtained at
 *
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
function base64ToUint8Array(n){for(var i=atob(n),r=new Uint8Array(i.length),t=0;t<i.length;t++)r[t]=i.charCodeAt(t);return r}function base64toBlob(n,t,i){var e,o,r,f,s,u,h;for(t=t||"",i=i||512,e=atob(n),o=[],r=0;r<e.length;r+=i){for(f=e.slice(r,r+i),s=new Array(f.length),u=0;u<f.length;u++)s[u]=f.charCodeAt(u);h=new Uint8Array(s);o.push(h)}return new Blob(o,{type:t})}function urlToBase64(n,t){var r=[n],i=new XMLHttpRequest;i.onload=function(){fileToBase64(i.response,function(n){t(n)})};i.onerror=function(){r.length>0?(i.open("GET",r.shift()),i.send()):t()};i.open("GET",r.shift());i.responseType="blob";i.send()}function fileToBase64(n,t){var i=new FileReader;i.onload=function(){t(i.result)};i.onerror=function(){t()};i.readAsDataURL(n)}function alert(n,t,i){var u=null,r;$(".alert-custom").length>0?u=$(".alert-custom").first():(u=$("<div/>",{"class":"alert-custom"}).css({position:"fixed","z-index":1e4,bottom:50,right:-320,width:320}).appendTo("body"),u.animate({right:15}));var f=null,e=null,o=null;switch(t){case"info":f="iconmoon iconmoon-information";e="#fff";o="#5ba5ea";break;case"warning":f="iconmoon iconmoon-TinhHuongKhanCap";e="#fff";o="#ea795b";break;case"success":f="iconmoon iconmoon-Check";e="#fff";o="#46bc7e";break;case"danger":f="iconmoon iconmoon-bangcam";e="#fff";o="#bf5655";break;case"nothing":f="iconmoon iconmoon-KyNangMem";e="#555";o="#fafafa";break;default:f="iconmoon iconmoon-TinhHuongKhanCap";e="#fff";o="#ea795b"}return r=$("<div/>").css({position:"relative",width:"100%",height:100,margin:"0 0 15px",color:e,background:o,"box-shadow":"0 0 12px rgba(0,0,0,0.1)"}).appendTo(u),$("<div/>").css({position:"absolute",top:0,left:0,bottom:0,width:100,height:60,margin:"auto",cursor:"pointer"}).html(`
                <div style="display: table;width: 100%;height: 100%;">
                    <div style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center;">
                        <i class="{iconmoon}" style="font-size:48px;"></i>
                    </div>
                </div>
            `.replace(/\s+/gm," ").replace("{iconmoon}",f)).appendTo(r).click(function(){r.fadeOut(400,function(){$(this).remove();u.find(">*").length===0&&u.remove()})}),$("<div/>").css({float:"right",width:180,height:"100%"}).html(`
                <div style="display: table; width: 100%; height: 100%;">
                    <div style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center;">
                        <div style="padding: 15px 15px 15px 0; margin: 0; font-weight: normal; word-break: break-word; line-height: 1.4;">{mesage}</div>
                    </div>
                </div>
            `.replace(/\s+/gm," ").replace("{mesage}",n)).appendTo(r),$("<div/>").css({clear:"both"}).appendTo(r),r.hide().appendTo(u).slideDown(function(){r[0].scrollHeight>r[0].offsetHeight&&r.css({height:"auto","min-height":r[0].offsetHeight})}),setTimeout(function(){r.fadeOut(2e3,function(){$(this).remove();u.find(">*").length===0&&u.remove()})},i||3e3),r}(function(n){n.fn.uploadApi=function(t,i,r,u){var s,f,o,e;u=u||{};s=[];typeof UPLOAD_API_FOLDER=="string"&&UPLOAD_API_FOLDER&&s.push(UPLOAD_API_FOLDER);u.subFolder&&(u.subFolder=u.subFolder.replace(/[^a-zA-Z0-9\/]/gm,"").replace(/\/+/gm,"/").replace(/^\//,"").replace(/\/$/,""),u.subFolder&&s.push(u.subFolder));u.isconvertvideo=!!u.isconvertvideo;u.isconvertpdf2image=!!u.isconvertpdf2image;u.isconvertoffice2image=!!u.isconvertoffice2image;u.isresizeimage=!!u.isresizeimage;f=new FormData;f.append("path",s.join("/"));f.append("types",u.fileType||null);f.append("file",t);f.append("base64",u.base64||!1);f.append("isconvertvideo",u.isconvertvideo);f.append("isconvertpdf2image",u.isconvertpdf2image);f.append("isconvertoffice2image",u.isconvertoffice2image);f.append("isresizeimage",u.isresizeimage);o=null;i||(o=n("body"));e=n(i||"#upload-progress");n.ajax({url:UPLOAD_API+"Files",data:f,processData:!1,contentType:!1,"async":typeof u.async=="boolean"?u.async:!0,type:"POST",beforeSend:function(){e.removeClass("d-none").removeClass("hide").removeClass("hidden").removeClass("invisible").show().find(".progress-bar").removeClass("progress-bar-danger").removeClass("progress-bar-warning").removeClass("progress-bar-success").width(0).find(".progress-bar-status").empty();e.find(".progress-name").text(t.name);o&&o.addClass("loading")},xhr:function(){var t=n.ajaxSettings.xhr();if(t.upload)return t.upload.addEventListener("progress",function(n){if(n.lengthComputable){var t=n.loaded*100/n.total;t<100?e.find(".progress-bar").width(t+"%").find(".progress-bar-status").text(parseInt(t)+"%"):e.find(".progress-bar").width("100%").addClass("progress-bar-striped").find(".progress-bar-status").text("Đang xử lý");o&&o.addClass("loading").attr("data-progress",t<100?parseInt(t)+"%":"Đang xử lý")}},!1),t},complete:function(){o&&o.removeClass("loading").removeAttr("data-progress")},success:function(n){window.location.hostname==="localhost"&&console.warn(JSON.stringify(n,null,2));var t=null;if(n)if(n.ReturnCode==="0"||n.ReturnCode===0)n.file&&(n.FileName=n.name,n.PathFileName=n.path+"/"+n.file.name,n.FileUrl=UPLOAD_API_URL+n.PathFileName,(u.isconvertoffice2image||u.isconvertpdf2image)&&n.fileType==="document"&&!n.extract&&alert("Tạo Slide ảnh trình chiếu không thành công!")),t=u.textSuccess||"Tải lên thành công",e.find(".progress-bar").removeClass("progress-bar-striped").addClass("progress-bar-success").find(".progress-bar-status").text(t);else{if(n.ReturnName)t=n.ReturnName;else switch(n.ReturnCode){case"500":t="Không hỗ trợ định dạng tập tin";break;case"501":t="Dung lượng tập tin vượt mức quy định";break;case"502":t="Tập tin không tồn tại";break;case"503":t="Thư mục không tồn tại";break;case"504":t="Lỗi hệ thống";break;case"505":t="Tên tập tin đã tồn tại";break;case"506":t="Tài khoản không tồn tại";break;default:t="Chưa có thông tin mã lỗi (#"+n.ReturnCode+")"}e.find(".progress-bar").removeClass("progress-bar-striped").addClass("progress-bar-warning").find(".progress-bar-status").text(t||"Hệ thống từ chối tập tin");alert(t||"Hệ thống từ chối tập tin")}else e.find(".progress-bar").removeClass("progress-bar-striped").addClass("progress-bar-danger").find(".progress-bar-status").text(t||"Hệ thống từ chối tập tin"),alert(t||"Hệ thống từ chối tập tin","danger");typeof r=="function"&&r(n)},error:function(n){e.find(".progress-bar").removeClass("progress-bar-striped").addClass("progress-bar-danger").find(".progress-bar-status").text("Hệ thống từ chối tập tin");typeof r=="function"&&r(n)}})};n.fn.uploadOfficeConvertApi=function(t,i,r,u){var o,f,e;u=u||{};o=new FormData;o.append("file",t);f=null;i||(f=n("body"));e=n(i||"#upload-progress");n.ajax({url:OFFICECONVERT_API+"api/PDFConvert/fromfile",data:o,processData:!1,contentType:!1,"async":!0,type:"POST",cache:!1,xhrFields:{responseType:"blob"},beforeSend:function(){e.removeClass("d-none").removeClass("hide").removeClass("hidden").removeClass("invisible").find(".progress-bar").removeClass("progress-bar-danger").removeClass("progress-bar-warning").removeClass("progress-bar-success").width(0).find(".progress-bar-status").empty();f&&f.addClass("loading")},xhr:function(){var t=n.ajaxSettings.xhr();if(t.upload)return t.upload.addEventListener("progress",function(n){if(n.lengthComputable){var t=n.loaded*100/n.total;t<100?e.find(".progress-bar").width(t+"%").find(".progress-bar-status").text(parseInt(t)+"%"):e.find(".progress-bar").width("100%").addClass("progress-bar-striped").find(".progress-bar-status").text("Đang xử lý");f&&f.addClass("loading").attr("data-progress",t<100?parseInt(t)+"%":"Đang xử lý")}},!1),t},complete:function(){f&&f.removeClass("loading").removeAttr("data-progress")},success:function(n){var i,u;typeof r=="function"&&(i=(t.name+"").split("."),i.pop(),u=new File([n],i.join(".").trim()+".pdf",{type:"application/pdf"}),r(u))},error:function(n){typeof r=="function"&&r(n)}})};n.fn.uploadApi_ConvertPdf=function(t,i,r,u){var f="."+(t.name+"").toLowerCase().split(".").pop(),e;[".doc",".xls",".ppt",".docx",".xlsx",".pptx"].indexOf(f)>=0?(e=function(t){t?n.fn.uploadApi_ConvertPdf(t,i,r,u):typeof r=="function"&&r({ReturnCode:-1})},n.fn.uploadOfficeConvertApi(t,i,e,u)):f?n.fn.uploadApi(t,i,r,u):typeof r=="function"&&r({ReturnCode:-1})}})(jQuery);var base64ToFile=function(n,t,i){let r=(n.match(/^data:([^;]+);/)||"")[1];fetch(n).then(function(n){return n.arrayBuffer()}).then(function(n){return new File([n],t,{type:r})}).then(function(n){i(n)})},newFileText=function(n,t){return new File([n],t+".txt",{type:"text/plain",lastModified:new Date})},resizeImageOnUpload=function(n,t,i){var r;if(!n||!/^(?:image\/bmp|image\/cis\-cod|image\/gif|image\/ief|image\/jpeg|image\/jpeg|image\/jpeg|image\/pipeg|image\/png|image\/svg\+xml|image\/tiff|image\/x\-cmu\-raster|image\/x\-cmx|image\/x\-icon|image\/x\-portable\-anymap|image\/x\-portable\-bitmap|image\/x\-portable\-graymap|image\/x\-portable\-pixmap|image\/x\-rgb|image\/x\-xbitmap|image\/x\-xpixmap|image\/x\-xwindowdump)$/i.test(n.type)){i();return}t=t||{};t.limit=t.limit||1080;r=new FileReader;r.onload=function(r){var u=new Image;u.onload=function(){var r,f;if(u.width<=t.limit&&u.height<=t.limit){i(n);return}r=document.createElement("canvas");f=r.getContext("2d");u.width/u.height>=1?(r.width=t.limit,r.height=t.limit*u.height/u.width):(r.height=t.limit,r.width=t.limit*u.width/u.height);f.drawImage(u,0,0,u.width,u.height,0,0,r.width,r.height);var s=r.toDataURL(),e=s.split(";"),o=e[0].split(":")[1],h=e[1].split(",")[1],c=base64toBlob(h,o),l=new File([c],`resizer-${n.name}`,{type:o});i(l)};u.src=r.target.result};r.readAsDataURL(n)};(function(){try{console.log("%cWelcome to SureBOARD - Lạc Việt","color: red; font-size: 30px; font-weight: bold;");console.log('%cĐây là một tính năng của trình duyệt dành cho các nhà phát triển. Nếu ai đó bảo bạn sao chép-dán nội dung nào đó vào đây để bật một tính năng của hệ thống hoặc "hack" tài khoản của người khác, thì đó là hành vi lừa đảo và sẽ khiến họ có thể truy cập vào tài khoản hệ thống của bạn.',"color: black; font-size: 18px;")}catch(n){}})();var setParamUrl=function(n,t){var i,r,u,f;if(n)if(typeof n=="string")replaceState(location.origin+location.pathname+n);else{if(i={},t)i=n;else{if(r=location.search.replace("?","").split("&"),r.length>0)for(u=0;u<r.length;u++)r[u]&&(f=r[u].split("="),i[f[0]]=decodeURIComponent(f[1]));$.extend(i,n)}replaceState(location.origin+location.pathname+"?"+$.param(i))}else replaceState(location.origin+location.pathname)},pushState=function(n){window.history.pushState({change:"loadState()"},null,n)},replaceState=function(n){window.history.replaceState({change:"loadState()"},null,n)},loadState=function(){};window.CallServer=function(n){typeof n.callback!="function"&&(n.callback=function(n){window.location.hostname==="localhost"&&console.log(n)});var t=function(n){n?document.querySelector("body").classList.add("loading"):document.querySelector("body").classList.remove("loading")};t(!0);fetch(n.url,{method:"POST",headers:{"Content-Type":"application/json"},body:n.data?JSON.stringify(n.data):null}).then(function(n){return t(!1),n.json()}).catch(function(i){t(!1);n.callback({returncode:-1,returnmsg:i.message})}).then(function(t){typeof t!="object"?t={returncode:-1,returnmsg:"Error 500"}:(t.returncode=typeof t.ReturnCode=="number"?t.ReturnCode:typeof t.returncode=="number"?t.returncode:-1,t.returnmsg=t.ReturnName||t.returnmsg||"Error");n.callback(t)}).catch(function(t){n.callback({returncode:-1,returnmsg:t.message})})};window.CallFetch=function(n){window.CallServer(n)};window.GetComponent=function(n){$("body").addClass("loading");$.get(ROOT_URL+n.url,n.data||null).done(function(t){$("body").removeClass("loading");typeof n.callback=="function"?n.callback(t):t?$(t).appendTo("body"):alert("Không tải được dữ liệu bổ sung")}).fail(function(){$("body").removeClass("loading");alert("Không tải được dữ liệu bổ sung")})};window.GetServer=function(n){$("body").addClass("loading");$.get(n.url?ROOT_URL+n.url:n.formUrl,n.data||null).done(function(t){$("body").removeClass("loading");var i=t?typeof t=="object"?t:JSON.parse(t):null;typeof n.callback=="function"&&n.callback(i)}).fail(function(){$("body").removeClass("loading");typeof n.callback=="function"&&n.callback()})};window.PostServer=function(n){$("body").addClass("loading");$.post(n.url?ROOT_URL+n.url:n.formUrl,n.data||null).done(function(t){$("body").removeClass("loading");var i=t?typeof t=="object"?t:JSON.parse(t):null;typeof n.callback=="function"&&n.callback(i)}).fail(function(){$("body").removeClass("loading");typeof n.callback=="function"&&n.callback()})};window.CallAjax=function(n){switch((n.method+"").toUpperCase()){case"POST":window.PostServer(n);break;case"GET":window.GetServer(n)}};window.PostAjax=function(n){window.PostServer(n)};window.GetAjax=function(n){window.GetServer(n)};