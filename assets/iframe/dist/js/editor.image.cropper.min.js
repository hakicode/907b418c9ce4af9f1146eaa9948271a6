/*!
 * SureBOARD v3.1.0.2020.01.21 (https://board.surelrn.vn)
 * Copyright 2018, Created by Middle Kien. All rights reserved.
 *
 * SureBOARD commercial licenses may be obtained at
 *
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
function setParentViewerId(n){ParentViewerId=n}function saveClick(){parent.$("#"+ParentViewerId).parents(".editor-iframe-box").find(".btn-save").click()}function valueEditor(n){var i,t;if(n){i=function(n){let t=[];return n.base64&&t.push(n.base64),n.path&&(t.push(API_UPLOAD_URL+n.path.replace(/^\//,"")),t.push(ROOT_URL+n.path.replace(/^\//,""))),n.url&&(n.url.match(/http(s)?\:\/\//)||n.url.match(/data:[^;]+;base64,/)?t.push(n.url):(t.push(API_UPLOAD_URL+n.url.replace(/^\//,"")),t.push(ROOT_URL+n.url.replace(/^\//,"")))),t};let t=i(n);if(t.length>0){let i=new Image;i.onload=function(){$("#imageBox img").attr({src:i.src||null,path:n.path||null});typeof cropperReInit=="function"&&window.cropperReInit()};i.onerror=function(){t.length>0&&(i.src=t.shift())};i.src=t.shift()}}else if($("#imageBox img").attr("ondrop")||$("#imageBox img").attr("oncrop")=="true"){if(t={url:$("#imageBox img").attr("src"),path:$("#imageBox img").attr("path")},typeof cropperIsCropped=="function"&&window.cropperIsCropped()&&typeof cropperApply=="function"&&(window.cropperApply(),t={url:$("#imageBox img").attr("src"),path:$("#imageBox img").attr("path")}),t.url.match(/data:[^;]+;base64,/))try{var r=new File([t.url],(Math.random()*999999999).toFixed()+".txt",{type:"text/plain",lastModified:new Date}),u=function(n){if(n&&n.file&&n.file.name){var i=`${n.path}/${n.file.name}`;t.path=i;t.url=n.root+i}};$(document).uploadApi(r,$("<div/>"),u,{subFolder:"material/cropper",fileType:"image",base64:!0,"async":!1})}catch(f){console.error(f)}return t}}window.addEventListener("load",function(){var t=document.getElementById("img-cropper"),u={dragMode:"none",aspectRatio:NaN,initialAspectRatio:NaN,viewMode:0,autoCrop:!1,autoCropArea:1,movable:!0,rotatable:!0,scalable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minContainerWidth:50,minContainerHeight:50,minCanvasWidth:50,minCanvasHeight:50,minCropBoxWidth:50,minCropBoxHeight:50,ready:function(){},cropstart:function(){},cropmove:function(){},cropend:function(){},crop:function(n){dataCropper=n.detail},zoom:function(){}},n=null,r=function(){n&&n.destroy();n=new Cropper(t,u);window.thisCropper=n},i;window.cropperReInit=r;i=function(i){i=i||(n?n.getCroppedCanvas().toDataURL("image/png"):null)||"";i&&(t.src=i,t.setAttribute("path",""))};window.cropperApply=i;window.cropperIsCropped=function(){return t.parentNode.querySelectorAll(".cropper-container").length?!0:!1};document.getElementById("actionBox").querySelectorAll(".btn").forEach(function(u){u.addEventListener("click",function(){var o=u.getAttribute("data-method"),f=u.getAttribute("data-option"),e;if(u.toggle=u.toggle?!1:!0,e=u.toggle,o)switch(o){case"aspectRatio":n.setAspectRatio(parseFloat(f));break;case"setDragMode":n.setDragMode(f);break;case"rotate":t.setAttribute("oncrop",!0);n.rotate(parseInt(f));break;case"scaleX":t.setAttribute("oncrop",!0);f=e?-1:1;n.scaleX(f);break;case"scaleY":t.setAttribute("oncrop",!0);f=e?-1:1;n.scaleY(f);break;case"reset":t.setAttribute("oncrop",!1);n.reset();n.clear();break;case"crop":t.setAttribute("oncrop",!0);i();r()}})});(document.getElementById("inputImage")||{}).onchange=function(){var f=this,t=f.files,u,n;t&&t.length&&(u=t[0],/^image\/\w+/.test(u.type)?(n=new FileReader,n.onload=function(){i(n.result);r();f.value=null},n.readAsDataURL(u)):window.alert("Please choose an image file."))}});var ParentViewerId=null,EditorContent=null;document.getElementById("img-cropper").addEventListener("load",function(){typeof cropperReInit=="function"&&window.cropperReInit()});window.addEventListener("load",function(){$("#imageBox img").css({"max-width":window.innerWidth,"max-height":window.innerHeight-90})});window.addEventListener("resize",function(){$("#imageBox img").css({"max-width":window.innerWidth,"max-height":window.innerHeight-90});typeof cropperReInit=="function"&&window.cropperReInit()});