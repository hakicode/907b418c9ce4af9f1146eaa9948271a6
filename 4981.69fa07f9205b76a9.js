"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4981],{1814:(ae,Rt,v)=>{v.d(Rt,{In:()=>ot,MA:()=>m,Mo:()=>C,NV:()=>O,S3:()=>j,dt:()=>lt,h8:()=>u,k0:()=>T});const j={fill:"transparent",stroke:"#129bff",strokeWidth:1},O={stroke:"#5F6CE1",strokeWidth:1,strokeLinecap:"round",strokeDasharrays:[4,2,1,2]},ot={fill:"#FFFFFF",stroke:"#5F6CE1",strokeWidth:1,width:7,height:7},C={fill:"transparent",stroke:"transparent",strokeWidth:1},lt={fill:"none",stroke:"#5F6CE1",strokeWidth:1},u={stroke:"#129bff",strokeWidth:1,strokeLinecap:"round",strokeDasharray:8},m={fill:"transparent"},T={fill:"none",stroke:"#999",strokeWidth:1,strokeDasharray:2}},9942:(ae,Rt,v)=>{v.d(Rt,{w:()=>Q,I:()=>M});var j=v(4981),O=v(9054),ot=v(5811),C=/^#[a-fA-F0-9]+$/i,lt=/^rgba\((\d+),(\d+),(\d+),(\d+)\)$/i,u=/^rgb\((\d+),(\d+),(\d+)\)$/i;const m=U=>{let z=null,tt=null;if(U)if("transparent"==U)z="#000000",tt=0;else if(U.match(C))z=U;else{let k=(U=U.replace(/\s+/g,"")).match(lt);if(k)z="#"+(256|k[1]).toString(16).slice(1)+(256|k[2]).toString(16).slice(1)+(256|k[3]).toString(16).slice(1),tt=(0,ot.q)(parseFloat(k[4]),100);else{let it=U.match(u);it&&(z="#"+(256|it[1]).toString(16).slice(1)+(256|it[2]).toString(16).slice(1)+(256|it[3]).toString(16).slice(1))}}return{hex:z,alpha:tt}},M=U=>E(null==U?void 0:U.url,null==U?void 0:U.path,null==U?void 0:U.src);var E=(U,z,tt)=>{var k,it;let Y,vt,gt,ft;var G,kt;return U&&(Y=U.replace(/\\/g,"/")),z&&(vt=z.replace(/\\/g,"/")),tt&&(gt=tt.replace(/\\/g,"/")),vt&&!Y&&(Y=(null===(G=j.icdt.config)||void 0===G?void 0:G.readfileuploadurl)+vt),!gt||vt||Y||(vt=gt.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),Y=(null===(kt=j.icdt.config)||void 0===kt?void 0:kt.readfileuploadurl)+vt),ft=(null!==(k=Y)&&void 0!==k?k:"").split("/").pop()||(null!==(it=vt)&&void 0!==it?it:"").split("/").pop()||"",{url:Y,path:vt,name:ft}};const Q=U=>{let z={x:0,y:0,width:U.screen.w,height:U.screen.h},tt=[];return U.data.forEach((k,it)=>{var Y,vt;let gt={id:"number"==typeof k.id?k.id:j.icdt.data.newSlideId,code:null===(Y=k.id)||void 0===Y?void 0:Y.toString(),name:"string"==typeof k.id?k.id:`Trang ${it+1}`,svg:{viewBox:z,nodes:[]},test:(ft=k.test2,ft?(ft.audiotrue&&(ft.audiotrue=M({path:ft.audiotrue.path})),ft.audiofalse&&(ft.audiofalse=M({path:ft.audiofalse.path})),ft.effecttrue&&(ft.effecttrue=M({path:ft.effecttrue.path})),ft.effectfalse&&(ft.effectfalse=M({path:ft.effectfalse.path})),ft.icontrue&&(ft.icontrue=M({path:ft.icontrue.path})),ft.iconfalse&&(ft.iconfalse=M({path:ft.iconfalse.path})),ft):{})};var ft;k.background&&gt.svg&&(gt.svg.background=function(U){return U&&(null!==U.match(/#([a-zA-Z0-9]+)/)||null!==U.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==U.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9]+\)/))}(k.background)?{color:k.background}:function(U){return U&&null!==U.match(/data:[^;]+;base64,/)}(k.background)?{base64:k.background}:function(U){return U&&null!==U.match(/http(s)?:\/\//)}(k.background)?E(k.background):E(void 0,k.background)),jQuery(null!==(vt=k.svg)&&void 0!==vt?vt:"").find(".svg-node").each((ft,G)=>{var kt,Bt;let zt=jQuery(G).parents(".indexs"),re=zt.attr("data-index"),Wt=zt.attr("data-time"),_t=null!==(kt=G.getAttribute("id"))&&void 0!==kt?kt:"0",et={id:parseInt(_t),code:`${G.nodeName}-${G.getAttribute("id")}`,name:G.nodeName,idx:re?parseInt(re):0,time:Wt?parseFloat(Wt):0,type:(()=>{switch(G.nodeName){case"polygon":return O.$.POLYGON;case"circle":return O.$.CIRCLE;case"ellipse":return O.$.ELLIPSE;case"line":return O.$.LINE;case"rect":return O.$.RECT;case"foreignObject":return O.$.FOREIGNOBJECT}return 0})(),size:(K=>{let ht=0,St=0,Gt=0,Ot=0,le=null,V=null,X=parseFloat((null===(K=G.getAttribute("transform"))||void 0===K?void 0:K.replace("rotate(","").replace(")",""))||"0")||null;switch(G.nodeName){case"polygon":{var d,q;let xt=[],wt=[],Mt=999999999,Ft=999999999,Kt=0,Tt=0;le=JSON.parse(G.getAttribute("ratios")||"[]"),V=null!==(d=null===(q=G.getAttribute("points"))||void 0===q?void 0:q.split(",").map(function(ct){return ct.split(" ").map(function($t){return parseFloat($t)})}))&&void 0!==d?d:[],V.forEach(function(ct){xt.push(ct[0]),wt.push(ct[1])}),Mt=Math.min.apply(null,xt),Ft=Math.min.apply(null,wt),Kt=Math.max.apply(null,xt),Tt=Math.max.apply(null,wt),ht=Mt,St=Ft,Gt=Kt-ht,Ot=Tt-St;break}case"circle":{let xt=parseFloat(G.getAttribute("cx")||"0"),wt=parseFloat(G.getAttribute("cy")||"0"),Mt=parseFloat(G.getAttribute("r")||"0");ht=xt-Mt,St=wt-Mt,Gt=2*Mt,Ot=2*Mt;break}case"ellipse":{let xt=parseFloat(G.getAttribute("cx")||"0"),wt=parseFloat(G.getAttribute("cy")||"0"),Mt=parseFloat(G.getAttribute("rx")||"0"),Ft=parseFloat(G.getAttribute("ry")||"0");ht=xt-Mt,St=wt-Ft,Gt=2*Mt,Ot=2*Ft;break}case"line":{let xt=parseFloat(G.getAttribute("x1")||"0"),wt=parseFloat(G.getAttribute("y1")||"0"),Mt=parseFloat(G.getAttribute("x2")||"0"),Ft=parseFloat(G.getAttribute("y2")||"0"),Kt=999999999,Tt=999999999,ct=0,$t=0;Kt=Math.min(xt,Mt),Tt=Math.min(wt,Ft),ct=Math.max(xt,Mt),$t=Math.max(wt,Ft),ht=Kt,St=Tt,Gt=ct-ht,Ot=$t-St,le=[[(xt-ht)/(Gt||1),(wt-St)/(Ot||1)],[(Mt-ht)/(Gt||1),(Ft-St)/(Ot||1)]];break}case"rect":case"foreignObject":ht=parseFloat(G.getAttribute("x")||"0"),St=parseFloat(G.getAttribute("y")||"0"),Gt=parseFloat(G.getAttribute("width")||"0"),Ot=parseFloat(G.getAttribute("height")||"0")}return Object.assign({},{x:ht,y:St,width:Gt,height:Ot,ratios:le,points:V,rotate:X})})(),attribute:(()=>{let K={};switch(G.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var ht,St,Gt,Ot,le,V;let X=null!==(ht=G.getAttribute("fill"))&&void 0!==ht?ht:null,d=null!==(St=G.getAttribute("stroke"))&&void 0!==St?St:null,q=null!==(Gt=parseFloat(G.getAttribute("stroke-width")||"0"))&&void 0!==Gt?Gt:null,xt=null!==(Ot=G.getAttribute("stroke-linecap"))&&void 0!==Ot?Ot:null,wt=null!==(le=G.getAttribute("stroke-linejoin"))&&void 0!==le?le:null,Mt=null!==(V=parseFloat(G.getAttribute("stroke-dasharray")||"0"))&&void 0!==V?V:null;Object.assign(K,{fill:X,stroke:d,strokeWidth:q,strokeLinecap:xt,strokeLinejoin:wt,strokeDasharray:Mt});break}}return K})(),style:(()=>{let K={};switch(G.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let le=jQuery(G).find(".svg-container");if(le.length){var ht,St;let X=null!==(ht=parseFloat(le.css("border-width")||"0"))&&void 0!==ht?ht:null,d=null!==(St=le.css("border-style"))&&void 0!==St?St:null,q=le.css("border-color")||null,xt=null,wt=le.css("background-color")||null,Mt=null;(()=>{let{hex:Ft,alpha:Kt}=m(q);q=Ft,xt=Kt})(),(()=>{let{hex:Ft,alpha:Kt}=m(wt);wt=Ft,Mt=Kt})(),Object.assign(K,{borderWidth:X,borderStyle:d,borderColor:q,borderOpacity:xt,backgroundColor:wt,backgroundOpacity:Mt})}let V=jQuery(G).find(".svg-editor-content");if(V.length){var Gt,Ot;let X=JSON.parse((V.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:d,alpha:q}=m(X.TextColor);Object.assign(K,{fontFamily:null!==(Gt=X.FontFamily)&&void 0!==Gt?Gt:null,fontSize:null!==(Ot=X.FontSize)&&void 0!==Ot?Ot:null,color:d,opacity:q})}break}}return K})(),source:(()=>{let K={};switch(G.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(zt.hasClass("editors")){let Tt=jQuery(G).find(".svg-editor-content");if(Tt.length){var ht;let ct=Tt.html(),$t=null!==(ht=(null!=ct?ct:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==ht?ht:[];Object.assign(K,{type:"html",html:{htmlContent:ct,variableKeywords:$t}})}}else if(zt.hasClass("inputs")||zt.hasClass("textareas"))Object.assign(K,{type:"input",input:{input:!!jQuery(G).find("input").length,textarea:!!jQuery(G).find("textarea").length}});else if(zt.hasClass("tests")){let Tt=jQuery(G).find(".svg-test");if(zt.hasClass("tests-truefalse")){var St,Gt;let ct=Tt.find(".svg-editor-content").html(),$t=null!==(St=(null!=ct?ct:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==St?St:[];Object.assign(K,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(Gt=k.test2.truefalse)||void 0===Gt?void 0:Gt.includes(_t)}},html:{htmlContent:ct,variableKeywords:$t}})}else if(zt.hasClass("tests-singlechoice")){var Ot,le;let ct=Tt.find(".svg-editor-content").html(),$t=null!==(Ot=(null!=ct?ct:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==Ot?Ot:[];Object.assign(K,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(le=k.test2.singlechoice)||void 0===le?void 0:le.includes(_t)}},html:{htmlContent:ct,variableKeywords:$t}})}else if(zt.hasClass("tests-multichoice")){var V,X;let ct=Tt.find(".svg-editor-content").html(),$t=null!==(V=(null!=ct?ct:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==V?V:[];Object.assign(K,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(X=k.test2.multichoice)||void 0===X?void 0:X.includes(_t)}},html:{htmlContent:ct,variableKeywords:$t}})}else if(zt.hasClass("tests-fill")){var d,q;let ct=Tt.find(".svg-editor-content").html(),$t=null!==(d=(null!=ct?ct:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==d?d:[],Z=null!==(q=(null!=ct?ct:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==q?q:[];Z=Z.filter((c,F,J)=>J.indexOf(c)==F),Object.assign(K,{type:"test",test:{type:"fill",fill:Z.map(c=>{var F;return{key:c,value:null===(F=k.test2.fill)||void 0===F||null===(F=F.find(J=>J.id==_t))||void 0===F||null===(F=F.vals)||void 0===F?void 0:F.map(J=>J.text).filter(J=>!["",null,void 0,NaN].includes(J))}})},html:{htmlContent:ct,variableKeywords:$t,fillKeywords:Z}})}else if(zt.hasClass("tests-matching")){if(Tt.hasClass("svg-test-empty"))Object.assign(K,{type:"test",test:{type:"matching-empty",matching:{key:Tt.attr("data-name")||null}}});else if(Tt.hasClass("svg-test-content")){var xt;let ct=Tt.find(".svg-editor-content").html(),$t=null!==(xt=(null!=ct?ct:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==xt?xt:[];Object.assign(K,{type:"test",test:{type:"matching-content",matching:{key:Tt.attr("data-name")||null}},html:{htmlContent:ct,variableKeywords:$t}})}}else if(zt.hasClass("tests-speech")){var wt;Object.assign(K,{type:"speech",speech:{value:null===(wt=k.test2.speech)||void 0===wt||null===(wt=wt.find(ct=>ct.id==_t))||void 0===wt||null===(wt=wt.vals)||void 0===wt?void 0:wt.map(ct=>ct.text).filter(ct=>!["",null,void 0,NaN].includes(ct))}})}else if(zt.hasClass("tests-submit")){let ct=jQuery(G).find(".svg-container img");Object.assign(K,{type:"test",test:{type:"submit"},image:E(ct.attr("url"),ct.attr("path"),ct.attr("src"))})}}else if(zt.hasClass("images")){let Tt=jQuery(G).find(".svg-editor-content img");if(Tt.length)Object.assign(K,{type:"image",image:E(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});else{let ct=jQuery(G).find("iframe");Object.assign(K,{type:"iframe",iframe:E(ct.attr("url"),ct.attr("path"),ct.attr("src"))})}}else if(zt.hasClass("sounds")){let Tt=jQuery(G).find(".svg-editor-content img");Tt.length&&Object.assign(K,{type:"image",image:E(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))})}else if(zt.hasClass("htmls")){let Tt=jQuery(G).find("iframe");Tt.length&&Object.assign(K,{type:"iframe",iframe:E(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))})}else if(zt.hasClass("svgs")){let Tt=jQuery(G).find("svg");var Mt,Ft;Tt.length&&Object.assign(K,{type:"svg",svg:Object.assign(E(Tt.attr("url"),Tt.attr("path"),Tt.attr("src")),{svgContent:null!==(Mt=null===(Ft=Tt.get(0))||void 0===Ft?void 0:Ft.outerHTML)&&void 0!==Mt?Mt:null})})}else if(zt.hasClass("medias")){let Tt=jQuery(G).find(".media-item");if(Tt.length)switch(Tt.attr("type")){case"audio":Object.assign(K,{type:"audio",audio:E(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});break;case"video":Object.assign(K,{type:"video",video:E(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});break;case"file":Object.assign(K,{type:"file",file:E(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});break;default:var Kt;Object.assign(K,{type:"link",link:{url:null!==(Kt=Tt.attr("url"))&&void 0!==Kt?Kt:null}})}let ct=jQuery(G).find("img");ct.length&&(Object.assign(K,{image:E(ct.attr("url"),ct.attr("path"),ct.attr("src"))}),K.type||Object.assign(K,{type:"image"}))}}return K})(),animate:(K=>{let ht={},St=null===(K=k.animates)||void 0===K?void 0:K.find(Gt=>Gt.elementId==_t);return St&&Object.assign(ht,{value:St.value}),ht})(),interactive:(()=>{let K={},ht=k.actions.show.filter(Gt=>Gt.elementId==_t&&Gt.active);ht.length&&(K.show={},ht.forEach(Gt=>{let{source:Ot}=Gt;switch(null==Ot?void 0:Ot.type){case"work":var le,V,X,d,q;K.show.action={},Object.assign(K.show.action,{value:null!==(le=Ot.value)&&void 0!==le?le:null,iteration:null!==(V=Ot.iteration)&&void 0!==V?V:null,finish:null!==(X=Ot.end)&&void 0!==X?X:null,time:null!==(d=Ot.time)&&void 0!==d?d:null,points:null!==(q=Ot.points)&&void 0!==q?q:null});break;case"audio":var xt,wt,Mt;K.show.audio={},Object.assign(K.show.audio,{source:E(null,null,Ot.url),iteration:null!==(xt=Ot.iteration)&&void 0!==xt?xt:null,finish:null!==(wt=Ot.end)&&void 0!==wt?wt:null,time:null!==(Mt=Ot.time)&&void 0!==Mt?Mt:null,async:-1==Ot.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Ft,Kt,Tt,ct,$t,Z,c,F,J,W,R,B,nt,P,H;Ot.options.includes("show")&&(K.show.triggershow={},Object.assign(K.show.triggershow,{id:null!==(Ft=parseInt(null!==(Kt=Ot.id)&&void 0!==Kt?Kt:"0"))&&void 0!==Ft?Ft:null,ids:null===(Tt=Ot.ids)||void 0===Tt?void 0:Tt.map(mt=>parseInt(mt)),async:null!==(ct=Ot.async)&&void 0!==ct?ct:null,time:null!==($t=Ot.time)&&void 0!==$t?$t:null})),Ot.options.includes("run")&&(K.show.triggerrun={},Object.assign(K.show.triggerrun,{id:null!==(Z=parseInt(null!==(c=Ot.id)&&void 0!==c?c:"0"))&&void 0!==Z?Z:null,ids:null===(F=Ot.ids)||void 0===F?void 0:F.map(mt=>parseInt(mt)),async:null!==(J=Ot.async)&&void 0!==J?J:null,time:null!==(W=Ot.time)&&void 0!==W?W:null})),Ot.options.includes("hide")&&(K.show.triggerhide={},Object.assign(K.show.triggerhide,{id:null!==(R=parseInt(null!==(B=Ot.id)&&void 0!==B?B:"0"))&&void 0!==R?R:null,ids:null===(nt=Ot.ids)||void 0===nt?void 0:nt.map(mt=>parseInt(mt)),async:null!==(P=Ot.async)&&void 0!==P?P:null,time:null!==(H=Ot.time)&&void 0!==H?H:null}))}}));let St=k.actions.click.filter(Gt=>Gt.elementId==_t&&Gt.active);return St&&(K.click={},St.forEach(Gt=>{let{source:Ot}=Gt;switch(null==Ot?void 0:Ot.type){case"work":var le,V,X,d,q;K.click.action={},Object.assign(K.click.action,{value:null!==(le=Ot.value)&&void 0!==le?le:null,iteration:null!==(V=Ot.iteration)&&void 0!==V?V:null,finish:null!==(X=Ot.end)&&void 0!==X?X:null,time:null!==(d=Ot.time)&&void 0!==d?d:null,points:null!==(q=Ot.points)&&void 0!==q?q:null});break;case"audio":var xt,wt,Mt;K.click.audio={},Object.assign(K.click.audio,{source:E(null,null,Ot.url),iteration:null!==(xt=Ot.iteration)&&void 0!==xt?xt:null,finish:null!==(wt=Ot.end)&&void 0!==wt?wt:null,time:null!==(Mt=Ot.time)&&void 0!==Mt?Mt:null,async:-1==Ot.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Ft,Kt,Tt,ct,$t,Z,c,F,J,W,R,B,nt,P,H;Ot.options.includes("show")&&(K.click.triggershow={},Object.assign(K.click.triggershow,{id:null!==(Ft=parseInt(null!==(Kt=Ot.id)&&void 0!==Kt?Kt:"0"))&&void 0!==Ft?Ft:null,ids:null===(Tt=Ot.ids)||void 0===Tt?void 0:Tt.map(It=>parseInt(It)),async:null!==(ct=Ot.async)&&void 0!==ct?ct:null,time:null!==($t=Ot.time)&&void 0!==$t?$t:null})),Ot.options.includes("run")&&(K.click.triggerrun={},Object.assign(K.click.triggerrun,{id:null!==(Z=parseInt(null!==(c=Ot.id)&&void 0!==c?c:"0"))&&void 0!==Z?Z:null,ids:null===(F=Ot.ids)||void 0===F?void 0:F.map(It=>parseInt(It)),async:null!==(J=Ot.async)&&void 0!==J?J:null,time:null!==(W=Ot.time)&&void 0!==W?W:null})),Ot.options.includes("hide")&&(K.click.triggerhide={},Object.assign(K.click.triggerhide,{id:null!==(R=parseInt(null!==(B=Ot.id)&&void 0!==B?B:"0"))&&void 0!==R?R:null,ids:null===(nt=Ot.ids)||void 0===nt?void 0:nt.map(It=>parseInt(It)),async:null!==(P=Ot.async)&&void 0!==P?P:null,time:null!==(H=Ot.time)&&void 0!==H?H:null}));break;case"slide":var mt;K.click.slide={},Object.assign(K.click.slide,{id:parseInt(null!==(mt=Ot.id)&&void 0!==mt?mt:"0")||Ot.num||null,code:Ot.id})}})),K})(),variable:(K=>{let ht={};var St;G.getAttribute("data-variable")&&(ht.input={},Object.assign(ht.input,{variable:null!==(St=G.getAttribute("data-variable"))&&void 0!==St?St:null}));let Gt=null===(K=k.nodes)||void 0===K||null===(K=K.find(d=>d.id==_t))||void 0===K?void 0:K.variable;var Ot,le,V,X;return Gt&&(ht.click={},Object.assign(ht.click,{variable:null!==(Ot=Gt.variable)&&void 0!==Ot?Ot:null,operator:null!==(le=Gt.operator)&&void 0!==le?le:null,valuetype:null!==(V=Gt.valuetype)&&void 0!==V?V:null,value:null!==(X=Gt.value)&&void 0!==X?X:null})),ht})()};null===(Bt=gt.svg)||void 0===Bt||Bt.nodes.push(et)}),tt.push(gt)}),console.log(tt),{screen:{width:U.screen.w,height:U.screen.h},data:{slides:tt},variable:U.variable}}},644:(ae,Rt,v)=>{v.d(Rt,{Dx:()=>u,aY:()=>S,qp:()=>T,qz:()=>lt,sV:()=>m,yR:()=>_});var j=v(5861),O=v(9422);O.config({driver:[O.INDEXEDDB,O.LOCALSTORAGE,O.WEBSQL],name:"_localDataDB",version:1});const C={create:(M=(0,j.Z)(function*(){return O}),function(){return M.apply(this,arguments)}),get:function(){var M=(0,j.Z)(function*(E){return O.getItem(E)});return function(Q){return M.apply(this,arguments)}}(),set:function(){var M=(0,j.Z)(function*(E,Q){return O.setItem(E,Q)});return function(Q,U){return M.apply(this,arguments)}}()},lt=function(){var M=(0,j.Z)(function*(E){yield C.create();var Q=(yield C.get("icdt-data"))||[];"function"==typeof E.callback&&E.callback(Q)});return function(Q){return M.apply(this,arguments)}}(),u=function(){var M=(0,j.Z)(function*(E){yield C.create(),E.params=E.params||{};try{yield C.set("icdt-data",E.params),"function"==typeof E.callback&&E.callback(E.params)}catch(Q){"function"==typeof E.callback&&E.callback(null),console.error(Q)}});return function(Q){return M.apply(this,arguments)}}(),m=function(){var M=(0,j.Z)(function*(E){yield C.create();try{var Q=(yield C.get("icdt-config"))||{};"function"==typeof E.callback&&E.callback(Q)}catch(U){"function"==typeof E.callback&&E.callback(null),console.error(U)}});return function(Q){return M.apply(this,arguments)}}(),T=function(){var M=(0,j.Z)(function*(E){yield C.create(),E.params=E.params||{};try{yield C.set("icdt-config",E.params),"function"==typeof E.callback&&E.callback(E.params)}catch(Q){"function"==typeof E.callback&&E.callback(null),console.error(Q)}});return function(Q){return M.apply(this,arguments)}}(),S=function(){var M=(0,j.Z)(function*(E){yield C.create();try{var Q=(yield C.get("icdt-clipboard"))||{};"function"==typeof E.callback&&E.callback(Q)}catch(U){"function"==typeof E.callback&&E.callback(null),console.error(U)}});return function(Q){return M.apply(this,arguments)}}(),_=function(){var M=(0,j.Z)(function*(E){yield C.create(),E.params=E.params||{};try{yield C.set("icdt-clipboard",E.params),"function"==typeof E.callback&&E.callback(E.params)}catch(Q){"function"==typeof E.callback&&E.callback(null),console.error(Q)}});return function(Q){return M.apply(this,arguments)}}();var M},1687:(ae,Rt,v)=>{v.d(Rt,{O:()=>j});const j={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"}},9125:(ae,Rt,v)=>{v.d(Rt,{D:()=>j});const j={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3}},968:(ae,Rt,v)=>{v.d(Rt,{_:()=>j});const j={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8}},4714:(ae,Rt,v)=>{v.d(Rt,{D:()=>j});const j={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306}},9054:(ae,Rt,v)=>{v.d(Rt,{$:()=>j});const j={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,PATH:8}},4981:(ae,Rt,v)=>{v.d(Rt,{icdt:()=>pt});var j=v(968),O=v(4080),ot=v(1687),C=v(9054),lt=v(4318),u=v(6816),m=v(666),T=v(2966);const M=A=>{var i,n,r,a,o;let g=(null===(i=A.mouseEvent)||void 0===i?void 0:i.target)||(null===(n=A.touchEvent)||void 0===n?void 0:n.target),y=(null==g?void 0:g.getAttribute("id"))||"",f=null==g?void 0:g.nodeName,x=(null==g||null===(r=g.parentNode)||void 0===r?void 0:r.getAttribute("id"))||"";var p,L;if([ot.O.RESIZE_GROUP,ot.O.SELECT_GROUP].includes(x))return null===(p=A.mouseEvent)||void 0===p||p.stopPropagation(),void(null===(L=A.mouseEvent)||void 0===L||L.preventDefault());if(null!==(a=A.mouseEvent)&&void 0!==a&&a.altKey||null!==(o=A.touchEvent)&&void 0!==o&&o.altKey||!y||y.match(/[^0-9]/)||!pt.dataSelect.nodeName.includes(f)){var I;pt.dataSelect.ids.length&&(pt.dataSelect.ids=[]),(0==(null===(I=A.mouseEvent)||void 0===I?void 0:I.button)||A.touchEvent)&&(A=>{let o=(0,O.g1)(ot.O.SCAN_GROUP,"g"),g=(0,lt.bH)(0,0,1,1);(0,O.vl)(o,g),((A,i,n)=>{(0,u.A)(A,{start:o=>{},move:(o,g)=>{((o,g,y,f)=>{i=(0,lt.bH)(o,g,y,f),(0,O.vl)(n,i)})(g[0][0],g[0][1],o.x,o.y)},end:(o,g)=>{null==n||n.remove(),pt.dataSelect.ids=pt.data.getNodeInArea(Math.min(g[0][0],o.x),Math.min(g[0][1],o.y),Math.max(g[0][0],o.x),Math.max(g[0][1],o.y));let y=pt.dataSelect.nodes;1==y.length?(0,m.y)(y[0]):y.length>1&&(0,T.Q)(y)}})})(A,g,o)})(A)}else{var st,dt;let yt=parseFloat(y||"0");pt.dataSelect.ids=null!==(st=A.mouseEvent)&&void 0!==st&&st.shiftKey||null!==(dt=A.touchEvent)&&void 0!==dt&&dt.shiftKey?[yt].concat(pt.dataSelect.ids).filter((Jt,he,ge)=>ge.indexOf(Jt)==he):[yt];let At=pt.dataSelect.nodes;At.length>1||1==At.length&&At[0].type==C.$.PATH?(0,T.Q)(At):1==At.length&&(0,m.y)(At[0])}};class Q{constructor(){let{x:i,y:n}=pt.screen.dislocation;var r=(a,o,g,y)=>{pt.screen.move({x:i,y:n},{x:g-a,y:y-o})};return{start:a=>{},move:(a,o)=>{r(o[0][0],o[0][1],a.x,a.y)},end:(a,o)=>{r(o[0][0],o[0][1],a.x,a.y)}}}}var U=v(4714);const z=[{name:"tam gi\xe1c vu\xf4ng",type:U.D.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:U.D.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:U.D.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:U.D.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:U.D.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:U.D.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:U.D.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:U.D.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:U.D.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:U.D.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:U.D.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:U.D.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:U.D.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}];var tt=v(8619),k=v(5811);class it{constructor(){let i=(0,O.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,tt._)(Math.ceil(1e9*Math.random())),g=(y,f,x,p)=>{o=(0,lt.bH)(y,f,x,p,{ratio:1}),o.x=(0,k.q)(o.x),o.y=(0,k.q)(o.y),o.width=(0,k.q)(o.width),o.height=(0,k.q)(o.height),Object.assign(a,(0,lt.sg)(C.$.CIRCLE,o)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:y=>{r.setAttribute("cx",y.x.toString()),r.setAttribute("cy",y.y.toString()),r.setAttribute("r","1")},move:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y)},end:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y),pt.data.node=Object.assign({id:n,type:C.$.CIRCLE,name:"Circle"},{size:o,attribute:a}),null==i||i.remove()}}}}var Y=v(8785);class vt{constructor(){let i=(0,O.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,Y.r)(Math.ceil(1e9*Math.random()));var g=(y,f,x,p)=>{o=(0,lt.bH)(y,f,x,p),o.x=(0,k.q)(o.x),o.y=(0,k.q)(o.y),o.width=(0,k.q)(o.width),o.height=(0,k.q)(o.height),Object.assign(a,(0,lt.sg)(C.$.ELLIPSE,o)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:y=>{r.setAttribute("cx",y.x.toString()),r.setAttribute("cy",y.y.toString()),r.setAttribute("rx","1"),r.setAttribute("ry","1")},move:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y)},end:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y),pt.data.node=Object.assign({id:n,type:C.$.ELLIPSE,name:"Ellipse"},{size:o,attribute:a}),null==i||i.remove()}}}}var gt=v(8054);class ft{constructor(){let i=(0,O.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,gt.f)(Math.ceil(1e9*Math.random()));var g=(y,f,x,p)=>{o=(0,lt.bH)(y,f,x,p),o.x=(0,k.q)(o.x),o.y=(0,k.q)(o.y),o.width=(0,k.q)(o.width),o.height=(0,k.q)(o.height),Object.assign(a,(0,lt.sg)(C.$.RECT,o)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:y=>{g(y.x,y.y,y.x+o.width,y.y+o.height)},move:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y)},end:(y,f)=>{o.width>=10&&o.height>=10?pt.data.node=Object.assign({id:n,type:C.$.RECT,name:"Rect"},{size:o,attribute:a}):null==r||r.remove(),null==i||i.remove()}}}}var G=v(2282);class kt{constructor(i){let n=(0,O.g1)(ot.O.CREATE_GROUP,"g"),r=i||[[0,0],[1,1],[0,1]],{nodeId:a,element:o,attribute:g,size:y}=(0,G.l)(Math.ceil(1e9*Math.random()));y.ratios=r;var f=(x,p,L,I)=>{y=(0,lt.bH)(x,p,L,I,{ratios:r}),y.x=(0,k.q)(y.x),y.y=(0,k.q)(y.y),y.width=(0,k.q)(y.width),y.height=(0,k.q)(y.height),Object.assign(g,(0,lt.sg)(C.$.POLYGON,y)),(0,O.__)(o,g),(0,O.g$)(n,y)};return{start:x=>{},move:(x,p)=>{f(p[0][0],p[0][1],x.x,x.y)},end:(x,p)=>{f(p[0][0],p[0][1],x.x,x.y),pt.data.node=Object.assign({id:a,type:C.$.POLYGON,name:"Polygon"},{size:y,attribute:g}),null==n||n.remove()}}}}var Bt=v(4921);class zt{constructor(){let i=(0,O.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,Bt.W)(Math.ceil(1e9*Math.random()));var g=(y,f,x,p)=>{o=(0,lt.bH)(y,f,x,p),o.x=(0,k.q)(o.x),o.y=(0,k.q)(o.y),o.width=(0,k.q)(o.width),o.height=(0,k.q)(o.height),Object.assign(a,(0,lt.sg)(C.$.LINE,o)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:y=>{},move:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y)},end:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y),pt.data.node=Object.assign({id:n,type:C.$.LINE,name:"Line"},{size:o,attribute:a}),null==i||i.remove()}}}}var re=v(8419);class Wt{constructor(){let{nodeId:i,element:n,attribute:r,size:a}=(0,re.G)(Math.ceil(1e9*Math.random())),g="";var y=(f,x)=>{g+=` ${f} ${x}`,n.setAttribute("d",g)};return{start:f=>{g=`M ${f.x} ${f.y} L ${f.x} ${f.y}`},move:(f,x)=>{y(f.x,f.y)},end:(f,x)=>{y(f.x,f.y),(f=>{let x=9999,p=9999,L=-9999,I=-9999;f.forEach(st=>{x=Math.min(x,st[0]),p=Math.min(p,st[1]),L=Math.max(L,st[0]),I=Math.max(I,st[1])}),a=(0,lt.bH)(x,p,L,I,{points:f}),Object.assign(r,(0,lt.sg)(C.$.PATH,a)),(0,O.__)(n,r)})(x),pt.data.node=Object.assign({id:i,type:C.$.PATH,name:"Path"},{size:a,attribute:r})}}}}var _t=v(2875);class et{constructor(){let i=(0,O.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,size:a,attribute:o,style:g,source:y}=(0,_t.e)(Math.ceil(1e9*Math.random()));var f=(x,p,L,I)=>{a=(0,lt.bH)(x,p,L,I),a.x=(0,k.q)(a.x),a.y=(0,k.q)(a.y),a.width=(0,k.q)(a.width),a.height=(0,k.q)(a.height),Object.assign(o,(0,lt.sg)(C.$.FOREIGNOBJECT,a)),(0,O.__)(r,o),(0,O.g$)(i,a)};return{start:x=>{f(x.x,x.y,x.x+a.width,x.y+a.height)},move:(x,p)=>{f(p[0][0],p[0][1],x.x,x.y)},end:(x,p)=>{a.width>=10&&a.height>=10?pt.data.node=Object.assign({id:n,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:g,source:y}):null==r||r.remove(),null==i||i.remove()}}}}var K=v(7210);class ht{constructor(){var i,n;let r=(0,O.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:a,element:o,size:g,attribute:y,source:f}=(0,K.G)(Math.ceil(1e9*Math.random())),x=1;(L=>{if(!L)return;let I=new Image;I.onload=()=>{x=(0,k.q)(I.naturalWidth/I.naturalHeight,100)},I.onerror=st=>{console.error(`ImgSrc load failed -> ${L}`,st)},I.src=L})(null!==(i=null===(n=f.image)||void 0===n?void 0:n.url)&&void 0!==i?i:"");var p=(L,I,st,dt)=>{g=(0,lt.bH)(L,I,st,dt,{ratio:x}),g.x=(0,k.q)(g.x),g.y=(0,k.q)(g.y),g.width=(0,k.q)(g.width),g.height=(0,k.q)(g.height),Object.assign(y,(0,lt.sg)(C.$.IMAGE,g)),(0,O.__)(o,y),(0,O.g$)(r,g)};return{start:L=>{p(L.x,L.y,L.x+g.width,L.y+g.height)},move:(L,I)=>{p(I[0][0],I[0][1],L.x,L.y)},end:(L,I)=>{g.width>=10&&g.height>=10?pt.data.node=Object.assign({id:a,type:C.$.IMAGE,name:"Image"},{size:g,attribute:y,source:f}):null==o||o.remove(),null==r||r.remove()}}}}var Gt=v(4578),Ot=v(9623);function X(A,i,n,r){return Math.sqrt(Math.pow(n-A,2)+Math.pow(r-i,2))}function d(A,i,n,r,a){return X(A,i,n,r)<a?1:0}function xt(A,i,n,r,a,o,g){var y=[];return y.push(d(A,i,n,r,g)),y.push(d(A,i,a,o,g)),y.push(function q(A,i,n,r,a,o,g){var y=[a-n,o-r],f=[A-n,i-r],x=[-y[1],y[0]],p=Math.sqrt(Math.pow(x[0],2)+Math.pow(x[1],2)),L=[x[0]/p,x[1]/p],I=Math.sqrt(Math.pow(y[0],2)+Math.pow(y[1],2)),st=[y[0]/I,y[1]/I],dt=f[0]*st[0]+f[1]*st[1];if(dt<=0||dt>=I)return 0;var yt=f[0]*L[0]+f[1]*L[1];return yt>=g||yt<=-g?0:1}(A,i,n,r,a,o,g)),y}function wt(A,i,n,r,a){var o=[n-A,r-i],g=[-o[1],o[0]],y=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),f=[g[0]/y,g[1]/y];return[[A+a*f[0],i+a*f[1]],[A-a*f[0],i-a*f[1]],[n-a*f[0],r-a*f[1]],[n+a*f[0],r+a*f[1]]]}function Mt(A,i,n,r,a,o,g){var dt,y=[a-A,o-i],f=[n-A,r-i],x=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2)),p=[f[0]/x,f[1]/x],L=y[0]*p[0]+y[1]*p[1],I=[A+L*p[0],i+L*p[1]],st=Math.sqrt(Math.pow(a-I[0],2)+Math.pow(o-I[1],2));dt=0===st?g:Math.sqrt(Math.pow(g,2)-Math.pow(st,2));var yt=[A+L*p[0]+dt*p[0],i+L*p[1]+dt*p[1]];return yt[0]===A&&yt[1]===i?null:yt}function Ft(A,i,n,r,a,o,g){var y=[a-A,o-i],f=[n-A,r-i],x=[-f[1],f[0]],p=Math.sqrt(Math.pow(x[0],2)+Math.pow(x[1],2)),L=[x[0]/p,x[1]/p],I=y[0]*L[0]+y[1]*L[1],st=c([A,i],[n,r],[a,o]);if($t([st[0]-a,st[1]-o])>=g)return null;var yt=Math.sqrt(Math.pow(g,2)-Math.pow(I,2)),At=[a-I*L[0],o-I*L[1]],Jt=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2)),he=[f[0]/Jt,f[1]/Jt],ge=[[At[0]-he[0]*yt,At[1]-he[1]*yt],[At[0]+he[0]*yt,At[1]+he[1]*yt]];return ge[0][0]===A&&ge[0][1]===i?null:ge}function Kt(A,i,n,r,a,o,g,y){var f,x,p,L,I,st;return-(p=g-a)*(x=r-i)+(f=n-A)*(L=y-o)==0?null:(st=(p*(i-o)-L*(A-a))/(-p*x+f*L),(I=(-x*(A-a)+f*(i-o))/(-p*x+f*L))>=0&&I<=1&&st>=0&&st<=1?[A+st*f,i+st*x]:null)}function Tt(A,i,n,r,a,o,g,y,f,x){var p=wt(o,g,y,f,x),L=[];if(n[0]&&!n[1])L.push(Mt(A,i,r,a,o,g,x)),L.push(Kt(A,i,r,a,p[0][0],p[0][1],p[3][0],p[3][1])),L.push(Kt(A,i,r,a,p[1][0],p[1][1],p[2][0],p[2][1])),(I=Ft(A,i,r,a,y,f,x))&&L.push(I[0],I[1]);else if(!n[0]&&n[1])L.push(Mt(A,i,r,a,y,f,x)),L.push(Kt(A,i,r,a,p[0][0],p[0][1],p[3][0],p[3][1])),L.push(Kt(A,i,r,a,p[1][0],p[1][1],p[2][0],p[2][1])),(I=Ft(A,i,r,a,o,g,x))&&L.push(I[0],I[1]);else if(n[0]&&n[1])L.push(Mt(A,i,r,a,o,g,x)),L.push(Kt(A,i,r,a,p[0][0],p[0][1],p[3][0],p[3][1])),L.push(Kt(A,i,r,a,p[1][0],p[1][1],p[2][0],p[2][1])),L.push(Mt(A,i,r,a,y,f,x));else{var I=Ft(A,i,r,a,y,f,x),st=Ft(A,i,r,a,o,g,x);I&&L.push(I[0],I[1]),st&&L.push(st[0],st[1]),L.push(Kt(A,i,r,a,p[0][0],p[0][1],p[3][0],p[3][1])),L.push(Kt(A,i,r,a,p[1][0],p[1][1],p[2][0],p[2][1]))}for(var dt=[A,i],yt=0;yt<L.length;yt++)L[yt]&&X(L[yt][0],L[yt][1],r,a)<X(dt[0],dt[1],r,a)&&(dt=L[yt]);return dt[0]===A&&dt[1]===i?null:dt}function ct(A,i,n,r,a,o,g,y,f){var x=wt(a,o,g,y,f),p=[],L=Ft(A,i,n,r,a,o,f);L&&p.push(L[0],L[1]),(L=Ft(A,i,n,r,g,y,f))&&p.push(L[0],L[1]),p.push(Kt(A,i,n,r,x[0][0],x[0][1],x[3][0],x[3][1])),p.push(Kt(A,i,n,r,x[1][0],x[1][1],x[2][0],x[2][1]));for(var I=[n,r],st=[A,i],dt=0;dt<p.length;dt++)p[dt]&&X(p[dt][0],p[dt][1],A,i)<X(I[0],I[1],A,i)&&(I=p[dt]);for(var yt=0;yt<p.length;yt++)p[yt]&&X(p[yt][0],p[yt][1],n,r)<X(st[0],st[1],n,r)&&(st=p[yt]);return I[0]===n&&I[1]===r||st[0]===A&&st[1]===i?null:[I,st]}var $t=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])},c=function(A,i,n){var r=[i[0]-A[0],i[1]-A[1]],a=$t(r);if(a<1e-6)return A;var o=[n[0]-A[0],n[1]-A[1]],g=(r[0]*o[0]+r[1]*o[1])/a;return g<0?A:g>a?i:[A[0]+r[0]*g/a,A[1]+r[1]*g/a]};class F{constructor(){let{element:r,size:o}=(0,re.G)(Math.ceil(1e9*Math.random()));(0,O.__)(r,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let g="";return{start:x=>{g=`M ${x.x} ${x.y} L ${x.x} ${x.y}`},move:(x,p)=>{((x,p)=>{g+=` ${x} ${p}`,r.setAttribute("d",g)})(x.x,x.y)},end:(x,p)=>{r.remove(),(x=>{let p=9999,L=9999,I=-9999,st=-9999;x.forEach(yt=>{p=Math.min(p,yt[0]),L=Math.min(L,yt[1]),I=Math.max(I,yt[0]),st=Math.max(st,yt[1])}),o=(0,lt.bH)(p,L,I,st,{points:x}),pt.data.getNodeInArea(0,0,1920,1920,C.$.PATH).forEach(yt=>{let Jt=((A,i,n)=>{n=n||20;var r=[],a=function(p){var L=i[0][0],I=i[0][1],st=0,dt=0;if(1!==p.length||d(p[0][0],p[0][1],L,I,n)){for(var yt;st<p.length-1;){var At=p[st],Jt=p[st+1],he=d(At[0],At[1],L,I,n),ge=d(Jt[0],Jt[1],L,I,n);if(he&&ge)dt=++st;else if(he&&!ge)(_e=Mt(At[0],At[1],Jt[0],Jt[1],L,I,n))?(p[st]=_e,dt=st):st++;else if(!he&&ge){var _e;(_e=Mt(Jt[0],Jt[1],At[0],At[1],L,I,n))&&((yt=p.slice(dt,st+1)).push(_e),r.push(yt)),dt=++st}else{var ye=Ft(At[0],At[1],Jt[0],Jt[1],L,I,n);ye?(((yt=p.slice(dt,st+1))[yt.length-1][0]!==ye[0][0]||yt[yt.length-1][1]!==ye[0][1])&&yt.push(ye[0]),yt.length>1&&r.push(yt),p[st]=ye[1],p[st+1]&&p[st+1][0]==ye[1][0]&&p[st+1][1]==ye[1][1]&&st++,dt=st):st++}}dt!==st&&(yt=p.slice(dt,p.length))&&r.push(yt)}else r.push(p)},o=function(p,L){var Jt,I=i[L],st=i[L+1],dt=0,yt=0;if(1!==p.length||-1!==(At=xt(p[0][0],p[0][1],I[0],I[1],st[0],st[1],n)).indexOf(1)){for(;dt<p.length-1;){var he=p[dt],ge=p[dt+1],At=xt(he[0],he[1],I[0],I[1],st[0],st[1],n),_e=xt(ge[0],ge[1],I[0],I[1],st[0],st[1],n);if(-1!==At.indexOf(1)&&-1!==_e.indexOf(1))yt=++dt;else if(-1!==At.indexOf(1)&&-1===_e.indexOf(1))(ye=Tt(he[0],he[1],At,ge[0],ge[1],I[0],I[1],st[0],st[1],n))?(p[dt]=ye,yt=dt):dt++;else if(-1===At.indexOf(1)&&-1!==_e.indexOf(1)){var ye;(ye=Tt(ge[0],ge[1],_e,he[0],he[1],I[0],I[1],st[0],st[1],n))?((Jt=p.slice(yt,dt+1)).push(ye),r.push(Jt),yt=++dt):dt++}else{var Ee=ct(he[0],he[1],ge[0],ge[1],I[0],I[1],st[0],st[1],n);Ee?(((Jt=p.slice(yt,dt+1))[Jt.length-1][0]!==Ee[0][0]||Jt[Jt.length-1][1]!==Ee[0][1])&&Jt.push(Ee[0]),Jt.length>1&&r.push(Jt),p[dt]=Ee[1],p[dt+1]&&p[dt+1][0]==Ee[1][0]&&p[dt+1][1]==Ee[1][1]&&dt++,yt=dt):dt++}}yt!==dt&&(Jt=p.slice(yt,p.length))&&r.push(Jt)}else r.push(p)};if(i=function V(A){var i=[];if(1===A.length)i=A;else{for(var n=0;n<A.length-1;)(A[n][0]!==A[n+1][0]||A[n][1]!==A[n+1][1])&&i.push(A[n]),n++;0!==A.length&&0===i.length&&i.push(A[0]),(A[A.length-1][0]!==A[i.length-1][0]||A[A.length-1][1]!==A[i.length-1][1])&&i.push(A[n])}return i}(i),1===i.length){for(var g=0;g<A.length;g++)a(A[g]);A=r}else for(var y=0;y<i.length-1;y++){for(g=0;g<A.length;g++)o(A[g],y);A=r,r=[]}for(var f=0;f<A.length;f++)for(var x=0;x<A[f].length;x++)A[f][x][0]=Math.round(A[f][x][0]),A[f][x][1]=Math.round(A[f][x][1]);return A})(pt.data.getNode(yt).size.points,x,2);console.log(Jt)})})(p)}}}}var W=v(1105);class R{constructor(){let i=(0,O.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o,source:g}=(0,W.$)(Math.ceil(1e9*Math.random())),y=(f,x,p,L)=>{o=(0,lt.bH)(f,x,p,L),o.x=(0,k.q)(o.x),o.y=(0,k.q)(o.y),o.width=(0,k.q)(o.width),o.height=(0,k.q)(o.height),Object.assign(a,(0,lt.sg)(C.$.TEXT,o)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:f=>{y(f.x,f.y,f.x+o.width,f.y+o.height)},move:(f,x)=>{y(x[0][0],x[0][1],f.x,f.y)},end:(f,x)=>{o.width>=10&&o.height>=10?pt.data.node=Object.assign({id:n,type:C.$.TEXT,name:"Text"},{size:o,attribute:a,source:g}):null==r||r.remove(),null==i||i.remove()}}}}var H=v(4113),mt=v(9125),It=v(7797);var Lt=v(6358);class Dt{constructor(){this._nodeName=["circle","ellipse","line","polygon","rect","text","path","foreignObject","image"],this._selected_Ids=[],this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(i){this._selected_Ids=i,this.change(this.ids)}get nodes(){return this._selected_Ids.map(i=>pt.data.getNode(i)).filter(i=>!i.isfake)}set onchange(i){this._fnChanges.push(i)}change(i){var n,r,a,o,g;null===(n=window.document.getElementById(ot.O.RESIZE_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(ot.O.SELECT_GROUP))||void 0===r||r.remove(),null===(a=window.document.getElementById(ot.O.SCAN_GROUP))||void 0===a||a.remove(),null===(o=window.document.getElementById(ot.O.CREATE_GROUP))||void 0===o||o.remove(),null===(g=window.document.getElementById(ot.O.INTERACTIVE_GROUP))||void 0===g||g.remove(),jQuery('[id^="icdt-temp-"]').remove(),this._fnChanges.forEach(y=>y(i))}deleteNode(){for(let i of this._selected_Ids){let n=pt.data.deleteNode(i);pt.history.push([{type:"delete",from:{id:n},to:{id:n}}])}pt.dataSelect.ids=[]}groupNode(){let i=[];if(pt.dataSelect.ids.length>=2){let n=pt.data.getNode(pt.dataSelect.ids[0]),{nodeId:r,attribute:a,size:o}=(0,Lt.m)(Math.ceil(1e9*Math.random()),void 0,n.pid?window.document.getElementById(n.pid):null);pt.data.node=Object.assign({id:r,type:C.$.GROUP,name:"G"},{size:o,attribute:a});for(let g of pt.dataSelect.ids)i.push(pt.data.addGroup(g,r))}if(i.length){pt.dataSelect.ids=i;let n=pt.dataSelect.nodes;1==n.length?(0,m.y)(n[0]):n.length>1&&(0,T.Q)(n)}}ungroupNode(){let i=[];for(let n of pt.dataSelect.ids)i.push(pt.data.unGroup(n));if(i.length){pt.dataSelect.ids=i;let n=pt.dataSelect.nodes;1==n.length?(0,m.y)(n[0]):n.length>1&&(0,T.Q)(n)}}}var Vt=v(9942);class Qt{createNodeImage(i,n){var r,a,o,g;let{nodeId:f,element:x,size:p,attribute:L,source:I}=(0,K.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},source:{type:"image",image:(0,Vt.I)(i)}});(st=>{if(!st)return;let dt=new Image;dt.onload=()=>{let yt=(0,k.q)(dt.naturalWidth/dt.naturalHeight,100);yt>=1?(p.width=Math.min(dt.naturalWidth,512),p.height=(0,k.q)(p.width/yt,100)):(p.height=Math.min(dt.naturalHeight,512),p.width=(0,k.q)(p.height*yt,100)),p.x=(0,k.q)(p.x+50-p.width/2,100),p.y=(0,k.q)(p.y+50-p.height/2,100),Object.assign(L,(0,lt.sg)(C.$.IMAGE,p)),(0,O.__)(x,L),pt.data.node=Object.assign({id:f,type:C.$.IMAGE,name:"Image"},{size:p,attribute:L,source:I})},dt.onerror=yt=>{console.error(`ImgSrc load failed -> ${st}`,yt),null==x||x.remove()},dt.src=st})(null!==(o=null===(g=I.image)||void 0===g?void 0:g.url)&&void 0!==o?o:"")}createNodeIframe(i,n){var r,a;let{nodeId:g,element:y,size:f,attribute:x,style:p,source:L}=(0,_t.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:(0,Vt.I)(i)}});(I=>{let st=(null===(I=pt.data.slide)||void 0===I||null===(I=I.svg)||void 0===I?void 0:I.viewBox)||{x:0,y:0,width:100,height:100},dt=(0,k.q)(st.width/st.height,100);dt>=1?(f.width=Math.min(st.width,512),f.height=(0,k.q)(f.width/dt,100)):(f.height=Math.min(st.height,512),f.width=(0,k.q)(f.height*dt,100)),f.x=(0,k.q)(f.x+50-f.width/2,100),f.y=(0,k.q)(f.y+50-f.height/2,100),Object.assign(x,(0,lt.sg)(C.$.IMAGE,f)),(0,O.__)(y,x),pt.data.node=Object.assign({id:g,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:f,attribute:x,style:p,source:L})})()}createNodeEmbed(i,n){var r,a;let{nodeId:g,element:y,size:f,attribute:x,style:p,source:L}=(0,_t.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},style:{},source:{type:"embed",embed:Object.assign(i,(0,Vt.I)(i))}});(I=>{let st=(null===(I=pt.data.slide)||void 0===I||null===(I=I.svg)||void 0===I?void 0:I.viewBox)||{x:0,y:0,width:100,height:100},dt=(0,k.q)(st.width/st.height,100);dt>=1?(f.width=Math.min(st.width,512),f.height=(0,k.q)(f.width/dt,100)):(f.height=Math.min(st.height,512),f.width=(0,k.q)(f.height*dt,100)),f.x=(0,k.q)(f.x+50-f.width/2,100),f.y=(0,k.q)(f.y+50-f.height/2,100),Object.assign(x,(0,lt.sg)(C.$.IMAGE,f)),(0,O.__)(y,x),pt.data.node=Object.assign({id:g,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:f,attribute:x,style:p,source:L})})()}createNodeMedia(i,n){var r,a,o,g;let{nodeId:f,element:x,size:p,attribute:L,source:I}=(0,K.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},source:{type:"image",image:(0,Vt.I)(i.cover)}}),st={click:{media:i.media}};(dt=>{if(!dt)return;let yt=new Image;yt.onload=()=>{let At=(0,k.q)(yt.naturalWidth/yt.naturalHeight,100);At>=1?(p.width=Math.min(yt.naturalWidth,512),p.height=(0,k.q)(p.width/At,100)):(p.height=Math.min(yt.naturalHeight,512),p.width=(0,k.q)(p.height*At,100)),p.x=(0,k.q)(p.x+50-p.width/2,100),p.y=(0,k.q)(p.y+50-p.height/2,100),Object.assign(L,(0,lt.sg)(C.$.IMAGE,p)),(0,O.__)(x,L),pt.data.node=Object.assign({id:f,type:C.$.IMAGE,name:"Image"},{size:p,attribute:L,source:I,interactive:st})},yt.onerror=At=>{console.error(`ImgSrc load failed -> ${dt}`,At),null==x||x.remove()},yt.src=dt})(null!==(o=null===(g=I.image)||void 0===g?void 0:g.url)&&void 0!==o?o:"")}insert(i){var n;if(pt.data.insertSlide(pt.data.slideId,1),i.title){let{nodeId:r,size:a,attribute:o,style:g,source:y}=(0,_t.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${i.title}</span>`}}});pt.data.node=Object.assign({id:r,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:g,source:y})}if(i.description){let{nodeId:r,size:a,attribute:o,style:g,source:y}=(0,_t.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${i.description.replace(/\n/g,"<br/>")}</span>`}}});pt.data.node=Object.assign({id:r,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:g,source:y})}null!==(n=i.media)&&void 0!==n&&n.prompt&&((()=>{let{nodeId:r,size:a,attribute:o}=(0,gt.f)(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});pt.data.node=Object.assign({id:r,type:C.$.RECT,name:"Rect"},{size:a,attribute:o})})(),(r=>{let{nodeId:a,size:o,attribute:g,style:y,source:f}=(0,_t.e)(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(r=i.media)||void 0===r?void 0:r.prompt}</i></span>`}}});pt.data.node=Object.assign({id:a,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:g,style:y,source:f})})())}}var Yt=v(5226);class ue{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:pt.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var i;let n=null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((o,g)=>g==this._slideIdx),r=null==n?void 0:n.svg,a=o=>{let g=[];return o.filter(y=>!y.isdeleted).forEach(y=>{y.type==C.$.GROUP?g=g.concat(a(y.nodes||[])):g.push(y.id)}),g};return a((null==r?void 0:r.nodes)||[])}}get get(){var i;let n=r=>{var a,o;return null===(a=r)||void 0===a||a.filter(g=>g.type==C.$.GROUP).forEach(g=>{var y;g.nodes=n(null===(y=g.nodes)||void 0===y?void 0:y.filter(f=>!f.isdeleted))}),(r=null===(o=r)||void 0===o?void 0:o.filter(g=>{var y,f;return g.type!=C.$.GROUP||(null!==(y=null===(f=g.nodes)||void 0===f?void 0:f.length)&&void 0!==y?y:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(o=>!o.isdeleted)))}),this._dataSource}get getResource(){var i;let n=[];return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a,o,g,y,f,x,p,L;n.push(null===(a=r.svg)||void 0===a||null===(a=a.background)||void 0===a?void 0:a.path),null===(o=r.svg)||void 0===o||o.nodes.forEach(I=>{var st,dt,yt,At,Jt,he,ge,_e,ye,Ee;n.push(null===(st=I.source)||void 0===st||null===(st=st.image)||void 0===st?void 0:st.path),n.push(null===(dt=I.source)||void 0===dt||null===(dt=dt.audio)||void 0===dt?void 0:dt.path),n.push(null===(yt=I.source)||void 0===yt||null===(yt=yt.video)||void 0===yt?void 0:yt.path),n.push(null===(At=I.source)||void 0===At||null===(At=At.file)||void 0===At?void 0:At.path),n.push(null===(Jt=I.source)||void 0===Jt||null===(Jt=Jt.iframe)||void 0===Jt?void 0:Jt.path),n.push(null===(he=I.source)||void 0===he||null===(he=he.track)||void 0===he?void 0:he.path),n.push(null===(ge=I.interactive)||void 0===ge||null===(ge=ge.show)||void 0===ge||null===(ge=ge.audio)||void 0===ge||null===(ge=ge.source)||void 0===ge?void 0:ge.path),n.push(null===(_e=I.interactive)||void 0===_e||null===(_e=_e.click)||void 0===_e||null===(_e=_e.audio)||void 0===_e||null===(_e=_e.source)||void 0===_e?void 0:_e.path),n.push(null===(ye=I.interactive)||void 0===ye||null===(ye=ye.click)||void 0===ye||null===(ye=ye.image)||void 0===ye||null===(ye=ye.source)||void 0===ye?void 0:ye.path),n.push(null===(Ee=I.interactive)||void 0===Ee||null===(Ee=Ee.click)||void 0===Ee||null===(Ee=Ee.video)||void 0===Ee||null===(Ee=Ee.source)||void 0===Ee?void 0:Ee.path)}),n.push(null===(g=r.test)||void 0===g||null===(g=g.audiotrue)||void 0===g?void 0:g.path),n.push(null===(y=r.test)||void 0===y||null===(y=y.audiofalse)||void 0===y?void 0:y.path),n.push(null===(f=r.test)||void 0===f||null===(f=f.effecttrue)||void 0===f?void 0:f.path),n.push(null===(x=r.test)||void 0===x||null===(x=x.effectfalse)||void 0===x?void 0:x.path),n.push(null===(p=r.test)||void 0===p||null===(p=p.icontrue)||void 0===p?void 0:p.path),n.push(null===(L=r.test)||void 0===L||null===(L=L.iconfalse)||void 0===L?void 0:L.path)}),n.filter(r=>r).map(r=>r.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((r,a,o)=>o.indexOf(r)==a)}set set(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,O.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var i;let n=r=>{var a,o;return null===(a=r)||void 0===a||a.filter(g=>g.type==C.$.GROUP).forEach(g=>{var y;g.nodes=n(null===(y=g.nodes)||void 0===y?void 0:y.filter(f=>!f.isdeleted))}),(r=null===(o=r)||void 0===o?void 0:o.filter(g=>{var y,f;return g.type!=C.$.GROUP||(null!==(y=null===(f=g.nodes)||void 0===f?void 0:f.length)&&void 0!==y?y:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(o=>!o.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,O.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var i,n;return null!==(i=null===(n=this.slide)||void 0===n?void 0:n.id)&&void 0!==i?i:0}get slideIdx(){return this._slideIdx}get slide(){var i;return null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((n,r)=>r==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var i,n;this._slideIdx<(null!==(i=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==i?i:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}refreshSlide(){(0,O.wM)(),(0,Yt.E)(this.slide)}openSlide(i,n){var r,a,o,g;if(i)for(let L=0,I=null!==(y=null===(f=this._dataSource.slides)||void 0===f?void 0:f.length)&&void 0!==y?y:0;L<I;L++){var y,f,x;if((null!==(x=this._dataSource.slides)&&void 0!==x?x:[])[L].id==i){this._slideIdx=L;break}}else if(n&&n>=0&&n<(null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.length)&&void 0!==r?r:0))this._slideIdx=null!=n?n:0;else{var p;this._slideIdx=0,null!==(p=this._dataSource.slides)&&void 0!==p&&p.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}(0,O.wM)(),(0,Yt.E)(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(o=null===(g=this._dataSource.slides)||void 0===g?void 0:g.length)&&void 0!==o?o:0,this.slide)}addSlide(){var i,n,r;null===(i=this._dataSource.slides)||void 0===i||i.push(this._defaultSlide),this._slideIdx=(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1,this.openSlide(void 0,this._slideIdx)}tryReplaceSlide(i,n,r){var a,o,g,y,f;let x=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(L=>L.id==i);if(!r||!x||null!=x&&null!==(o=x.svg)&&void 0!==o&&o.nodes.filter(L=>!L.isdeleted).length)return this.insertSlide(i,n,r);let p=null!==(g=null===(y=this._dataSource.slides)||void 0===y?void 0:y.indexOf(x))&&void 0!==g?g:0;null===(f=this._dataSource.slides)||void 0===f||f.splice(p,1,r),this._slideIdx=p,this.openSlide(void 0,this._slideIdx)}insertSlide(i,n,r){var a,o,g,y,f;let x=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(I=>I.id==i))&&void 0!==a?a:this._defaultSlide,p=(null!==(g=null===(y=this._dataSource.slides)||void 0===y?void 0:y.indexOf(x))&&void 0!==g?g:0)+n;var L;r?(r.id=this.newSlideId,r.code=void 0,r.name||(r.name="Trang m\u1edbi"),null!==(L=r.svg)&&void 0!==L&&L.viewBox||r.svg&&(r.svg.viewBox=pt.screen.frameSize)):r=this._defaultSlide,null===(f=this._dataSource.slides)||void 0===f||f.splice(p,0,r),this._slideIdx=p,this.openSlide(void 0,this._slideIdx)}copySlide(i){var n,r,a,o,g,y,f;let x=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(I=>I.id==i))&&void 0!==n?n:this._defaultSlide,p=(null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(x))&&void 0!==a?a:0)+1,L=Object.assign(JSON.parse(JSON.stringify(x)),{id:this.newSlideId,code:void 0,name:`${x.name} + (Copy)`});null===(g=this._dataSource.slides)||void 0===g||g.splice(p,0,L),this.changeSlide(this.slides,this.slideIdx,null!==(y=null===(f=this._dataSource.slides)||void 0===f?void 0:f.length)&&void 0!==y?y:0,this.slide)}moveSlide(i,n){var r,a,o,g,y,f;let x=null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(L=>L.id==i))&&void 0!==r?r:this._defaultSlide,p=null!==(o=null===(g=this._dataSource.slides)||void 0===g?void 0:g.indexOf(x))&&void 0!==o?o:0;null===(y=this._dataSource.slides)||void 0===y||y.splice(p+n,0,null===(f=this._dataSource.slides)||void 0===f?void 0:f.splice(p,1)[0])}deleteSlide(i){var n,r,a,o,g,y;let f=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(I=>I.id==i))&&void 0!==n?n:this._defaultSlide,x=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(f))&&void 0!==a?a:0;if(null===(g=this._dataSource.slides)||void 0===g||g.splice(x,1),null!==(y=this._dataSource.slides)&&void 0!==y&&y.length)if(x<this._slideIdx){var p,L;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(p=null===(L=this._dataSource.slides)||void 0===L?void 0:L.length)&&void 0!==p?p:0,this.slide)}else x==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(i){var n,r,a,o,g;let y=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(x=>x.id==i))&&void 0!==n?n:this._defaultSlide,f=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(y))&&void 0!==a?a:0;if(y.isdeleted=!0,null!==(g=this._dataSource.slides)&&void 0!==g&&null!==(g=g.filter(x=>!x.isdeleted))&&void 0!==g&&g.length){let x=!0;for(;y.isdeleted;)x?f++:f--,this._dataSource.slides[f]?y=this._dataSource.slides[f]:x=!x;this.openSlide(y.id)}else this.addSlide()}set onChangeSlide(i){this._fnChangeSlides.push(i)}changeSlide(i,n,r,a){this._fnChangeSlides.forEach(o=>o(i,n,r,a))}set node(i){var n,r;let a=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((g,y)=>y==this._slideIdx),o=null==a?void 0:a.svg;null!=o&&o.nodes&&(null==o||o.nodes.push(i)),pt.history.push([{type:"add",from:{id:i.id},to:{id:i.id}}]),(0,Yt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id)}findNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((I,st)=>st==this._slideIdx),a=null==r?void 0:r.svg,o=(I,st)=>{let dt=null==I?void 0:I.find(Jt=>Jt.id==i);if(dt)return dt.pid=st,dt;let yt=0,At=I.length||0;for(;yt<At&&!dt&&(dt=o(I[yt].nodes||[],I[yt].id),!dt);)yt++;return dt},g=o((null==a?void 0:a.nodes)||[]);var y,f,x,p,L;return g?(g.style=null!==(y=g.style)&&void 0!==y?y:{},g.source=null!==(f=g.source)&&void 0!==f?f:{},g.animate=null!==(x=g.animate)&&void 0!==x?x:{},g.interactive=null!==(p=g.interactive)&&void 0!==p?p:{},g.variable=null!==(L=g.variable)&&void 0!==L?L:{},g):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((y,f)=>f==this._slideIdx),a=null==r?void 0:r.svg,g=y=>{let f=(null==y?void 0:y.find(dt=>dt.id==i))||(y=>{let f=null,x=0,p=y.length||0;for(;x<p&&!f;){if(f=g(y[x].nodes),f){f.pid=y[x].id;break}x++}var L,I,st,dt,yt;return f&&(f.style=null!==(L=f.style)&&void 0!==L?L:{},f.source=null!==(I=f.source)&&void 0!==I?I:{},f.animate=null!==(st=f.animate)&&void 0!==st?st:{},f.interactive=null!==(dt=f.interactive)&&void 0!==dt?dt:{},f.variable=null!==(yt=f.variable)&&void 0!==yt?yt:{}),f})((null==y?void 0:y.filter(dt=>dt.type==C.$.GROUP))||[]);var x,p,L,I,st;return f&&(f.style=null!==(x=f.style)&&void 0!==x?x:{},f.source=null!==(p=f.source)&&void 0!==p?p:{},f.animate=null!==(L=f.animate)&&void 0!==L?L:{},f.interactive=null!==(I=f.interactive)&&void 0!==I?I:{},f.variable=null!==(st=f.variable)&&void 0!==st?st:{}),f};return g((null==a?void 0:a.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(i,n,r,a,o){var g;let y=null===(g=this._dataSource.slides)||void 0===g?void 0:g.find((p,L)=>L==this._slideIdx),f=null==y?void 0:y.svg,x=p=>{let L=[];return p.filter(I=>!I.isdeleted).forEach(I=>{I.type==C.$.GROUP?L=L.concat(x(I.nodes||[])):i>I.size.x||n>I.size.y||r<I.size.x+I.size.width||a<I.size.y+I.size.height||(o?I.type==o&&L.push(I.id):L.push(I.id))}),L};return x((null==f?void 0:f.nodes)||[])}getNodeOnArea(i,n,r,a,o){var g;let y=null===(g=this._dataSource.slides)||void 0===g?void 0:g.find((p,L)=>L==this._slideIdx),f=null==y?void 0:y.svg,x=p=>{let L=[];return p.filter(I=>!I.isdeleted).forEach(I=>{I.type==C.$.GROUP?L=L.concat(x(I.nodes||[])):I.size.x+I.size.width<i||I.size.y+I.size.height<n||I.size.x>r||I.size.y>a||(o?I.type==o&&L.push(I.id):L.push(I.id))}),L};return x((null==f?void 0:f.nodes)||[])}deleteNode(i,n){var r;return this.getNode(i).isdeleted=null==n||n,(0,Yt.E)(this.slide),(0,Yt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),i}unGroup(i){var n,r;let a=this.getNode(i),o=Math.ceil(1e9*Math.random());return null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:o})),Object.assign(a,{isdeleted:!0}),(0,Yt.E)(this.slide),(0,Yt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),o}addGroup(i,n){var r;let a=this.getNode(i),o=this.getNode(n);o.nodes=o.nodes||[];let g=Math.ceil(1e9*Math.random());return o.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:g})),Object.assign(a,{isdeleted:!0}),(0,Yt.E)(this.slide),(0,Yt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),g}setNodeP(i,n){var r;let a=null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r?void 0:r.nodes.find(o=>o.id==i);a&&(a.pid=n||null)}bringToFront(i){this.bringToFrontStep(i,0)}sendToBack(i){this.sendToBackStep(i,0)}bringToFrontStep(i,n){var r,a,o,g;null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.forEach((p,L)=>{p.index=L+1});let y=(null!==(a=null===(o=this.slide)||void 0===o||null===(o=o.svg)||void 0===o?void 0:o.nodes.length)&&void 0!==a?a:0)+1;var f,x;i.map(p=>{var L,I;return{id:p,index:null!==(L=null===(I=this.slide)||void 0===I||null===(I=I.svg)||void 0===I||null===(I=I.nodes.find(st=>st.id==p))||void 0===I?void 0:I.index)&&void 0!==L?L:0}}).sort((p,L)=>p.index-L.index).forEach(p=>{var I,L;n?null===(I=this.slide)||void 0===I||null===(I=I.svg)||void 0===I||I.nodes.filter((st,dt)=>st.id==p.id).forEach(st=>{st.index=n+p.index+p.index/1e3}):null===(L=this.slide)||void 0===L||null===(L=L.svg)||void 0===L||L.nodes.filter(st=>st.id==p.id).forEach(st=>{st.index=y+p.index})}),null===(g=this.slide)||void 0===g||null===(g=g.svg)||void 0===g||g.nodes.sort((p,L)=>{var I,st;return(null!==(I=p.index)&&void 0!==I?I:0)-(null!==(st=L.index)&&void 0!==st?st:0)}),(0,Yt.T)(this.slide),i.length<=1?(null===(f=window.document.getElementById(ot.O.RESIZE_GROUP))||void 0===f||f.remove(),(0,m.y)(pt.dataSelect.nodes[0])):(null===(x=window.document.getElementById(ot.O.SELECT_GROUP))||void 0===x||x.remove(),(0,T.Q)(pt.dataSelect.nodes))}sendToBackStep(i,n){var r,a,o,g;null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.forEach((y,f)=>{y.index=f+1}),i.map(y=>{var f,x;return{id:y,index:null!==(f=null===(x=this.slide)||void 0===x||null===(x=x.svg)||void 0===x||null===(x=x.nodes.find(p=>p.id==y))||void 0===x?void 0:x.index)&&void 0!==f?f:0}}).sort((y,f)=>y.index-f.index).forEach(y=>{var x,f;n?null===(x=this.slide)||void 0===x||null===(x=x.svg)||void 0===x||x.nodes.filter(p=>p.id==y.id).forEach(p=>{p.index=n+y.index+y.index/1e3}):null===(f=this.slide)||void 0===f||null===(f=f.svg)||void 0===f||f.nodes.filter(p=>p.id==y.id).forEach(p=>{p.index=y.index/100-1})}),null===(a=this.slide)||void 0===a||null===(a=a.svg)||void 0===a||a.nodes.sort((y,f)=>{var x,p;return(null!==(x=y.index)&&void 0!==x?x:0)-(null!==(p=f.index)&&void 0!==p?p:0)}),(0,Yt.T)(this.slide),i.length<=1?(null===(o=window.document.getElementById(ot.O.RESIZE_GROUP))||void 0===o||o.remove(),(0,m.y)(pt.dataSelect.nodes[0])):(null===(g=window.document.getElementById(ot.O.SELECT_GROUP))||void 0===g||g.remove(),(0,T.Q)(pt.dataSelect.nodes))}bringToFrontArea(i){var n,r;let a=i.map(dt=>pt.data.getNode(dt)).filter(dt=>!dt.isfake),{x1:o,y1:g,x2:y,y2:f}=be(a),x=this.getNodeOnArea(o,g,y,f);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((dt,yt)=>{dt.index=yt+1});let p=x.map(dt=>{var yt,At;return null!==(yt=null===(At=this.slide)||void 0===At||null===(At=At.svg)||void 0===At||null===(At=At.nodes.find(Jt=>Jt.id==dt))||void 0===At?void 0:At.index)&&void 0!==yt?yt:0}),L=Math.max.apply(null,p);var I,st;i.forEach((dt,yt)=>{var At;null===(At=this.slide)||void 0===At||null===(At=At.svg)||void 0===At||At.nodes.filter(Jt=>Jt.id==dt).forEach(Jt=>{Jt.index=L+(yt+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((dt,yt)=>{var At,Jt;return(null!==(At=dt.index)&&void 0!==At?At:0)-(null!==(Jt=yt.index)&&void 0!==Jt?Jt:0)}),(0,Yt.T)(this.slide),i.length<=1?(null===(I=window.document.getElementById(ot.O.RESIZE_GROUP))||void 0===I||I.remove(),(0,m.y)(pt.dataSelect.nodes[0])):(null===(st=window.document.getElementById(ot.O.SELECT_GROUP))||void 0===st||st.remove(),(0,T.Q)(pt.dataSelect.nodes))}sendToBackArea(i){var n,r;let a=i.map(dt=>pt.data.getNode(dt)).filter(dt=>!dt.isfake),{x1:o,y1:g,x2:y,y2:f}=be(a),x=this.getNodeOnArea(o,g,y,f);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((dt,yt)=>{dt.index=yt+1});let p=x.map(dt=>{var yt,At;return null!==(yt=null===(At=this.slide)||void 0===At||null===(At=At.svg)||void 0===At||null===(At=At.nodes.find(Jt=>Jt.id==dt))||void 0===At?void 0:At.index)&&void 0!==yt?yt:0}),L=Math.min.apply(null,p)-1;var I,st;i.forEach((dt,yt)=>{var At;null===(At=this.slide)||void 0===At||null===(At=At.svg)||void 0===At||At.nodes.filter(Jt=>Jt.id==dt).forEach(Jt=>{Jt.index=L+(yt+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((dt,yt)=>{var At,Jt;return(null!==(At=dt.index)&&void 0!==At?At:0)-(null!==(Jt=yt.index)&&void 0!==Jt?Jt:0)}),(0,Yt.T)(this.slide),i.length<=1?(null===(I=window.document.getElementById(ot.O.RESIZE_GROUP))||void 0===I||I.remove(),(0,m.y)(pt.dataSelect.nodes[0])):(null===(st=window.document.getElementById(ot.O.SELECT_GROUP))||void 0===st||st.remove(),(0,T.Q)(pt.dataSelect.nodes))}}const be=A=>{let i=999999,n=999999,r=-999999,a=-999999;return A.forEach(o=>{i=Math.min(i,o.size.x),n=Math.min(n,o.size.y),r=Math.max(r,o.size.x+o.size.width),a=Math.max(a,o.size.y+o.size.height)}),{x1:i,y1:n,x2:r,y2:a}};class ce{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":pt.data.deleteNode(n.from.id);break;case"edit":break;case"delete":pt.data.deleteNode(n.from.id,!1);break;case"size":{let{id:r,type:a,size:o,attribute:g}=pt.data.getNode(n.from.id);Object.assign(o,n.from.size),Object.assign(g,(0,lt.sg)(a,o)),(0,O.__)(window.document.getElementById(r),g);break}case"attribute":{let{id:r,attribute:a}=pt.data.getNode(n.from.id);Object.assign(a,n.from.attribute),(0,O.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=pt.data.getNode(n.from.id);Object.assign(null!=a?a:{},n.from.style),(0,O.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:o}=pt.data.getNode(n.from.id);Object.assign(null!=o?o:{},n.from.source),(0,O.QI)(window.document.getElementById(r),a,null!=o?o:{});break}case"animate":{let{animate:r}=pt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.animate);break}case"interactive":{let{interactive:r}=pt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.interactive);break}case"variable":{let{variable:r}=pt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.variable);break}}}),pt.dataSelect.ids=[]},this.redoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":pt.data.deleteNode(n.to.id,!1);break;case"edit":break;case"delete":pt.data.deleteNode(n.to.id,!0);break;case"size":{let{id:r,type:a,size:o,attribute:g}=pt.data.getNode(n.to.id);Object.assign(o,n.to.size),Object.assign(g,(0,lt.sg)(a,o)),(0,O.__)(window.document.getElementById(r),g);break}case"attribute":{let{id:r,attribute:a}=pt.data.getNode(n.to.id);Object.assign(a,n.to.attribute),(0,O.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=pt.data.getNode(n.to.id);Object.assign(null!=a?a:{},n.to.style),(0,O.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:o}=pt.data.getNode(n.to.id);Object.assign(null!=o?o:{},n.to.source),(0,O.QI)(window.document.getElementById(r),a,null!=o?o:{});break}case"animate":{let{animate:r}=pt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.animate);break}case"interactive":{let{interactive:r}=pt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.interactive);break}case"variable":{let{variable:r}=pt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.variable);break}}}),pt.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(i){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:i}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:i})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(i){this._fnChanges.push(i)}change(){this._fnChanges.forEach(i=>i(this.index,this.total))}}class fe{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(i){this._actived=i}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(i){var n,r;this._frameSize.width=null!==(n=null==i?void 0:i.width)&&void 0!==n?n:1080,this._frameSize.height=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}get frameSize(){return this._frameSize}set frameSize(i){this._frameSize.x=i.x,this._frameSize.y=i.y,this._frameSize.width=i.width,this._frameSize.height=i.height,this.reset()}set screen(i){this._offset=i.offset,this._width=i.width,this._height=i.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(i,n,r){var a;if(!(i<.1||i>10)){if(n=null!==(a=n)&&void 0!==a?a:{x:this._width/2,y:this._height/2},r)this._dislocation.x=this._width/i/2-n.x,this._dislocation.y=this._height/i/2-n.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var o={x:Math.max(0,Math.min((0,k.q)(n.x/this._width,1e3),1)),y:Math.max(0,Math.min((0,k.q)(n.y/this._height,1e3),1))},g={x:(this._width/i-this._width/this._scale)*o.x,y:(this._height/i-this._height/this._scale)*o.y};this._dislocation.x+=g.x,this._dislocation.y+=g.y}this._scale=i,this.change(),this.zoomChange(this.scale)}}set zoomTo(i){"fit"==i?this.scaleTo(Math.min((this._width-80)/this._frameSize.width,(this._height-80)/this._frameSize.height),void 0,!0):"number"==typeof i&&this.scaleTo(i/100,void 0,!0)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(i,n){this._dislocation.x=i.x+n.x/this._scale,this._dislocation.y=i.y+n.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(0,O.eb)()}set onZoomChange(i){this._fnZoomChanges.push(i)}zoomChange(i){this._fnZoomChanges.forEach(n=>n(i))}}var Te=v(644);class qe{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){(0,Te.sV)({callback:i=>{this._fill=(null==i?void 0:i.fill)||this._fill,this._stroke=(null==i?void 0:i.stroke)||this._stroke,this._strokeWidth=(null==i?void 0:i.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==i?void 0:i.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==i?void 0:i.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){(0,Te.qp)({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(i){this._fill=i,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(i){this._stroke=i,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(i){this._strokeWidth=i,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(i){this._strokeLinecap=i}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(i){this._strokeLinejoin=i}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(i){this._fnChangeFills.push(i)}changeFill(i){this._fnChangeFills.forEach(n=>n(i)),this.saveConfig()}set onchangestroke(i){this._fnChangeStrokes.push(i)}changeStroke(i){this._fnChangeStrokes.forEach(n=>n(i)),this.saveConfig()}set onchangestrokewidth(i){this._fnChangeStrokeWidths.push(i)}changeStrokeWidth(i){this._fnChangeStrokeWidths.forEach(n=>n(i)),this.saveConfig()}}var Ue=v(70),ni=v(5973),ri=v(4787),Me=function(A){return A&&JSON.parse(JSON.stringify(A))},Ge=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],Je=[],ai={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},oi={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class ti{constructor(){this._data_variables=Me(Ge).concat(Me(Je)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=i=>{"function"==typeof i&&this.GetActionExecuteds.push(i)},this.OnGetActionExecuted=i=>{this.GetActionExecuteds.forEach(n=>{n(i)})},this.SetActionExecutings=[],this.FuncSetExecutings=i=>{"function"==typeof i&&this.SetActionExecutings.push(i)},this.OnSetActionExecuting=i=>{this.SetActionExecutings.forEach(n=>{n(i)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=i=>{"function"==typeof i&&this.SetActionExecuteds.push(i)},this.OnSetActionExecuted=i=>{for(var n of(this.SetActionExecuteds.forEach(r=>{r(i)}),this.getCondition(i.key)||[]))n.if&&n.if.length>0&&(this.checkValueConditions(n.if)?this.setValueOperators(n.then||[]):this.setValueOperators(n.else||[]))}}renew(){this._data_variables=Me(Ge).concat(Me(Je)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(i){if(!i)return;let n={};"string"==typeof i?n=JSON.parse(i):"object"==typeof i&&(n=i),this._data_variables=n.variables||[],this._data_conditions=n.conditions||(r=>(this._data_variables.map(a=>a.change||[]).forEach(a=>{r=r.concat(a)}),r))([]),Ge.forEach(r=>{var a=this._data_variables.filter(o=>o.key==r.key);a.length?a.forEach(function(o,g,y){o.type=r.type,o.readonly=r.readonly,o.system=r.system}):this._data_variables.push(r)})}getVariableTemp(){return Me(ai)}getConditionTemp(){return Me(oi)}getKeys(){return this._data_variables.map(function(i){return i.key}).sort(function(i,n){return i.localeCompare(n)})}getVariableAll(){return this._data_variables.length?Me((A=this._data_variables,i="key",function(n){for(var r of A.map(function(a){return a[i]}).sort())A.filter(function(a){return a[i]==r}).forEach(function(a){n.push(a)}),A=A.filter(function(a){return a[i]!=r});return n}([]))):Me(Ge).concat(Me(Je));var A,i}setVariableAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_variables=i),Ge.forEach(n=>{var r=this._data_variables.filter(a=>a.key==n.key);r.length?r.forEach((a,o,g)=>{a.type=n.type,a.readonly=n.readonly,a.system=n.system}):this._data_variables.push(n)}))}getVariable(i){return i?Me(this._data_variables.filter(n=>n.key==i)[0]||{}):{}}setVariable(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(o=>o.key==i)[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(o=>o.key==i);a.length?a.forEach(function(o,g,y){o.value=n,o.type=r}):this._data_variables.push({key:i,value:n,type:r})}}getValue(i,n){if(!i)return"";var r=this._data_variables.filter(function(g){return g.key==i});if(r.length){var o,a=r[0]||{};switch(this.OnGetActionExecuting(a),n||(n=a.type||null),n){case"string":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":"string"==typeof a.value?a.value||"":a.value.toString().trim();break;case"number":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?0:"number"==typeof a.value?a.value||0:parseFloat(a.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(a.value)>=0?o=!1:"boolean"==typeof a.value?o=a.value:(o=(a.value+"").toLowerCase(),o="1"==a.value||"true"==a.value||"yes"==a.value||"dung"==a.value);break;case"audio-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></audio>`:"";break;case"video-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></video>`:"";break;case"img-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<img style="width:100%;vertical-align:middle;" src="${a.value}"/>`:"";break;default:o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value}return this.OnGetActionExecuted(a),o}return null}setValue(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(function(g){return g.key==i})[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(function(g){return g.key==i});if(a.length){var o=a[0];this.OnSetActionExecuting(o),o&&(o.value=n),this.OnSetActionExecuted(o)}}}getConditionAll(){return Me(this._data_conditions.sort(function(i,n){return i.idx-n.idx}))}setConditionAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_conditions=i))}getCondition(i){return i?Me(this._data_conditions.filter(n=>n.variable==i||(n.variables||[]).indexOf(i)>=0).sort(function(n,r){return n.idx-r.idx})):{}}switchCondition(i,n,r){switch(i){case"==":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,o){return a+o})>0):n==r;case"!=":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),0==r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,o){return a+o})):n!=r;case">=":return n>=r;case"<=":return n<=r;case">":return n>r;case"<":return n<r;case"\u2208":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,o){return a+o})>0;case"\u2209":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),0==r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,o){return a+o});default:return!1}}switchOperator(i,n,r){switch(i){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return n/r;case"=":return r;case"=!":return!r;case"==":return n==r;case"!=":return n!=r}}switchFormula(i,n){switch(i){case"sum":return n.reduce(function(a,o){return a+o});case"sub":return n.reduce(function(a,o){return a-o});case"pro":return n.reduce(function(a,o){return a*o});case"div":return n.reduce(function(a,o){return a/o});case"avg":var r=n.reduce(function(a,o){return a+o})/(n.length||1);return Math.round(1e4*(r+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,n);case"max":return Math.max.apply(null,n);case"and":return n.reduce(function(a,o){return a&&o});case"or":return n.reduce(function(a,o){return a||o});default:return 0}}switchValueType_Condition(i){switch(i.valuetype){case"value":return this.switchCondition(i.condition,this.getValue(i.variable),i.value);case"variable":return this.switchCondition(i.condition,this.getValue(i.variable),this.getValue(i.value));default:return 0}}switchValueType_Operator(i){switch(i.valuetype){case"value":return this.switchOperator(i.operator,this.getValue(i.variable),i.value);case"variable":return this.switchOperator(i.operator,this.getValue(i.variable),this.getValue(i.value));case"variables":var n=this.switchFormula(i.valueformula,i.value.map(r=>this.getValue(r)));return this.switchOperator(i.operator,this.getValue(i.variable),n)}}checkValueCondition(i){return this.switchValueType_Condition(i)}getValueOperator(i){return this.switchValueType_Operator(i)}setValueOperator(i){null!=i&&i.variable&&this.setValue(i.variable,this.getValueOperator(i))}checkValueConditions(i){return 0==i.map(n=>{switch(n.type){case"variable":return this.switchValueType_Condition(n)?0:1;case"variables":return 0==n.variables.map(r=>this.switchValueType_Condition(Object.assign(Me(n),{variable:r}))?0:1).reduce(function(r,a){return r+a})?0:1;default:return 0}}).reduce((n,r)=>(null!=n?n:0)+(null!=r?r:0))}setValueOperators(i){for(var n of i)switch(n.type){case"variable":this.setValue(n.variable,this.getValueOperator(n));break;case"variables":for(var r of n.variables)this.setValue(r,this.getValueOperator(Object.assign(Me(n),{variable:r})));break;case"slide":Ue.$.runSlide(void 0,void 0,n.slide);break;case"node":{var a;(0,ri.L5)({id:n.node,nodeStatus:Ue.$.nodeStatus,slideStatus:Ue.$.slideStatus});let o=Ue.$.findNode(n.node);null!=o&&null!==(a=o.interactive)&&void 0!==a&&a.click&&(0,ni.F)(o,Ue.$.nodeStatus,Ue.$.slideStatus);break}}}FuncGetExecutings(i){"function"==typeof i&&this.GetActionExecutings.push(i)}OnGetActionExecuting(i){this.GetActionExecutings.forEach(n=>{n(i)})}}class Ze{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(i,n,r){if(this._pointer_type=i,n)switch(i){case j._.PEN:this._pen_type=n;break;case j._.SHAPE:this._shape_type=n,r&&n===C.$.POLYGON&&(this._polygon_type=r)}}get pointer_type(){return this._pointer_type}set pointer_type(i){this._pointer_type=i,this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(i){this._pointer_type_temp=i,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(i){this._pen_type=i,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(i){this._shape_type=i,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(i){this._polygon_type=i,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(i){this._fnChangePointerTypes.push(i)}changePointerType(i,n,r){this._fnChangePointerTypes.forEach(a=>a(i,n,r))}set onchangePointerTypeTemp(i){this._fnChangePointerTypeTemps.push(i)}changePointerTypeTemp(i,n,r){this._fnChangePointerTypeTemps.forEach(a=>a(i,n,r))}set onchangePenType(i){this._fnChangePenTypes.push(i)}changePenType(i,n,r){this._fnChangePenTypes.forEach(a=>a(i,n,r))}set onchangeShapeType(i){this._fnChangeShapeTypes.push(i)}changeShapeType(i,n,r){this._fnChangeShapeTypes.forEach(a=>a(i,n,r))}set onchangePolygonType(i){this._fnChangePolygonTypes.push(i)}changePolygonType(i,n,r){this._fnChangePolygonTypes.forEach(a=>a(i,n,r))}set onchange(i){this._fnChanges.push(i)}change(i,n,r){this._fnChanges.forEach(a=>a(i,n,r))}}const pt=new class si{constructor(){this._container="",this._svg="",this._screen=fe.prototype,this._data=ue.prototype,this._dataSelect=Dt.prototype,this._slide=Qt.prototype,this._history=ce.prototype,this._attribute=qe.prototype,this._pointer=Ze.prototype,this._variable=ti.prototype,this._data=new ue,this._dataSelect=new Dt,this._slide=new Qt,this._history=new ce,this._attribute=new qe,this._pointer=new Ze,this._variable=new ti,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._pointer.onchangePointerTypeTemp=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(i){this._config=i}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,resources:this._data.getResource,variable:this._variable.get,info:{}}}set dataSource(i){this._screen.set=i.screen||{width:1080,height:1080},this._data.set=i.data||{},this._variable.set=i.variable||{}}get container(){return this._container}set container(i){this._container=i}get svg(){return this._svg}set svg(i){this._svg=i}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var i,n,r,a,o;this._screen.screen=(i=jQuery(this._container).offset(),n=jQuery(this._container).width(),r=jQuery(this._container).height(),console.log("reloadView",JSON.stringify({offset:i,width:n,height:r})),{offset:{x:null!==(a=null==i?void 0:i.left)&&void 0!==a?a:0,y:null!==(o=null==i?void 0:i.top)&&void 0!==o?o:0},width:null!=n?n:0,height:null!=r?r:0})}init(i){this._container=i.container,this._svg=i.target,this._screen=new fe,(A=>{new O.Mh(A.container,A.target),pt.pointer.onchange=(r,a,o)=>{switch(r){case j._.POINTER:jQuery(A.target).css({cursor:"auto"});break;case j._.HAND:jQuery(A.target).css({cursor:"grab"});break;case j._.PEN:switch(a){case mt.D.DRAW:jQuery(A.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case mt.D.HIGHTLIGH:jQuery(A.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case j._.ERASER:jQuery(A.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case j._.SHAPE:jQuery(A.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case j._.TEXT:case j._.FOREIGNOBJECT:jQuery(A.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}},jQuery(A.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{pt.pointer.pointer_type==j._.HAND&&jQuery(A.target).css({cursor:"grabbing"})}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{pt.pointer.pointer_type==j._.HAND&&jQuery(A.target).css({cursor:"grab"})}),jQuery(A.container).off("mousewheel.icdt-init").on("mousewheel.icdt-init",r=>{var a;r.preventDefault();var o=pt.screen.scale,g=(null!==(a=r.originalEvent)&&void 0!==a?a:r).deltaY>0?1:-1;pt.screen.scaleTo(o-.04*o*g,(0,It.p)({x:r.clientX,y:r.clientY},1,{x:0,y:0},pt.screen.offset))}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{pt.screen.actived=!!jQuery(r.target).parents("app-main").length}),jQuery(A.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{pt.screen.actived=!0}),jQuery(A.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{pt.screen.actived=!1}),jQuery(A.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(A.container.includes("#")&&A.container.includes(r.target.getAttribute("id"))||A.container.includes(".")&&A.container.includes(r.target.getAttribute("class"))||A.container.includes(r.target.nodeName))&&(pt.pointer.pointer_type_temp||pt.pointer.pointer_type)===j._.POINTER&&(pt.dataSelect.ids=[])}),jQuery(A.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const i=r=>{switch(pt.pointer.pointer_type_temp||pt.pointer.pointer_type){case j._.POINTER:M(r);break;case j._.HAND:(A=>{(0,u.A)(A,new Q,1,{x:0,y:0})})(r);break;case j._.PEN:(0,Ot.i)(r);break;case j._.SHAPE:(A=>{var i=null;switch(pt.pointer.shape_type){case C.$.CIRCLE:i=new it;break;case C.$.ELLIPSE:i=new vt;break;case C.$.LINE:i=new zt;break;case C.$.RECT:i=new ft;break;case C.$.POLYGON:var n;i=new kt(null===(n=z.find(r=>r.type==pt.pointer.polygon_type))||void 0===n?void 0:n.ratios);break;case C.$.FOREIGNOBJECT:i=new et;break;case C.$.IMAGE:i=new ht;break;case C.$.TEXT:case C.$.PATH:i=new Wt}i&&(0,u.A)(A,i)})(r);break;case j._.FOREIGNOBJECT:(A=>{(0,u.A)(A,new et)})(r);break;case j._.IMAGE:(A=>{(0,u.A)(A,new ht)})(r);break;case j._.TEXT:(A=>{(0,u.A)(A,new R)})(r);break;case j._.ERASER:(A=>{(0,u.A)(A,new F)})(r);break;case j._.INDEX:(0,H.s)(r)}};let n=!1;jQuery(A.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,i({touchEvent:r})}),jQuery(A.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);i({mouseEvent:r})}}),A.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{pt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Gt.t)(r))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{pt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Gt.t)(r))}))})({container:i.container,target:i.target,iskeyboard:i.iskeyboard})}}},4113:(ae,Rt,v)=>{v.d(Rt,{s:()=>T,Q:()=>_});var j=v(1687),O=v(4981),ot=v(4318),C=v(6816),lt=v(4080);const T=M=>{var E,Q,U,z;let tt=(null===(E=M.mouseEvent)||void 0===E?void 0:E.target)||(null===(Q=M.touchEvent)||void 0===Q?void 0:Q.target),k=(null==tt?void 0:tt.getAttribute("id"))||"",it=null==tt?void 0:tt.nodeName,Y=jQuery(tt).parents("g[id]").attr("id")||"";if(![j.O.INDEX_GROUP].includes(Y))if(null!==(U=M.mouseEvent)&&void 0!==U&&U.altKey||null!==(z=M.touchEvent)&&void 0!==z&&z.altKey||!k||k.match(/[^0-9]/)||!O.icdt.dataSelect.nodeName.includes(it)){var vt;O.icdt.dataSelect.ids.length&&(O.icdt.dataSelect.ids=[]),(0==(null===(vt=M.mouseEvent)||void 0===vt?void 0:vt.button)||M.touchEvent)&&((M,E)=>{let k=(0,lt.g1)(j.O.SCAN_GROUP,"g"),it=(0,ot.bH)(0,0,1,1);(0,lt.vl)(k,it),((M,E,Q,U)=>{(0,C.A)(M,{start:k=>{},move:(k,it)=>{((k,it,Y,vt)=>{E=(0,ot.bH)(k,it,Y,vt),(0,lt.vl)(Q,E)})(it[0][0],it[0][1],k.x,k.y)},end:(k,it)=>{null==Q||Q.remove(),O.icdt.dataSelect.ids=O.icdt.data.getNodeInArea(Math.min(it[0][0],k.x),Math.min(it[0][1],k.y),Math.max(it[0][0],k.x),Math.max(it[0][1],k.y)),U(O.icdt.dataSelect.nodes)}})})(M,it,k,E)})(M,S)}else{var gt,ft;let G=parseFloat(k||"0");O.icdt.dataSelect.ids=null!==(gt=M.mouseEvent)&&void 0!==gt&&gt.shiftKey||null!==(ft=M.touchEvent)&&void 0!==ft&&ft.shiftKey?[G].concat(O.icdt.dataSelect.ids).filter((Bt,zt,re)=>re.indexOf(Bt)==zt):[G],S(O.icdt.dataSelect.nodes)}},S=M=>{var E,Q;let U=1;var z,tt;if(M.length&&(U=Math.max.apply(null,null!==(z=null===(tt=O.icdt.data.slide)||void 0===tt||null===(tt=tt.svg)||void 0===tt?void 0:tt.nodes.map(it=>{var Y;return null!==(Y=it.idx)&&void 0!==Y?Y:0}))&&void 0!==z?z:[0])+1),1==M.length)M[0].idx||(M[0].idx=U,M[0].time=0);else if(M.length>=0){let it=M.map(vt=>{var gt;return null!==(gt=vt.idx)&&void 0!==gt?gt:0}).filter(vt=>vt>0),Y=it.length?Math.min.apply(null,it):U;M.forEach(vt=>{var gt;vt.idx=Y,vt.time=null!==(gt=vt.time)&&void 0!==gt?gt:0})}let k=(0,lt.g1)(j.O.INDEX_GROUP,"g");(0,lt.mo)(k,null!==(E=null===(Q=O.icdt.data.slide)||void 0===Q||null===(Q=Q.svg)||void 0===Q?void 0:Q.nodes)&&void 0!==E?E:[])},_=M=>{var E,Q,U;null!=M&&null!==(E=M.svg)&&void 0!==E&&E.nodes&&M.svg.nodes.forEach(tt=>{tt.idx=0,tt.time=null});let z=(0,lt.g1)(j.O.INDEX_GROUP,"g");(0,lt.mo)(z,null!==(Q=null===(U=O.icdt.data.slide)||void 0===U||null===(U=U.svg)||void 0===U?void 0:U.nodes)&&void 0!==Q?Q:[])}},4578:(ae,Rt,v)=>{v.d(Rt,{h:()=>E,t:()=>Q});var j=v(644),O=v(7308),ot=v(968),C=v(4981),lt=v(666),u=v(2966),m=v(5226),T=v(3423),S=v(5811),_=v(3385);const E=new class M{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:O.s.Escape,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.ids=[])}},this.onchange={type:"keydown",key:O.s.Delete,fn:()=>{C.icdt.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:O.s.Space,fn:()=>{C.icdt.pointer.pointer_type_temp=ot._.HAND}},this.onchange={type:"keyup",key:O.s.Space,fn:()=>{C.icdt.pointer.pointer_type_temp=ot._.POINTER}},this.onchange={type:"keydown",key:O.s.ArrowLeft,fn:()=>{C.icdt.dataSelect.ids.length||C.icdt.data.backSlide()}},this.onchange={type:"keydown",key:O.s.ArrowRight,fn:()=>{C.icdt.dataSelect.ids.length||C.icdt.data.nextSlide()}},this.onchange={type:"keydown",key:O.s.ArrowLeft,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(z=>{(0,_.k6)(z,(0,S.q)(z.size.x-(0,T.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,lt.y)(C.icdt.dataSelect.nodes[0]):(0,u.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.ArrowRight,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(z=>{(0,_.k6)(z,(0,S.q)(z.size.x+(0,T.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,lt.y)(C.icdt.dataSelect.nodes[0]):(0,u.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.ArrowUp,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(z=>{(0,_.co)(z,(0,S.q)(z.size.y-(0,T.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,lt.y)(C.icdt.dataSelect.nodes[0]):(0,u.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.ArrowDown,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(z=>{(0,_.co)(z,(0,S.q)(z.size.y+(0,T.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,lt.y)(C.icdt.dataSelect.nodes[0]):(0,u.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.Digit1,fn:z=>{z.shiftKey&&(C.icdt.reloadView(),C.icdt.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:O.s.KeyA,fn:z=>{if(z.ctrlKey){C.icdt.dataSelect.ids=C.icdt.data.getNodeAll();let tt=C.icdt.dataSelect.nodes;1==tt.length?(0,lt.y)(tt[0]):tt.length>1&&(0,u.Q)(tt)}}},this.onchange={type:"keydown",key:O.s.KeyC,fn:z=>{if(z.ctrlKey){let tt=C.icdt.dataSelect.nodes;tt&&(0,j.yR)({params:{type:"nodes",nodes:tt}})}}},this.onchange={type:"keydown",key:O.s.KeyV,fn:z=>{z.ctrlKey&&(0,j.aY)({callback:tt=>{var k,it;"nodes"==(null==tt?void 0:tt.type)&&null!=tt&&null!==(k=tt.nodes)&&void 0!==k&&k.length&&(null==tt||null===(it=tt.nodes)||void 0===it||it.forEach(Y=>{Y.id=Math.ceil(1e9*Math.random()),C.icdt.data.node=Y}),(0,m.E)(C.icdt.data.slide))}})}},this.onchange={type:"keydown",key:O.s.KeyZ,fn:z=>{z.ctrlKey&&z.shiftKey?C.icdt.history.redo():z.ctrlKey&&C.icdt.history.undo()}},this.onchange={type:"keydown",key:O.s.BracketLeft,fn:z=>{z.ctrlKey&&z.shiftKey?C.icdt.data.sendToBack(C.icdt.dataSelect.ids):z.ctrlKey?C.icdt.data.sendToBackStep(C.icdt.dataSelect.ids,-2):C.icdt.data.sendToBackArea(C.icdt.dataSelect.ids)}},this.onchange={type:"keydown",key:O.s.BracketRight,fn:z=>{z.ctrlKey&&z.shiftKey?C.icdt.data.bringToFront(C.icdt.dataSelect.ids):z.ctrlKey?C.icdt.data.bringToFrontStep(C.icdt.dataSelect.ids,1):C.icdt.data.bringToFrontArea(C.icdt.dataSelect.ids)}}}set onchange(z){let tt=this._fnChanges.find(k=>k.eventType==z.type&&k.eventKey==z.key);tt?tt.fns.push(z.fn):this._fnChanges.push({eventType:z.type,eventKey:z.key,fns:[z.fn]})}change(z,tt,k){var it;null===(it=this._fnChanges.find(Y=>Y.eventType==z&&Y.eventKey==tt))||void 0===it||it.fns.forEach(Y=>Y(k))}},Q=U=>{E.change(U.type,U.keyCode||U.which||U.charCode||0,U)}},410:(ae,Rt,v)=>{v.d(Rt,{a:()=>_});var j=v(4318),O=v(8419),ot=v(9054),C=v(4080),lt=v(511),u=v(3423),m=v(1687),T=v(4981),S=v(8619);class _{constructor(E,Q){var U,z,tt,k;let it={stroke:"#FF0000",strokeWidth:(0,u.v)(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,u.v)(8)},{element:vt,attribute:gt,size:ft}=(0,O.G)(Math.ceil(1e9*Math.random()),{size:Q});window.document.getElementById(m.O.INTERACTIVE_GROUP).querySelectorAll("path").forEach(_t=>null==_t?void 0:_t.remove()),window.document.getElementById(m.O.INTERACTIVE_GROUP).querySelectorAll("circle").forEach(_t=>null==_t?void 0:_t.remove()),null===(U=window.document.getElementById(m.O.INTERACTIVE_GROUP))||void 0===U||U.appendChild(vt);var G=_t=>{var et,K;if(!_t)return;kt(_t);let{size:ht}=null!==(et=null!=E?E:T.icdt.dataSelect.nodes[0])&&void 0!==et?et:{};if(!ht)return;let St=[[_t[0]-ht.width/2,_t[1]-ht.height/2],[_t[0]+ht.width/2,_t[1]-ht.height/2],[_t[0]+ht.width/2,_t[1]+ht.height/2],[_t[0]-ht.width/2,_t[1]+ht.height/2],[_t[0]-ht.width/2,_t[1]-ht.height/2]],{element:Gt}=(0,O.G)(Math.ceil(1e9*Math.random()),{attribute:{fill:"#FFFFFF",fillOpacity:.6,stroke:"#5f6ce1",strokeWidth:(0,u.v)(1),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,u.v)(8)},size:{x:0,y:0,width:10,height:10,points:St}});null===(K=window.document.getElementById(m.O.INTERACTIVE_GROUP))||void 0===K||K.appendChild(Gt)},kt=_t=>{var et;if(!_t)return;let{element:K}=(0,S._)(Math.ceil(1e9*Math.random()),{attribute:{fill:"#FF0000",strokeWidth:(0,u.v)(1)},size:{x:_t[0]-5,y:_t[1]-5,width:10,height:10}});null===(et=window.document.getElementById(m.O.INTERACTIVE_GROUP))||void 0===et||et.appendChild(K)};(0,C.__)(vt,it),G(null!=Q&&null!==(z=Q.points)&&void 0!==z&&z.length?Q.points[0]:void 0),G(null!=Q&&null!==(tt=Q.points)&&void 0!==tt&&tt.length&&(null==Q||null===(k=Q.points)||void 0===k?void 0:k.length)>=2?Q.points[Q.points.length-1]:void 0);let zt="";return{start:_t=>{zt=`M ${_t.x} ${_t.y} L ${_t.x} ${_t.y}`},move:(_t,et)=>{((_t,et)=>{zt+=` ${_t} ${et}`,vt.setAttribute("d",zt)})(_t.x,_t.y)},end:(_t,et)=>{(_t=>{let K=lt.jvg().x(ht=>ht[0]).y(ht=>ht[1]).curve(lt.$0Z)(_t);vt.setAttribute("d",K),_t.length>=2&&(window.interactivePoints=_t)})(et),(_t=>{let et=9999,K=9999,ht=-9999,St=-9999;_t.forEach(Gt=>{et=Math.min(et,Gt[0]),K=Math.min(K,Gt[1]),ht=Math.max(ht,Gt[0]),St=Math.max(St,Gt[1])}),ft=(0,j.bH)(et,K,ht,St,{points:_t}),Object.assign(gt,(0,j.sg)(ot.$.PATH,ft),it)})(et),G(et.length?et[0]:void 0),G(et.length>=2?et[et.length-1]:void 0)}}}}},9623:(ae,Rt,v)=>{v.d(Rt,{U:()=>U,i:()=>Q});var j=v(1687),O=v(9125),ot=v(4981),C=v(6816),lt=v(4080),u=v(4318),m=v(8419),T=v(9054),S=v(511);class _{constructor(){let tt={strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:k,element:it,attribute:Y,size:vt}=(0,m.G)(Math.ceil(1e9*Math.random()));(0,lt.__)(it,Y);let ft="";return{start:Bt=>{ft=`M ${Bt.x} ${Bt.y} L ${Bt.x} ${Bt.y}`},move:(Bt,zt)=>{((Bt,zt)=>{ft+=` ${Bt} ${zt}`,it.setAttribute("d",ft)})(Bt.x,Bt.y)},end:(Bt,zt)=>{(Bt=>{let re=S.jvg().x(Wt=>Wt[0]).y(Wt=>Wt[1]).curve(S.$0Z)(Bt);it.setAttribute("d",re)})(zt),(Bt=>{let zt=9999,re=9999,Wt=-9999,_t=-9999;Bt.forEach(et=>{zt=Math.min(zt,et[0]),re=Math.min(re,et[1]),Wt=Math.max(Wt,et[0]),_t=Math.max(_t,et[1])}),vt=(0,u.bH)(zt,re,Wt,_t,{points:Bt}),Object.assign(Y,(0,u.sg)(T.$.PATH,vt),tt)})(zt),ot.icdt.data.node=Object.assign({id:k,type:T.$.PATH,name:"Path"},{size:vt,attribute:Y})}}}}class M{constructor(){let tt={strokeOpacity:.4,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:k,element:it,attribute:Y,size:vt}=(0,m.G)(Math.ceil(1e9*Math.random()));(0,lt.__)(it,Y);let ft="";var G=(kt,Bt)=>{ft+=` ${kt} ${Bt}`,it.setAttribute("d",ft)};return{start:kt=>{ft=`M ${kt.x} ${kt.y} L ${kt.x} ${kt.y}`},move:(kt,Bt)=>{G(kt.x,kt.y)},end:(kt,Bt)=>{G(kt.x,kt.y),(kt=>{let Bt=9999,zt=9999,re=-9999,Wt=-9999;kt.forEach(_t=>{Bt=Math.min(Bt,_t[0]),zt=Math.min(zt,_t[1]),re=Math.max(re,_t[0]),Wt=Math.max(Wt,_t[1])}),vt=(0,u.bH)(Bt,zt,re,Wt,{points:kt}),Object.assign(Y,(0,u.sg)(T.$.PATH,vt),tt)})(Bt),ot.icdt.data.node=Object.assign({id:k,type:T.$.PATH,name:"Path"},{size:vt,attribute:Y})}}}}var E=v(410);const Q=z=>{switch(ot.icdt.pointer.pen_type){case O.D.DRAW:(0,C.A)(z,new _);break;case O.D.HIGHTLIGH:(0,C.A)(z,new M);break;case O.D.INTERACTIVE:U(z)}},U=z=>{var tt,k;let it=(0,lt.g1)(j.O.INTERACTIVE_GROUP,"g"),Y=null!==(tt=null===(k=ot.icdt.data.slide)||void 0===k||null===(k=k.svg)||void 0===k?void 0:k.viewBox)&&void 0!==tt?tt:(()=>{let{width:vt,height:gt}=ot.icdt.screen.get;return{x:0,y:0,width:vt,height:gt}})();(0,lt.XH)(it,Y),z&&(0,C.A)(z,new E.a)}},666:(ae,Rt,v)=>{v.d(Rt,{y:()=>m});var j=v(1687),O=v(4981),ot=v(4318),C=v(6816),lt=v(4080),u=v(5811);const m=_=>{let M=(0,lt.g1)(j.O.RESIZE_GROUP,"g");(0,lt.hJ)(M,_).forEach(E=>{T(E.element,E.posType,_,M)})},T=(_,M,E,Q)=>{let U=!1;null==_||_.addEventListener("touchstart",z=>{U=!0,S({touchEvent:z},M,E,Q)}),null==_||_.addEventListener("mousedown",z=>{if(0==z.button){if(U)return void(U=!1);S({mouseEvent:z},M,E,Q)}})},S=(_,M,E,Q)=>{let G,{id:U,type:z,size:tt,attribute:k}=E,{x:it,y:Y,width:vt,height:gt}=tt,ft=(vt||1)/(gt||1),Bt=null,Wt=!1;(0,C.A)(_,{start:et=>{Bt=JSON.parse(JSON.stringify({id:U,size:tt,attribute:k}))},move:(et,K)=>{((et,K,ht,St)=>{switch(M){case"rect-center":var Gt,Ot;G=null!==(Gt=_.mouseEvent)&&void 0!==Gt&&Gt.shiftKey||null!==(Ot=_.touchEvent)&&void 0!==Ot&&Ot.shiftKey?Math.abs(ht-et)>=Math.abs(St-K)?{x:it+ht-et,y:Y,width:vt,height:gt}:{x:it,y:Y+St-K,width:vt,height:gt}:{x:it+ht-et,y:Y+St-K,width:vt,height:gt};break;case"rect-top-left":var le,V,X,d,q,xt,wt,Mt;G=(null!==(le=_.mouseEvent)&&void 0!==le&&le.shiftKey||null!==(V=_.touchEvent)&&void 0!==V&&V.shiftKey)&&(null!==(X=_.mouseEvent)&&void 0!==X&&X.altKey||null!==(d=_.touchEvent)&&void 0!==d&&d.altKey)?ft>=1?{x:it+(ht-et),y:Y+(ht-et)/ft,width:vt-2*(ht-et),height:gt-2*(ht-et)/ft}:{x:it+(St-K)*ft,y:Y+(St-K),width:vt-2*(St-K)*ft,height:gt-2*(St-K)}:null!==(q=_.mouseEvent)&&void 0!==q&&q.shiftKey||null!==(xt=_.touchEvent)&&void 0!==xt&&xt.shiftKey?ft>=1?{x:it+(ht-et),y:Y+(ht-et)/ft,width:vt-(ht-et),height:gt-(ht-et)/ft}:{x:it+(St-K)*ft,y:Y+(St-K),width:vt-(St-K)*ft,height:gt-(St-K)}:null!==(wt=_.mouseEvent)&&void 0!==wt&&wt.altKey||null!==(Mt=_.touchEvent)&&void 0!==Mt&&Mt.altKey?{x:it+(ht-et),y:Y+(St-K),width:vt-2*(ht-et),height:gt-2*(St-K)}:{x:it+(ht-et),y:Y+(St-K),width:vt-(ht-et),height:gt-(St-K)};break;case"rect-top-right":var Ft,Kt,Tt,ct,$t,Z,c,F;G=(null!==(Ft=_.mouseEvent)&&void 0!==Ft&&Ft.shiftKey||null!==(Kt=_.touchEvent)&&void 0!==Kt&&Kt.shiftKey)&&(null!==(Tt=_.mouseEvent)&&void 0!==Tt&&Tt.altKey||null!==(ct=_.touchEvent)&&void 0!==ct&&ct.altKey)?ft>=1?{x:it-(ht-et),y:Y-(ht-et)/ft,width:vt+2*(ht-et),height:gt+2*(ht-et)/ft}:{x:it+(St-K)*ft,y:Y+(St-K),width:vt-2*(St-K)*ft,height:gt-2*(St-K)}:null!==($t=_.mouseEvent)&&void 0!==$t&&$t.shiftKey||null!==(Z=_.touchEvent)&&void 0!==Z&&Z.shiftKey?ft>=1?{x:it,y:Y-(ht-et)/ft,width:vt+(ht-et),height:gt+(ht-et)/ft}:{x:it,y:Y+(St-K),width:vt-(St-K)*ft,height:gt-(St-K)}:null!==(c=_.mouseEvent)&&void 0!==c&&c.altKey||null!==(F=_.touchEvent)&&void 0!==F&&F.altKey?{x:it-(ht-et),y:Y+(St-K),width:vt+2*(ht-et),height:gt-2*(St-K)}:{x:it,y:Y+(St-K),width:vt+(ht-et),height:gt-(St-K)};break;case"rect-bottom-left":var J,W,R,B,nt,P,H,mt;G=(null!==(J=_.mouseEvent)&&void 0!==J&&J.shiftKey||null!==(W=_.touchEvent)&&void 0!==W&&W.shiftKey)&&(null!==(R=_.mouseEvent)&&void 0!==R&&R.altKey||null!==(B=_.touchEvent)&&void 0!==B&&B.altKey)?ft>=1?{x:it+(ht-et),y:Y+(ht-et)/ft,width:vt-2*(ht-et),height:gt-2*(ht-et)/ft}:{x:it-(St-K)*ft,y:Y-(St-K),width:vt+2*(St-K)*ft,height:gt+2*(St-K)}:null!==(nt=_.mouseEvent)&&void 0!==nt&&nt.shiftKey||null!==(P=_.touchEvent)&&void 0!==P&&P.shiftKey?ft>=1?{x:it+(ht-et),y:Y,width:vt-(ht-et),height:gt-(ht-et)/ft}:{x:it-(St-K)*ft,y:Y,width:vt+(St-K)*ft,height:gt+(St-K)}:null!==(H=_.mouseEvent)&&void 0!==H&&H.altKey||null!==(mt=_.touchEvent)&&void 0!==mt&&mt.altKey?{x:it+(ht-et),y:Y-(St-K),width:vt-2*(ht-et),height:gt+2*(St-K)}:{x:it+(ht-et),y:Y,width:vt-(ht-et),height:gt+(St-K)};break;case"rect-bottom-right":var It,Et,Lt,Dt,Vt,Qt,Yt,ue;G=(null!==(It=_.mouseEvent)&&void 0!==It&&It.shiftKey||null!==(Et=_.touchEvent)&&void 0!==Et&&Et.shiftKey)&&(null!==(Lt=_.mouseEvent)&&void 0!==Lt&&Lt.altKey||null!==(Dt=_.touchEvent)&&void 0!==Dt&&Dt.altKey)?ft>=1?{x:it-(ht-et),y:Y-(ht-et)/ft,width:vt+2*(ht-et),height:gt+2*(ht-et)/ft}:{x:it-(St-K)*ft,y:Y-(St-K),width:vt+2*(St-K)*ft,height:gt+2*(St-K)}:null!==(Vt=_.mouseEvent)&&void 0!==Vt&&Vt.shiftKey||null!==(Qt=_.touchEvent)&&void 0!==Qt&&Qt.shiftKey?ft>=1?{x:it,y:Y,width:vt+(ht-et),height:gt+(ht-et)/ft}:{x:it,y:Y,width:vt+(St-K)*ft,height:gt+(St-K)}:null!==(Yt=_.mouseEvent)&&void 0!==Yt&&Yt.altKey||null!==(ue=_.touchEvent)&&void 0!==ue&&ue.altKey?{x:it-(ht-et),y:Y-(St-K),width:vt+2*(ht-et),height:gt+2*(St-K)}:{x:it,y:Y,width:vt+(ht-et),height:gt+(St-K)};break;default:G={x:it+ht-et,y:Y+St-K,width:vt,height:gt}}G.width<0&&(G.width=0),G.height<0&&(G.height=0),G.x=(0,u.q)(G.x),G.y=(0,u.q)(G.y),G.width=(0,u.q)(G.width),G.height=(0,u.q)(G.height),Object.assign(tt,G),Object.assign(k,(0,ot.sg)(z,tt)),(0,lt.__)(window.document.getElementById(U),k),(0,lt.hJ)(Q,E)})(K[0][0],K[0][1],et.x,et.y),Wt=!0},end:(et,K)=>{Wt&&Bt&&O.icdt.history.push([{type:"size",from:Bt,to:JSON.parse(JSON.stringify({id:U,size:tt,attribute:k}))}])}})}},2966:(ae,Rt,v)=>{v.d(Rt,{Q:()=>T});var j=v(1687),O=v(4981),ot=v(4318),C=v(6816),lt=v(4080),u=v(3423),m=v(5811);const T=M=>{let E=999999,Q=999999,U=-999999,z=-999999;null==M||M.forEach(it=>{E=Math.min(E,it.size.x),Q=Math.min(Q,it.size.y),U=Math.max(U,it.size.x+it.size.width),z=Math.max(z,it.size.y+it.size.height)});let tt=(0,lt.g1)(j.O.SELECT_GROUP,"g"),k=(0,ot.bH)(E,Q,U,z);(0,lt.yD)(tt,M,k).forEach(it=>{S(it.element,it.posType,k,M,tt)})},S=(M,E,Q,U,z)=>{let tt=!1;null==M||M.addEventListener("touchstart",k=>{tt=!0,_({touchEvent:k},E,Q,U,z)}),null==M||M.addEventListener("mousedown",k=>{if(0==k.button){if(tt)return void(tt=!1);_({mouseEvent:k},E,Q,U,z)}})},_=(M,E,Q,U,z)=>{let{x:tt,y:k,width:it,height:Y}=Q,vt=U.map(zt=>Object.assign({},zt.size)),ft=[];(0,C.A)(M,{start:zt=>{U.forEach((zt,re)=>{let{id:Wt,size:et,attribute:K}=zt;ft.push(JSON.parse(JSON.stringify({id:Wt,size:et,attribute:K})))})},move:(zt,re)=>{((zt,re,Wt,_t)=>{(()=>{let et;et="rect-center"===E?{x:tt+Wt-zt,y:k+_t-re,width:it,height:Y}:{x:tt,y:k,width:it,height:Y},(0,u.v)(O.icdt.screen.width),(0,u.v)(O.icdt.screen.height),et.width<0&&(et.width=0),et.height<0&&(et.height=0),Object.assign(Q,et),(0,lt.yD)(z,U,Q)})(),U.forEach((et,K)=>{let q,{x:ht,y:St,width:Gt,height:Ot}=vt[K],{id:le,type:V,size:X,attribute:d}=et;q="rect-center"===E?{x:ht+Wt-zt,y:St+_t-re,width:Gt,height:Ot}:{x:ht,y:St,width:Gt,height:Ot},(0,u.v)(O.icdt.screen.width),(0,u.v)(O.icdt.screen.height),q.width<0&&(q.width=0),q.height<0&&(q.height=0),q.x=(0,m.q)(q.x),q.y=(0,m.q)(q.y),q.width=(0,m.q)(q.width),q.height=(0,m.q)(q.height),Object.assign(X,q),Object.assign(d,(0,ot.sg)(V,X)),(0,lt.__)(window.document.getElementById(le),d)})})(re[0][0],re[0][1],zt.x,zt.y)},end:(zt,re)=>{ft.length&&O.icdt.history.push(U.map((zt,re)=>{let{id:Wt,size:et,attribute:K}=zt;return{type:"size",from:ft[re],to:JSON.parse(JSON.stringify({id:Wt,size:et,attribute:K}))}}))}})}},5226:(ae,Rt,v)=>{v.d(Rt,{E:()=>z,T:()=>tt});var j=v(1687),O=v(8619),ot=v(8785),C=v(2282),lt=v(8054),u=v(4921),m=v(6358),T=v(9054),S=v(8419),_=v(1105),M=v(2875),E=v(7210),Q=v(4981),U=v(4080);const z=(k,it,Y)=>{var vt;if(it&&!(null!=Y?Y:window).document.getElementById(it))return;if("localhost"==location.hostname&&console.log("aaaaaaaaaaaaaaa s\u1ee3 qu\xe1 \u0111iiiiiiiiiiiiiiiiiiiiiiiiiii!",it),it){let ft=(null!=Y?Y:window).document.getElementById(it);jQuery(ft).find("#"+j.O.BACKGROUND_GROUP).empty();let G=(0,U.g1)(j.O.BACKGROUND_GROUP,"g",void 0,ft);(0,U.x0)(G,k)}else{jQuery(Q.icdt.target).find("#"+j.O.BACKGROUND_GROUP).empty();let ft=(0,U.g1)(j.O.BACKGROUND_GROUP,"g",void 0,Q.icdt.target);(0,U.x0)(ft,k)}let gt=(ft,G)=>{G=G?`${it}-${G}`:it,null==ft||ft.forEach(kt=>{let Bt=it?`${it}-${kt.id}`:kt.id;var zt;if(kt.isdeleted)null===(zt=(null!=Y?Y:window).document.getElementById(Bt))||void 0===zt||zt.remove();else switch(kt.type){case T.$.GROUP:(0,m.m)(Bt,{},G?(null!=Y?Y:window).document.getElementById(G):null),gt(kt.nodes,kt.id);break;case T.$.CIRCLE:(0,O._)(Bt,{size:kt.size,attribute:kt.attribute},G?(null!=Y?Y:window).document.getElementById(G):null);break;case T.$.ELLIPSE:(0,ot.r)(Bt,{size:kt.size,attribute:kt.attribute},G?(null!=Y?Y:window).document.getElementById(G):null);break;case T.$.LINE:(0,u.W)(Bt,{size:kt.size,attribute:kt.attribute},G?(null!=Y?Y:window).document.getElementById(G):null);break;case T.$.RECT:(0,lt.f)(Bt,{size:kt.size,attribute:kt.attribute},G?(null!=Y?Y:window).document.getElementById(G):null);break;case T.$.POLYGON:(0,C.l)(Bt,{size:kt.size,attribute:kt.attribute},G?(null!=Y?Y:window).document.getElementById(G):null);break;case T.$.FOREIGNOBJECT:(0,M.e)(Bt,{size:kt.size,attribute:kt.attribute,style:kt.style,source:kt.source},G?(null!=Y?Y:window).document.getElementById(G):null);break;case T.$.IMAGE:(0,E.G)(Bt,{size:kt.size,attribute:kt.attribute,source:kt.source},G?(null!=Y?Y:window).document.getElementById(G):null);break;case T.$.TEXT:(0,_.$)(Bt,{size:kt.size,attribute:kt.attribute,source:kt.source},G?(null!=Y?Y:window).document.getElementById(G):null);break;case T.$.PATH:(0,S.G)(Bt,{size:kt.size,attribute:kt.attribute},G?(null!=Y?Y:window).document.getElementById(G):null)}})};gt(null==k||null===(vt=k.svg)||void 0===vt?void 0:vt.nodes)},tt=(k,it)=>{var Y;if(it&&!window.document.getElementById(it))return;let vt=(gt,ft)=>{ft=ft?`${it}-${ft}`:it,null==gt||gt.forEach(G=>{jQuery("#"+(it?`${it}-${G.id}`:G.id)).appendTo(ft?window.document.getElementById(ft):Q.icdt.target),G.type==T.$.GROUP&&vt(G.nodes,G.id)})};vt(null==k||null===(Y=k.svg)||void 0===Y?void 0:Y.nodes)}},8619:(ae,Rt,v)=>{v.d(Rt,{_:()=>lt});var j=v(9054),O=v(4981),ot=v(4318),C=v(4080);const lt=(u,m,T)=>{let S=(null==m?void 0:m.size)||{x:0,y:0,width:10,height:10},_=(null==m?void 0:m.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(_,(0,ot.sg)(j.$.CIRCLE,S)),{nodeId:u,element:(0,C.it)(u,j.$.CIRCLE,"circle",{size:S,attribute:_},T),size:S,attribute:_}}},8785:(ae,Rt,v)=>{v.d(Rt,{r:()=>lt});var j=v(9054),O=v(4981),ot=v(4318),C=v(4080);const lt=(u,m,T)=>{let S=(null==m?void 0:m.size)||{x:0,y:0,width:10,height:10},_=(null==m?void 0:m.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(_,(0,ot.sg)(j.$.ELLIPSE,S)),{nodeId:u,element:(0,C.it)(u,j.$.ELLIPSE,"ellipse",{size:S,attribute:_},T),size:S,attribute:_}}},2875:(ae,Rt,v)=>{v.d(Rt,{e:()=>C});var j=v(9054),O=v(4318),ot=v(4080);const C=(lt,u,m)=>{let T=(null==u?void 0:u.size)||{x:0,y:0,width:180,height:180},S=(null==u?void 0:u.attribute)||{};Object.assign(S,(0,O.sg)(j.$.FOREIGNOBJECT,T));let _=(null==u?void 0:u.source)||{type:"html",html:{htmlContent:'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>'}},M=(null==u?void 0:u.style)||{};return{nodeId:lt,element:(0,ot.it)(lt,j.$.FOREIGNOBJECT,"foreignObject",{size:T,attribute:S,style:M,source:_},m),size:T,attribute:S,style:M,source:_}}},6358:(ae,Rt,v)=>{v.d(Rt,{m:()=>C});var j=v(9054),O=v(4318),ot=v(4080);const C=(u,m,T)=>{let S=(null==m?void 0:m.size)||{x:0,y:0,width:10,height:10},_=(null==m?void 0:m.attribute)||{};return Object.assign(_,(0,O.sg)(j.$.GROUP,S)),{nodeId:u,element:(0,ot.it)(u,j.$.GROUP,"g",{size:S,attribute:_},T),size:S,attribute:_}}},7210:(ae,Rt,v)=>{v.d(Rt,{G:()=>C});var j=v(9054),O=v(4318),ot=v(4080);const C=(lt,u,m)=>{let T=(null==u?void 0:u.size)||{x:0,y:0,width:100,height:100},S=(null==u?void 0:u.attribute)||{preserveAspectRatio:"none"};Object.assign(S,(0,O.sg)(j.$.IMAGE,T));let _=(null==u?void 0:u.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:lt,element:(0,ot.it)(lt,j.$.IMAGE,"image",{size:T,attribute:S,source:_},m),size:T,attribute:S,source:_}}},4921:(ae,Rt,v)=>{v.d(Rt,{W:()=>lt});var j=v(9054),O=v(4981),ot=v(4318),C=v(4080);const lt=(u,m,T)=>{let S=(null==m?void 0:m.size)||{x:0,y:0,width:10,height:10},_=(null==m?void 0:m.attribute)||{stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth,strokeLinecap:O.icdt.attribute.strokeLinecap};return Object.assign(_,(0,ot.sg)(j.$.LINE,S)),{nodeId:u,element:(0,C.it)(u,j.$.LINE,"line",{size:S,attribute:_},T),size:S,attribute:_}}},8419:(ae,Rt,v)=>{v.d(Rt,{G:()=>lt});var j=v(9054),O=v(4981),ot=v(4318),C=v(4080);const lt=(u,m,T)=>{let S=(null==m?void 0:m.size)||{x:0,y:0,width:10,height:10},_=(null==m?void 0:m.attribute)||{stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(_,(0,ot.sg)(j.$.PATH,S)),{nodeId:u,element:(0,C.it)(u,j.$.PATH,"path",{size:S,attribute:_},T),size:S,attribute:_}}},2282:(ae,Rt,v)=>{v.d(Rt,{l:()=>lt});var j=v(9054),O=v(4981),ot=v(4318),C=v(4080);const lt=(u,m,T)=>{let S=(null==m?void 0:m.size)||{x:0,y:0,width:10,height:10},_=(null==m?void 0:m.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(_,(0,ot.sg)(j.$.POLYGON,S)),{nodeId:u,element:(0,C.it)(u,j.$.POLYGON,"polygon",{size:S,attribute:_},T),size:S,attribute:_}}},8054:(ae,Rt,v)=>{v.d(Rt,{f:()=>lt});var j=v(9054),O=v(4981),ot=v(4318),C=v(4080);const lt=(u,m,T)=>{let S=(null==m?void 0:m.size)||{x:0,y:0,width:10,height:10},_=(null==m?void 0:m.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(_,(0,ot.sg)(j.$.RECT,S)),{nodeId:u,element:(0,C.it)(u,j.$.RECT,"rect",{size:S,attribute:_},T),size:S,attribute:_}}},1105:(ae,Rt,v)=>{v.d(Rt,{$:()=>lt});var j=v(9054),O=v(4981),ot=v(4318),C=v(4080);const lt=(u,m,T)=>{let S=(null==m?void 0:m.size)||{x:0,y:0,width:100,height:50},_=(null==m?void 0:m.attribute)||{fill:O.icdt.attribute.stroke,fontFamily:O.icdt.attribute.fontFamily,fontSize:O.icdt.attribute.fontSize,textLength:O.icdt.attribute.textLength};Object.assign(_,(0,ot.sg)(j.$.TEXT,S));let M=(null==m?void 0:m.source)||{type:"text",text:{textContent:"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!"}};return{nodeId:u,element:(0,C.it)(u,j.$.TEXT,"text",{size:S,attribute:_,source:M},T),size:S,attribute:_,source:M}}},4318:(ae,Rt,v)=>{v.d(Rt,{bH:()=>O,sg:()=>ot});var j=v(9054);const O=(lt,u,m,T,S)=>{let _={x:Math.min(lt,m),y:Math.min(u,T),width:Math.abs(m-lt)||1,height:Math.abs(T-u)||1};return null!=S&&S.ratio&&(_.width<=_.height?_.height=_.width*(null==S?void 0:S.ratio):_.width=_.height/(null==S?void 0:S.ratio)),Object.assign(_,{ratios:(null==S?void 0:S.ratios)||[[(lt-_.x)/(_.width||1),(u-_.y)/(_.height||1)],[(m-_.x)/(_.width||1),(T-_.y)/(_.height||1)]]}),null!=S&&S.points&&(_.points=null==S?void 0:S.points),_},ot=(lt,u,m)=>{var T=(()=>{switch(lt){case j.$.CIRCLE:return{cx:u.x+u.width/2,cy:u.y+u.height/2,r:Math.min(u.width/2,u.height/2)};case j.$.ELLIPSE:return{cx:u.x+u.width/2,cy:u.y+u.height/2,rx:u.width/2,ry:u.height/2};case j.$.LINE:{var S;let E={};return null===(S=u.ratios)||void 0===S||S.forEach((Q,U)=>{E[`x${U+1}`]=u.x+u.width*Q[0],E[`y${U+1}`]=u.y+u.height*Q[1]}),E}case j.$.RECT:return{x:u.x,y:u.y,width:u.width,height:u.height};case j.$.POLYGON:var _;return{points:((null===(_=u.ratios)||void 0===_?void 0:_.map(E=>[u.x+u.width*E[0],u.y+u.height*E[1]]))||[]).map(E=>E.join(" ")).join(",")};case j.$.FOREIGNOBJECT:case j.$.IMAGE:return{x:u.x,y:u.y,width:u.width,height:u.height};case j.$.TEXT:return{x:u.x,y:u.y};case j.$.PATH:{var M;let E=null!==(M=u.points)&&void 0!==M?M:[];return E.length?{d:`M ${E[0][0]} ${E[0][1]} L `+(E.map(Q=>[Q[0],Q[1]])||[]).map(Q=>Q.join(" ")).join(" ")}:{d:""}}}return{}})();return u.rotate?(T.transform=`rotate(${u.rotate})`,T.transformOrigin=`${u.x+u.width/2} ${u.y+u.height/2}`):(T.transform=null,T.transformOrigin=null),T}},5811:(ae,Rt,v)=>{v.d(Rt,{q:()=>j});const j=(O,ot)=>{var C;return ot=null!==(C=ot)&&void 0!==C?C:100,Math.round((O+Number.EPSILON)*ot)/ot}},3423:(ae,Rt,v)=>{v.d(Rt,{v:()=>ot});var j=v(4981),O=v(5811);const ot=C=>(0,O.q)(C/j.icdt.screen.scale)},3385:(ae,Rt,v)=>{v.d(Rt,{Vs:()=>T,co:()=>u,k6:()=>lt,lO:()=>m,mr:()=>S});var j=v(4981),O=v(4080),ot=v(4318),C=v(5811);const lt=(_,M)=>{let{id:E,type:Q,size:U,attribute:z}=_,tt=JSON.parse(JSON.stringify({id:E,size:U,attribute:z}));U.x=(0,C.q)(M),Object.assign(z,(0,ot.sg)(Q,U)),(0,O.__)(window.document.getElementById(E),z),j.icdt.history.push([{type:"size",from:tt,to:JSON.parse(JSON.stringify({id:E,size:U,attribute:z}))}])},u=(_,M)=>{let{id:E,type:Q,size:U,attribute:z}=_,tt=JSON.parse(JSON.stringify({id:E,size:U,attribute:z}));U.y=(0,C.q)(M),Object.assign(z,(0,ot.sg)(Q,U)),(0,O.__)(window.document.getElementById(E),z),j.icdt.history.push([{type:"size",from:tt,to:JSON.parse(JSON.stringify({id:E,size:U,attribute:z}))}])},m=(_,M,E)=>{let{id:Q,type:U,size:z,attribute:tt}=_,k=JSON.parse(JSON.stringify({id:Q,size:z,attribute:tt}));E&&(z.height=(0,C.q)(M*z.height/z.width)),z.width=(0,C.q)(M),Object.assign(tt,(0,ot.sg)(U,z)),(0,O.__)(window.document.getElementById(Q),tt),j.icdt.history.push([{type:"size",from:k,to:JSON.parse(JSON.stringify({id:Q,size:z,attribute:tt}))}])},T=(_,M,E)=>{let{id:Q,type:U,size:z,attribute:tt}=_,k=JSON.parse(JSON.stringify({id:Q,size:z,attribute:tt}));E&&(z.width=(0,C.q)(M*z.width/z.height)),z.height=(0,C.q)(M),Object.assign(tt,(0,ot.sg)(U,z)),(0,O.__)(window.document.getElementById(Q),tt),j.icdt.history.push([{type:"size",from:k,to:JSON.parse(JSON.stringify({id:Q,size:z,attribute:tt}))}])},S=(_,M)=>{let{id:E,type:Q,size:U,attribute:z}=_,tt=JSON.parse(JSON.stringify({id:E,size:U,attribute:z}));U.rotate=(0,C.q)(M),Object.assign(z,(0,ot.sg)(Q,U)),(0,O.__)(window.document.getElementById(E),z),j.icdt.history.push([{type:"size",from:tt,to:JSON.parse(JSON.stringify({id:E,size:U,attribute:z}))}])}},6816:(ae,Rt,v)=>{v.d(Rt,{A:()=>u});var j=v(968),O=v(4981);class ot{constructor(T){this._points=[],this._options=T}start(T){this._points.length=0,this._points.push([T.x,T.y]),this._options.start(T)}move(T){this._points.push([T.x,T.y]),this._options.move(T,this._points)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(T=this._points[0])[0],y:T[1]}:{x:0,y:0};var T}get offsetLast(){return this._points.length>=1?{x:(T=this._points[this._points.length-1])[0],y:T[1]}:{x:0,y:0};var T}}var C=v(7797);const u=(m,T,S,_,M)=>{var E,Q,U;let z=null,tt=0,k=0;m.mouseEvent?(z=m.mouseEvent.target,tt=m.mouseEvent.offsetX,k=m.mouseEvent.offsetY):m.touchEvent&&(z=m.touchEvent.target,m.touchEvent.touches.length&&(tt=m.touchEvent.touches[0].clientX,k=m.touchEvent.touches[0].clientY));let it=null!=S?S:O.icdt.screen.scale,Y=null!=_?_:O.icdt.screen.dislocation,vt=null!=M?M:O.icdt.screen.offset,gt=()=>{};var ft=new ot({start:null!==(E=null==T?void 0:T.start)&&void 0!==E?E:gt,move:null!==(Q=null==T?void 0:T.move)&&void 0!==Q?Q:gt,end:null!==(U=null==T?void 0:T.end)&&void 0!==U?U:gt});m.mouseEvent?ft.start((0,C.p)({x:tt,y:k},it,Y,{x:0,y:0})):m.touchEvent&&ft.start((0,C.p)({x:tt,y:k},it,Y,vt));let G=et=>{ft.move((0,C.p)({x:et.clientX,y:et.clientY},it,Y,vt))},kt=et=>{ft.end(),[j._.SHAPE,j._.FOREIGNOBJECT,j._.IMAGE,j._.TEXT].includes(O.icdt.pointer.pointer_type)&&(et.shiftKey||(O.icdt.pointer.pointer_type=j._.POINTER))},Bt=et=>{et.touches.length&&G({clientX:et.touches[0].clientX,clientY:et.touches[0].clientY})},zt=et=>{kt({shiftKey:et.shiftKey,ctrlKey:et.ctrlKey,altKey:et.altKey}),window.removeEventListener("touchmove",Bt,!1),window.removeEventListener("touchend",zt,!1)},re=et=>{0==et.button&&G({clientX:et.clientX,clientY:et.clientY})},Wt=et=>{0==et.button&&(kt({shiftKey:et.shiftKey,ctrlKey:et.ctrlKey,altKey:et.altKey}),window.removeEventListener("mousemove",re,!1),window.removeEventListener("mouseup",Wt,!1))};if(m.mouseEvent)window.addEventListener("mousemove",re,!1),window.addEventListener("mouseup",Wt,!1);else if(m.touchEvent){var _t;window.addEventListener("touchmove",Bt,!1),window.addEventListener("touchend",zt,!1),null===(_t=z)||void 0===_t||_t.addEventListener("touchmove",function(et){et.preventDefault()})}}},7797:(ae,Rt,v)=>{v.d(Rt,{p:()=>O});var j=v(5811);const O=(ot,C,lt,u)=>(ot.x-=u.x,ot.y-=u.y,ot.x/=C,ot.y/=C,ot.x-=lt.x,ot.y-=lt.y,ot.x=(0,j.q)(ot.x),ot.y=(0,j.q)(ot.y),ot)},70:(ae,Rt,v)=>{v.d(Rt,{$:()=>ct,U:()=>$t});var j=v(1687),O=v(4981),ot=v(9054),C=v(5973),lt=v(2336),u=v(861),m=v(157),T=v(4787),_=v(1105),M=v(6358);var tt=v(7267),k=v(7210),it=v(5811);const Y=(Z,c,F)=>{var J,W,R,B;let nt=1,P=new Image;P.onload=()=>{var H,mt,It,Et;nt=(0,it.q)(P.naturalWidth/P.naturalHeight,100);let Lt=0,Dt=0,Vt=0,Qt=0;var Yt,ue,be,ce;nt>=1?(Vt=Math.min(P.naturalWidth,null!==(Yt=null===(ue=ct.slide.svg)||void 0===ue||null===(ue=ue.viewBox)||void 0===ue?void 0:ue.width)&&void 0!==Yt?Yt:0),Qt=Vt/nt):(Qt=Math.min(P.naturalHeight,null!==(be=null===(ce=ct.slide.svg)||void 0===ce||null===(ce=ce.viewBox)||void 0===ce?void 0:ce.height)&&void 0!==be?be:0),Vt=Qt/nt),Lt=((null!==(H=null===(mt=ct.slide.svg)||void 0===mt||null===(mt=mt.viewBox)||void 0===mt?void 0:mt.width)&&void 0!==H?H:0)-Vt)/2,Dt=((null!==(It=null===(Et=ct.slide.svg)||void 0===Et||null===(Et=Et.viewBox)||void 0===Et?void 0:Et.height)&&void 0!==It?It:0)-Qt)/2,c.size={x:Lt,y:Dt,width:Vt,height:Qt},vt(c,F)},P.onerror=H=>{console.error(`ImgSrc load failed -> ${JSON.stringify(c.source)}`,H)},P.src=(null!==(J=c.source)&&void 0!==J&&J.path?(null===(W=O.icdt.config)||void 0===W?void 0:W.readfileuploadurl)+(null===(R=c.source)||void 0===R?void 0:R.path):null===(B=c.source)||void 0===B?void 0:B.url)||""},vt=(Z,c)=>{if(Z.slideStatus!=ct.slideStatus)return void c();let{element:F}=(0,k.G)(Math.ceil(1e9*Math.random()),{size:Z.size,source:{type:"image",image:null==Z?void 0:Z.source}});setTimeout(()=>{null==F||F.remove(),c()},3e3)};var gt=v(4080);const ft=(Z,c,F)=>{var J,W,R,B;let nt=new Image;nt.onload=()=>{G(Z,{width:nt.naturalWidth,height:nt.naturalHeight},c,F)},nt.onerror=P=>{console.error(`ImgSrc load failed -> ${JSON.stringify(c.source)}`,P),F()},nt.src=(null!==(J=c.source)&&void 0!==J&&J.path?(null===(W=O.icdt.config)||void 0===W?void 0:W.readfileuploadurl)+(null===(R=c.source)||void 0===R?void 0:R.path):null===(B=c.source)||void 0===B?void 0:B.url)||""},G=(Z,c,F,J)=>{if(F.slideStatus!=ct.slideStatus)return void J();let W=(0,it.q)(c.width/c.height,100),R=0,B=0,nt=0,P=0;W>=1?(nt=c.width,nt=Math.max(nt,40),nt=Math.min(nt,40),P=nt/W):(P=c.height,P=Math.max(P,40),P=Math.min(P,40),nt=P/W);let{size:It}=Z;R=It.x+It.width-nt/2,B=It.y-P/2;let Et=(0,gt.g1)(j.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,k.G)(`icon-${Z.id}`,{size:{x:R,y:B,width:nt,height:P},source:{type:"image",image:null==F?void 0:F.source}},Et),setTimeout(()=>{J()},3e3)},kt=(Z,c,F)=>{var J,W,R,B,nt,P,H;if(c.slideStatus!=ct.slideStatus)return void F();if(!(null!==(J=c.source)&&void 0!==J&&J.path||null!==(W=c.source)&&void 0!==W&&W.url))return console.warn(`${Z.id} -> audio no source!`),void F();var mt=jQuery("#"+Z.id);let It=null!==(R=c.iteration)&&void 0!==R?R:0;if(It<0&&(F(),F=function(){}),!(mt.data("audio-running")&&It<0)){mt.data("audio-running",!0);var Et=new Audio;return Et.autoplay=!0,Et.loop=0!=It,Et.preload="auto",Et.controls=!0,Et.setAttributeNode(document.createAttribute("playsinline")),Et.addEventListener("canplay",function(){var Lt=Et.play();Lt&&Lt.then(function(Dt){mt.data("audio-running",!0)}).catch(function(Dt){mt.data("audio-running",!1),c.slideStatus===ct.slideStatus&&F()})}),Et.addEventListener("timeupdate",function(){var Dt;c.slideStatus!==ct.slideStatus&&((Dt=this).pause(),Dt.remove(),mt.data("audio-running",!1))}),Et.addEventListener("canplaythrough",function(){this.loop&&(It>0?It--:0==It&&(this.loop=!1))}),Et.addEventListener("play",function(){}),Et.addEventListener("pause",function(){}),Et.addEventListener("ended",function(){this.remove(),mt.data("audio-running",!1),c.slideStatus===ct.slideStatus&&F()}),Et.onerror=function(){this.remove(),mt.data("audio-running",!1),c.slideStatus===ct.slideStatus&&F()},Et.src=(null!==(B=c.source)&&void 0!==B&&B.path?(null===(nt=O.icdt.config)||void 0===nt?void 0:nt.readfileuploadurl)+(null===(P=c.source)||void 0===P?void 0:P.path):null===(H=c.source)||void 0===H?void 0:H.url)||"",Et}};var Bt=v(9942);const ht=(Z,c,F)=>{var J;null===(J=c.test)||void 0===J||null===(J=J.answer)||void 0===J||null===(J=J.matching)||void 0===J||J.filter(W=>W.value==F.key).forEach(W=>W.value="")},Gt=(Z,c,F,J,W,R)=>{var B,nt,P,H,mt,It,Et,Lt,Dt,Vt,Qt,Yt;W.iscorrect?(null!==(B=c.test)&&void 0!==B&&null!==(B=B.audiotrue)&&void 0!==B&&B.path&&kt(Z,{source:(0,Bt.I)(null===(H=c.test)||void 0===H?void 0:H.audiotrue),iteration:0,nodeStatus:F,slideStatus:J},R),null!==(nt=c.test)&&void 0!==nt&&null!==(nt=nt.icontrue)&&void 0!==nt&&nt.path&&ft(Z,{source:(0,Bt.I)(null===(mt=c.test)||void 0===mt?void 0:mt.icontrue),iteration:0,nodeStatus:F,slideStatus:J},R),null!==(P=c.test)&&void 0!==P&&null!==(P=P.effecttrue)&&void 0!==P&&P.path&&Y(0,{source:(0,Bt.I)(null===(It=c.test)||void 0===It?void 0:It.effecttrue),iteration:0,nodeStatus:F,slideStatus:J},R)):(null!==(Et=c.test)&&void 0!==Et&&null!==(Et=Et.audiofalse)&&void 0!==Et&&Et.path&&kt(Z,{source:(0,Bt.I)(null===(Vt=c.test)||void 0===Vt?void 0:Vt.audiofalse),iteration:0,nodeStatus:F,slideStatus:J},R),null!==(Lt=c.test)&&void 0!==Lt&&null!==(Lt=Lt.iconfalse)&&void 0!==Lt&&Lt.path&&ft(Z,{source:(0,Bt.I)(null===(Qt=c.test)||void 0===Qt?void 0:Qt.iconfalse),iteration:0,nodeStatus:F,slideStatus:J},R),null!==(Dt=c.test)&&void 0!==Dt&&null!==(Dt=Dt.effectfalse)&&void 0!==Dt&&Dt.path&&Y(0,{source:(0,Bt.I)(null===(Yt=c.test)||void 0===Yt?void 0:Yt.effectfalse),iteration:0,nodeStatus:F,slideStatus:J},R))},Ot=(Z,c,F,J)=>{var W,R,B,nt,P,H,It,Lt,Et;null!==(W=c.animate)&&void 0!==W&&W.value&&(0,tt.Z)(c,F.nodeStatus,F.slideStatus),null!==(R=c.interactive)&&void 0!==R&&R.show?((Z,c,F,J)=>{var W,R,B;console.log("icdt_Run_Interactive_NodeShow",Z,c,F);let nt={total:0,counter:0},{triggershow:P,triggerrun:H,triggerhide:mt,action:It,audio:Et}=null!==(W=null===(R=Z.interactive)||void 0===R?void 0:R.show)&&void 0!==W?W:{};if(P){let{id:Dt,ids:Vt,time:Qt,async:Yt}=P;"asynctrue"==Yt?setTimeout(()=>{(0,T.L5)({id:Dt,ids:Vt,nodeStatus:c,slideStatus:F})}):"time"==Yt&&setTimeout(()=>{(0,T.L5)({id:Dt,ids:Vt,nodeStatus:c,slideStatus:F})},1e3*(null!=Qt?Qt:0))}if(H){let{id:Dt,ids:Vt,time:Qt,async:Yt}=H;"asynctrue"==Yt?setTimeout(()=>{(0,T.Ar)({id:Dt,ids:Vt,nodeStatus:c,slideStatus:F})}):"time"==Yt&&setTimeout(()=>{(0,T.Ar)({id:Dt,ids:Vt,nodeStatus:c,slideStatus:F})},1e3*(null!=Qt?Qt:0))}if(mt){let{id:Dt,ids:Vt,time:Qt,async:Yt}=mt;"asynctrue"==Yt?setTimeout(()=>{(0,T.WT)({id:Dt,ids:Vt,nodeStatus:c,slideStatus:F})}):"time"==Yt&&setTimeout(()=>{(0,T.WT)({id:Dt,ids:Vt,nodeStatus:c,slideStatus:F})},1e3*(null!=Qt?Qt:0))}let Lt=()=>{setTimeout(()=>{if(nt.counter>=nt.total){if(J&&J(),P){let{id:Dt,ids:Vt,async:Qt}=P;(!Qt||"asyncfalse"==Qt)&&(0,T.L5)({id:Dt,ids:Vt,nodeStatus:c,slideStatus:F})}if(H){let{id:Dt,ids:Vt,async:Qt}=H;(!Qt||"asyncfalse"==Qt)&&(0,T.Ar)({id:Dt,ids:Vt,nodeStatus:c,slideStatus:F})}if(mt){let{id:Dt,ids:Vt,async:Qt}=mt;(!Qt||"asyncfalse"==Qt)&&(0,T.WT)({id:Dt,ids:Vt,nodeStatus:c,slideStatus:F})}}})};if(null!=It&&It.value){nt.total+=1;let Dt=()=>{nt.counter+=1,Lt()};switch(null==It?void 0:It.value){case"hide":jQuery("#"+Z.id).addClass("hide"),Dt();break;case"points":{let{points:Vt,time:Qt,iteration:Yt,finish:ue}=It;(0,u.G)(Z.id,{node:Z,points:Vt,time:Qt,iteration:Yt,finish:ue,nodeStatus:c,slideStatus:F},Dt);break}default:{let{value:Vt,time:Qt,iteration:Yt,finish:ue}=It;(0,lt.Q)(Z.id,{node:Z,value:Vt,time:Qt,iteration:Yt,finish:ue,nodeStatus:c,slideStatus:F},Dt);break}}}if(null!=Et&&null!==(B=Et.source)&&void 0!==B&&B.path){nt.total+=1;let Dt=()=>{nt.counter+=1,Lt()};(0,m.R)(Z.id,Et,nt,{nodeStatus:c,slideStatus:F},Dt)}nt.total||Lt()})(c,F.nodeStatus,F.slideStatus,J):J&&J(),null!==(B=c.interactive)&&void 0!==B&&B.click&&(Lt=null===(It=c.interactive)||void 0===It?void 0:It.click,Object.keys(null!=Lt?Lt:{}).map(Vt=>Lt[Vt]?1:0).includes(1)&&jQuery("#"+c.id).addClass("interactive-click"),jQuery("#"+c.id).click(Lt=>{Lt.preventDefault(),F.nodeStatus=ct.refreshNodeStatus(),(0,C.F)(c,F.nodeStatus,F.slideStatus)})),null!==(nt=c.variable)&&void 0!==nt&&nt.input&&jQuery("#"+c.id).on("change","input,textarea",Lt=>{Lt.preventDefault(),((Z,c,F)=>{var J,W;O.icdt.variable.setValue(null!==(J=null===(W=c.variable)||void 0===W||null===(W=W.input)||void 0===W?void 0:W.variable)&&void 0!==J?J:"",Z),(Z=>{var c;let F=(J,W)=>{null==J||J.forEach(R=>{switch(R.type){case ot.$.GROUP:(0,M.m)(R.id,{},W?window.document.getElementById(W):null),F(R.nodes,R.id);break;case ot.$.POLYGON:break;case ot.$.TEXT:(0,_.$)(R.id,{size:R.size,attribute:R.attribute,source:R.source},W?window.document.getElementById(W):null)}})};F(null===(c=Z.svg)||void 0===c?void 0:c.nodes)})(F)})(Lt.target.value,c,Z)}),null!==(P=c.variable)&&void 0!==P&&P.click&&(null!==(Et=c.variable)&&void 0!==Et&&null!==(Et=Et.click)&&void 0!==Et&&Et.variable&&jQuery("#"+c.id).addClass("variable-click"),jQuery("#"+c.id).click(Lt=>{Lt.preventDefault(),((Z,c)=>{var F;O.icdt.variable.setValueOperator(null===(F=Z.variable)||void 0===F?void 0:F.click),(Z=>{var c;let F=(J,W)=>{null==J||J.forEach(R=>{switch(R.type){case ot.$.GROUP:(0,M.m)(R.id,{},W?window.document.getElementById(W):null),F(R.nodes,R.id);break;case ot.$.POLYGON:break;case ot.$.TEXT:(0,_.$)(R.id,{size:R.size,attribute:R.attribute,source:R.source},W?window.document.getElementById(W):null)}})};F(null===(c=Z.svg)||void 0===c?void 0:c.nodes)})(c)})(c,Z)})),"test"==(null===(H=c.source)||void 0===H?void 0:H.type)&&((Z,c)=>{var F;let J=()=>{};switch(null===(F=Z.source)||void 0===F||null===(F=F.test)||void 0===F?void 0:F.type){case"truefalse":var W;if(jQuery("#"+Z.id).click(P=>{P.preventDefault(),((Z,c,F,J,W)=>{var R,B;let nt=null===(R=Z.source)||void 0===R||null===(R=R.test)||void 0===R||null===(R=R.truefalse)||void 0===R?void 0:R.iscorrect;if(null!==(B=c.svg)&&void 0!==B&&B.nodes.find(P=>{var H;return"submit"==(null===(H=P.source)||void 0===H||null===(H=H.test)||void 0===H?void 0:H.type)})||Gt(Z,c,F,J,{iscorrect:nt},W),c.test?c.test.answer?c.test.answer.truefalse={value:Z.id,iscorrect:nt}:c.test.answer={truefalse:{value:Z.id,iscorrect:nt}}:c.test={answer:{truefalse:{value:Z.id,iscorrect:nt}}},c.test.showselection){let P=(0,gt.g1)(j.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,gt.Yw)(P,c)}console.log("node source ->",Z.source),console.log("slide test ->",c.test)})(Z,c,ct.nodeStatus,ct.slideStatus,J)}),null!==(W=c.test)&&void 0!==W&&W.showselection){let P=(0,gt.g1)(j.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,gt.Yw)(P,c)}break;case"singlechoice":var R;if(jQuery("#"+Z.id).click(P=>{P.preventDefault(),((Z,c,F,J,W)=>{var R,B;let nt=null===(R=Z.source)||void 0===R||null===(R=R.test)||void 0===R||null===(R=R.singlechoice)||void 0===R?void 0:R.iscorrect;if(null!==(B=c.svg)&&void 0!==B&&B.nodes.find(P=>{var H;return"submit"==(null===(H=P.source)||void 0===H||null===(H=H.test)||void 0===H?void 0:H.type)})||Gt(Z,c,F,J,{iscorrect:nt},W),c.test?c.test.answer?c.test.answer.singlechoice={value:Z.id,iscorrect:nt}:c.test.answer={singlechoice:{value:Z.id,iscorrect:nt}}:c.test={answer:{singlechoice:{value:Z.id,iscorrect:nt}}},c.test.showselection){let P=(0,gt.g1)(j.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,gt.Yw)(P,c)}console.log("node source ->",Z.source),console.log("slide test ->",c.test)})(Z,c,ct.nodeStatus,ct.slideStatus,J)}),null!==(R=c.test)&&void 0!==R&&R.showselection){let P=(0,gt.g1)(j.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,gt.Yw)(P,c)}break;case"multichoice":var B;if(jQuery("#"+Z.id).click(P=>{P.preventDefault(),((Z,c,F,J,W)=>{var R,B;let P,nt=null===(R=Z.source)||void 0===R||null===(R=R.test)||void 0===R||null===(R=R.multichoice)||void 0===R?void 0:R.iscorrect;if(null!==(B=c.svg)&&void 0!==B&&B.nodes.find(H=>{var mt;return"submit"==(null===(mt=H.source)||void 0===mt||null===(mt=mt.test)||void 0===mt?void 0:mt.type)})||Gt(Z,c,F,J,{iscorrect:nt},W),c.test?c.test.answer?c.test.answer.multichoice?c.test.answer.multichoice.find(H=>H.value==Z.id)?(c.test.answer.multichoice=c.test.answer.multichoice.filter(H=>H.value!=Z.id),P=!0):c.test.answer.multichoice.push({value:Z.id,iscorrect:nt}):c.test.answer.multichoice=[{value:Z.id,iscorrect:nt}]:c.test.answer={multichoice:[{value:Z.id,iscorrect:nt}]}:c.test={answer:{multichoice:[{value:Z.id,iscorrect:nt}]}},c.test.showselection){let H=(0,gt.g1)(j.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,gt.Yw)(H,c)}console.log("node source ->",Z.source),console.log("slide test ->",c.test)})(Z,c,ct.nodeStatus,ct.slideStatus,J)}),null!==(B=c.test)&&void 0!==B&&B.showselection){let P=(0,gt.g1)(j.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,gt.Yw)(P,c)}break;case"fill":var nt;jQuery("#"+Z.id).on("keyup",'input[type="text"]',P=>{var H;let mt=jQuery("<div/>").css({"font-size":jQuery(P.target).css("font-size"),visibility:"hidden",float:"left"}).text(P.target.value).appendTo(window.document.body);jQuery(P.target).css({width:(null!==(H=mt.width())&&void 0!==H?H:0)+30})}).on("keypress",'input[type="text"]',P=>{13===(P.keyCode||P.charCode||P.which)&&(P.preventDefault(),P.stopPropagation(),jQuery(P.target).blur())}).on("change",'input[type="text"]',P=>{var H,mt;let It=ct.nodeStatus,Et=ct.slideStatus,Lt=null===(H=P.target)||void 0===H?void 0:H.getAttribute("data-key"),Dt=null===(mt=P.target)||void 0===mt||null===(mt=mt.value)||void 0===mt?void 0:mt.trim();((Z,c,F,J,W,R)=>{var B,nt,P,H;let{value:mt}=null!==(B=null===(nt=Z.source)||void 0===nt||null===(nt=nt.test)||void 0===nt||null===(nt=nt.fill)||void 0===nt?void 0:nt.find(Et=>Et.key==`[[${W.key}]]`))&&void 0!==B?B:{},It=mt&&mt.map(Et=>null==Et?void 0:Et.toLocaleLowerCase()).includes(null===(P=W.value)||void 0===P?void 0:P.toLocaleLowerCase());null!==(H=c.svg)&&void 0!==H&&H.nodes.find(Et=>{var Lt;return"submit"==(null===(Lt=Et.source)||void 0===Lt||null===(Lt=Lt.test)||void 0===Lt?void 0:Lt.type)})||Gt(Z,c,F,J,{iscorrect:It},R),W.iscorrect=It,c.test?c.test.answer?c.test.answer.fill?c.test.answer.fill.find(Et=>Et.key==W.key)?c.test.answer.fill.filter(Et=>Et.key==W.key).forEach(Et=>{Et.value=W.value,Et.iscorrect=W.iscorrect}):c.test.answer.fill.push(W):c.test.answer.fill=[W]:c.test.answer={fill:[W]}:c.test={answer:{fill:[W]}},console.log("node source ->",Z.source),console.log("slide test ->",c.test)})(Z,c,It,Et,{key:Lt,value:Dt},J),jQuery("#"+Z.id).find(`input[type="text"][data-key="${Lt}"]`).val(Dt)}),null!==(nt=c.test)&&void 0!==nt&&nt.showselection||jQuery("#"+Z.id).addClass("hide-selection");break;case"matching-empty":jQuery("#"+Z.id).on("touchmove",".ondrag-item",function(P){P.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(P){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${Z.size.height/Z.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${P.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(P){var H;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(H=c.test)&&void 0!==H&&H.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(P){},dragend:function(P){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${Z.id} .ondrop-here`).kendoDropTarget({dragenter:function(P){P.dropTarget.hasClass("actived")&&P.dropTarget.addClass("focused")},dragleave:function(P){P.dropTarget.hasClass("actived")&&P.dropTarget.removeClass("focused")},drop:function(P){if(!P.dropTarget.hasClass("actived"))return;P.dropTarget.removeClass("focused");let H=P.dropTarget,mt=P.draggable.currentTarget;H.is(":empty")||H.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),mt.appendTo(H),((Z,c,F,J,W,R)=>{var B,nt,P;let{key:H}=null!==(B=null===(nt=Z.source)||void 0===nt||null===(nt=nt.test)||void 0===nt?void 0:nt.matching)&&void 0!==B?B:{key:"KIEN"},mt=W.key==H;null!==(P=c.svg)&&void 0!==P&&P.nodes.find(Et=>{var Lt;return"submit"==(null===(Lt=Et.source)||void 0===Lt||null===(Lt=Lt.test)||void 0===Lt?void 0:Lt.type)})||Gt(Z,c,F,J,{iscorrect:mt},R),ht(Z,c,W);let It={key:null!=H?H:"",value:W.key};c.test?c.test.answer?c.test.answer.matching?c.test.answer.matching.find(Et=>Et.key==H)?c.test.answer.matching.filter(Et=>Et.key==H).forEach(Et=>Et.value=It.value):c.test.answer.matching.push(It):c.test.answer.matching=[It]:c.test.answer={matching:[It]}:c.test={answer:{matching:[It]}},console.log("node source ->",Z.source),console.log("slide test ->",c.test)})(Z,c,ct.nodeStatus,ct.slideStatus,{key:mt.data("key")},J)}});break;case"matching-content":jQuery("#"+Z.id).on("touchmove",".ondrag-item",function(P){P.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(P){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${Z.size.height/Z.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${P.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(P){var H;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(H=c.test)&&void 0!==H&&H.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(P){},dragend:function(P){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${Z.id} .ondrop-here`).kendoDropTarget({dragenter:function(P){P.dropTarget.hasClass("actived")&&P.dropTarget.addClass("focused")},dragleave:function(P){P.dropTarget.hasClass("actived")&&P.dropTarget.removeClass("focused")},drop:function(P){if(!P.dropTarget.hasClass("actived"))return;P.dropTarget.removeClass("focused");let mt=P.draggable.currentTarget;mt.appendTo(P.dropTarget),ht(Z,c,{key:mt.data("key")})}});break;case"speech":break;case"submit":jQuery("#"+Z.id).click(P=>{P.preventDefault(),((Z,c,F,J,W)=>{var R,B,nt,P,H;let mt;var It;if(null!=c&&null!==(R=c.test)&&void 0!==R&&null!==(R=R.answer)&&void 0!==R&&R.truefalse)mt=null==c||null===(It=c.test)||void 0===It||null===(It=It.answer)||void 0===It||null===(It=It.truefalse)||void 0===It?void 0:It.iscorrect;else if(null!=c&&null!==(B=c.test)&&void 0!==B&&null!==(B=B.answer)&&void 0!==B&&B.singlechoice){var Et;mt=null==c||null===(Et=c.test)||void 0===Et||null===(Et=Et.answer)||void 0===Et||null===(Et=Et.singlechoice)||void 0===Et?void 0:Et.iscorrect}else if(null!=c&&null!==(nt=c.test)&&void 0!==nt&&null!==(nt=nt.answer)&&void 0!==nt&&nt.multichoice){var Lt,Dt,Vt;mt=1==[null==c||null===(Lt=c.test)||void 0===Lt||null===(Lt=Lt.answer)||void 0===Lt||null===(Lt=Lt.multichoice)||void 0===Lt?void 0:Lt.length,null==c||null===(Dt=c.test)||void 0===Dt||null===(Dt=Dt.answer)||void 0===Dt||null===(Dt=Dt.multichoice)||void 0===Dt||null===(Dt=Dt.map(ce=>ce.iscorrect?1:0))||void 0===Dt?void 0:Dt.reduce((ce,fe)=>ce+fe),null==c||null===(Vt=c.svg)||void 0===Vt||null===(Vt=Vt.nodes)||void 0===Vt||null===(Vt=Vt.filter(ce=>{var fe,Te;return"multichoice"==(null===(fe=ce.source)||void 0===fe||null===(fe=fe.test)||void 0===fe?void 0:fe.type)&&(null===(Te=ce.source)||void 0===Te||null===(Te=Te.test)||void 0===Te||null===(Te=Te.multichoice)||void 0===Te?void 0:Te.iscorrect)}))||void 0===Vt?void 0:Vt.length].filter((ce,fe,Te)=>Te.indexOf(ce)==fe).length}else if(null!=c&&null!==(P=c.test)&&void 0!==P&&null!==(P=P.answer)&&void 0!==P&&P.fill){var Qt,Yt;mt=(null==c||null===(Qt=c.test)||void 0===Qt||null===(Qt=Qt.answer)||void 0===Qt||null===(Qt=Qt.fill)||void 0===Qt||null===(Qt=Qt.map(ce=>ce.iscorrect?1:0))||void 0===Qt?void 0:Qt.reduce((ce,fe)=>ce+fe))==(null===(Yt=c.svg)||void 0===Yt||null===(Yt=Yt.nodes)||void 0===Yt||null===(Yt=Yt.filter(ce=>{var fe;return"fill"==(null===(fe=ce.source)||void 0===fe||null===(fe=fe.test)||void 0===fe?void 0:fe.type)}))||void 0===Yt?void 0:Yt.length)}else if(null!=c&&null!==(H=c.test)&&void 0!==H&&null!==(H=H.answer)&&void 0!==H&&H.matching){var ue,be;mt=(null===(ue=c.svg)||void 0===ue||null===(ue=ue.nodes)||void 0===ue||null===(ue=ue.filter(ce=>{var fe;return"matching-empty"==(null===(fe=ce.source)||void 0===fe||null===(fe=fe.test)||void 0===fe?void 0:fe.type)}))||void 0===ue?void 0:ue.length)==((null==c||null===(be=c.test)||void 0===be||null===(be=be.answer)||void 0===be?void 0:be.matching)||[]).map(ce=>ce.key==ce.value?1:0).reduce((ce,fe)=>ce+fe)}Gt(Z,c,F,J,{iscorrect:mt},W),console.log("node source ->",Z.source),console.log("slide test ->",c.test)})(Z,c,ct.nodeStatus,ct.slideStatus,J)})}})(c,Z)};var le=v(8619),V=v(8785),X=v(4921),d=v(8054),q=v(2282),xt=v(2875),wt=v(8419);const Ft=(Z,c,F)=>{if(F.slideStatus!=ct.slideStatus||!c.length)return;let J=c.shift(),W=Z.filter(P=>{var H;return(null!==(H=P.idx)&&void 0!==H?H:0)==J});if(!W.length)return;let R=Math.max.apply(null,W.map(P=>{var H;return null!==(H=P.time)&&void 0!==H?H:0})),B=!1,nt=R<.5?0:setTimeout(()=>{B||(B=!0,Ft(Z,c,F))},1e3*R);Kt(Z,c,W,0,F,{idx:J,total:W.length,counter:0,isRecursive:B,timeoutRecursive:nt,maxTimeCoundown:R,uid:Math.floor(1e9*Math.random())})},Kt=(Z,c,F,J,W,R)=>{if(W.slideStatus!=ct.slideStatus)return;let B=F[J];if(B){switch(B.type){case ot.$.GROUP:break;case ot.$.CIRCLE:(0,le._)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null);break;case ot.$.ELLIPSE:(0,V.r)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null);break;case ot.$.LINE:(0,X.W)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null);break;case ot.$.RECT:(0,d.f)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null);break;case ot.$.POLYGON:(0,q.l)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null);break;case ot.$.FOREIGNOBJECT:(0,xt.e)(B.id,{size:B.size,attribute:B.attribute,style:B.style,source:B.source},B.pid?window.document.getElementById(B.pid):null);break;case ot.$.IMAGE:(0,k.G)(B.id,{size:B.size,attribute:B.attribute,source:B.source},B.pid?window.document.getElementById(B.pid):null);break;case ot.$.TEXT:(0,_.$)(B.id,{size:B.size,attribute:B.attribute,source:B.source},B.pid?window.document.getElementById(B.pid):null);break;case ot.$.PATH:(0,wt.G)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null)}Ot(W.slide,B,W,()=>{R.counter+=1,R.maxTimeCoundown<.5&&R.counter>=R.total&&(R.total=R.counter=0,R.isRecursive||(clearTimeout(R.timeoutRecursive),R.isRecursive=!0,setTimeout(()=>{Ft(Z,c,W)},250)))}),Kt(Z,c,F,++J,W,R)}},ct=new class Tt{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(c){this._dataSource=c.data||{},O.icdt.variable.set=c.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var c,F;return null!==(c=null===(F=this._dataSource)||void 0===F||null===(F=F.slides)||void 0===F?void 0:F.length)&&void 0!==c?c:0}get slides(){var c;return(null===(c=this._dataSource)||void 0===c?void 0:c.slides)||[]}get slide(){var c;return((null===(c=this._dataSource)||void 0===c?void 0:c.slides)||[])[this._slideIdx]||{}}findNode(c){var F;let J=null===(F=this._dataSource)||void 0===F||null===(F=F.slides)||void 0===F?void 0:F.find((Et,Lt)=>Lt==this._slideIdx),W=null==J?void 0:J.svg,R=(Et,Lt)=>{let Dt=null==Et?void 0:Et.find(Yt=>Yt.id==c);if(Dt)return Dt.pid=Lt,Dt;let Vt=0,Qt=Et.length||0;for(;Vt<Qt&&!Dt&&(Dt=R(Et[Vt].nodes||[],Et[Vt].id),!Dt);)Vt++;return Dt},B=R((null==W?void 0:W.nodes)||[]);var nt,P,H,mt,It;return B?(B.style=null!==(nt=B.style)&&void 0!==nt?nt:{},B.source=null!==(P=B.source)&&void 0!==P?P:{},B.animate=null!==(H=B.animate)&&void 0!==H?H:{},B.interactive=null!==(mt=B.interactive)&&void 0!==mt?mt:{},B.variable=null!==(It=B.variable)&&void 0!==It?It:{},B):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(c,F,J){var W;let R;var B,nt;if(this.refreshNodeStatus(),this.refreshSlideStatus(),J)R=null===(B=this._dataSource)||void 0===B||null===(B=B.slides)||void 0===B?void 0:B.find(It=>It.code==J||It.id==J),R&&(this._slideIdx=(null===(nt=this._dataSource)||void 0===nt||null===(nt=nt.slides)||void 0===nt?void 0:nt.indexOf(R))||0);else if(F){var P,H;R=null===(P=this._dataSource)||void 0===P||null===(P=P.slides)||void 0===P?void 0:P.find(It=>It.id==F),R&&(this._slideIdx=(null===(H=this._dataSource)||void 0===H||null===(H=H.slides)||void 0===H?void 0:H.indexOf(R))||0)}else this._slideIdx=Math.min(Math.max(c||0,0),this.slideTotal-1),R=this.slide;if(R){var mt;$t(O.icdt.container,O.icdt.svg,R,!0),null===(mt=jQuery(O.icdt.svg).find("#"+j.O.BACKGROUND_GROUP))||void 0===mt||mt.empty();let It=(0,gt.g1)(j.O.BACKGROUND_GROUP,"g",void 0,O.icdt.svg);(0,gt.x0)(It,R),(Z=>{var c,F,J,W;let R=ct.nodeStatus,B=ct.slideStatus;null===(c=Z.svg)||void 0===c||c.nodes.forEach(P=>{P.pid=Math.ceil(1e9*Math.random()),(0,M.m)(P.pid)});let nt=null===(F=Z.svg)||void 0===F||null===(F=F.nodes)||void 0===F?void 0:F.map(P=>{var H;return null!==(H=P.idx)&&void 0!==H?H:0}).filter((P,H,mt)=>mt.indexOf(P)==H).sort((P,H)=>(null!=P?P:0)-(null!=H?H:0));Ft(null!==(J=null===(W=Z.svg)||void 0===W?void 0:W.nodes)&&void 0!==J?J:[],null!=nt?nt:[],{slide:Z,nodeStatus:R,slideStatus:B})})(R)}this.changeSlide(this.slides,null===(W=this.slide)||void 0===W?void 0:W.id,this.slideIdx,this.slides.length,R)}set onChangeSlide(c){this._fnChangeSlides.push(c)}changeSlide(c,F,J,W,R){this._fnChangeSlides.forEach(B=>B(c,F,J,W,R))}},$t=(Z,c,F,J)=>{var W,R,B,nt;let P=window.document.querySelector(c);var H;P||(P=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(H=window.document.querySelector(Z))||void 0===H||H.appendChild(P)),J&&(P.textContent=null);let{x:mt,y:It,width:Et,height:Lt}=null!==(W=null==F||null===(R=F.svg)||void 0===R?void 0:R.viewBox)&&void 0!==W?W:O.icdt.screen.frameSize;P.setAttributeNS(null,"viewBox",mt+" "+It+" "+Et+" "+Lt),P.setAttribute("id",c.replace("#",""));var ue,be,Dt=null!==(B=jQuery(Z).width())&&void 0!==B?B:1080,Vt=null!==(nt=jQuery(Z).height())&&void 0!==nt?nt:1080,Yt=Et/Lt;Yt>=Dt/Vt?be=(ue=Dt)/Yt:ue=(be=Vt)*Yt,P.setAttributeNS(null,"width",ue.toString()),P.setAttributeNS(null,"height",be.toString())}},7267:(ae,Rt,v)=>{v.d(Rt,{E:()=>ot,Z:()=>O});var j=v(70);const O=(lt,u,m)=>{var T;let{value:_}=null!==(T=lt.animate)&&void 0!==T?T:{};ot(lt.id,{node:lt,value:_,nodeStatus:u,slideStatus:m},()=>{})},ot=(lt,u,m)=>{var T;if(!u.value)return void m();let S=jQuery("#"+lt).parents("g");if(!S.length)return void m();let{size:_}=u.node;S.css("transform-origin",`${_.x+_.width/2}px ${_.y+_.height/2}px`);let M="",E=null!==(T=u.iteration)&&void 0!==T?T:0,Q=[];(u.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?Q.push(u.value):u.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(u.value)?(Q.push("animation"),Q.push(`animation-${u.value}`)):(Q.push("animate__animated"),Q.push(`animate__${u.value}`)):(Q.push("animation"),Q.push("animation-fadein")),E<0?(Q.push("animation-iteration-infinite"),m(),m=function(){}):E>0&&Q.push("animation-iteration-"+(E+1)),M=Q.join(" "),function(z){let tt=function(){S.data("animate-running")?S.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){S.data("animate-running",!1),setTimeout(function(){z()},100)}):z()};S.hasClass("animation")?setTimeout(function(){tt()}):tt()}(function(){var z;C(lt),(E>0||E<0)&&S.one("animationiteration",function(){u.slideStatus===j.$.slideStatus||(S.data("animate-running",!1),C(lt),u.slideStatus===j.$.slideStatus&&m())}),S.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(S.data("animate-running",!1),C(lt),u.finish){default:case 0:case 1:break;case 2:var tt;ot(lt,{node:u.node,value:null===(tt=u.node.animate)||void 0===tt?void 0:tt.out,nodeStatus:u.nodeStatus,slideStatus:u.slideStatus},()=>{S.addClass("hide")})}u.slideStatus===j.$.slideStatus&&m()}),S.attr("data-class",null!==(z=S.attr("class"))&&void 0!==z?z:""),S.addClass(M),S.data("animate-running",!0)})},C=function(lt){var u,m,T=jQuery("#"+lt).parents("g"),S=null===(u=T.attr("class"))||void 0===u?void 0:u.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),_=null===(m=T.attr("class"))||void 0===m?void 0:m.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);S&&S.forEach(function(E){jQuery(T).removeClass(E)}),_&&_.forEach(function(E){jQuery(T).removeClass(E)});let M=T.attr("data-class");M&&(T.attr("class",M),T.removeAttr("data-class")),jQuery(T).data("animation-running",!1)}},2336:(ae,Rt,v)=>{v.d(Rt,{Q:()=>ot});var j=v(70),O=v(7267);const ot=(lt,u,m)=>{var T;if(!u.value)return void m();let S=jQuery("#"+lt).parents("g");if(!S.length)return void m();let{size:_}=u.node;S.css("transform-origin",`${_.x+_.width/2}px ${_.y+_.height/2}px`);let M="",E=null!==(T=u.iteration)&&void 0!==T?T:0,Q=[];(u.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?Q.push(u.value):(Q.push("animation"),Q.push(u.value?"animation-"+u.value:"animation-fadein")),E<0?(Q.push("animation-iteration-infinite"),m(),m=function(){}):E>0&&Q.push("animation-iteration-"+(E+1)),M=Q.join(" "),function(z){let tt=function(){S.data("animate-running")?S.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){S.data("animate-running",!1),setTimeout(function(){z()},100)}):z()};S.hasClass("animation")?setTimeout(function(){tt()}):tt()}(function(){var z;C(lt),(E>0||E<0)&&S.one("animationiteration",function(){u.slideStatus===j.$.slideStatus||(S.data("animate-running",!1),C(lt),u.slideStatus===j.$.slideStatus&&m())}),S.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(S.data("animate-running",!1),C(lt),u.finish){default:case 0:case 1:break;case 2:var tt;(0,O.E)(lt,{node:u.node,value:null===(tt=u.node.animate)||void 0===tt?void 0:tt.out,nodeStatus:u.nodeStatus,slideStatus:u.slideStatus},()=>{S.addClass("hide")})}u.slideStatus===j.$.slideStatus&&m()}),S.attr("data-class",null!==(z=S.attr("class"))&&void 0!==z?z:""),S.addClass(M),S.data("animate-running",!0)})},C=function(lt){var u,m=jQuery("#"+lt).parents("g"),T=null===(u=m.attr("class"))||void 0===u?void 0:u.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);T&&T.forEach(function(_){jQuery(m).removeClass(_)});let S=m.attr("data-class");S&&(m.attr("class",S),m.removeAttr("data-class")),jQuery(m).data("animation-running",!1)}},861:(ae,Rt,v)=>{v.d(Rt,{G:()=>lt});var j=v(4318),O=v(70),ot=v(4080),C=v(7267);const lt=(m,T,S)=>{var _;if(!T.points||!T.points.length)return void S();let M=jQuery("#"+m),E=function u(m){let T=[];2===m.length&&m.splice(1,0,[(m[0][0]+m[1][0])/2,(m[0][1]+m[1][1])/2]);let Q,U,z,S=1,_=m.length;for(;S<_;){if(Q=m[S-1],U=m[S],z=m[S+1],(Math.abs(Q[0]-U[0])>=15||Math.abs(Q[1]-U[1])>=15)&&Math.pow(Q[0]-U[0],2)+Math.pow(Q[1]-U[1],2)>=Math.pow(15,2)&&z&&(Math.abs(Q[0]-z[0])<=20||Math.abs(Q[1]-z[1])<=20)&&Math.pow(Q[0]-z[0],2)+Math.pow(Q[1]-z[1],2)<=Math.pow(20,2))T.push(U);else{let k=U[0]-Q[0],it=U[1]-Q[1],Y=Math.max(Math.abs(k),Math.abs(it));for(var tt=0;tt<Y;tt+=15)T.push([Q[0]+k*tt/Y,Q[1]+it*tt/Y])}S++}return _>0&&(T.splice(0,0,m[0]),T.push(m[_-1])),T}(T.points||[]),Q=null!==(_=T.iteration)&&void 0!==_?_:0;if(Q<0&&(S(),S=function(){}),M.data("work-running")&&Q<0)return;M.data("work-running",!0);let vt,U=E.length,z=Math.max(20,1e3*(T.time||3)/U),{id:tt,type:k,size:it,attribute:Y}=O.$.findNode(m),gt=function(ft){if(T.slideStatus!==O.$.slideStatus)return M.data("work-running",!1),void(T.slideStatus===O.$.slideStatus&&S());if(ft<U){let kt=E[ft];kt&&(vt=Object.assign({},it,{x:kt[0]-it.width/2,y:kt[1]-it.height/2}),Object.assign(Y,(0,j.sg)(k,vt)),(0,ot.__)(window.document.getElementById(tt),Y),setTimeout(function(){gt(++ft)},z))}else if(Q>0)Q--,gt(1);else if(Q<0)gt(1);else switch(M.data("work-running",!1),T.slideStatus===O.$.slideStatus&&S(),T.finish){default:case 0:break;case 1:Object.assign(Y,(0,j.sg)(k,it)),(0,ot.__)(window.document.getElementById(tt),Y);break;case 2:var G;(0,C.E)(T.node.id,{node:T.node,value:null===(G=T.node.animate)||void 0===G?void 0:G.out,nodeStatus:T.nodeStatus,slideStatus:T.slideStatus},()=>{M.addClass("hide")})}};gt(1)}},157:(ae,Rt,v)=>{v.d(Rt,{R:()=>ot});var j=v(4981),O=v(70);const ot=(lt,u,m,T,S)=>{var _,M,E,Q,U,z,tt;if(T.slideStatus!=O.$.slideStatus)return u.async&&"change-slide"!=u.async?void 0:void S();if(T.nodeStatus!=O.$.nodeStatus&&(!u.async||"change-node"==u.async))return void S();if(!(null!==(_=u.source)&&void 0!==_&&_.path||null!==(M=u.source)&&void 0!==M&&M.url))return console.warn(`${lt} -> audio no source!`),S(),void(S=()=>{});var k=jQuery("#"+lt);let it=null!==(E=u.iteration)&&void 0!==E?E:0;if(it<0&&(S(),S=function(){}),!(k.data("audio-running")&&it<0)){k.data("audio-running",!0);var Y=function(gt){gt.pause(),gt.remove(),k.data("audio-running",!1)},vt=new Audio;return vt.autoplay=!0,vt.loop=0!=it,vt.preload="auto",vt.controls=!0,vt.setAttributeNode(document.createAttribute("playsinline")),vt.addEventListener("canplay",function(){var gt=vt.play();gt&&gt.then(function(ft){var G;k.data("audio-running",!0),"time"==u.async?setTimeout(()=>{Y(vt),S(),S=()=>{}},1e3*(null!==(G=u.time)&&void 0!==G?G:1)):"non-stop"==u.async&&(S(),S=()=>{})}).catch(function(ft){k.data("audio-running",!1),T.slideStatus===O.$.slideStatus&&(S(),S=()=>{})})}),vt.addEventListener("timeupdate",function(){switch(u.async){case"time":case"non-stop":break;case"finish-action":m.total>=2&&m.total-m.counter==1&&(Y(this),S(),S=()=>{});break;default:case"change-node":T.nodeStatus!==O.$.nodeStatus&&(Y(this),S(),S=()=>{});break;case"change-slide":T.slideStatus!==O.$.slideStatus&&(Y(this),S(),S=()=>{})}}),vt.addEventListener("canplaythrough",function(){this.loop&&(it>0?it--:0==it&&(this.loop=!1))}),vt.addEventListener("play",function(){}),vt.addEventListener("pause",function(){}),vt.addEventListener("ended",function(){this.remove(),k.data("audio-running",!1),T.slideStatus===O.$.slideStatus&&(S(),S=()=>{})}),vt.onerror=function(){this.remove(),k.data("audio-running",!1),T.slideStatus===O.$.slideStatus&&(S(),S=()=>{})},vt.src=(null!==(Q=u.source)&&void 0!==Q&&Q.path?(null===(U=j.icdt.config)||void 0===U?void 0:U.readfileuploadurl)+(null===(z=u.source)||void 0===z?void 0:z.path):null===(tt=u.source)||void 0===tt?void 0:tt.url)||"",vt}}},5973:(ae,Rt,v)=>{v.d(Rt,{F:()=>S});var j=v(4981),O=v(70),ot=v(2336),C=v(861),lt=v(157),u=v(4787),m=v(370),T=v(7267);const S=(_,M,E,Q)=>{var U,z,tt;let k={total:0,counter:0},{triggershow:it,triggerrun:Y,triggerhide:vt,action:gt,audio:ft,slide:G,media:kt}=null!==(U=null===(z=_.interactive)||void 0===z?void 0:z.click)&&void 0!==U?U:{};if(it){let{id:_t,ids:et,time:K,async:ht}=it;"asynctrue"==ht?(0,u.L5)({id:_t,ids:et,nodeStatus:M,slideStatus:E}):"time"==ht&&setTimeout(()=>{(0,u.L5)({id:_t,ids:et,nodeStatus:M,slideStatus:E})},1e3*(null!=K?K:0))}if(Y){let{id:_t,ids:et,time:K,async:ht}=Y;"asynctrue"==ht?(0,u.Ar)({id:_t,ids:et,nodeStatus:M,slideStatus:E}):"time"==ht&&setTimeout(()=>{(0,u.Ar)({id:_t,ids:et,nodeStatus:M,slideStatus:E})},1e3*(null!=K?K:0))}if(vt){let{id:_t,ids:et,time:K,async:ht}=vt;"asynctrue"==ht?(0,u.WT)({id:_t,ids:et,nodeStatus:M,slideStatus:E}):"time"==ht&&setTimeout(()=>{(0,u.WT)({id:_t,ids:et,nodeStatus:M,slideStatus:E})},1e3*(null!=K?K:0))}let Bt=()=>{setTimeout(()=>{if(k.counter>=k.total){if(Q&&Q(),it){let{id:_t,ids:et,async:K}=it;(!K||"asyncfalse"==K)&&(0,u.L5)({id:_t,ids:et,nodeStatus:M,slideStatus:E})}if(Y){let{id:_t,ids:et,async:K}=Y;(!K||"asyncfalse"==K)&&(0,u.Ar)({id:_t,ids:et,nodeStatus:M,slideStatus:E})}if(vt){let{id:_t,ids:et,async:K}=vt;(!K||"asyncfalse"==K)&&(0,u.WT)({id:_t,ids:et,nodeStatus:M,slideStatus:E})}}})};if(null!=gt&&gt.value){k.total+=1;let _t=()=>{k.counter+=1,Bt()};switch(null==gt?void 0:gt.value){case"hide":var zt;(0,T.E)(_.id,{node:_,value:null===(zt=_.animate)||void 0===zt?void 0:zt.out,nodeStatus:M,slideStatus:E},()=>{jQuery("#"+_.id).addClass("hide"),_t()});break;case"points":{let{points:et,time:K,iteration:ht,finish:St}=gt;et&&(0,C.G)(_.id,{node:_,points:et,time:K,iteration:ht,finish:St,nodeStatus:M,slideStatus:E},_t);break}default:{let{value:et,time:K,iteration:ht,finish:St}=gt;(0,ot.Q)(_.id,{node:_,value:et,time:K,iteration:ht,finish:St,nodeStatus:M,slideStatus:E},_t);break}}}if(null!=ft&&null!==(tt=ft.source)&&void 0!==tt&&tt.path){k.total+=1;let _t=()=>{k.counter+=1,Bt()};(0,lt.R)(_.id,ft,k,{nodeStatus:M,slideStatus:E},_t)}if(k.total||Bt(),null!=G&&G.id)switch(console.log(`InteractiveNode #${_.id} slide(undefined,${G.id},${G.code}) success!`),G.id){case-1:O.$.runSlide(O.$.slideIdx-1);break;case-2:O.$.runSlide(O.$.slideIdx+1);break;default:var re;O.$.runSlide(void 0,G.id,null===(re=G.code)||void 0===re?void 0:re.toString())}if(null!=kt&&kt.type){var Wt;let et=`<div class="popup-media-viewer"><iframe src="${(0,m.e)({readfileuploadurl:null===(Wt=j.icdt.config)||void 0===Wt?void 0:Wt.readfileuploadurl,type:null==kt?void 0:kt.type,oss:null==kt?void 0:kt.oss,path:null==kt?void 0:kt.path,url:null==kt?void 0:kt.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,K=jQuery(et).appendTo(window.document.body);K.find(".btn-close").click(function(ht){ht.preventDefault(),K.remove()})}}},4787:(ae,Rt,v)=>{v.d(Rt,{Ar:()=>lt,L5:()=>C,WT:()=>u});var j=v(70),O=v(5973),ot=v(7267);const C=m=>{console.log("icdt_Run_Interactive_TriggerShow",m),m.id?jQuery("#"+m.id).removeClass("hide"):m.ids&&m.ids.forEach(T=>{jQuery("#"+T).removeClass("hide")})},lt=m=>{console.log("icdt_Run_Interactive_TriggerRun",m),m.id?(jQuery("#"+m.id).removeClass("hide"),(0,O.F)(j.$.findNode(m.id),m.nodeStatus,m.slideStatus)):m.ids&&m.ids.forEach(T=>{jQuery("#"+T).removeClass("hide"),(0,O.F)(j.$.findNode(T),m.nodeStatus,m.slideStatus)})},u=m=>{if(console.log("icdt_Run_Interactive_TriggerHide",m),m.id){var T;let S=j.$.findNode(m.id);(0,ot.E)(m.id,{node:S,value:null===(T=S.animate)||void 0===T?void 0:T.out,nodeStatus:m.nodeStatus,slideStatus:m.slideStatus},()=>{jQuery("#"+m.id).addClass("hide")})}else m.ids&&m.ids.forEach(S=>{var _;let M=j.$.findNode(S);(0,ot.E)(S,{node:M,value:null===(_=M.animate)||void 0===_?void 0:_.out,nodeStatus:m.nodeStatus,slideStatus:m.slideStatus},()=>{jQuery("#"+S).addClass("hide")})})}},4080:(ae,Rt,v)=>{v.d(Rt,{Mh:()=>Y,wM:()=>ft,xo:()=>vt,it:()=>G,g1:()=>Wt,__:()=>kt,QI:()=>zt,DB:()=>Bt,eb:()=>gt,x0:()=>Ot,g$:()=>_t,mo:()=>Gt,XH:()=>St,hJ:()=>et,vl:()=>ht,yD:()=>K,Yw:()=>le});var j=v(9054),O=v(1687),lt=/^#?[a-fA-F0-9]+$/;const T=(V,X)=>{var d;if("none"==(V=null!==(d=V)&&void 0!==d?d:""))return"none";if("transparent"==V)return"rgba(0,0,0,0)";if(V.includes("rgba("))return V;if(V.includes("rgb(")&&(V=((V,X)=>{if(!V)return"";let d=V.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),q=(d&&d[4]||"").trim(),xt=d?(256|d[1]).toString(16).slice(1)+(256|d[2]).toString(16).slice(1)+(256|d[3]).toString(16).slice(1):V;return"0"==q?"transparent":`#${xt}`})(V)),!(V=V.replace(/[^0-9a-fA-F]/g,"")))return"";if(!lt.test(V))return console.error(`hex2rgba -> ${V}: first argument has invalid hexadecimal characters`),"";if("#"===V[0]&&(V=V.slice(1)),3===V.length){let xt=V.split("");xt.splice(2,0,V[2]),xt.splice(1,0,V[1]),xt.splice(0,0,V[0]),V=xt.join("")}if(6!==V.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var q=[parseInt(V.slice(0,2),16),parseInt(V.slice(2,4),16),parseInt(V.slice(4,6),16)];return X="number"==typeof X?X:parseFloat(X),q.push(X>=0&&X<=1?X:1),"rgba("+q.join(",")+")"};var S=v(370),_=v(1814),M=v(4981),E=v(3423),Q=v(8054),U=v(7210),z=v(8619),tt=v(70),k=v(2875),it=v(1105);class Y{constructor(X,d){let q=window.document.querySelector(d);var xt;q||(q=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(xt=window.document.querySelector(X))||void 0===xt||xt.appendChild(q));let{svgViewBox:wt,svgSize:Mt}=M.icdt.screen.init();q.setAttributeNS(null,"viewBox",`${wt.x} ${wt.y} ${wt.width} ${wt.height}`),q.setAttribute("id",d.replace("#","")),q.style.display="block",q.style.width=`${Mt.width}px`,q.style.height=`${Mt.height}px`,q.style.backgroundColor="#fafafa",q.style.cursor="default"}}const vt=V=>{jQuery(M.icdt.target).find("#"+O.O.BACKGROUND_GROUP).empty();let X=Wt(O.O.BACKGROUND_GROUP,"g",void 0,M.icdt.target);Ot(X,V),(()=>{let d=window.document.getElementById(null==V?void 0:V.id);jQuery(d).find("#"+O.O.BACKGROUND_GROUP).empty();let q=Wt(O.O.BACKGROUND_GROUP,"g",void 0,d);Ot(q,V)})()},gt=()=>{let V=M.icdt.screen.svgViewBox,X=M.icdt.screen.svgSize;M.icdt.target&&(M.icdt.target.setAttributeNS(null,"viewBox",`${V.x} ${V.y} ${V.width} ${V.height}`),M.icdt.target.style.left=`${X.x}px`,M.icdt.target.style.top=`${X.y}px`,M.icdt.target.style.width=`${X.width}px`,M.icdt.target.style.height=`${X.height}px`)},ft=()=>{jQuery(M.icdt.target).find(">*:not(defs)").remove()},G=(V,X,d,q,xt)=>{let wt;return V?(wt=jQuery(xt||M.icdt.target).find("#"+V).get(0),wt||(wt=window.document.createElementNS("http://www.w3.org/2000/svg",d),wt.setAttribute("id",V),X==j.$.FOREIGNOBJECT&&wt.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(wt).appendTo(xt||M.icdt.target))):(wt=window.document.createElementNS("http://www.w3.org/2000/svg",d),jQuery(wt).appendTo(xt||M.icdt.target)),null!=q&&q.attribute&&kt(wt,null==q?void 0:q.attribute),null!=q&&q.style&&Bt(wt,null==q?void 0:q.style),null!=q&&q.source&&zt(wt,X,null==q?void 0:q.source),wt},kt=(V,X)=>{return jQuery(V).attr((d=Object.assign({},X||{}),null===(q=Object.keys(d))||void 0===q||q.forEach(Mt=>{switch(Mt){case"fill":break;case"stroke":var Ft;Object.assign(d,{"stroke-width":null!==(Ft=d.strokeWidth)&&void 0!==Ft?Ft:null,strokeWidth:null});break;case"strokeLinecap":var Kt;Object.assign(d,{"stroke-linecap":null!==(Kt=d.strokeLinecap)&&void 0!==Kt?Kt:null,strokeLinecap:null});break;case"strokeLinejoin":var Tt;Object.assign(d,{"stroke-linejoin":null!==(Tt=d.strokeLinejoin)&&void 0!==Tt?Tt:null,strokeLinejoin:null});break;case"strokeDasharray":var ct;Object.assign(d,{"stroke-dasharray":null!==(ct=d.strokeDasharray)&&void 0!==ct?ct:null,strokeDasharray:null});break;case"strokeDasharrays":var $t,Z;Object.assign(d,{"stroke-dasharray":null!==($t=null===(Z=d.strokeDasharrays)||void 0===Z?void 0:Z.join(" "))&&void 0!==$t?$t:null,strokeDasharrays:null});break;case"fontFamily":var c;Object.assign(d,{"font-family":null!==(c=d.fontFamily)&&void 0!==c?c:null,fontFamily:null});break;case"fontSize":var F;Object.assign(d,{"font-size":null!==(F=d.fontSize)&&void 0!==F?F:null,fontSize:null});break;case"textLength":Object.assign(d,{textLength:d.textLength?`${d.textLength}px`:null});break;case"transformOrigin":var J;Object.assign(d,{"transform-origin":null!==(J=d.transformOrigin)&&void 0!==J?J:null,transformOrigin:null})}}),Object.assign({},null!=d?d:{},{fill:null!=d&&d.fill?T(d.fill,null!==(xt=null==d?void 0:d.fillOpacity)&&void 0!==xt?xt:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=d&&d.stroke?T(d.stroke,null!==(wt=null==d?void 0:d.strokeOpacity)&&void 0!==wt?wt:1):"rgba(0,0,0,0)",strokeOpacity:null}))),V;var d,q,xt,wt},Bt=(V,X)=>{return jQuery(V).css((d=Object.assign({},X||{}),null===(q=Object.keys(d))||void 0===q||q.forEach(xt=>{switch(xt){case"padding":Object.assign(d,{padding:d.padding?`${d.padding}px`:null});break;case"borderWidth":var wt;Object.assign(d,d.borderWidth&&d.borderStyle&&d.borderColor?{"border-width":`${d.borderWidth}px`,"border-style":d.borderStyle,"border-color":T(d.borderColor,null!==(wt=d.borderOpacity)&&void 0!==wt?wt:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(d,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(d,{"border-radius":d.borderRadius?`${d.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var Mt;d.backgroundColor&&Object.assign(d,{"background-color":T(d.backgroundColor,null!==(Mt=d.backgroundOpacity)&&void 0!==Mt?Mt:1)}),Object.assign(d,{backgroundColor:null,backgroundOpacity:null})}}),d)),V;var d,q},zt=(V,X,d)=>{switch(X){case j.$.TEXT:var q,xt;jQuery(V).text(null!==(q=null==d||null===(xt=d.text)||void 0===xt?void 0:xt.textContent)&&void 0!==q?q:"");break;case j.$.IMAGE:var wt,Mt,Ft,Kt,Tt;jQuery(V).attr("href",(null==d||null===(wt=d.image)||void 0===wt?void 0:wt.base64)||(null!=d&&null!==(Mt=d.image)&&void 0!==Mt&&Mt.path?(null===(Ft=M.icdt.config)||void 0===Ft?void 0:Ft.readfileuploadurl)+(null==d||null===(Kt=d.image)||void 0===Kt?void 0:Kt.path):null==d||null===(Tt=d.image)||void 0===Tt?void 0:Tt.url)||"");break;case j.$.FOREIGNOBJECT:switch(null==d?void 0:d.type){case"text":var ct,$t;if(null!==(ct=d.text)&&void 0!==ct&&ct.variableKeywords&&null!==($t=d.text)&&void 0!==$t&&$t.variableKeywords.length){var Z;let g=M.icdt.variable.getKeys(),y=(null===(Z=d.text)||void 0===Z?void 0:Z.textContent)||"";d.text.variableKeywords.forEach(f=>{var x=f.replace(/[^a-zA-Z0-9_]/gm,"");if(g.indexOf(x)>=0){var p=M.icdt.variable.getValue(x);y=y.replace(f,p)}}),jQuery(V).text(y)}else{var c;jQuery(V).text((null===(c=d.text)||void 0===c?void 0:c.textContent)||"")}break;case"html":{var F,J,W;let g=(null==d||null===(F=d.html)||void 0===F?void 0:F.htmlContent)||"";if(null!==(J=d.html)&&void 0!==J&&J.variableKeywords&&null!==(W=d.html)&&void 0!==W&&W.variableKeywords.length){let y=M.icdt.variable.getKeys();d.html.variableKeywords.forEach(f=>{var x=f.replace(/[^a-zA-Z0-9_]/gm,"");if(y.indexOf(x)>=0){var p=M.icdt.variable.getValue(x);g=g.replace(f,p)}})}jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${g}</div>`).find("img[path],video[path],iframe[path]").each((y,f)=>{var x,p;f.setAttribute("src",(null!==(x=null===(p=M.icdt.config)||void 0===p?void 0:p.readfileuploadurl)&&void 0!==x?x:"")+f.getAttribute("path")),f.removeAttribute("path")});break}case"input":var R,B,nt,P;if(null!==(R=d.input)&&void 0!==R&&R.input)jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(nt=null===(P=d.input)||void 0===P?void 0:P.placeholder)&&void 0!==nt?nt:""}" maxlength="100" /></div>`);else if(null!==(B=d.input)&&void 0!==B&&B.textarea){var H,mt;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(H=null===(mt=d.input)||void 0===mt?void 0:mt.placeholder)&&void 0!==H?H:""}" maxlength="1000"></textarea></div>`)}break;case"image":var It,Et,Lt,Dt,Vt;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(It=d.image)||void 0===It?void 0:It.base64)||(null!==(Et=d.image)&&void 0!==Et&&Et.path?(null===(Lt=M.icdt.config)||void 0===Lt?void 0:Lt.readfileuploadurl)+(null===(Dt=d.image)||void 0===Dt?void 0:Dt.path):null===(Vt=d.image)||void 0===Vt?void 0:Vt.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var Qt,Yt,ue,be;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${(null!==(Qt=d.iframe)&&void 0!==Qt&&Qt.path?(null===(Yt=M.icdt.config)||void 0===Yt?void 0:Yt.readfileuploadurl)+(null===(ue=d.iframe)||void 0===ue?void 0:ue.path):null===(be=d.iframe)||void 0===be?void 0:be.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var ce,fe,Te,qe,Ue;let g=(0,S.e)({readfileuploadurl:null===(ce=M.icdt.config)||void 0===ce?void 0:ce.readfileuploadurl,type:null===(fe=d.embed)||void 0===fe?void 0:fe.type,oss:null===(Te=d.embed)||void 0===Te?void 0:Te.oss,path:null===(qe=d.embed)||void 0===qe?void 0:qe.path,url:null===(Ue=d.embed)||void 0===Ue?void 0:Ue.url});jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${g}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var ni,ri;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(ni=null===(ri=d.svg)||void 0===ri?void 0:ri.svgContent)&&void 0!==ni?ni:""}</div>`);break;case"test":{var vi,Me,li,Ge;let g=(null==d||null===(vi=d.html)||void 0===vi?void 0:vi.htmlContent)||"";if(null!==(Me=d.html)&&void 0!==Me&&Me.variableKeywords&&null!==(li=d.html)&&void 0!==li&&li.variableKeywords.length){let y=M.icdt.variable.getKeys();d.html.variableKeywords.forEach(f=>{var x=f.replace(/[^a-zA-Z0-9_]/gm,"");if(y.indexOf(x)>=0){var p=M.icdt.variable.getValue(x);g=g.replace(f,p)}})}switch(null==d||null===(Ge=d.test)||void 0===Ge?void 0:Ge.type){case"truefalse":var Je;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Je=d.test.truefalse)&&void 0!==Je&&Je.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"singlechoice":var ai;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(ai=d.test.singlechoice)&&void 0!==ai&&ai.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"multichoice":var oi;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(oi=d.test.multichoice)&&void 0!==oi&&oi.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"matching-empty":var ti;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty" data-key="${null==d||null===(ti=d.test.matching)||void 0===ti?void 0:ti.key}"></div>`);break;case"matching-content":var Ze,si,pt;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content" data-key="${null==d||null===(Ze=d.test.matching)||void 0===Ze?void 0:Ze.key}"><div class="ondrag-item" data-key="${null!==(si=null==d||null===(pt=d.test)||void 0===pt||null===(pt=pt.matching)||void 0===pt?void 0:pt.key)&&void 0!==si?si:"KIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div></div>`);break;case"fill":var A;((null===(A=d.html)||void 0===A?void 0:A.fillKeywords)||[]).forEach(y=>{var f=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${y.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;g=g.replace(new RegExp(y.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),f)}),jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"speech":jQuery(V).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var i,n,r,a,o;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(i=null!==(n=d.image)&&void 0!==n&&n.path?(null===(r=M.icdt.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(a=d.image)||void 0===a?void 0:a.path):null===(o=d.image)||void 0===o?void 0:o.url)&&void 0!==i?i:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(V).find("img[path],video[path],iframe[path]").each((y,f)=>{var x,p;f.setAttribute("src",(null!==(x=null===(p=M.icdt.config)||void 0===p?void 0:p.readfileuploadurl)&&void 0!==x?x:"")+f.getAttribute("path")),f.removeAttribute("path")})}}}},Wt=(V,X,d,q)=>{let xt=jQuery(q||M.icdt.target).find("#"+V).get(0);return xt||(xt=window.document.createElementNS("http://www.w3.org/2000/svg",X),xt.setAttribute("id",V),jQuery(xt).appendTo(q||M.icdt.target)),jQuery(xt).attr((null==d?void 0:d.attribute)||{}),jQuery(xt).css((null==d?void 0:d.style)||{}),xt},_t=(V,X)=>{let d=(0,E.v)(2),q={fill:_.S3.fill,stroke:_.S3.stroke,"stroke-width":(0,E.v)(_.S3.strokeWidth)};return[{element:Wt("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:X.x-d,y:X.y-d,width:X.width+2*d,height:X.height+2*d},q)},V),posType:"rect-center"}]},et=(V,X)=>{let{size:d}=X,q=(0,E.v)(1),xt=(0,E.v)(2),wt=(0,E.v)(5),Mt={stroke:_.NV.stroke,"stroke-width":(0,E.v)(_.NV.strokeWidth),"stroke-linecap":_.NV.strokeLinecap},Ft={fill:_.Mo.fill,stroke:_.Mo.stroke,"stroke-width":(0,E.v)(_.Mo.strokeWidth)},Kt={fill:_.In.fill,stroke:_.In.stroke,"stroke-width":(0,E.v)(_.In.strokeWidth),width:(0,E.v)(_.In.width),height:(0,E.v)(_.In.height)};return Wt("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:d.x-q,y1:d.y,x2:d.x-q,y2:d.y+d.height},Mt)},V),Wt("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-q,x2:d.x+d.width,y2:d.y-q},Mt)},V),Wt("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:d.x+d.width+q,y1:d.y,x2:d.x+d.width+q,y2:d.y+d.height},Mt)},V),Wt("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+q,x2:d.x+d.width,y2:d.y+d.height+q},Mt)},V),[{element:Wt("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},Ft),style:{cursor:"move"}},V),posType:"rect-center"},{element:Wt("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:d.x-wt,y:d.y-wt},Kt),style:{cursor:"nw-resize"}},V),posType:"rect-top-left"},{element:Wt("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:d.x+d.width-xt,y:d.y-wt},Kt),style:{cursor:"ne-resize"}},V),posType:"rect-top-right"},{element:Wt("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:d.x-wt,y:d.y+d.height-xt},Kt),style:{cursor:"sw-resize"}},V),posType:"rect-bottom-left"},{element:Wt("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:d.x+d.width-xt,y:d.y+d.height-xt},Kt),style:{cursor:"se-resize"}},V),posType:"rect-bottom-right"}]},K=(V,X,d)=>{let q=(0,E.v)(1),xt={stroke:_.NV.stroke,"stroke-width":(0,E.v)(_.NV.strokeWidth),"stroke-linecap":_.NV.strokeLinecap},wt={fill:_.Mo.fill,stroke:_.Mo.stroke,"stroke-width":(0,E.v)(_.Mo.strokeWidth)},Mt={fill:_.dt.fill,stroke:_.dt.stroke,"stroke-width":(0,E.v)(_.dt.strokeWidth)},$t=(Wt("icdt-temp-select-line-left","line",{attribute:Object.assign({x1:d.x-q,y1:d.y,x2:d.x-q,y2:d.y+d.height},xt)},V),Wt("icdt-temp-select-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-q,x2:d.x+d.width,y2:d.y-q},xt)},V),Wt("icdt-temp-select-line-right","line",{attribute:Object.assign({x1:d.x+d.width+q,y1:d.y,x2:d.x+d.width+q,y2:d.y+d.height},xt)},V),Wt("icdt-temp-select-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+q,x2:d.x+d.width,y2:d.y+d.height+q},xt)},V),Wt("icdt-temp-select-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},wt)},V));return X.forEach(Z=>{let{size:c}=Z;Wt("icdt-temp-select-rect-node-"+Z.id,"rect",{attribute:Object.assign({x:c.x,y:c.y,width:c.width,height:c.height},Mt)},V)}),[{element:$t,posType:"rect-center"}]},ht=(V,X)=>{let d=(0,E.v)(1),q={stroke:_.NV.stroke,"stroke-width":(0,E.v)(_.NV.strokeWidth),"stroke-linecap":_.NV.strokeLinecap},xt={fill:_.Mo.fill,stroke:_.Mo.stroke,"stroke-width":(0,E.v)(_.Mo.strokeWidth)};return Wt("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:X.x-d,y1:X.y,x2:X.x-d,y2:X.y+X.height},q)},V),Wt("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:X.x,y1:X.y-d,x2:X.x+X.width,y2:X.y-d},q)},V),Wt("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:X.x+X.width+d,y1:X.y,x2:X.x+X.width+d,y2:X.y+X.height},q)},V),Wt("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:X.x,y1:X.y+X.height+d,x2:X.x+X.width,y2:X.y+X.height+d},q)},V),[{element:Wt("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:X.x,y:X.y,width:X.width,height:X.height},xt)},V),posType:"rect-center"}]},St=(V,X)=>((0,E.v)(-1),(0,E.v)(_.h8.strokeWidth),(0,E.v)(_.h8.strokeDasharray),Wt("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:X.x,y:X.y,width:X.width,height:X.height,class:"cursor-draw"},{fill:_.MA.fill})},V),[]),Gt=(V,X)=>{let d={fill:_.k0.fill,stroke:_.k0.stroke,"stroke-width":(0,E.v)(_.k0.strokeWidth),"stroke-dasharray":(0,E.v)(_.k0.strokeDasharray)};jQuery(V).empty(),X.forEach(q=>{var xt,wt;let{size:Mt}=q;if(!q.idx)return;Wt("icdt-temp-index-rect-node-"+q.id,"rect",{attribute:Object.assign({x:Mt.x-5,y:Mt.y-5,width:Mt.width+10,height:Mt.height+10},d)},V);let{element:Ft}=(0,k.e)(Math.ceil(1e9*Math.random()),{size:{x:Mt.x-76,y:Mt.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(xt=q.idx)&&void 0!==xt?xt:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(wt=q.time)&&void 0!==wt?wt:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},V);Ft.classList.add("node-input"),jQuery(Ft).on("change",'input[name="idx"]',Kt=>{var Tt;q.idx=parseInt(null!==(Tt=Kt.target.value)&&void 0!==Tt?Tt:"0")}).on("change",'input[name="time"]',Kt=>{var Tt;q.time=parseFloat(null!==(Tt=Kt.target.value)&&void 0!==Tt?Tt:"0")}).on("click",'button[name="remove"]',Kt=>{q.idx=0,q.time=null,Gt(V,X)})})},Ot=(V,X)=>{var d,q,xt,wt,Mt,Ft;let{color:Kt,opacity:Tt,path:ct,url:$t,base64:Z}=null!==(d=null==X||null===(q=X.svg)||void 0===q?void 0:q.background)&&void 0!==d?d:{},{x:c,y:F,width:J,height:W}=null!==(xt=null==X||null===(wt=X.svg)||void 0===wt?void 0:wt.viewBox)&&void 0!==xt?xt:{x:0,y:0,width:0,height:0};(0,it.$)(void 0,{size:{x:0,y:-7,width:J,height:W},attribute:{fill:"#999",fontSize:14,class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(Mt=null!==(Ft=null==X?void 0:X.name)&&void 0!==Ft?Ft:null==X?void 0:X.code)&&void 0!==Mt?Mt:void 0}}},V),(0,Q.f)(void 0,{size:{x:c,y:F,width:J,height:W},attribute:{fill:"#fff",stroke:"#999",strokeWidth:1,strokeDasharray:10,class:"hide-on-viewer"}},V),Kt&&(0,Q.f)(void 0,{size:{x:c,y:F,width:J,height:W},attribute:{fill:Kt,fillOpacity:Tt}},V),ct&&(0,U.G)(void 0,{size:{x:c,y:F,width:J,height:W},source:{type:"image",image:{path:ct,url:$t,base64:Z}}},V)},le=(V,X)=>{var d;switch(jQuery(V).empty(),null===(d=X.test)||void 0===d?void 0:d.type){case"truefalse":{var q,xt,wt;let F=null==X||null===(q=X.test)||void 0===q||null===(q=q.answer)||void 0===q||null===(q=q.truefalse)||void 0===q?void 0:q.value;null===(xt=X.svg)||void 0===xt||xt.nodes.filter(J=>{var W;return"truefalse"==(null===(W=J.source)||void 0===W||null===(W=W.test)||void 0===W?void 0:W.type)&&J.id!=F}).forEach(J=>{var W;let{x:B,y:nt,width:P,height:H}=null!==(W=null==J?void 0:J.size)&&void 0!==W?W:{x:0,y:0,width:0,height:0};(0,z._)(Math.ceil(1e9*Math.random()),{size:{x:B-.5,y:nt-.5,width:P+1,height:H+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},V)}),null!=X&&null!==(wt=X.test)&&void 0!==wt&&null!==(wt=wt.answer)&&void 0!==wt&&wt.truefalse&&F&&(J=>{let W=tt.$.findNode(F),{x:B,y:nt,width:P,height:H}=null!==(J=null==W?void 0:W.size)&&void 0!==J?J:{x:0,y:0,width:0,height:0};(0,z._)(Math.ceil(1e9*Math.random()),{size:{x:B-2,y:nt-2,width:P+4,height:H+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},V)})();break}case"singlechoice":{var Mt,Ft,Kt;let F=null==X||null===(Mt=X.test)||void 0===Mt||null===(Mt=Mt.answer)||void 0===Mt||null===(Mt=Mt.singlechoice)||void 0===Mt?void 0:Mt.value;null===(Ft=X.svg)||void 0===Ft||Ft.nodes.filter(J=>{var W;return"singlechoice"==(null===(W=J.source)||void 0===W||null===(W=W.test)||void 0===W?void 0:W.type)&&J.id!=F}).forEach(J=>{var W;let{x:B,y:nt,width:P,height:H}=null!==(W=null==J?void 0:J.size)&&void 0!==W?W:{x:0,y:0,width:0,height:0};(0,z._)(Math.ceil(1e9*Math.random()),{size:{x:B-.5,y:nt-.5,width:P+1,height:H+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},V)}),null!=X&&null!==(Kt=X.test)&&void 0!==Kt&&null!==(Kt=Kt.answer)&&void 0!==Kt&&Kt.singlechoice&&F&&(J=>{let W=tt.$.findNode(F),{x:B,y:nt,width:P,height:H}=null!==(J=null==W?void 0:W.size)&&void 0!==J?J:{x:0,y:0,width:0,height:0};(0,z._)(Math.ceil(1e9*Math.random()),{size:{x:B-2,y:nt-2,width:P+4,height:H+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},V)})();break}case"multichoice":{var Tt,ct,$t,Z;let F=null!==(Tt=null==X||null===(ct=X.test)||void 0===ct||null===(ct=ct.answer)||void 0===ct||null===(ct=ct.multichoice)||void 0===ct?void 0:ct.map(J=>J.value))&&void 0!==Tt?Tt:[];var c;null===($t=X.svg)||void 0===$t||$t.nodes.filter(J=>{var W;return"multichoice"==(null===(W=J.source)||void 0===W||null===(W=W.test)||void 0===W?void 0:W.type)&&!F.includes(J.id)}).forEach(J=>{var W;let{x:B,y:nt,width:P,height:H}=null!==(W=null==J?void 0:J.size)&&void 0!==W?W:{x:0,y:0,width:0,height:0};(0,Q.f)(Math.ceil(1e9*Math.random()),{size:{x:B-.5,y:nt-.5,width:P+1,height:H+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},V)}),null!=X&&null!==(Z=X.test)&&void 0!==Z&&null!==(Z=Z.answer)&&void 0!==Z&&Z.multichoice&&F.length&&(null==X||null===(c=X.test)||void 0===c||null===(c=c.answer)||void 0===c||c.multichoice.forEach(J=>{var W;let R=tt.$.findNode(J.value),{x:nt,y:P,width:H,height:mt}=null!==(W=null==R?void 0:R.size)&&void 0!==W?W:{x:0,y:0,width:0,height:0};(0,Q.f)(Math.ceil(1e9*Math.random()),{size:{x:nt-2,y:P-2,width:H+4,height:mt+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},V)}));break}}}},370:(ae,Rt,v)=>{v.d(Rt,{e:()=>ot});const ot=u=>{switch(null==u?void 0:u.type){case 901:return"assets/iframe/lib/mk-image-viewer/viewer.html?url="+u.readfileuploadurl+u.path;case 902:return"assets/iframe/lib/mk-audio-player/player.html?url="+u.readfileuploadurl+u.path;case 903:return"assets/iframe/lib/mk-video-player/player.html?url="+u.readfileuploadurl+u.path;case 908:return"https://view.officeapps.live.com/op/view.aspx?src="+u.readfileuploadurl+u.path;case 909:return"assets/iframe/lib/PDFReader/web/viewer.html?file="+u.readfileuploadurl+u.path;case 906:case 911:case 910:return""+u.readfileuploadurl+u.path;case 905:case 912:var m;return"imsmanifest.xml"==(null===(m=u.path)||void 0===m||null===(m=m.split("/"))||void 0===m?void 0:m.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+u.readfileuploadurl+u.path:""+u.readfileuploadurl+u.path;case 907:case 900:return""+u.readfileuploadurl+u.path;case 904:switch(u.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+u.url;case 1002:var T;return null!==(T=C(u.url))&&void 0!==T?T:"";case 1005:var S;return null!==(S=u.url)&&void 0!==S?S:"";default:var _;return null!==(_=u.url)&&void 0!==_?_:""}default:return""+u.readfileuploadurl+u.path}},C=u=>{let m=lt(u);return m?"https://www.youtube.com/embed/"+m+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},lt=u=>{let m=null==u?void 0:u.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return m&&m.length>=2?m[1]:null}},511:(ae,Rt,v)=>{function j(){}function O(t){return null==t?j:function(){return this.querySelector(t)}}function lt(){return[]}function u(t){return null==t?lt:function(){return this.querySelectorAll(t)}}function S(t){return function(){return this.matches(t)}}function _(t){return function(e){return e.matches(t)}}v.d(Rt,{$0Z:()=>aa,jvg:()=>la});var M=Array.prototype.find;function Q(){return this.firstElementChild}var z=Array.prototype.filter;function tt(){return Array.from(this.children)}function vt(t){return new Array(t.length)}function ft(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function kt(t,e,l,s,h,w){for(var N,b=0,D=e.length,at=w.length;b<at;++b)(N=e[b])?(N.__data__=w[b],s[b]=N):l[b]=new ft(t,w[b]);for(;b<D;++b)(N=e[b])&&(h[b]=N)}function Bt(t,e,l,s,h,w,b){var N,D,Zt,at=new Map,ut=e.length,Nt=w.length,jt=new Array(ut);for(N=0;N<ut;++N)(D=e[N])&&(jt[N]=Zt=b.call(D,D.__data__,N,e)+"",at.has(Zt)?h[N]=D:at.set(Zt,D));for(N=0;N<Nt;++N)Zt=b.call(t,w[N],N,w)+"",(D=at.get(Zt))?(s[N]=D,D.__data__=w[N],at.delete(Zt)):l[N]=new ft(t,w[N]);for(N=0;N<ut;++N)(D=e[N])&&at.get(jt[N])===D&&(h[N]=D)}function zt(t){return t.__data__}function Wt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Gt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}ft.prototype={constructor:ft,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var xt="http://www.w3.org/1999/xhtml";const wt={svg:"http://www.w3.org/2000/svg",xhtml:xt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Mt(t){var e=t+="",l=e.indexOf(":");return l>=0&&"xmlns"!==(e=t.slice(0,l))&&(t=t.slice(l+1)),wt.hasOwnProperty(e)?{space:wt[e],local:t}:t}function Ft(t){return function(){this.removeAttribute(t)}}function Kt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Tt(t,e){return function(){this.setAttribute(t,e)}}function ct(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function $t(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttribute(t):this.setAttribute(t,l)}}function Z(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,l)}}function F(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function J(t){return function(){this.style.removeProperty(t)}}function W(t,e,l){return function(){this.style.setProperty(t,e,l)}}function R(t,e,l){return function(){var s=e.apply(this,arguments);null==s?this.style.removeProperty(t):this.style.setProperty(t,s,l)}}function nt(t,e){return t.style.getPropertyValue(e)||F(t).getComputedStyle(t,null).getPropertyValue(e)}function P(t){return function(){delete this[t]}}function H(t,e){return function(){this[t]=e}}function mt(t,e){return function(){var l=e.apply(this,arguments);null==l?delete this[t]:this[t]=l}}function Et(t){return t.trim().split(/^|\s+/)}function Lt(t){return t.classList||new Dt(t)}function Dt(t){this._node=t,this._names=Et(t.getAttribute("class")||"")}function Vt(t,e){for(var l=Lt(t),s=-1,h=e.length;++s<h;)l.add(e[s])}function Qt(t,e){for(var l=Lt(t),s=-1,h=e.length;++s<h;)l.remove(e[s])}function Yt(t){return function(){Vt(this,t)}}function ue(t){return function(){Qt(this,t)}}function be(t,e){return function(){(e.apply(this,arguments)?Vt:Qt)(this,t)}}function fe(){this.textContent=""}function Te(t){return function(){this.textContent=t}}function qe(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ni(){this.innerHTML=""}function ri(t){return function(){this.innerHTML=t}}function vi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function li(){this.nextSibling&&this.parentNode.appendChild(this)}function Je(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function oi(t){return function(){var e=this.ownerDocument,l=this.namespaceURI;return l===xt&&e.documentElement.namespaceURI===xt?e.createElement(t):e.createElementNS(l,t)}}function ti(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ze(t){var e=Mt(t);return(e.local?ti:oi)(e)}function pt(){return null}function i(){var t=this.parentNode;t&&t.removeChild(this)}function r(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function a(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function x(t){return function(){var e=this.__on;if(e){for(var w,l=0,s=-1,h=e.length;l<h;++l)w=e[l],t.type&&w.type!==t.type||w.name!==t.name?e[++s]=w:this.removeEventListener(w.type,w.listener,w.options);++s?e.length=s:delete this.__on}}}function p(t,e,l){return function(){var h,s=this.__on,w=function y(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var b=0,N=s.length;b<N;++b)if((h=s[b]).type===t.type&&h.name===t.name)return this.removeEventListener(h.type,h.listener,h.options),this.addEventListener(h.type,h.listener=w,h.options=l),void(h.value=e);this.addEventListener(t.type,w,l),h={type:t.type,name:t.name,value:e,listener:w,options:l},s?s.push(h):this.__on=[h]}}function I(t,e,l){var s=F(t),h=s.CustomEvent;"function"==typeof h?h=new h(e,l):(h=s.document.createEvent("Event"),l?(h.initEvent(e,l.bubbles,l.cancelable),h.detail=l.detail):h.initEvent(e,!1,!1)),t.dispatchEvent(h)}function st(t,e){return function(){return I(this,t,e)}}function dt(t,e){return function(){return I(this,t,e.apply(this,arguments))}}Dt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Jt=[null];function he(t,e){this._groups=t,this._parents=e}function ge(){return new he([[document.documentElement]],Jt)}he.prototype=ge.prototype={constructor:he,select:function ot(t){"function"!=typeof t&&(t=O(t));for(var e=this._groups,l=e.length,s=new Array(l),h=0;h<l;++h)for(var D,at,w=e[h],b=w.length,N=s[h]=new Array(b),ut=0;ut<b;++ut)(D=w[ut])&&(at=t.call(D,D.__data__,ut,w))&&("__data__"in D&&(at.__data__=D.__data__),N[ut]=at);return new he(s,this._parents)},selectAll:function T(t){t="function"==typeof t?function m(t){return function(){return function C(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):u(t);for(var e=this._groups,l=e.length,s=[],h=[],w=0;w<l;++w)for(var D,b=e[w],N=b.length,at=0;at<N;++at)(D=b[at])&&(s.push(t.call(D,D.__data__,at,b)),h.push(D));return new he(s,h)},selectChild:function U(t){return this.select(null==t?Q:function E(t){return function(){return M.call(this.children,t)}}("function"==typeof t?t:_(t)))},selectChildren:function it(t){return this.selectAll(null==t?tt:function k(t){return function(){return z.call(this.children,t)}}("function"==typeof t?t:_(t)))},filter:function Y(t){"function"!=typeof t&&(t=S(t));for(var e=this._groups,l=e.length,s=new Array(l),h=0;h<l;++h)for(var D,w=e[h],b=w.length,N=s[h]=[],at=0;at<b;++at)(D=w[at])&&t.call(D,D.__data__,at,w)&&N.push(D);return new he(s,this._parents)},data:function re(t,e){if(!arguments.length)return Array.from(this,zt);var l=e?Bt:kt,s=this._parents,h=this._groups;"function"!=typeof t&&(t=function G(t){return function(){return t}}(t));for(var w=h.length,b=new Array(w),N=new Array(w),D=new Array(w),at=0;at<w;++at){var ut=s[at],Nt=h[at],jt=Nt.length,Zt=Wt(t.call(ut,ut&&ut.__data__,at,s)),pe=Zt.length,xe=N[at]=new Array(pe),Pt=b[at]=new Array(pe);l(ut,Nt,xe,Pt,D[at]=new Array(jt),Zt,e);for(var oe,ve,ee=0,Xt=0;ee<pe;++ee)if(oe=xe[ee]){for(ee>=Xt&&(Xt=ee+1);!(ve=Pt[Xt])&&++Xt<pe;);oe._next=ve||null}}return(b=new he(b,s))._enter=N,b._exit=D,b},enter:function gt(){return new he(this._enter||this._groups.map(vt),this._parents)},exit:function _t(){return new he(this._exit||this._groups.map(vt),this._parents)},join:function et(t,e,l){var s=this.enter(),h=this,w=this.exit();return"function"==typeof t?(s=t(s))&&(s=s.selection()):s=s.append(t+""),null!=e&&(h=e(h))&&(h=h.selection()),null==l?w.remove():l(w),s&&h?s.merge(h).order():h},merge:function K(t){for(var e=t.selection?t.selection():t,l=this._groups,s=e._groups,h=l.length,b=Math.min(h,s.length),N=new Array(h),D=0;D<b;++D)for(var Zt,at=l[D],ut=s[D],Nt=at.length,jt=N[D]=new Array(Nt),pe=0;pe<Nt;++pe)(Zt=at[pe]||ut[pe])&&(jt[pe]=Zt);for(;D<h;++D)N[D]=l[D];return new he(N,this._parents)},selection:function _e(){return this},order:function ht(){for(var t=this._groups,e=-1,l=t.length;++e<l;)for(var b,s=t[e],h=s.length-1,w=s[h];--h>=0;)(b=s[h])&&(w&&4^b.compareDocumentPosition(w)&&w.parentNode.insertBefore(b,w),w=b);return this},sort:function St(t){function e(Nt,jt){return Nt&&jt?t(Nt.__data__,jt.__data__):!Nt-!jt}t||(t=Gt);for(var l=this._groups,s=l.length,h=new Array(s),w=0;w<s;++w){for(var at,b=l[w],N=b.length,D=h[w]=new Array(N),ut=0;ut<N;++ut)(at=b[ut])&&(D[ut]=at);D.sort(e)}return new he(h,this._parents).order()},call:function Ot(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function le(){return Array.from(this)},node:function V(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var s=t[e],h=0,w=s.length;h<w;++h){var b=s[h];if(b)return b}return null},size:function X(){let t=0;for(const e of this)++t;return t},empty:function d(){return!this.node()},each:function q(t){for(var e=this._groups,l=0,s=e.length;l<s;++l)for(var N,h=e[l],w=0,b=h.length;w<b;++w)(N=h[w])&&t.call(N,N.__data__,w,h);return this},attr:function c(t,e){var l=Mt(t);if(arguments.length<2){var s=this.node();return l.local?s.getAttributeNS(l.space,l.local):s.getAttribute(l)}return this.each((null==e?l.local?Kt:Ft:"function"==typeof e?l.local?Z:$t:l.local?ct:Tt)(l,e))},style:function B(t,e,l){return arguments.length>1?this.each((null==e?J:"function"==typeof e?R:W)(t,e,null==l?"":l)):nt(this.node(),t)},property:function It(t,e){return arguments.length>1?this.each((null==e?P:"function"==typeof e?mt:H)(t,e)):this.node()[t]},classed:function ce(t,e){var l=Et(t+"");if(arguments.length<2){for(var s=Lt(this.node()),h=-1,w=l.length;++h<w;)if(!s.contains(l[h]))return!1;return!0}return this.each(("function"==typeof e?be:e?Yt:ue)(l,e))},text:function Ue(t){return arguments.length?this.each(null==t?fe:("function"==typeof t?qe:Te)(t)):this.node().textContent},html:function Me(t){return arguments.length?this.each(null==t?ni:("function"==typeof t?vi:ri)(t)):this.node().innerHTML},raise:function Ge(){return this.each(li)},lower:function ai(){return this.each(Je)},append:function si(t){var e="function"==typeof t?t:Ze(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function A(t,e){var l="function"==typeof t?t:Ze(t),s=null==e?pt:"function"==typeof e?e:O(e);return this.select(function(){return this.insertBefore(l.apply(this,arguments),s.apply(this,arguments)||null)})},remove:function n(){return this.each(i)},clone:function o(t){return this.select(t?a:r)},datum:function g(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function L(t,e,l){var h,b,s=function f(t){return t.trim().split(/^|\s+/).map(function(e){var l="",s=e.indexOf(".");return s>=0&&(l=e.slice(s+1),e=e.slice(0,s)),{type:e,name:l}})}(t+""),w=s.length;if(!(arguments.length<2)){for(N=e?p:x,h=0;h<w;++h)this.each(N(s[h],e,l));return this}var N=this.node().__on;if(N)for(var ut,D=0,at=N.length;D<at;++D)for(h=0,ut=N[D];h<w;++h)if((b=s[h]).type===ut.type&&b.name===ut.name)return ut.value},dispatch:function yt(t,e){return this.each(("function"==typeof e?dt:st)(t,e))},[Symbol.iterator]:function*At(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var b,s=t[e],h=0,w=s.length;h<w;++h)(b=s[h])&&(yield b)}};const ye=ge;var Ee={value:()=>{}};function vn(){for(var s,t=0,e=arguments.length,l={};t<e;++t){if(!(s=arguments[t]+"")||s in l||/[\s.]/.test(s))throw new Error("illegal type: "+s);l[s]=[]}return new Ri(l)}function Ri(t){this._=t}function ar(t,e){for(var h,l=0,s=t.length;l<s;++l)if((h=t[l]).name===e)return h.value}function gn(t,e,l){for(var s=0,h=t.length;s<h;++s)if(t[s].name===e){t[s]=Ee,t=t.slice(0,s).concat(t.slice(s+1));break}return null!=l&&t.push({name:e,value:l}),t}Ri.prototype=vn.prototype={constructor:Ri,on:function(t,e){var h,l=this._,s=function lr(t,e){return t.trim().split(/^|\s+/).map(function(l){var s="",h=l.indexOf(".");if(h>=0&&(s=l.slice(h+1),l=l.slice(0,h)),l&&!e.hasOwnProperty(l))throw new Error("unknown type: "+l);return{type:l,name:s}})}(t+"",l),w=-1,b=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++w<b;)if(h=(t=s[w]).type)l[h]=gn(l[h],t.name,e);else if(null==e)for(h in l)l[h]=gn(l[h],t.name,null);return this}for(;++w<b;)if((h=(t=s[w]).type)&&(h=ar(l[h],t.name)))return h},copy:function(){var t={},e=this._;for(var l in e)t[l]=e[l].slice();return new Ri(t)},call:function(t,e){if((h=arguments.length-2)>0)for(var h,w,l=new Array(h),s=0;s<h;++s)l[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,h=(w=this._[t]).length;s<h;++s)w[s].value.apply(e,l)},apply:function(t,e,l){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],h=0,w=s.length;h<w;++h)s[h].value.apply(e,l)}};const or=vn;var Ni,Oi,gi=0,xi=0,Ei=0,yn=1e3,Li=0,di=0,Di=0,Si="object"==typeof performance&&performance.now?performance:Date,pn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Xi(){return di||(pn(sr),di=Si.now()+Di)}function sr(){di=0}function ji(){this._call=this._time=this._next=null}function mn(t,e,l){var s=new ji;return s.restart(t,e,l),s}function _n(){di=(Li=Si.now())+Di,gi=xi=0;try{!function dr(){Xi(),++gi;for(var e,t=Ni;t;)(e=di-t._time)>=0&&t._call.call(void 0,e),t=t._next;--gi}()}finally{gi=0,function hr(){for(var t,l,e=Ni,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(l=e._next,e._next=null,e=t?t._next=l:Ni=l);Oi=t,Yi(s)}(),di=0}}function ur(){var t=Si.now(),e=t-Li;e>yn&&(Di-=e,Li=t)}function Yi(t){gi||(xi&&(xi=clearTimeout(xi)),t-di>24?(t<1/0&&(xi=setTimeout(_n,t-Si.now()-Di)),Ei&&(Ei=clearInterval(Ei))):(Ei||(Li=Si.now(),Ei=setInterval(ur,yn)),gi=1,pn(_n)))}function wn(t,e,l){var s=new ji;return s.restart(h=>{s.stop(),t(h+e)},e=null==e?0:+e,l),s}ji.prototype=mn.prototype={constructor:ji,restart:function(t,e,l){if("function"!=typeof t)throw new TypeError("callback is not a function");l=(null==l?Xi():+l)+(null==e?0:+e),!this._next&&Oi!==this&&(Oi?Oi._next=this:Ni=this,Oi=this),this._call=t,this._time=l,Yi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yi())}};var cr=or("start","end","cancel","interrupt"),fr=[],bn=0,zi=3;function Ki(t,e,l,s,h,w){var b=t.__transition;if(b){if(l in b)return}else t.__transition={};!function vr(t,e,l){var h,s=t.__transition;function b(at){var ut,Nt,jt,Zt;if(1!==l.state)return D();for(ut in s)if((Zt=s[ut]).name===l.name){if(Zt.state===zi)return wn(b);4===Zt.state?(Zt.state=6,Zt.timer.stop(),Zt.on.call("interrupt",t,t.__data__,Zt.index,Zt.group),delete s[ut]):+ut<e&&(Zt.state=6,Zt.timer.stop(),Zt.on.call("cancel",t,t.__data__,Zt.index,Zt.group),delete s[ut])}if(wn(function(){l.state===zi&&(l.state=4,l.timer.restart(N,l.delay,l.time),N(at))}),l.state=2,l.on.call("start",t,t.__data__,l.index,l.group),2===l.state){for(l.state=zi,h=new Array(jt=l.tween.length),ut=0,Nt=-1;ut<jt;++ut)(Zt=l.tween[ut].value.call(t,t.__data__,l.index,l.group))&&(h[++Nt]=Zt);h.length=Nt+1}}function N(at){for(var ut=at<l.duration?l.ease.call(null,at/l.duration):(l.timer.restart(D),l.state=5,1),Nt=-1,jt=h.length;++Nt<jt;)h[Nt].call(t,ut);5===l.state&&(l.on.call("end",t,t.__data__,l.index,l.group),D())}function D(){for(var at in l.state=6,l.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=l,l.timer=mn(function w(at){l.state=1,l.timer.restart(b,l.delay,l.time),l.delay<=at&&b(at-l.delay)},0,l.time)}(t,l,{name:e,index:s,group:h,on:cr,tween:fr,time:w.time,delay:w.delay,duration:w.duration,ease:w.ease,timer:null,state:bn})}function tn(t,e){var l=We(t,e);if(l.state>bn)throw new Error("too late; already scheduled");return l}function Qe(t,e){var l=We(t,e);if(l.state>zi)throw new Error("too late; already running");return l}function We(t,e){var l=t.__transition;if(!l||!(l=l[e]))throw new Error("transition not found");return l}function ei(t,e){return t=+t,e=+e,function(l){return t*(1-l)+e*l}}var Ui,On=180/Math.PI,en={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Sn(t,e,l,s,h,w){var b,N,D;return(b=Math.sqrt(t*t+e*e))&&(t/=b,e/=b),(D=t*l+e*s)&&(l-=t*D,s-=e*D),(N=Math.sqrt(l*l+s*s))&&(l/=N,s/=N,D/=N),t*s<e*l&&(t=-t,e=-e,D=-D,b=-b),{translateX:h,translateY:w,rotate:Math.atan2(e,t)*On,skewX:Math.atan(D)*On,scaleX:b,scaleY:N}}function kn(t,e,l,s){function h(at){return at.length?at.pop()+" ":""}return function(at,ut){var Nt=[],jt=[];return at=t(at),ut=t(ut),function w(at,ut,Nt,jt,Zt,pe){if(at!==Nt||ut!==jt){var xe=Zt.push("translate(",null,e,null,l);pe.push({i:xe-4,x:ei(at,Nt)},{i:xe-2,x:ei(ut,jt)})}else(Nt||jt)&&Zt.push("translate("+Nt+e+jt+l)}(at.translateX,at.translateY,ut.translateX,ut.translateY,Nt,jt),function b(at,ut,Nt,jt){at!==ut?(at-ut>180?ut+=360:ut-at>180&&(at+=360),jt.push({i:Nt.push(h(Nt)+"rotate(",null,s)-2,x:ei(at,ut)})):ut&&Nt.push(h(Nt)+"rotate("+ut+s)}(at.rotate,ut.rotate,Nt,jt),function N(at,ut,Nt,jt){at!==ut?jt.push({i:Nt.push(h(Nt)+"skewX(",null,s)-2,x:ei(at,ut)}):ut&&Nt.push(h(Nt)+"skewX("+ut+s)}(at.skewX,ut.skewX,Nt,jt),function D(at,ut,Nt,jt,Zt,pe){if(at!==Nt||ut!==jt){var xe=Zt.push(h(Zt)+"scale(",null,",",null,")");pe.push({i:xe-4,x:ei(at,Nt)},{i:xe-2,x:ei(ut,jt)})}else(1!==Nt||1!==jt)&&Zt.push(h(Zt)+"scale("+Nt+","+jt+")")}(at.scaleX,at.scaleY,ut.scaleX,ut.scaleY,Nt,jt),at=ut=null,function(Zt){for(var Pt,pe=-1,xe=jt.length;++pe<xe;)Nt[(Pt=jt[pe]).i]=Pt.x(Zt);return Nt.join("")}}}var _r=kn(function pr(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?en:Sn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),wr=kn(function mr(t){return null!=t&&(Ui||(Ui=document.createElementNS("http://www.w3.org/2000/svg","g")),Ui.setAttribute("transform",t),t=Ui.transform.baseVal.consolidate())?Sn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):en},", ",")",")");function br(t,e){var l,s;return function(){var h=Qe(this,t),w=h.tween;if(w!==l)for(var b=0,N=(s=l=w).length;b<N;++b)if(s[b].name===e){(s=s.slice()).splice(b,1);break}h.tween=s}}function xr(t,e,l){var s,h;if("function"!=typeof l)throw new Error;return function(){var w=Qe(this,t),b=w.tween;if(b!==s){h=(s=b).slice();for(var N={name:e,value:l},D=0,at=h.length;D<at;++D)if(h[D].name===e){h[D]=N;break}D===at&&h.push(N)}w.tween=h}}function nn(t,e,l){var s=t._id;return t.each(function(){var h=Qe(this,s);(h.value||(h.value={}))[e]=l.apply(this,arguments)}),function(h){return We(h,s).value[e]}}function rn(t,e,l){t.prototype=e.prototype=l,l.constructor=t}function Tn(t,e){var l=Object.create(t.prototype);for(var s in e)l[s]=e[s];return l}function ki(){}var Gi=1/.7,yi="\\s*([+-]?\\d+)\\s*",Mi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",He="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Or=/^#([0-9a-f]{3,8})$/,Sr=new RegExp(`^rgb\\(${yi},${yi},${yi}\\)$`),kr=new RegExp(`^rgb\\(${He},${He},${He}\\)$`),Tr=new RegExp(`^rgba\\(${yi},${yi},${yi},${Mi}\\)$`),Mr=new RegExp(`^rgba\\(${He},${He},${He},${Mi}\\)$`),Cr=new RegExp(`^hsl\\(${Mi},${He},${He}\\)$`),Ar=new RegExp(`^hsla\\(${Mi},${He},${He},${Mi}\\)$`),Mn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Cn(){return this.rgb().formatHex()}function An(){return this.rgb().formatRgb()}function Ci(t){var e,l;return t=(t+"").trim().toLowerCase(),(e=Or.exec(t))?(l=e[1].length,e=parseInt(e[1],16),6===l?In(e):3===l?new De(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===l?Wi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===l?Wi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Sr.exec(t))?new De(e[1],e[2],e[3],1):(e=kr.exec(t))?new De(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Tr.exec(t))?Wi(e[1],e[2],e[3],e[4]):(e=Mr.exec(t))?Wi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Cr.exec(t))?Nn(e[1],e[2]/100,e[3]/100,1):(e=Ar.exec(t))?Nn(e[1],e[2]/100,e[3]/100,e[4]):Mn.hasOwnProperty(t)?In(Mn[t]):"transparent"===t?new De(NaN,NaN,NaN,0):null}function In(t){return new De(t>>16&255,t>>8&255,255&t,1)}function Wi(t,e,l,s){return s<=0&&(t=e=l=NaN),new De(t,e,l,s)}function Fi(t,e,l,s){return 1===arguments.length?function Rr(t){return t instanceof ki||(t=Ci(t)),t?new De((t=t.rgb()).r,t.g,t.b,t.opacity):new De}(t):new De(t,e,l,null==s?1:s)}function De(t,e,l,s){this.r=+t,this.g=+e,this.b=+l,this.opacity=+s}function Pn(){return`#${hi(this.r)}${hi(this.g)}${hi(this.b)}`}function Rn(){const t=Qi(this.opacity);return`${1===t?"rgb(":"rgba("}${ui(this.r)}, ${ui(this.g)}, ${ui(this.b)}${1===t?")":`, ${t})`}`}function Qi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ui(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function hi(t){return((t=ui(t))<16?"0":"")+t.toString(16)}function Nn(t,e,l,s){return s<=0?t=e=l=NaN:l<=0||l>=1?t=e=NaN:e<=0&&(t=NaN),new Fe(t,e,l,s)}function Ln(t){if(t instanceof Fe)return new Fe(t.h,t.s,t.l,t.opacity);if(t instanceof ki||(t=Ci(t)),!t)return new Fe;if(t instanceof Fe)return t;var e=(t=t.rgb()).r/255,l=t.g/255,s=t.b/255,h=Math.min(e,l,s),w=Math.max(e,l,s),b=NaN,N=w-h,D=(w+h)/2;return N?(b=e===w?(l-s)/N+6*(l<s):l===w?(s-e)/N+2:(e-l)/N+4,N/=D<.5?w+h:2-w-h,b*=60):N=D>0&&D<1?0:b,new Fe(b,N,D,t.opacity)}function Fe(t,e,l,s){this.h=+t,this.s=+e,this.l=+l,this.opacity=+s}function Dn(t){return(t=(t||0)%360)<0?t+360:t}function Hi(t){return Math.max(0,Math.min(1,t||0))}function ln(t,e,l){return 255*(t<60?e+(l-e)*t/60:t<180?l:t<240?e+(l-e)*(240-t)/60:e)}function jn(t,e,l,s,h){var w=t*t,b=w*t;return((1-3*t+3*w-b)*e+(4-6*w+3*b)*l+(1+3*t+3*w-3*b)*s+b*h)/6}rn(ki,Ci,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Cn,formatHex:Cn,formatHex8:function Ir(){return this.rgb().formatHex8()},formatHsl:function Pr(){return Ln(this).formatHsl()},formatRgb:An,toString:An}),rn(De,Fi,Tn(ki,{brighter(t){return t=null==t?Gi:Math.pow(Gi,t),new De(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new De(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new De(ui(this.r),ui(this.g),ui(this.b),Qi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pn,formatHex:Pn,formatHex8:function Nr(){return`#${hi(this.r)}${hi(this.g)}${hi(this.b)}${hi(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Rn,toString:Rn})),rn(Fe,function Lr(t,e,l,s){return 1===arguments.length?Ln(t):new Fe(t,e,l,null==s?1:s)},Tn(ki,{brighter(t){return t=null==t?Gi:Math.pow(Gi,t),new Fe(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Fe(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,l=this.l,s=l+(l<.5?l:1-l)*e,h=2*l-s;return new De(ln(t>=240?t-240:t+120,h,s),ln(t,h,s),ln(t<120?t+240:t-120,h,s),this.opacity)},clamp(){return new Fe(Dn(this.h),Hi(this.s),Hi(this.l),Qi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qi(this.opacity);return`${1===t?"hsl(":"hsla("}${Dn(this.h)}, ${100*Hi(this.s)}%, ${100*Hi(this.l)}%${1===t?")":`, ${t})`}`}}));const zn=t=>()=>t;function Kn(t,e){var l=e-t;return l?function Bn(t,e){return function(l){return t+l*e}}(t,l):zn(isNaN(t)?e:t)}const Un=function t(e){var l=function Br(t){return 1==(t=+t)?Kn:function(e,l){return l-e?function zr(t,e,l){return t=Math.pow(t,l),e=Math.pow(e,l)-t,l=1/l,function(s){return Math.pow(t+s*e,l)}}(e,l,t):zn(isNaN(e)?l:e)}}(e);function s(h,w){var b=l((h=Fi(h)).r,(w=Fi(w)).r),N=l(h.g,w.g),D=l(h.b,w.b),at=Kn(h.opacity,w.opacity);return function(ut){return h.r=b(ut),h.g=N(ut),h.b=D(ut),h.opacity=at(ut),h+""}}return s.gamma=t,s}(1);function Gn(t){return function(e){var b,N,l=e.length,s=new Array(l),h=new Array(l),w=new Array(l);for(b=0;b<l;++b)N=Fi(e[b]),s[b]=N.r||0,h[b]=N.g||0,w[b]=N.b||0;return s=t(s),h=t(h),w=t(w),N.opacity=1,function(D){return N.r=s(D),N.g=h(D),N.b=w(D),N+""}}}Gn(function Dr(t){var e=t.length-1;return function(l){var s=l<=0?l=0:l>=1?(l=1,e-1):Math.floor(l*e),h=t[s],w=t[s+1];return jn((l-s/e)*e,s>0?t[s-1]:2*h-w,h,w,s<e-1?t[s+2]:2*w-h)}}),Gn(function jr(t){var e=t.length;return function(l){var s=Math.floor(((l%=1)<0?++l:l)*e);return jn((l-s/e)*e,t[(s+e-1)%e],t[s%e],t[(s+1)%e],t[(s+2)%e])}});var an=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,on=new RegExp(an.source,"g");function Gr(t,e){var s,h,w,l=an.lastIndex=on.lastIndex=0,b=-1,N=[],D=[];for(t+="",e+="";(s=an.exec(t))&&(h=on.exec(e));)(w=h.index)>l&&(w=e.slice(l,w),N[b]?N[b]+=w:N[++b]=w),(s=s[0])===(h=h[0])?N[b]?N[b]+=h:N[++b]=h:(N[++b]=null,D.push({i:b,x:ei(s,h)})),l=on.lastIndex;return l<e.length&&(w=e.slice(l),N[b]?N[b]+=w:N[++b]=w),N.length<2?D[0]?function Ur(t){return function(e){return t(e)+""}}(D[0].x):function Kr(t){return function(){return t}}(e):(e=D.length,function(at){for(var Nt,ut=0;ut<e;++ut)N[(Nt=D[ut]).i]=Nt.x(at);return N.join("")})}function Wn(t,e){var l;return("number"==typeof e?ei:e instanceof Ci?Un:(l=Ci(e))?(e=l,Un):Gr)(t,e)}function Wr(t){return function(){this.removeAttribute(t)}}function Fr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qr(t,e,l){var s,w,h=l+"";return function(){var b=this.getAttribute(t);return b===h?null:b===s?w:w=e(s=b,l)}}function Hr(t,e,l){var s,w,h=l+"";return function(){var b=this.getAttributeNS(t.space,t.local);return b===h?null:b===s?w:w=e(s=b,l)}}function Vr(t,e,l){var s,h,w;return function(){var b,D,N=l(this);return null==N?void this.removeAttribute(t):(b=this.getAttribute(t))===(D=N+"")?null:b===s&&D===h?w:(h=D,w=e(s=b,N))}}function Jr(t,e,l){var s,h,w;return function(){var b,D,N=l(this);return null==N?void this.removeAttributeNS(t.space,t.local):(b=this.getAttributeNS(t.space,t.local))===(D=N+"")?null:b===s&&D===h?w:(h=D,w=e(s=b,N))}}function $r(t,e){var l,s;function h(){var w=e.apply(this,arguments);return w!==s&&(l=(s=w)&&function Yr(t,e){return function(l){this.setAttributeNS(t.space,t.local,e.call(this,l))}}(t,w)),l}return h._value=e,h}function qr(t,e){var l,s;function h(){var w=e.apply(this,arguments);return w!==s&&(l=(s=w)&&function Xr(t,e){return function(l){this.setAttribute(t,e.call(this,l))}}(t,w)),l}return h._value=e,h}function el(t,e){return function(){tn(this,t).delay=+e.apply(this,arguments)}}function il(t,e){return e=+e,function(){tn(this,t).delay=e}}function rl(t,e){return function(){Qe(this,t).duration=+e.apply(this,arguments)}}function ll(t,e){return e=+e,function(){Qe(this,t).duration=e}}var wl=ye.prototype.constructor;function Fn(t){return function(){this.style.removeProperty(t)}}var zl=0;function Xe(t,e,l,s){this._groups=t,this._parents=e,this._name=l,this._id=s}function Qn(){return++zl}var Ye=ye.prototype;Xe.prototype=function Bl(t){return ye().transition(t)}.prototype={constructor:Xe,select:function ml(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=O(t));for(var s=this._groups,h=s.length,w=new Array(h),b=0;b<h;++b)for(var ut,Nt,N=s[b],D=N.length,at=w[b]=new Array(D),jt=0;jt<D;++jt)(ut=N[jt])&&(Nt=t.call(ut,ut.__data__,jt,N))&&("__data__"in ut&&(Nt.__data__=ut.__data__),at[jt]=Nt,Ki(at[jt],e,l,jt,at,We(ut,l)));return new Xe(w,this._parents,e,l)},selectAll:function _l(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=u(t));for(var s=this._groups,h=s.length,w=[],b=[],N=0;N<h;++N)for(var ut,D=s[N],at=D.length,Nt=0;Nt<at;++Nt)if(ut=D[Nt]){for(var Zt,jt=t.call(ut,ut.__data__,Nt,D),pe=We(ut,l),xe=0,Pt=jt.length;xe<Pt;++xe)(Zt=jt[xe])&&Ki(Zt,e,l,xe,jt,pe);w.push(jt),b.push(ut)}return new Xe(w,b,e,l)},selectChild:Ye.selectChild,selectChildren:Ye.selectChildren,filter:function hl(t){"function"!=typeof t&&(t=S(t));for(var e=this._groups,l=e.length,s=new Array(l),h=0;h<l;++h)for(var D,w=e[h],b=w.length,N=s[h]=[],at=0;at<b;++at)(D=w[at])&&t.call(D,D.__data__,at,w)&&N.push(D);return new Xe(s,this._parents,this._name,this._id)},merge:function cl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,l=t._groups,s=e.length,w=Math.min(s,l.length),b=new Array(s),N=0;N<w;++N)for(var jt,D=e[N],at=l[N],ut=D.length,Nt=b[N]=new Array(ut),Zt=0;Zt<ut;++Zt)(jt=D[Zt]||at[Zt])&&(Nt[Zt]=jt);for(;N<s;++N)b[N]=e[N];return new Xe(b,this._parents,this._name,this._id)},selection:function bl(){return new wl(this._groups,this._parents)},transition:function Dl(){for(var t=this._name,e=this._id,l=Qn(),s=this._groups,h=s.length,w=0;w<h;++w)for(var D,b=s[w],N=b.length,at=0;at<N;++at)if(D=b[at]){var ut=We(D,e);Ki(D,t,l,at,b,{time:ut.time+ut.delay+ut.duration,delay:0,duration:ut.duration,ease:ut.ease})}return new Xe(s,this._parents,t,l)},call:Ye.call,nodes:Ye.nodes,node:Ye.node,size:Ye.size,empty:Ye.empty,each:Ye.each,on:function gl(t,e){var l=this._id;return arguments.length<2?We(this.node(),l).on.on(t):this.each(function vl(t,e,l){var s,h,w=function fl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var l=e.indexOf(".");return l>=0&&(e=e.slice(0,l)),!e||"start"===e})}(e)?tn:Qe;return function(){var b=w(this,t),N=b.on;N!==s&&(h=(s=N).copy()).on(e,l),b.on=h}}(l,t,e))},attr:function Zr(t,e){var l=Mt(t),s="transform"===l?wr:Wn;return this.attrTween(t,"function"==typeof e?(l.local?Jr:Vr)(l,s,nn(this,"attr."+t,e)):null==e?(l.local?Fr:Wr)(l):(l.local?Hr:Qr)(l,s,e))},attrTween:function tl(t,e){var l="attr."+t;if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==e)return this.tween(l,null);if("function"!=typeof e)throw new Error;var s=Mt(t);return this.tween(l,(s.local?$r:qr)(s,e))},style:function kl(t,e,l){var s="transform"==(t+="")?_r:Wn;return null==e?this.styleTween(t,function xl(t,e){var l,s,h;return function(){var w=nt(this,t),b=(this.style.removeProperty(t),nt(this,t));return w===b?null:w===l&&b===s?h:h=e(l=w,s=b)}}(t,s)).on("end.style."+t,Fn(t)):"function"==typeof e?this.styleTween(t,function Ol(t,e,l){var s,h,w;return function(){var b=nt(this,t),N=l(this),D=N+"";return null==N&&(this.style.removeProperty(t),D=N=nt(this,t)),b===D?null:b===s&&D===h?w:(h=D,w=e(s=b,N))}}(t,s,nn(this,"style."+t,e))).each(function Sl(t,e){var l,s,h,N,w="style."+e,b="end."+w;return function(){var D=Qe(this,t),at=D.on,ut=null==D.value[w]?N||(N=Fn(e)):void 0;(at!==l||h!==ut)&&(s=(l=at).copy()).on(b,h=ut),D.on=s}}(this._id,t)):this.styleTween(t,function El(t,e,l){var s,w,h=l+"";return function(){var b=nt(this,t);return b===h?null:b===s?w:w=e(s=b,l)}}(t,s,e),l).on("end.style."+t,null)},styleTween:function Cl(t,e,l){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(null==e)return this.tween(s,null);if("function"!=typeof e)throw new Error;return this.tween(s,function Ml(t,e,l){var s,h;function w(){var b=e.apply(this,arguments);return b!==h&&(s=(h=b)&&function Tl(t,e,l){return function(s){this.style.setProperty(t,e.call(this,s),l)}}(t,b,l)),s}return w._value=e,w}(t,e,null==l?"":l))},text:function Pl(t){return this.tween("text","function"==typeof t?function Il(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(nn(this,"text",t)):function Al(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function Ll(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function Nl(t){var e,l;function s(){var h=t.apply(this,arguments);return h!==l&&(e=(l=h)&&function Rl(t){return function(e){this.textContent=t.call(this,e)}}(h)),e}return s._value=t,s}(t))},remove:function pl(){return this.on("end.remove",function yl(t){return function(){var e=this.parentNode;for(var l in this.__transition)if(+l!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function Er(t,e){var l=this._id;if(t+="",arguments.length<2){for(var b,s=We(this.node(),l).tween,h=0,w=s.length;h<w;++h)if((b=s[h]).name===t)return b.value;return null}return this.each((null==e?br:xr)(l,t,e))},delay:function nl(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?el:il)(e,t)):We(this.node(),e).delay},duration:function al(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?rl:ll)(e,t)):We(this.node(),e).duration},ease:function sl(t){var e=this._id;return arguments.length?this.each(function ol(t,e){if("function"!=typeof e)throw new Error;return function(){Qe(this,t).ease=e}}(e,t)):We(this.node(),e).ease},easeVarying:function ul(t){if("function"!=typeof t)throw new Error;return this.each(function dl(t,e){return function(){var l=e.apply(this,arguments);if("function"!=typeof l)throw new Error;Qe(this,t).ease=l}}(this._id,t))},end:function jl(){var t,e,l=this,s=l._id,h=l.size();return new Promise(function(w,b){var N={value:b},D={value:function(){0==--h&&w()}};l.each(function(){var at=Qe(this,s),ut=at.on;ut!==t&&((e=(t=ut).copy())._.cancel.push(N),e._.interrupt.push(N),e._.end.push(D)),at.on=e}),0===h&&w()})},[Symbol.iterator]:Ye[Symbol.iterator]};var Ul={time:null,delay:0,duration:250,ease:function Kl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Gl(t,e){for(var l;!(l=t.__transition)||!(l=l[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return l}ye.prototype.interrupt=function yr(t){return this.each(function(){!function gr(t,e){var s,h,b,l=t.__transition,w=!0;if(l){for(b in e=null==e?null:e+"",l)(s=l[b]).name===e?(h=s.state>2&&s.state<5,s.state=6,s.timer.stop(),s.on.call(h?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete l[b]):w=!1;w&&delete t.__transition}}(this,t)})},ye.prototype.transition=function Wl(t){var e,l;t instanceof Xe?(e=t._id,t=t._name):(e=Qn(),(l=Ul).time=Xi(),t=null==t?null:t+"");for(var s=this._groups,h=s.length,w=0;w<h;++w)for(var D,b=s[w],N=b.length,at=0;at<N;++at)(D=b[at])&&Ki(D,t,e,at,b,l||Gl(D,e));return new Xe(s,this._parents,t,e)};Math;function Ai(t){return{type:t}}function _i(t){return function(){return t}}function Yn(t){this._context=t}function $l(t){return new Yn(t)}["w","e"].map(Ai),["n","s"].map(Ai),["n","w","e","s","nw","ne","sw","se"].map(Ai),Yn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const cn=Math.PI,fn=2*cn,ci=1e-6,ql=fn-ci;function $n(t){this._+=t[0];for(let e=1,l=t.length;e<l;++e)this._+=arguments[e]+t[e]}class Zi{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?$n:function ta(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return $n;const l=10**e;return function(s){this._+=s[0];for(let h=1,w=s.length;h<w;++h)this._+=Math.round(arguments[h]*l)/l+s[h]}}(e)}moveTo(e,l){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,l){this._append`L${this._x1=+e},${this._y1=+l}`}quadraticCurveTo(e,l,s,h){this._append`Q${+e},${+l},${this._x1=+s},${this._y1=+h}`}bezierCurveTo(e,l,s,h,w,b){this._append`C${+e},${+l},${+s},${+h},${this._x1=+w},${this._y1=+b}`}arcTo(e,l,s,h,w){if(e=+e,l=+l,s=+s,h=+h,(w=+w)<0)throw new Error(`negative radius: ${w}`);let b=this._x1,N=this._y1,D=s-e,at=h-l,ut=b-e,Nt=N-l,jt=ut*ut+Nt*Nt;if(null===this._x1)this._append`M${this._x1=e},${this._y1=l}`;else if(jt>ci)if(Math.abs(Nt*D-at*ut)>ci&&w){let Zt=s-b,pe=h-N,xe=D*D+at*at,Pt=Zt*Zt+pe*pe,Ct=Math.sqrt(xe),ee=Math.sqrt(jt),Xt=w*Math.tan((cn-Math.acos((xe+jt-Pt)/(2*Ct*ee)))/2),oe=Xt/ee,ve=Xt/Ct;Math.abs(oe-1)>ci&&this._append`L${e+oe*ut},${l+oe*Nt}`,this._append`A${w},${w},0,0,${+(Nt*Zt>ut*pe)},${this._x1=e+ve*D},${this._y1=l+ve*at}`}else this._append`L${this._x1=e},${this._y1=l}`}arc(e,l,s,h,w,b){if(e=+e,l=+l,b=!!b,(s=+s)<0)throw new Error(`negative radius: ${s}`);let N=s*Math.cos(h),D=s*Math.sin(h),at=e+N,ut=l+D,Nt=1^b,jt=b?h-w:w-h;null===this._x1?this._append`M${at},${ut}`:(Math.abs(this._x1-at)>ci||Math.abs(this._y1-ut)>ci)&&this._append`L${at},${ut}`,s&&(jt<0&&(jt=jt%fn+fn),jt>ql?this._append`A${s},${s},0,1,${Nt},${e-N},${l-D}A${s},${s},0,1,${Nt},${this._x1=at},${this._y1=ut}`:jt>ci&&this._append`A${s},${s},0,${+(jt>=cn)},${Nt},${this._x1=e+s*Math.cos(w)},${this._y1=l+s*Math.sin(w)}`)}rect(e,l,s,h){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}h${s=+s}v${+h}h${-s}Z`}toString(){return this._}}function na(t){return t[0]}function ra(t){return t[1]}function la(t,e){var l=_i(!0),s=null,h=$l,w=null,b=function ia(t){let e=3;return t.digits=function(l){if(!arguments.length)return e;if(null==l)e=null;else{const s=Math.floor(l);if(!(s>=0))throw new RangeError(`invalid digits: ${l}`);e=s}return t},()=>new Zi(e)}(N);function N(D){var at,Nt,Zt,ut=(D=function Yl(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(D)).length,jt=!1;for(null==s&&(w=h(Zt=b())),at=0;at<=ut;++at)!(at<ut&&l(Nt=D[at],at,D))===jt&&((jt=!jt)?w.lineStart():w.lineEnd()),jt&&w.point(+t(Nt,at,D),+e(Nt,at,D));if(Zt)return w=null,Zt+""||null}return t="function"==typeof t?t:void 0===t?na:_i(t),e="function"==typeof e?e:void 0===e?ra:_i(e),N.x=function(D){return arguments.length?(t="function"==typeof D?D:_i(+D),N):t},N.y=function(D){return arguments.length?(e="function"==typeof D?D:_i(+D),N):e},N.defined=function(D){return arguments.length?(l="function"==typeof D?D:_i(!!D),N):l},N.curve=function(D){return arguments.length?(h=D,null!=s&&(w=h(s)),N):h},N.context=function(D){return arguments.length?(null==D?s=w=null:w=h(s=D),N):s},N}function qn(t,e,l){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+l)/6)}function tr(t){this._context=t}function aa(t){return new tr(t)}function wi(t,e,l){this.k=t,this.x=e,this.y=l}tr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:qn(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:qn(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},wi.prototype={constructor:wi,scale:function(t){return 1===t?this:new wi(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new wi(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new wi(1,0,0)}}]);