"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4981],{1814:(he,At,f)=>{f.d(At,{In:()=>dt,MA:()=>C,Mo:()=>T,NV:()=>x,S3:()=>z,dt:()=>Z,h8:()=>c,k0:()=>E});const z={fill:"transparent",stroke:"#129bff",strokeWidth:1},x={stroke:"#5F6CE1",strokeWidth:1,strokeLinecap:"round",strokeDasharrays:[4,2,1,2]},dt={fill:"#FFFFFF",stroke:"#5F6CE1",strokeWidth:1,width:7,height:7},T={fill:"transparent",stroke:"transparent",strokeWidth:1},Z={fill:"none",stroke:"#5F6CE1",strokeWidth:1},c={stroke:"#129bff",strokeWidth:1,strokeLinecap:"round",strokeDasharray:8},C={fill:"transparent"},E={fill:"none",stroke:"#999",strokeWidth:1,strokeDasharray:2}},9942:(he,At,f)=>{f.d(At,{w:()=>et,I:()=>S});var z=f(4981),x=f(9054),dt=f(5811),T=/^#[a-fA-F0-9]+$/i,Z=/^rgba\((\d+),(\d+),(\d+),(\d+)\)$/i,c=/^rgb\((\d+),(\d+),(\d+)\)$/i;const C=K=>{let Q=null,at=null;if(K)if("transparent"==K)Q="#000000",at=0;else if(K.match(T))Q=K;else{let I=(K=K.replace(/\s+/g,"")).match(Z);if(I)Q="#"+(256|I[1]).toString(16).slice(1)+(256|I[2]).toString(16).slice(1)+(256|I[3]).toString(16).slice(1),at=(0,dt.q)(parseFloat(I[4]),100);else{let rt=K.match(c);rt&&(Q="#"+(256|rt[1]).toString(16).slice(1)+(256|rt[2]).toString(16).slice(1)+(256|rt[3]).toString(16).slice(1))}}return{hex:Q,alpha:at}},S=K=>w(null==K?void 0:K.url,null==K?void 0:K.path,null==K?void 0:K.src);var w=(K,Q,at)=>{var I,rt;let gt,mt,ct,q;var D,Wt;return K&&(gt=K.replace(/\\/g,"/")),Q&&(mt=Q.replace(/\\/g,"/")),at&&(ct=at.replace(/\\/g,"/")),mt&&!gt&&(gt=(null===(D=z.icdt.config)||void 0===D?void 0:D.readfileuploadurl)+mt),!ct||mt||gt||(mt=ct.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),gt=(null===(Wt=z.icdt.config)||void 0===Wt?void 0:Wt.readfileuploadurl)+mt),q=(null!==(I=gt)&&void 0!==I?I:"").split("/").pop()||(null!==(rt=mt)&&void 0!==rt?rt:"").split("/").pop()||"",{url:gt,path:mt,name:q}};const et=K=>{let Q={x:0,y:0,width:K.screen.w,height:K.screen.h},at=[];return K.data.forEach((I,rt)=>{var gt,mt;let ct={id:"number"==typeof I.id?I.id:z.icdt.data.newSlideId,code:null===(gt=I.id)||void 0===gt?void 0:gt.toString(),name:"string"==typeof I.id?I.id:`Trang ${rt+1}`,svg:{viewBox:Q,nodes:[]},test:(q=I.test2,q?(q.audiotrue&&(q.audiotrue=S({path:q.audiotrue.path})),q.audiofalse&&(q.audiofalse=S({path:q.audiofalse.path})),q.effecttrue&&(q.effecttrue=S({path:q.effecttrue.path})),q.effectfalse&&(q.effectfalse=S({path:q.effectfalse.path})),q.icontrue&&(q.icontrue=S({path:q.icontrue.path})),q.iconfalse&&(q.iconfalse=S({path:q.iconfalse.path})),q):{})};var q;I.background&&ct.svg&&(ct.svg.background=function(K){return K&&(null!==K.match(/#([a-zA-Z0-9]+)/)||null!==K.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==K.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9]+\)/))}(I.background)?{color:I.background}:function(K){return K&&null!==K.match(/data:[^;]+;base64,/)}(I.background)?{base64:I.background}:function(K){return K&&null!==K.match(/http(s)?:\/\//)}(I.background)?w(I.background):w(void 0,I.background)),jQuery(null!==(mt=I.svg)&&void 0!==mt?mt:"").find(".svg-node").each((q,D)=>{var Wt,Lt;let Dt=jQuery(D).parents(".indexs"),Vt=Dt.attr("data-index"),Mt=Dt.attr("data-time"),Gt=null!==(Wt=D.getAttribute("id"))&&void 0!==Wt?Wt:"0",ht={id:parseInt(Gt),code:`${D.nodeName}-${D.getAttribute("id")}`,name:D.nodeName,idx:Vt?parseInt(Vt):0,time:Mt?parseFloat(Mt):0,type:(()=>{switch(D.nodeName){case"polygon":return x.$.POLYGON;case"circle":return x.$.CIRCLE;case"ellipse":return x.$.ELLIPSE;case"line":return x.$.LINE;case"rect":return x.$.RECT;case"foreignObject":return x.$.FOREIGNOBJECT}return 0})(),size:(it=>{let Et=0,St=0,Yt=0,pt=0,ne=null,U=null,P=parseFloat((null===(it=D.getAttribute("transform"))||void 0===it?void 0:it.replace("rotate(","").replace(")",""))||"0")||null;switch(D.nodeName){case"polygon":{var h,H;let yt=[],ft=[],Ot=999999999,Qt=999999999,zt=0,xt=0;ne=JSON.parse(D.getAttribute("ratios")||"[]"),U=null!==(h=null===(H=D.getAttribute("points"))||void 0===H?void 0:H.split(",").map(function(_t){return _t.split(" ").map(function(qt){return parseFloat(qt)})}))&&void 0!==h?h:[],U.forEach(function(_t){yt.push(_t[0]),ft.push(_t[1])}),Ot=Math.min.apply(null,yt),Qt=Math.min.apply(null,ft),zt=Math.max.apply(null,yt),xt=Math.max.apply(null,ft),Et=Ot,St=Qt,Yt=zt-Et,pt=xt-St;break}case"circle":{let yt=parseFloat(D.getAttribute("cx")||"0"),ft=parseFloat(D.getAttribute("cy")||"0"),Ot=parseFloat(D.getAttribute("r")||"0");Et=yt-Ot,St=ft-Ot,Yt=2*Ot,pt=2*Ot;break}case"ellipse":{let yt=parseFloat(D.getAttribute("cx")||"0"),ft=parseFloat(D.getAttribute("cy")||"0"),Ot=parseFloat(D.getAttribute("rx")||"0"),Qt=parseFloat(D.getAttribute("ry")||"0");Et=yt-Ot,St=ft-Qt,Yt=2*Ot,pt=2*Qt;break}case"line":{let yt=parseFloat(D.getAttribute("x1")||"0"),ft=parseFloat(D.getAttribute("y1")||"0"),Ot=parseFloat(D.getAttribute("x2")||"0"),Qt=parseFloat(D.getAttribute("y2")||"0"),zt=999999999,xt=999999999,_t=0,qt=0;zt=Math.min(yt,Ot),xt=Math.min(ft,Qt),_t=Math.max(yt,Ot),qt=Math.max(ft,Qt),Et=zt,St=xt,Yt=_t-Et,pt=qt-St,ne=[[(yt-Et)/(Yt||1),(ft-St)/(pt||1)],[(Ot-Et)/(Yt||1),(Qt-St)/(pt||1)]];break}case"rect":case"foreignObject":Et=parseFloat(D.getAttribute("x")||"0"),St=parseFloat(D.getAttribute("y")||"0"),Yt=parseFloat(D.getAttribute("width")||"0"),pt=parseFloat(D.getAttribute("height")||"0")}return Object.assign({},{x:Et,y:St,width:Yt,height:pt,ratios:ne,points:U,rotate:P})})(),attribute:(()=>{let it={};switch(D.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var Et,St,Yt,pt,ne,U;let P=null!==(Et=D.getAttribute("fill"))&&void 0!==Et?Et:null,h=null!==(St=D.getAttribute("stroke"))&&void 0!==St?St:null,H=null!==(Yt=parseFloat(D.getAttribute("stroke-width")||"0"))&&void 0!==Yt?Yt:null,yt=null!==(pt=D.getAttribute("stroke-linecap"))&&void 0!==pt?pt:null,ft=null!==(ne=D.getAttribute("stroke-linejoin"))&&void 0!==ne?ne:null,Ot=null!==(U=parseFloat(D.getAttribute("stroke-dasharray")||"0"))&&void 0!==U?U:null;Object.assign(it,{fill:P,stroke:h,strokeWidth:H,strokeLinecap:yt,strokeLinejoin:ft,strokeDasharray:Ot});break}}return it})(),style:(()=>{let it={};switch(D.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let ne=jQuery(D).find(".svg-container");if(ne.length){var Et,St;let P=null!==(Et=parseFloat(ne.css("border-width")||"0"))&&void 0!==Et?Et:null,h=null!==(St=ne.css("border-style"))&&void 0!==St?St:null,H=ne.css("border-color")||null,yt=null,ft=ne.css("background-color")||null,Ot=null;(()=>{let{hex:Qt,alpha:zt}=C(H);H=Qt,yt=zt})(),(()=>{let{hex:Qt,alpha:zt}=C(ft);ft=Qt,Ot=zt})(),Object.assign(it,{borderWidth:P,borderStyle:h,borderColor:H,borderOpacity:yt,backgroundColor:ft,backgroundOpacity:Ot})}let U=jQuery(D).find(".svg-editor-content");if(U.length){var Yt,pt;let P=JSON.parse((U.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:h,alpha:H}=C(P.TextColor);Object.assign(it,{fontFamily:null!==(Yt=P.FontFamily)&&void 0!==Yt?Yt:null,fontSize:null!==(pt=P.FontSize)&&void 0!==pt?pt:null,color:h,opacity:H})}break}}return it})(),source:(()=>{let it={};switch(D.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(Dt.hasClass("editors")){let xt=jQuery(D).find(".svg-editor-content");if(xt.length){var Et;let _t=xt.html(),qt=null!==(Et=(null!=_t?_t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==Et?Et:[];Object.assign(it,{type:"html",html:{htmlContent:_t,variableKeywords:qt}})}}else if(Dt.hasClass("inputs")||Dt.hasClass("textareas"))Object.assign(it,{type:"input",input:{input:!!jQuery(D).find("input").length,textarea:!!jQuery(D).find("textarea").length}});else if(Dt.hasClass("tests")){let xt=jQuery(D).find(".svg-test");if(Dt.hasClass("tests-truefalse")){var St,Yt;let _t=xt.find(".svg-editor-content").html(),qt=null!==(St=(null!=_t?_t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==St?St:[];Object.assign(it,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(Yt=I.test2.truefalse)||void 0===Yt?void 0:Yt.includes(Gt)}},html:{htmlContent:_t,variableKeywords:qt}})}else if(Dt.hasClass("tests-singlechoice")){var pt,ne;let _t=xt.find(".svg-editor-content").html(),qt=null!==(pt=(null!=_t?_t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==pt?pt:[];Object.assign(it,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(ne=I.test2.singlechoice)||void 0===ne?void 0:ne.includes(Gt)}},html:{htmlContent:_t,variableKeywords:qt}})}else if(Dt.hasClass("tests-multichoice")){var U,P;let _t=xt.find(".svg-editor-content").html(),qt=null!==(U=(null!=_t?_t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==U?U:[];Object.assign(it,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(P=I.test2.multichoice)||void 0===P?void 0:P.includes(Gt)}},html:{htmlContent:_t,variableKeywords:qt}})}else if(Dt.hasClass("tests-fill")){var h,H;let _t=xt.find(".svg-editor-content").html(),qt=null!==(h=(null!=_t?_t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==h?h:[],Pt=null!==(H=(null!=_t?_t:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==H?H:[];Pt=Pt.filter((re,j,d)=>d.indexOf(re)==j),Object.assign(it,{type:"test",test:{type:"fill",fill:Pt.map(re=>{var j;return{key:re,value:null===(j=I.test2.fill)||void 0===j||null===(j=j.find(d=>d.id==Gt))||void 0===j||null===(j=j.vals)||void 0===j?void 0:j.map(d=>d.text).filter(d=>!["",null,void 0,NaN].includes(d))}})},html:{htmlContent:_t,variableKeywords:qt,fillKeywords:Pt}})}else if(Dt.hasClass("tests-matching")){if(xt.hasClass("svg-test-empty"))Object.assign(it,{type:"test",test:{type:"matching-empty",matching:{key:xt.attr("data-name")||null}}});else if(xt.hasClass("svg-test-content")){var yt;let _t=xt.find(".svg-editor-content").html(),qt=null!==(yt=(null!=_t?_t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==yt?yt:[];Object.assign(it,{type:"test",test:{type:"matching-content",matching:{key:xt.attr("data-name")||null}},html:{htmlContent:_t,variableKeywords:qt}})}}else if(Dt.hasClass("tests-speech")){var ft;Object.assign(it,{type:"speech",speech:{value:null===(ft=I.test2.speech)||void 0===ft||null===(ft=ft.find(_t=>_t.id==Gt))||void 0===ft||null===(ft=ft.vals)||void 0===ft?void 0:ft.map(_t=>_t.text).filter(_t=>!["",null,void 0,NaN].includes(_t))}})}else if(Dt.hasClass("tests-submit")){let _t=jQuery(D).find(".svg-container img");Object.assign(it,{type:"test",test:{type:"submit"},image:w(_t.attr("url"),_t.attr("path"),_t.attr("src"))})}}else if(Dt.hasClass("images")){let xt=jQuery(D).find(".svg-editor-content img");if(xt.length)Object.assign(it,{type:"image",image:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))});else{let _t=jQuery(D).find("iframe");Object.assign(it,{type:"iframe",iframe:w(_t.attr("url"),_t.attr("path"),_t.attr("src"))})}}else if(Dt.hasClass("sounds")){let xt=jQuery(D).find(".svg-editor-content img");xt.length&&Object.assign(it,{type:"image",image:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))})}else if(Dt.hasClass("htmls")){let xt=jQuery(D).find("iframe");xt.length&&Object.assign(it,{type:"iframe",iframe:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))})}else if(Dt.hasClass("svgs")){let xt=jQuery(D).find("svg");var Ot,Qt;xt.length&&Object.assign(it,{type:"svg",svg:Object.assign(w(xt.attr("url"),xt.attr("path"),xt.attr("src")),{svgContent:null!==(Ot=null===(Qt=xt.get(0))||void 0===Qt?void 0:Qt.outerHTML)&&void 0!==Ot?Ot:null})})}else if(Dt.hasClass("medias")){let xt=jQuery(D).find(".media-item");if(xt.length)switch(xt.attr("type")){case"audio":Object.assign(it,{type:"audio",audio:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))});break;case"video":Object.assign(it,{type:"video",video:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))});break;case"file":Object.assign(it,{type:"file",file:w(xt.attr("url"),xt.attr("path"),xt.attr("src"))});break;default:var zt;Object.assign(it,{type:"link",link:{url:null!==(zt=xt.attr("url"))&&void 0!==zt?zt:null}})}let _t=jQuery(D).find("img");_t.length&&(Object.assign(it,{image:w(_t.attr("url"),_t.attr("path"),_t.attr("src"))}),it.type||Object.assign(it,{type:"image"}))}}return it})(),animate:(it=>{let Et={},St=null===(it=I.animates)||void 0===it?void 0:it.find(Yt=>Yt.elementId==Gt);return St&&Object.assign(Et,{value:St.value}),Et})(),interactive:(()=>{let it={},Et=I.actions.show.filter(Yt=>Yt.elementId==Gt&&Yt.active);Et.length&&(it.show={},Et.forEach(Yt=>{let{source:pt}=Yt;switch(null==pt?void 0:pt.type){case"work":var ne,U,P,h,H;it.show.action={},Object.assign(it.show.action,{value:null!==(ne=pt.value)&&void 0!==ne?ne:null,iteration:null!==(U=pt.iteration)&&void 0!==U?U:null,finish:null!==(P=pt.end)&&void 0!==P?P:null,time:null!==(h=pt.time)&&void 0!==h?h:null,points:null!==(H=pt.points)&&void 0!==H?H:null});break;case"audio":var yt,ft,Ot;it.show.audio={},Object.assign(it.show.audio,{source:w(null,null,pt.url),iteration:null!==(yt=pt.iteration)&&void 0!==yt?yt:null,finish:null!==(ft=pt.end)&&void 0!==ft?ft:null,time:null!==(Ot=pt.time)&&void 0!==Ot?Ot:null,async:-1==pt.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Qt,zt,xt,_t,qt,Pt,re,j,d,O,G,V,B,A,J;pt.options.includes("show")&&(it.show.triggershow={},Object.assign(it.show.triggershow,{id:null!==(Qt=parseInt(null!==(zt=pt.id)&&void 0!==zt?zt:"0"))&&void 0!==Qt?Qt:null,ids:null===(xt=pt.ids)||void 0===xt?void 0:xt.map(k=>parseInt(k)),async:null!==(_t=pt.async)&&void 0!==_t?_t:null,time:null!==(qt=pt.time)&&void 0!==qt?qt:null})),pt.options.includes("run")&&(it.show.triggerrun={},Object.assign(it.show.triggerrun,{id:null!==(Pt=parseInt(null!==(re=pt.id)&&void 0!==re?re:"0"))&&void 0!==Pt?Pt:null,ids:null===(j=pt.ids)||void 0===j?void 0:j.map(k=>parseInt(k)),async:null!==(d=pt.async)&&void 0!==d?d:null,time:null!==(O=pt.time)&&void 0!==O?O:null})),pt.options.includes("hide")&&(it.show.triggerhide={},Object.assign(it.show.triggerhide,{id:null!==(G=parseInt(null!==(V=pt.id)&&void 0!==V?V:"0"))&&void 0!==G?G:null,ids:null===(B=pt.ids)||void 0===B?void 0:B.map(k=>parseInt(k)),async:null!==(A=pt.async)&&void 0!==A?A:null,time:null!==(J=pt.time)&&void 0!==J?J:null}))}}));let St=I.actions.click.filter(Yt=>Yt.elementId==Gt&&Yt.active);return St&&(it.click={},St.forEach(Yt=>{let{source:pt}=Yt;switch(null==pt?void 0:pt.type){case"work":var ne,U,P,h,H;it.click.action={},Object.assign(it.click.action,{value:null!==(ne=pt.value)&&void 0!==ne?ne:null,iteration:null!==(U=pt.iteration)&&void 0!==U?U:null,finish:null!==(P=pt.end)&&void 0!==P?P:null,time:null!==(h=pt.time)&&void 0!==h?h:null,points:null!==(H=pt.points)&&void 0!==H?H:null});break;case"audio":var yt,ft,Ot;it.click.audio={},Object.assign(it.click.audio,{source:w(null,null,pt.url),iteration:null!==(yt=pt.iteration)&&void 0!==yt?yt:null,finish:null!==(ft=pt.end)&&void 0!==ft?ft:null,time:null!==(Ot=pt.time)&&void 0!==Ot?Ot:null,async:-1==pt.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Qt,zt,xt,_t,qt,Pt,re,j,d,O,G,V,B,A,J;pt.options.includes("show")&&(it.click.triggershow={},Object.assign(it.click.triggershow,{id:null!==(Qt=parseInt(null!==(zt=pt.id)&&void 0!==zt?zt:"0"))&&void 0!==Qt?Qt:null,ids:null===(xt=pt.ids)||void 0===xt?void 0:xt.map(X=>parseInt(X)),async:null!==(_t=pt.async)&&void 0!==_t?_t:null,time:null!==(qt=pt.time)&&void 0!==qt?qt:null})),pt.options.includes("run")&&(it.click.triggerrun={},Object.assign(it.click.triggerrun,{id:null!==(Pt=parseInt(null!==(re=pt.id)&&void 0!==re?re:"0"))&&void 0!==Pt?Pt:null,ids:null===(j=pt.ids)||void 0===j?void 0:j.map(X=>parseInt(X)),async:null!==(d=pt.async)&&void 0!==d?d:null,time:null!==(O=pt.time)&&void 0!==O?O:null})),pt.options.includes("hide")&&(it.click.triggerhide={},Object.assign(it.click.triggerhide,{id:null!==(G=parseInt(null!==(V=pt.id)&&void 0!==V?V:"0"))&&void 0!==G?G:null,ids:null===(B=pt.ids)||void 0===B?void 0:B.map(X=>parseInt(X)),async:null!==(A=pt.async)&&void 0!==A?A:null,time:null!==(J=pt.time)&&void 0!==J?J:null}));break;case"slide":var k;it.click.slide={},Object.assign(it.click.slide,{id:parseInt(null!==(k=pt.id)&&void 0!==k?k:"0")||pt.num||null,code:pt.id})}})),it})(),variable:(it=>{let Et={};var St;D.getAttribute("data-variable")&&(Et.input={},Object.assign(Et.input,{variable:null!==(St=D.getAttribute("data-variable"))&&void 0!==St?St:null}));let Yt=null===(it=I.nodes)||void 0===it||null===(it=it.find(h=>h.id==Gt))||void 0===it?void 0:it.variable;var pt,ne,U,P;return Yt&&(Et.click={},Object.assign(Et.click,{variable:null!==(pt=Yt.variable)&&void 0!==pt?pt:null,operator:null!==(ne=Yt.operator)&&void 0!==ne?ne:null,valuetype:null!==(U=Yt.valuetype)&&void 0!==U?U:null,value:null!==(P=Yt.value)&&void 0!==P?P:null})),Et})()};null===(Lt=ct.svg)||void 0===Lt||Lt.nodes.push(ht)}),at.push(ct)}),console.log(at),{screen:{width:K.screen.w,height:K.screen.h},data:{slides:at},variable:K.variable}}},644:(he,At,f)=>{f.d(At,{Dx:()=>c,aY:()=>Y,qp:()=>E,qz:()=>Z,sV:()=>C,yR:()=>m});var z=f(5861),x=f(9422);x.config({driver:[x.INDEXEDDB,x.LOCALSTORAGE,x.WEBSQL],name:"_localDataDB",version:1});const T={create:(S=(0,z.Z)(function*(){return x}),function(){return S.apply(this,arguments)}),get:function(){var S=(0,z.Z)(function*(w){return x.getItem(w)});return function(et){return S.apply(this,arguments)}}(),set:function(){var S=(0,z.Z)(function*(w,et){return x.setItem(w,et)});return function(et,K){return S.apply(this,arguments)}}()},Z=function(){var S=(0,z.Z)(function*(w){yield T.create();var et=(yield T.get("icdt-data"))||[];"function"==typeof w.callback&&w.callback(et)});return function(et){return S.apply(this,arguments)}}(),c=function(){var S=(0,z.Z)(function*(w){yield T.create(),w.params=w.params||{};try{yield T.set("icdt-data",w.params),"function"==typeof w.callback&&w.callback(w.params)}catch(et){"function"==typeof w.callback&&w.callback(null),console.error(et)}});return function(et){return S.apply(this,arguments)}}(),C=function(){var S=(0,z.Z)(function*(w){yield T.create();try{var et=(yield T.get("icdt-config"))||{};"function"==typeof w.callback&&w.callback(et)}catch(K){"function"==typeof w.callback&&w.callback(null),console.error(K)}});return function(et){return S.apply(this,arguments)}}(),E=function(){var S=(0,z.Z)(function*(w){yield T.create(),w.params=w.params||{};try{yield T.set("icdt-config",w.params),"function"==typeof w.callback&&w.callback(w.params)}catch(et){"function"==typeof w.callback&&w.callback(null),console.error(et)}});return function(et){return S.apply(this,arguments)}}(),Y=function(){var S=(0,z.Z)(function*(w){yield T.create();try{var et=(yield T.get("icdt-clipboard"))||{};"function"==typeof w.callback&&w.callback(et)}catch(K){"function"==typeof w.callback&&w.callback(null),console.error(K)}});return function(et){return S.apply(this,arguments)}}(),m=function(){var S=(0,z.Z)(function*(w){yield T.create(),w.params=w.params||{};try{yield T.set("icdt-clipboard",w.params),"function"==typeof w.callback&&w.callback(w.params)}catch(et){"function"==typeof w.callback&&w.callback(null),console.error(et)}});return function(et){return S.apply(this,arguments)}}();var S},1687:(he,At,f)=>{f.d(At,{O:()=>z});const z={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"}},9125:(he,At,f)=>{f.d(At,{D:()=>z});const z={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3}},968:(he,At,f)=>{f.d(At,{_:()=>z});const z={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8}},4714:(he,At,f)=>{f.d(At,{D:()=>z});const z={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306}},9054:(he,At,f)=>{f.d(At,{$:()=>z});const z={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,PATH:8}},4981:(he,At,f)=>{f.d(At,{icdt:()=>wt});var z=f(968),x=f(4080),dt=f(1687),T=f(9054),Z=f(4318),c=f(6816),C=f(666),E=f(2966);const S=M=>{var i,n,r,a,o;let v=(null===(i=M.mouseEvent)||void 0===i?void 0:i.target)||(null===(n=M.touchEvent)||void 0===n?void 0:n.target),p=(null==v?void 0:v.getAttribute("id"))||"",g=null==v?void 0:v.nodeName,R=(null==v||null===(r=v.parentNode)||void 0===r?void 0:r.getAttribute("id"))||"";var b,F;if([dt.O.RESIZE_GROUP,dt.O.SELECT_GROUP].includes(R))return null===(b=M.mouseEvent)||void 0===b||b.stopPropagation(),void(null===(F=M.mouseEvent)||void 0===F||F.preventDefault());if(null!==(a=M.mouseEvent)&&void 0!==a&&a.altKey||null!==(o=M.touchEvent)&&void 0!==o&&o.altKey||!p||p.match(/[^0-9]/)||!wt.dataSelect.nodeName.includes(g)){var W;wt.dataSelect.ids.length&&(wt.dataSelect.ids=[]),(0==(null===(W=M.mouseEvent)||void 0===W?void 0:W.button)||M.touchEvent)&&(M=>{let o=(0,x.g1)(dt.O.SCAN_GROUP,"g"),v=(0,Z.bH)(0,0,1,1);(0,x.vl)(o,v),((M,i,n)=>{(0,c.A)(M,{start:o=>{},move:(o,v)=>{((o,v,p,g)=>{i=(0,Z.bH)(o,v,p,g),(0,x.vl)(n,i)})(v[0][0],v[0][1],o.x,o.y)},end:(o,v)=>{null==n||n.remove(),wt.dataSelect.ids=wt.data.getNodeInArea(Math.min(v[0][0],o.x),Math.min(v[0][1],o.y),Math.max(v[0][0],o.x),Math.max(v[0][1],o.y));let p=wt.dataSelect.nodes;1==p.length?(0,C.y)(p[0]):p.length>1&&(0,E.Q)(p)}})})(M,v,o)})(M)}else{var lt,ut;let ot=parseFloat(p||"0");wt.dataSelect.ids=null!==(lt=M.mouseEvent)&&void 0!==lt&&lt.shiftKey||null!==(ut=M.touchEvent)&&void 0!==ut&&ut.shiftKey?[ot].concat(wt.dataSelect.ids).filter((oe,ce,pe)=>pe.indexOf(oe)==ce):[ot];let Ft=wt.dataSelect.nodes;Ft.length>1||1==Ft.length&&Ft[0].type==T.$.PATH?(0,E.Q)(Ft):1==Ft.length&&(0,C.y)(Ft[0])}};class et{constructor(){let{x:i,y:n}=wt.screen.dislocation;var r=(a,o,v,p)=>{wt.screen.move({x:i,y:n},{x:v-a,y:p-o})};return{start:a=>{},move:(a,o)=>{r(o[0][0],o[0][1],a.x,a.y)},end:(a,o)=>{r(o[0][0],o[0][1],a.x,a.y)}}}}var K=f(4714);const Q=[{name:"tam gi\xe1c vu\xf4ng",type:K.D.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:K.D.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:K.D.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:K.D.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:K.D.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:K.D.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:K.D.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:K.D.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:K.D.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:K.D.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:K.D.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:K.D.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:K.D.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}];var at=f(8619),I=f(5811);class rt{constructor(){let i=(0,x.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,at._)(Math.ceil(1e9*Math.random())),v=(p,g,R,b)=>{o=(0,Z.bH)(p,g,R,b,{ratio:1}),o.x=(0,I.q)(o.x),o.y=(0,I.q)(o.y),o.width=(0,I.q)(o.width),o.height=(0,I.q)(o.height),Object.assign(a,(0,Z.sg)(T.$.CIRCLE,o)),(0,x.__)(r,a),(0,x.g$)(i,o)};return{start:p=>{r.setAttribute("cx",p.x.toString()),r.setAttribute("cy",p.y.toString()),r.setAttribute("r","1")},move:(p,g)=>{v(g[0][0],g[0][1],p.x,p.y)},end:(p,g)=>{v(g[0][0],g[0][1],p.x,p.y),wt.data.node=Object.assign({id:n,type:T.$.CIRCLE,name:"Circle"},{size:o,attribute:a}),null==i||i.remove()}}}}var gt=f(8785);class mt{constructor(){let i=(0,x.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,gt.r)(Math.ceil(1e9*Math.random()));var v=(p,g,R,b)=>{o=(0,Z.bH)(p,g,R,b),o.x=(0,I.q)(o.x),o.y=(0,I.q)(o.y),o.width=(0,I.q)(o.width),o.height=(0,I.q)(o.height),Object.assign(a,(0,Z.sg)(T.$.ELLIPSE,o)),(0,x.__)(r,a),(0,x.g$)(i,o)};return{start:p=>{r.setAttribute("cx",p.x.toString()),r.setAttribute("cy",p.y.toString()),r.setAttribute("rx","1"),r.setAttribute("ry","1")},move:(p,g)=>{v(g[0][0],g[0][1],p.x,p.y)},end:(p,g)=>{v(g[0][0],g[0][1],p.x,p.y),wt.data.node=Object.assign({id:n,type:T.$.ELLIPSE,name:"Ellipse"},{size:o,attribute:a}),null==i||i.remove()}}}}var ct=f(8054);class q{constructor(){let i=(0,x.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,ct.f)(Math.ceil(1e9*Math.random()));var v=(p,g,R,b)=>{o=(0,Z.bH)(p,g,R,b),o.x=(0,I.q)(o.x),o.y=(0,I.q)(o.y),o.width=(0,I.q)(o.width),o.height=(0,I.q)(o.height),Object.assign(a,(0,Z.sg)(T.$.RECT,o)),(0,x.__)(r,a),(0,x.g$)(i,o)};return{start:p=>{v(p.x,p.y,p.x+o.width,p.y+o.height)},move:(p,g)=>{v(g[0][0],g[0][1],p.x,p.y)},end:(p,g)=>{o.width>=10&&o.height>=10?wt.data.node=Object.assign({id:n,type:T.$.RECT,name:"Rect"},{size:o,attribute:a}):null==r||r.remove(),null==i||i.remove()}}}}var D=f(2282);class Wt{constructor(i){let n=(0,x.g1)(dt.O.CREATE_GROUP,"g"),r=i||[[0,0],[1,1],[0,1]],{nodeId:a,element:o,attribute:v,size:p}=(0,D.l)(Math.ceil(1e9*Math.random()));p.ratios=r;var g=(R,b,F,W)=>{p=(0,Z.bH)(R,b,F,W,{ratios:r}),p.x=(0,I.q)(p.x),p.y=(0,I.q)(p.y),p.width=(0,I.q)(p.width),p.height=(0,I.q)(p.height),Object.assign(v,(0,Z.sg)(T.$.POLYGON,p)),(0,x.__)(o,v),(0,x.g$)(n,p)};return{start:R=>{},move:(R,b)=>{g(b[0][0],b[0][1],R.x,R.y)},end:(R,b)=>{g(b[0][0],b[0][1],R.x,R.y),wt.data.node=Object.assign({id:a,type:T.$.POLYGON,name:"Polygon"},{size:p,attribute:v}),null==n||n.remove()}}}}var Lt=f(4921);class Dt{constructor(){let i=(0,x.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,Lt.W)(Math.ceil(1e9*Math.random()));var v=(p,g,R,b)=>{o=(0,Z.bH)(p,g,R,b),o.x=(0,I.q)(o.x),o.y=(0,I.q)(o.y),o.width=(0,I.q)(o.width),o.height=(0,I.q)(o.height),Object.assign(a,(0,Z.sg)(T.$.LINE,o)),(0,x.__)(r,a),(0,x.g$)(i,o)};return{start:p=>{},move:(p,g)=>{v(g[0][0],g[0][1],p.x,p.y)},end:(p,g)=>{v(g[0][0],g[0][1],p.x,p.y),wt.data.node=Object.assign({id:n,type:T.$.LINE,name:"Line"},{size:o,attribute:a}),null==i||i.remove()}}}}var Vt=f(8419);class Mt{constructor(){let{nodeId:i,element:n,attribute:r,size:a}=(0,Vt.G)(Math.ceil(1e9*Math.random())),v="";var p=(g,R)=>{v+=` ${g} ${R}`,n.setAttribute("d",v)};return{start:g=>{v=`M ${g.x} ${g.y} L ${g.x} ${g.y}`},move:(g,R)=>{p(g.x,g.y)},end:(g,R)=>{p(g.x,g.y),(g=>{let R=9999,b=9999,F=-9999,W=-9999;g.forEach(lt=>{R=Math.min(R,lt[0]),b=Math.min(b,lt[1]),F=Math.max(F,lt[0]),W=Math.max(W,lt[1])}),a=(0,Z.bH)(R,b,F,W,{points:g}),Object.assign(r,(0,Z.sg)(T.$.PATH,a)),(0,x.__)(n,r)})(R),wt.data.node=Object.assign({id:i,type:T.$.PATH,name:"Path"},{size:a,attribute:r})}}}}var Gt=f(2875);class ht{constructor(){let i=(0,x.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,size:a,attribute:o,style:v,source:p}=(0,Gt.e)(Math.ceil(1e9*Math.random()));var g=(R,b,F,W)=>{a=(0,Z.bH)(R,b,F,W),a.x=(0,I.q)(a.x),a.y=(0,I.q)(a.y),a.width=(0,I.q)(a.width),a.height=(0,I.q)(a.height),Object.assign(o,(0,Z.sg)(T.$.FOREIGNOBJECT,a)),(0,x.__)(r,o),(0,x.g$)(i,a)};return{start:R=>{g(R.x,R.y,R.x+a.width,R.y+a.height)},move:(R,b)=>{g(b[0][0],b[0][1],R.x,R.y)},end:(R,b)=>{a.width>=10&&a.height>=10?wt.data.node=Object.assign({id:n,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:v,source:p}):null==r||r.remove(),null==i||i.remove()}}}}var it=f(7210);class Et{constructor(){var i,n;let r=(0,x.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:a,element:o,size:v,attribute:p,source:g}=(0,it.G)(Math.ceil(1e9*Math.random())),R=1;(F=>{if(!F)return;let W=new Image;W.onload=()=>{R=(0,I.q)(W.naturalWidth/W.naturalHeight,100)},W.onerror=lt=>{console.error(`ImgSrc load failed -> ${F}`,lt)},W.src=F})(null!==(i=null===(n=g.image)||void 0===n?void 0:n.url)&&void 0!==i?i:"");var b=(F,W,lt,ut)=>{v=(0,Z.bH)(F,W,lt,ut,{ratio:R}),v.x=(0,I.q)(v.x),v.y=(0,I.q)(v.y),v.width=(0,I.q)(v.width),v.height=(0,I.q)(v.height),Object.assign(p,(0,Z.sg)(T.$.IMAGE,v)),(0,x.__)(o,p),(0,x.g$)(r,v)};return{start:F=>{b(F.x,F.y,F.x+v.width,F.y+v.height)},move:(F,W)=>{b(W[0][0],W[0][1],F.x,F.y)},end:(F,W)=>{v.width>=10&&v.height>=10?wt.data.node=Object.assign({id:a,type:T.$.IMAGE,name:"Image"},{size:v,attribute:p,source:g}):null==o||o.remove(),null==r||r.remove()}}}}var Yt=f(4578),pt=f(9623);function P(M,i,n,r){return Math.sqrt(Math.pow(n-M,2)+Math.pow(r-i,2))}function h(M,i,n,r,a){return P(M,i,n,r)<a?1:0}function yt(M,i,n,r,a,o,v){var p=[];return p.push(h(M,i,n,r,v)),p.push(h(M,i,a,o,v)),p.push(function H(M,i,n,r,a,o,v){var p=[a-n,o-r],g=[M-n,i-r],R=[-p[1],p[0]],b=Math.sqrt(Math.pow(R[0],2)+Math.pow(R[1],2)),F=[R[0]/b,R[1]/b],W=Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2)),lt=[p[0]/W,p[1]/W],ut=g[0]*lt[0]+g[1]*lt[1];if(ut<=0||ut>=W)return 0;var ot=g[0]*F[0]+g[1]*F[1];return ot>=v||ot<=-v?0:1}(M,i,n,r,a,o,v)),p}function ft(M,i,n,r,a){var o=[n-M,r-i],v=[-o[1],o[0]],p=Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2)),g=[v[0]/p,v[1]/p];return[[M+a*g[0],i+a*g[1]],[M-a*g[0],i-a*g[1]],[n-a*g[0],r-a*g[1]],[n+a*g[0],r+a*g[1]]]}function Ot(M,i,n,r,a,o,v){var ut,p=[a-M,o-i],g=[n-M,r-i],R=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),b=[g[0]/R,g[1]/R],F=p[0]*b[0]+p[1]*b[1],W=[M+F*b[0],i+F*b[1]],lt=Math.sqrt(Math.pow(a-W[0],2)+Math.pow(o-W[1],2));ut=0===lt?v:Math.sqrt(Math.pow(v,2)-Math.pow(lt,2));var ot=[M+F*b[0]+ut*b[0],i+F*b[1]+ut*b[1]];return ot[0]===M&&ot[1]===i?null:ot}function Qt(M,i,n,r,a,o,v){var p=[a-M,o-i],g=[n-M,r-i],R=[-g[1],g[0]],b=Math.sqrt(Math.pow(R[0],2)+Math.pow(R[1],2)),F=[R[0]/b,R[1]/b],W=p[0]*F[0]+p[1]*F[1],lt=re([M,i],[n,r],[a,o]);if(qt([lt[0]-a,lt[1]-o])>=v)return null;var ot=Math.sqrt(Math.pow(v,2)-Math.pow(W,2)),Ft=[a-W*F[0],o-W*F[1]],oe=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),ce=[g[0]/oe,g[1]/oe],pe=[[Ft[0]-ce[0]*ot,Ft[1]-ce[1]*ot],[Ft[0]+ce[0]*ot,Ft[1]+ce[1]*ot]];return pe[0][0]===M&&pe[0][1]===i?null:pe}function zt(M,i,n,r,a,o,v,p){var g,R,b,F,W,lt;return-(b=v-a)*(R=r-i)+(g=n-M)*(F=p-o)==0?null:(lt=(b*(i-o)-F*(M-a))/(-b*R+g*F),(W=(-R*(M-a)+g*(i-o))/(-b*R+g*F))>=0&&W<=1&&lt>=0&&lt<=1?[M+lt*g,i+lt*R]:null)}function xt(M,i,n,r,a,o,v,p,g,R){var b=ft(o,v,p,g,R),F=[];if(n[0]&&!n[1])F.push(Ot(M,i,r,a,o,v,R)),F.push(zt(M,i,r,a,b[0][0],b[0][1],b[3][0],b[3][1])),F.push(zt(M,i,r,a,b[1][0],b[1][1],b[2][0],b[2][1])),(W=Qt(M,i,r,a,p,g,R))&&F.push(W[0],W[1]);else if(!n[0]&&n[1])F.push(Ot(M,i,r,a,p,g,R)),F.push(zt(M,i,r,a,b[0][0],b[0][1],b[3][0],b[3][1])),F.push(zt(M,i,r,a,b[1][0],b[1][1],b[2][0],b[2][1])),(W=Qt(M,i,r,a,o,v,R))&&F.push(W[0],W[1]);else if(n[0]&&n[1])F.push(Ot(M,i,r,a,o,v,R)),F.push(zt(M,i,r,a,b[0][0],b[0][1],b[3][0],b[3][1])),F.push(zt(M,i,r,a,b[1][0],b[1][1],b[2][0],b[2][1])),F.push(Ot(M,i,r,a,p,g,R));else{var W=Qt(M,i,r,a,p,g,R),lt=Qt(M,i,r,a,o,v,R);W&&F.push(W[0],W[1]),lt&&F.push(lt[0],lt[1]),F.push(zt(M,i,r,a,b[0][0],b[0][1],b[3][0],b[3][1])),F.push(zt(M,i,r,a,b[1][0],b[1][1],b[2][0],b[2][1]))}for(var ut=[M,i],ot=0;ot<F.length;ot++)F[ot]&&P(F[ot][0],F[ot][1],r,a)<P(ut[0],ut[1],r,a)&&(ut=F[ot]);return ut[0]===M&&ut[1]===i?null:ut}function _t(M,i,n,r,a,o,v,p,g){var R=ft(a,o,v,p,g),b=[],F=Qt(M,i,n,r,a,o,g);F&&b.push(F[0],F[1]),(F=Qt(M,i,n,r,v,p,g))&&b.push(F[0],F[1]),b.push(zt(M,i,n,r,R[0][0],R[0][1],R[3][0],R[3][1])),b.push(zt(M,i,n,r,R[1][0],R[1][1],R[2][0],R[2][1]));for(var W=[n,r],lt=[M,i],ut=0;ut<b.length;ut++)b[ut]&&P(b[ut][0],b[ut][1],M,i)<P(W[0],W[1],M,i)&&(W=b[ut]);for(var ot=0;ot<b.length;ot++)b[ot]&&P(b[ot][0],b[ot][1],n,r)<P(lt[0],lt[1],n,r)&&(lt=b[ot]);return W[0]===n&&W[1]===r||lt[0]===M&&lt[1]===i?null:[W,lt]}var qt=function(M){return Math.sqrt(M[0]*M[0]+M[1]*M[1])},re=function(M,i,n){var r=[i[0]-M[0],i[1]-M[1]],a=qt(r);if(a<1e-6)return M;var o=[n[0]-M[0],n[1]-M[1]],v=(r[0]*o[0]+r[1]*o[1])/a;return v<0?M:v>a?i:[M[0]+r[0]*v/a,M[1]+r[1]*v/a]};class j{constructor(){let{element:r,size:o}=(0,Vt.G)(Math.ceil(1e9*Math.random()));(0,x.__)(r,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let v="";return{start:R=>{v=`M ${R.x} ${R.y} L ${R.x} ${R.y}`},move:(R,b)=>{((R,b)=>{v+=` ${R} ${b}`,r.setAttribute("d",v)})(R.x,R.y)},end:(R,b)=>{r.remove(),(R=>{let b=9999,F=9999,W=-9999,lt=-9999;R.forEach(ot=>{b=Math.min(b,ot[0]),F=Math.min(F,ot[1]),W=Math.max(W,ot[0]),lt=Math.max(lt,ot[1])}),o=(0,Z.bH)(b,F,W,lt,{points:R}),wt.data.getNodeInArea(0,0,1920,1920,T.$.PATH).forEach(ot=>{let oe=((M,i,n)=>{n=n||20;var r=[],a=function(b){var F=i[0][0],W=i[0][1],lt=0,ut=0;if(1!==b.length||h(b[0][0],b[0][1],F,W,n)){for(var ot;lt<b.length-1;){var Ft=b[lt],oe=b[lt+1],ce=h(Ft[0],Ft[1],F,W,n),pe=h(oe[0],oe[1],F,W,n);if(ce&&pe)ut=++lt;else if(ce&&!pe)(be=Ot(Ft[0],Ft[1],oe[0],oe[1],F,W,n))?(b[lt]=be,ut=lt):lt++;else if(!ce&&pe){var be;(be=Ot(oe[0],oe[1],Ft[0],Ft[1],F,W,n))&&((ot=b.slice(ut,lt+1)).push(be),r.push(ot)),ut=++lt}else{var me=Qt(Ft[0],Ft[1],oe[0],oe[1],F,W,n);me?(((ot=b.slice(ut,lt+1))[ot.length-1][0]!==me[0][0]||ot[ot.length-1][1]!==me[0][1])&&ot.push(me[0]),ot.length>1&&r.push(ot),b[lt]=me[1],b[lt+1]&&b[lt+1][0]==me[1][0]&&b[lt+1][1]==me[1][1]&&lt++,ut=lt):lt++}}ut!==lt&&(ot=b.slice(ut,b.length))&&r.push(ot)}else r.push(b)},o=function(b,F){var oe,W=i[F],lt=i[F+1],ut=0,ot=0;if(1!==b.length||-1!==(Ft=yt(b[0][0],b[0][1],W[0],W[1],lt[0],lt[1],n)).indexOf(1)){for(;ut<b.length-1;){var ce=b[ut],pe=b[ut+1],Ft=yt(ce[0],ce[1],W[0],W[1],lt[0],lt[1],n),be=yt(pe[0],pe[1],W[0],W[1],lt[0],lt[1],n);if(-1!==Ft.indexOf(1)&&-1!==be.indexOf(1))ot=++ut;else if(-1!==Ft.indexOf(1)&&-1===be.indexOf(1))(me=xt(ce[0],ce[1],Ft,pe[0],pe[1],W[0],W[1],lt[0],lt[1],n))?(b[ut]=me,ot=ut):ut++;else if(-1===Ft.indexOf(1)&&-1!==be.indexOf(1)){var me;(me=xt(pe[0],pe[1],be,ce[0],ce[1],W[0],W[1],lt[0],lt[1],n))?((oe=b.slice(ot,ut+1)).push(me),r.push(oe),ot=++ut):ut++}else{var ke=_t(ce[0],ce[1],pe[0],pe[1],W[0],W[1],lt[0],lt[1],n);ke?(((oe=b.slice(ot,ut+1))[oe.length-1][0]!==ke[0][0]||oe[oe.length-1][1]!==ke[0][1])&&oe.push(ke[0]),oe.length>1&&r.push(oe),b[ut]=ke[1],b[ut+1]&&b[ut+1][0]==ke[1][0]&&b[ut+1][1]==ke[1][1]&&ut++,ot=ut):ut++}}ot!==ut&&(oe=b.slice(ot,b.length))&&r.push(oe)}else r.push(b)};if(i=function U(M){var i=[];if(1===M.length)i=M;else{for(var n=0;n<M.length-1;)(M[n][0]!==M[n+1][0]||M[n][1]!==M[n+1][1])&&i.push(M[n]),n++;0!==M.length&&0===i.length&&i.push(M[0]),(M[M.length-1][0]!==M[i.length-1][0]||M[M.length-1][1]!==M[i.length-1][1])&&i.push(M[n])}return i}(i),1===i.length){for(var v=0;v<M.length;v++)a(M[v]);M=r}else for(var p=0;p<i.length-1;p++){for(v=0;v<M.length;v++)o(M[v],p);M=r,r=[]}for(var g=0;g<M.length;g++)for(var R=0;R<M[g].length;R++)M[g][R][0]=Math.round(M[g][R][0]),M[g][R][1]=Math.round(M[g][R][1]);return M})(wt.data.getNode(ot).size.points,R,2);console.log(oe)})})(b)}}}}var O=f(1105);class G{constructor(){let i=(0,x.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o,source:v}=(0,O.$)(Math.ceil(1e9*Math.random())),p=(g,R,b,F)=>{o=(0,Z.bH)(g,R,b,F),o.x=(0,I.q)(o.x),o.y=(0,I.q)(o.y),o.width=(0,I.q)(o.width),o.height=(0,I.q)(o.height),Object.assign(a,(0,Z.sg)(T.$.TEXT,o)),(0,x.__)(r,a),(0,x.g$)(i,o)};return{start:g=>{p(g.x,g.y,g.x+o.width,g.y+o.height)},move:(g,R)=>{p(R[0][0],R[0][1],g.x,g.y)},end:(g,R)=>{o.width>=10&&o.height>=10?wt.data.node=Object.assign({id:n,type:T.$.TEXT,name:"Text"},{size:o,attribute:a,source:v}):null==r||r.remove(),null==i||i.remove()}}}}var J=f(4113),k=f(9125),X=f(7797);var Kt=f(6358);class Tt{constructor(){this._nodeName=["circle","ellipse","line","polygon","rect","text","path","foreignObject","image"],this._selected_Ids=[],this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(i){this._selected_Ids=i,this.change(this.ids)}get nodes(){return this._selected_Ids.map(i=>wt.data.getNode(i)).filter(i=>!i.isfake)}set onchange(i){this._fnChanges.push(i)}change(i){var n,r,a,o,v;null===(n=window.document.getElementById(dt.O.RESIZE_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(dt.O.SELECT_GROUP))||void 0===r||r.remove(),null===(a=window.document.getElementById(dt.O.SCAN_GROUP))||void 0===a||a.remove(),null===(o=window.document.getElementById(dt.O.CREATE_GROUP))||void 0===o||o.remove(),null===(v=window.document.getElementById(dt.O.INTERACTIVE_GROUP))||void 0===v||v.remove(),jQuery('[id^="icdt-temp-"]').remove(),this._fnChanges.forEach(p=>p(i))}deleteNode(){for(let i of this._selected_Ids){let n=wt.data.deleteNode(i);wt.history.push([{type:"delete",from:{id:n},to:{id:n}}])}wt.dataSelect.ids=[]}groupNode(){let i=[];if(wt.dataSelect.ids.length>=2){let n=wt.data.getNode(wt.dataSelect.ids[0]),{nodeId:r,attribute:a,size:o}=(0,Kt.m)(Math.ceil(1e9*Math.random()),void 0,n.pid?window.document.getElementById(n.pid):null);wt.data.node=Object.assign({id:r,type:T.$.GROUP,name:"G"},{size:o,attribute:a});for(let v of wt.dataSelect.ids)i.push(wt.data.addGroup(v,r))}if(i.length){wt.dataSelect.ids=i;let n=wt.dataSelect.nodes;1==n.length?(0,C.y)(n[0]):n.length>1&&(0,E.Q)(n)}}ungroupNode(){let i=[];for(let n of wt.dataSelect.ids)i.push(wt.data.unGroup(n));if(i.length){wt.dataSelect.ids=i;let n=wt.dataSelect.nodes;1==n.length?(0,C.y)(n[0]):n.length>1&&(0,E.Q)(n)}}}var Rt=f(9942);class jt{createNodeImage(i,n){var r,a,o,v;let{nodeId:g,element:R,size:b,attribute:F,source:W}=(0,it.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},source:{type:"image",image:(0,Rt.I)(i)}});(lt=>{if(!lt)return;let ut=new Image;ut.onload=()=>{let ot=(0,I.q)(ut.naturalWidth/ut.naturalHeight,100);ot>=1?(b.width=Math.min(ut.naturalWidth,512),b.height=(0,I.q)(b.width/ot,100)):(b.height=Math.min(ut.naturalHeight,512),b.width=(0,I.q)(b.height*ot,100)),b.x=(0,I.q)(b.x+50-b.width/2,100),b.y=(0,I.q)(b.y+50-b.height/2,100),Object.assign(F,(0,Z.sg)(T.$.IMAGE,b)),(0,x.__)(R,F),wt.data.node=Object.assign({id:g,type:T.$.IMAGE,name:"Image"},{size:b,attribute:F,source:W})},ut.onerror=ot=>{console.error(`ImgSrc load failed -> ${lt}`,ot),null==R||R.remove()},ut.src=lt})(null!==(o=null===(v=W.image)||void 0===v?void 0:v.url)&&void 0!==o?o:"")}createNodeIframe(i,n){var r,a;let{nodeId:v,element:p,size:g,attribute:R,style:b,source:F}=(0,Gt.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:(0,Rt.I)(i)}});(W=>{let lt=(null===(W=wt.data.slide)||void 0===W||null===(W=W.svg)||void 0===W?void 0:W.viewBox)||{x:0,y:0,width:100,height:100},ut=(0,I.q)(lt.width/lt.height,100);ut>=1?(g.width=Math.min(lt.width,512),g.height=(0,I.q)(g.width/ut,100)):(g.height=Math.min(lt.height,512),g.width=(0,I.q)(g.height*ut,100)),g.x=(0,I.q)(g.x+50-g.width/2,100),g.y=(0,I.q)(g.y+50-g.height/2,100),Object.assign(R,(0,Z.sg)(T.$.IMAGE,g)),(0,x.__)(p,R),wt.data.node=Object.assign({id:v,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:g,attribute:R,style:b,source:F})})()}createNodeEmbed(i,n){var r,a;let{nodeId:v,element:p,size:g,attribute:R,style:b,source:F}=(0,Gt.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},style:{},source:{type:"embed",embed:Object.assign(i,(0,Rt.I)(i))}});(W=>{let lt=(null===(W=wt.data.slide)||void 0===W||null===(W=W.svg)||void 0===W?void 0:W.viewBox)||{x:0,y:0,width:100,height:100},ut=(0,I.q)(lt.width/lt.height,100);ut>=1?(g.width=Math.min(lt.width,512),g.height=(0,I.q)(g.width/ut,100)):(g.height=Math.min(lt.height,512),g.width=(0,I.q)(g.height*ut,100)),g.x=(0,I.q)(g.x+50-g.width/2,100),g.y=(0,I.q)(g.y+50-g.height/2,100),Object.assign(R,(0,Z.sg)(T.$.IMAGE,g)),(0,x.__)(p,R),wt.data.node=Object.assign({id:v,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:g,attribute:R,style:b,source:F})})()}createNodeMedia(i,n){var r,a,o,v;let{nodeId:g,element:R,size:b,attribute:F,source:W}=(0,it.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},source:{type:"image",image:(0,Rt.I)(i.cover)}}),lt={click:{media:i.media}};(ut=>{if(!ut)return;let ot=new Image;ot.onload=()=>{let Ft=(0,I.q)(ot.naturalWidth/ot.naturalHeight,100);Ft>=1?(b.width=Math.min(ot.naturalWidth,512),b.height=(0,I.q)(b.width/Ft,100)):(b.height=Math.min(ot.naturalHeight,512),b.width=(0,I.q)(b.height*Ft,100)),b.x=(0,I.q)(b.x+50-b.width/2,100),b.y=(0,I.q)(b.y+50-b.height/2,100),Object.assign(F,(0,Z.sg)(T.$.IMAGE,b)),(0,x.__)(R,F),wt.data.node=Object.assign({id:g,type:T.$.IMAGE,name:"Image"},{size:b,attribute:F,source:W,interactive:lt})},ot.onerror=Ft=>{console.error(`ImgSrc load failed -> ${ut}`,Ft),null==R||R.remove()},ot.src=ut})(null!==(o=null===(v=W.image)||void 0===v?void 0:v.url)&&void 0!==o?o:"")}insert(i){var n;if(wt.data.insertSlide(wt.data.slideId,1),i.title){let{nodeId:r,size:a,attribute:o,style:v,source:p}=(0,Gt.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${i.title}</span>`}}});wt.data.node=Object.assign({id:r,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:v,source:p})}if(i.description){let{nodeId:r,size:a,attribute:o,style:v,source:p}=(0,Gt.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${i.description.replace(/\n/g,"<br/>")}</span>`}}});wt.data.node=Object.assign({id:r,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:v,source:p})}null!==(n=i.media)&&void 0!==n&&n.prompt&&((()=>{let{nodeId:r,size:a,attribute:o}=(0,ct.f)(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});wt.data.node=Object.assign({id:r,type:T.$.RECT,name:"Rect"},{size:a,attribute:o})})(),(r=>{let{nodeId:a,size:o,attribute:v,style:p,source:g}=(0,Gt.e)(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(r=i.media)||void 0===r?void 0:r.prompt}</i></span>`}}});wt.data.node=Object.assign({id:a,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:v,style:p,source:g})})())}}var Ut=f(5226);class Jt{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:wt.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var i;let n=null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((o,v)=>v==this._slideIdx),r=null==n?void 0:n.svg,a=o=>{let v=[];return o.filter(p=>!p.isdeleted).forEach(p=>{p.type==T.$.GROUP?v=v.concat(a(p.nodes||[])):v.push(p.id)}),v};return a((null==r?void 0:r.nodes)||[])}}get get(){var i;let n=r=>{var a,o;return null===(a=r)||void 0===a||a.filter(v=>v.type==T.$.GROUP).forEach(v=>{var p;v.nodes=n(null===(p=v.nodes)||void 0===p?void 0:p.filter(g=>!g.isdeleted))}),(r=null===(o=r)||void 0===o?void 0:o.filter(v=>{var p,g;return v.type!=T.$.GROUP||(null!==(p=null===(g=v.nodes)||void 0===g?void 0:g.length)&&void 0!==p?p:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(o=>!o.isdeleted)))}),this._dataSource}get getResource(){var i;let n=[];return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a,o,v,p,g,R,b,F;n.push(null===(a=r.svg)||void 0===a||null===(a=a.background)||void 0===a?void 0:a.path),null===(o=r.svg)||void 0===o||o.nodes.forEach(W=>{var lt,ut,ot,Ft,oe,ce,pe,be,me,ke;n.push(null===(lt=W.source)||void 0===lt||null===(lt=lt.image)||void 0===lt?void 0:lt.path),n.push(null===(ut=W.source)||void 0===ut||null===(ut=ut.audio)||void 0===ut?void 0:ut.path),n.push(null===(ot=W.source)||void 0===ot||null===(ot=ot.video)||void 0===ot?void 0:ot.path),n.push(null===(Ft=W.source)||void 0===Ft||null===(Ft=Ft.file)||void 0===Ft?void 0:Ft.path),n.push(null===(oe=W.source)||void 0===oe||null===(oe=oe.iframe)||void 0===oe?void 0:oe.path),n.push(null===(ce=W.source)||void 0===ce||null===(ce=ce.track)||void 0===ce?void 0:ce.path),n.push(null===(pe=W.interactive)||void 0===pe||null===(pe=pe.show)||void 0===pe||null===(pe=pe.audio)||void 0===pe||null===(pe=pe.source)||void 0===pe?void 0:pe.path),n.push(null===(be=W.interactive)||void 0===be||null===(be=be.click)||void 0===be||null===(be=be.audio)||void 0===be||null===(be=be.source)||void 0===be?void 0:be.path),n.push(null===(me=W.interactive)||void 0===me||null===(me=me.click)||void 0===me||null===(me=me.image)||void 0===me||null===(me=me.source)||void 0===me?void 0:me.path),n.push(null===(ke=W.interactive)||void 0===ke||null===(ke=ke.click)||void 0===ke||null===(ke=ke.video)||void 0===ke||null===(ke=ke.source)||void 0===ke?void 0:ke.path)}),n.push(null===(v=r.test)||void 0===v||null===(v=v.audiotrue)||void 0===v?void 0:v.path),n.push(null===(p=r.test)||void 0===p||null===(p=p.audiofalse)||void 0===p?void 0:p.path),n.push(null===(g=r.test)||void 0===g||null===(g=g.effecttrue)||void 0===g?void 0:g.path),n.push(null===(R=r.test)||void 0===R||null===(R=R.effectfalse)||void 0===R?void 0:R.path),n.push(null===(b=r.test)||void 0===b||null===(b=b.icontrue)||void 0===b?void 0:b.path),n.push(null===(F=r.test)||void 0===F||null===(F=F.iconfalse)||void 0===F?void 0:F.path)}),n.filter(r=>r).map(r=>r.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((r,a,o)=>o.indexOf(r)==a)}set set(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,x.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var i;let n=r=>{var a,o;return null===(a=r)||void 0===a||a.filter(v=>v.type==T.$.GROUP).forEach(v=>{var p;v.nodes=n(null===(p=v.nodes)||void 0===p?void 0:p.filter(g=>!g.isdeleted))}),(r=null===(o=r)||void 0===o?void 0:o.filter(v=>{var p,g;return v.type!=T.$.GROUP||(null!==(p=null===(g=v.nodes)||void 0===g?void 0:g.length)&&void 0!==p?p:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(o=>!o.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,x.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var i,n;return null!==(i=null===(n=this.slide)||void 0===n?void 0:n.id)&&void 0!==i?i:0}get slideIdx(){return this._slideIdx}get slide(){var i;return null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((n,r)=>r==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var i,n;this._slideIdx<(null!==(i=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==i?i:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}openSlide(i,n){var r,a,o,v;if(i)for(let F=0,W=null!==(p=null===(g=this._dataSource.slides)||void 0===g?void 0:g.length)&&void 0!==p?p:0;F<W;F++){var p,g,R;if((null!==(R=this._dataSource.slides)&&void 0!==R?R:[])[F].id==i){this._slideIdx=F;break}}else if(n&&n>=0&&n<(null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.length)&&void 0!==r?r:0))this._slideIdx=null!=n?n:0;else{var b;this._slideIdx=0,null!==(b=this._dataSource.slides)&&void 0!==b&&b.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}(0,x.wM)(),(0,Ut.E)(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(o=null===(v=this._dataSource.slides)||void 0===v?void 0:v.length)&&void 0!==o?o:0,this.slide)}addSlide(){var i,n,r;null===(i=this._dataSource.slides)||void 0===i||i.push(this._defaultSlide),this._slideIdx=(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1,this.openSlide(void 0,this._slideIdx)}insertSlide(i,n,r){var a,o,v,p,g;let R=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(lt=>lt.id==i))&&void 0!==a?a:this._defaultSlide,b=(null!==(v=null===(p=this._dataSource.slides)||void 0===p?void 0:p.indexOf(R))&&void 0!==v?v:0)+n;var F,W;r?(r.id=this.newSlideId,r.code=void 0,r.name=null!==(F=r.name)&&void 0!==F?F:"Trang m\u1edbi",null!==(W=r.svg)&&void 0!==W&&W.viewBox||r.svg&&(r.svg.viewBox=wt.screen.frameSize)):r=this._defaultSlide,null===(g=this._dataSource.slides)||void 0===g||g.splice(b,0,r),this._slideIdx=b,this.openSlide(void 0,this._slideIdx)}copySlide(i){var n,r,a,o,v,p,g;let R=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(W=>W.id==i))&&void 0!==n?n:this._defaultSlide,b=(null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(R))&&void 0!==a?a:0)+1,F=Object.assign(JSON.parse(JSON.stringify(R)),{id:this.newSlideId,code:void 0,name:`${R.name} + (Copy)`});null===(v=this._dataSource.slides)||void 0===v||v.splice(b,0,F),this.changeSlide(this.slides,this.slideIdx,null!==(p=null===(g=this._dataSource.slides)||void 0===g?void 0:g.length)&&void 0!==p?p:0,this.slide)}moveSlide(i,n){var r,a,o,v,p,g;let R=null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(F=>F.id==i))&&void 0!==r?r:this._defaultSlide,b=null!==(o=null===(v=this._dataSource.slides)||void 0===v?void 0:v.indexOf(R))&&void 0!==o?o:0;null===(p=this._dataSource.slides)||void 0===p||p.splice(b+n,0,null===(g=this._dataSource.slides)||void 0===g?void 0:g.splice(b,1)[0])}deleteSlide(i){var n,r,a,o,v,p;let g=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(W=>W.id==i))&&void 0!==n?n:this._defaultSlide,R=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(g))&&void 0!==a?a:0;if(null===(v=this._dataSource.slides)||void 0===v||v.splice(R,1),null!==(p=this._dataSource.slides)&&void 0!==p&&p.length)if(R<this._slideIdx){var b,F;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(b=null===(F=this._dataSource.slides)||void 0===F?void 0:F.length)&&void 0!==b?b:0,this.slide)}else R==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(i){var n,r,a,o,v;let p=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(R=>R.id==i))&&void 0!==n?n:this._defaultSlide,g=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(p))&&void 0!==a?a:0;if(p.isdeleted=!0,null!==(v=this._dataSource.slides)&&void 0!==v&&null!==(v=v.filter(R=>!R.isdeleted))&&void 0!==v&&v.length){let R=!0;for(;p.isdeleted;)R?g++:g--,this._dataSource.slides[g]?p=this._dataSource.slides[g]:R=!R;this.openSlide(p.id)}else this.addSlide()}set onChangeSlide(i){this._fnChangeSlides.push(i)}changeSlide(i,n,r,a){this._fnChangeSlides.forEach(o=>o(i,n,r,a))}set node(i){var n,r;let a=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((v,p)=>p==this._slideIdx),o=null==a?void 0:a.svg;null!=o&&o.nodes&&(null==o||o.nodes.push(i)),wt.history.push([{type:"add",from:{id:i.id},to:{id:i.id}}]),(0,Ut.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id)}findNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((W,lt)=>lt==this._slideIdx),a=null==r?void 0:r.svg,o=(W,lt)=>{let ut=null==W?void 0:W.find(oe=>oe.id==i);if(ut)return ut.pid=lt,ut;let ot=0,Ft=W.length||0;for(;ot<Ft&&!ut&&(ut=o(W[ot].nodes||[],W[ot].id),!ut);)ot++;return ut},v=o((null==a?void 0:a.nodes)||[]);var p,g,R,b,F;return v?(v.style=null!==(p=v.style)&&void 0!==p?p:{},v.source=null!==(g=v.source)&&void 0!==g?g:{},v.animate=null!==(R=v.animate)&&void 0!==R?R:{},v.interactive=null!==(b=v.interactive)&&void 0!==b?b:{},v.variable=null!==(F=v.variable)&&void 0!==F?F:{},v):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((p,g)=>g==this._slideIdx),a=null==r?void 0:r.svg,v=p=>{let g=(null==p?void 0:p.find(ut=>ut.id==i))||(p=>{let g=null,R=0,b=p.length||0;for(;R<b&&!g;){if(g=v(p[R].nodes),g){g.pid=p[R].id;break}R++}var F,W,lt,ut,ot;return g&&(g.style=null!==(F=g.style)&&void 0!==F?F:{},g.source=null!==(W=g.source)&&void 0!==W?W:{},g.animate=null!==(lt=g.animate)&&void 0!==lt?lt:{},g.interactive=null!==(ut=g.interactive)&&void 0!==ut?ut:{},g.variable=null!==(ot=g.variable)&&void 0!==ot?ot:{}),g})((null==p?void 0:p.filter(ut=>ut.type==T.$.GROUP))||[]);var R,b,F,W,lt;return g&&(g.style=null!==(R=g.style)&&void 0!==R?R:{},g.source=null!==(b=g.source)&&void 0!==b?b:{},g.animate=null!==(F=g.animate)&&void 0!==F?F:{},g.interactive=null!==(W=g.interactive)&&void 0!==W?W:{},g.variable=null!==(lt=g.variable)&&void 0!==lt?lt:{}),g};return v((null==a?void 0:a.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(i,n,r,a,o){var v;let p=null===(v=this._dataSource.slides)||void 0===v?void 0:v.find((b,F)=>F==this._slideIdx),g=null==p?void 0:p.svg,R=b=>{let F=[];return b.filter(W=>!W.isdeleted).forEach(W=>{W.type==T.$.GROUP?F=F.concat(R(W.nodes||[])):i>W.size.x||n>W.size.y||r<W.size.x+W.size.width||a<W.size.y+W.size.height||(o?W.type==o&&F.push(W.id):F.push(W.id))}),F};return R((null==g?void 0:g.nodes)||[])}getNodeOnArea(i,n,r,a,o){var v;let p=null===(v=this._dataSource.slides)||void 0===v?void 0:v.find((b,F)=>F==this._slideIdx),g=null==p?void 0:p.svg,R=b=>{let F=[];return b.filter(W=>!W.isdeleted).forEach(W=>{W.type==T.$.GROUP?F=F.concat(R(W.nodes||[])):W.size.x+W.size.width<i||W.size.y+W.size.height<n||W.size.x>r||W.size.y>a||(o?W.type==o&&F.push(W.id):F.push(W.id))}),F};return R((null==g?void 0:g.nodes)||[])}deleteNode(i,n){var r;return this.getNode(i).isdeleted=null==n||n,(0,Ut.E)(this.slide),(0,Ut.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),i}unGroup(i){var n,r;let a=this.getNode(i),o=Math.ceil(1e9*Math.random());return null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:o})),Object.assign(a,{isdeleted:!0}),(0,Ut.E)(this.slide),(0,Ut.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),o}addGroup(i,n){var r;let a=this.getNode(i),o=this.getNode(n);o.nodes=o.nodes||[];let v=Math.ceil(1e9*Math.random());return o.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:v})),Object.assign(a,{isdeleted:!0}),(0,Ut.E)(this.slide),(0,Ut.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),v}setNodeP(i,n){var r;let a=null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r?void 0:r.nodes.find(o=>o.id==i);a&&(a.pid=n||null)}bringToFront(i){var n,r,a;let o=i.map(lt=>wt.data.getNode(lt)).filter(lt=>!lt.isfake),{x1:v,y1:p,x2:g,y2:R}=ae(o),b=this.getNodeOnArea(v,p,g,R);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((lt,ut)=>{lt.index=ut+1});let F=b.map(lt=>{var ut,ot;return null!==(ut=null===(ot=this.slide)||void 0===ot||null===(ot=ot.svg)||void 0===ot||null===(ot=ot.nodes.find(Ft=>Ft.id==lt))||void 0===ot?void 0:ot.index)&&void 0!==ut?ut:0}),W=Math.max.apply(null,F);i.forEach((lt,ut)=>{var ot;null===(ot=this.slide)||void 0===ot||null===(ot=ot.svg)||void 0===ot||ot.nodes.filter(Ft=>Ft.id==lt).forEach(Ft=>{Ft.index=W+(ut+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((lt,ut)=>{var ot,Ft;return(null!==(ot=lt.index)&&void 0!==ot?ot:0)-(null!==(Ft=ut.index)&&void 0!==Ft?Ft:0)}),(0,Ut.T)(this.slide),null===(a=window.document.getElementById(dt.O.SELECT_GROUP))||void 0===a||a.remove(),(0,E.Q)(o)}sendToBack(i){var n,r,a;let o=i.map(lt=>wt.data.getNode(lt)).filter(lt=>!lt.isfake),{x1:v,y1:p,x2:g,y2:R}=ae(o),b=this.getNodeOnArea(v,p,g,R);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((lt,ut)=>{lt.index=ut+1});let F=b.map(lt=>{var ut,ot;return null!==(ut=null===(ot=this.slide)||void 0===ot||null===(ot=ot.svg)||void 0===ot||null===(ot=ot.nodes.find(Ft=>Ft.id==lt))||void 0===ot?void 0:ot.index)&&void 0!==ut?ut:0}),W=Math.min.apply(null,F)-1;i.forEach((lt,ut)=>{var ot;null===(ot=this.slide)||void 0===ot||null===(ot=ot.svg)||void 0===ot||ot.nodes.filter(Ft=>Ft.id==lt).forEach(Ft=>{Ft.index=W+(ut+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((lt,ut)=>{var ot,Ft;return(null!==(ot=lt.index)&&void 0!==ot?ot:0)-(null!==(Ft=ut.index)&&void 0!==Ft?Ft:0)}),(0,Ut.T)(this.slide),null===(a=window.document.getElementById(dt.O.SELECT_GROUP))||void 0===a||a.remove(),(0,E.Q)(o)}}const ae=M=>{let i=999999,n=999999,r=-999999,a=-999999;return M.forEach(o=>{i=Math.min(i,o.size.x),n=Math.min(n,o.size.y),r=Math.max(r,o.size.x+o.size.width),a=Math.max(a,o.size.y+o.size.height)}),{x1:i,y1:n,x2:r,y2:a}};class ye{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":wt.data.deleteNode(n.from.id);break;case"edit":break;case"delete":wt.data.deleteNode(n.from.id,!1);break;case"size":{let{id:r,type:a,size:o,attribute:v}=wt.data.getNode(n.from.id);Object.assign(o,n.from.size),Object.assign(v,(0,Z.sg)(a,o)),(0,x.__)(window.document.getElementById(r),v);break}case"attribute":{let{id:r,attribute:a}=wt.data.getNode(n.from.id);Object.assign(a,n.from.attribute),(0,x.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=wt.data.getNode(n.from.id);Object.assign(null!=a?a:{},n.from.style),(0,x.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:o}=wt.data.getNode(n.from.id);Object.assign(null!=o?o:{},n.from.source),(0,x.QI)(window.document.getElementById(r),a,null!=o?o:{});break}case"animate":{let{animate:r}=wt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.animate);break}case"interactive":{let{interactive:r}=wt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.interactive);break}case"variable":{let{variable:r}=wt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.variable);break}}}),wt.dataSelect.ids=[]},this.redoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":wt.data.deleteNode(n.to.id,!1);break;case"edit":break;case"delete":wt.data.deleteNode(n.to.id,!0);break;case"size":{let{id:r,type:a,size:o,attribute:v}=wt.data.getNode(n.to.id);Object.assign(o,n.to.size),Object.assign(v,(0,Z.sg)(a,o)),(0,x.__)(window.document.getElementById(r),v);break}case"attribute":{let{id:r,attribute:a}=wt.data.getNode(n.to.id);Object.assign(a,n.to.attribute),(0,x.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=wt.data.getNode(n.to.id);Object.assign(null!=a?a:{},n.to.style),(0,x.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:o}=wt.data.getNode(n.to.id);Object.assign(null!=o?o:{},n.to.source),(0,x.QI)(window.document.getElementById(r),a,null!=o?o:{});break}case"animate":{let{animate:r}=wt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.animate);break}case"interactive":{let{interactive:r}=wt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.interactive);break}case"variable":{let{variable:r}=wt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.variable);break}}}),wt.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(i){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:i}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:i})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(i){this._fnChanges.push(i)}change(){this._fnChanges.forEach(i=>i(this.index,this.total))}}class Ee{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(i){this._actived=i}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(i){var n,r;this._frameSize.width=null!==(n=null==i?void 0:i.width)&&void 0!==n?n:1080,this._frameSize.height=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}get frameSize(){return this._frameSize}set frameSize(i){this._frameSize.x=i.x,this._frameSize.y=i.y,this._frameSize.width=i.width,this._frameSize.height=i.height,this.reset()}set screen(i){this._offset=i.offset,this._width=i.width,this._height=i.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(i,n,r){var a;if(!(i<.1||i>10)){if(n=null!==(a=n)&&void 0!==a?a:{x:this._width/2,y:this._height/2},r)this._dislocation.x=this._width/i/2-n.x,this._dislocation.y=this._height/i/2-n.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var o={x:Math.max(0,Math.min((0,I.q)(n.x/this._width,1e3),1)),y:Math.max(0,Math.min((0,I.q)(n.y/this._height,1e3),1))},v={x:(this._width/i-this._width/this._scale)*o.x,y:(this._height/i-this._height/this._scale)*o.y};this._dislocation.x+=v.x,this._dislocation.y+=v.y}this._scale=i,this.change(),this.zoomChange(this.scale)}}set zoomTo(i){"fit"==i?this.scaleTo(Math.min((this._width-60)/this._frameSize.width,(this._height-60)/this._frameSize.height),void 0,!0):"number"==typeof i&&this.scaleTo(i/100,void 0,!0)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(i,n){this._dislocation.x=i.x+n.x/this._scale,this._dislocation.y=i.y+n.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(0,x.eb)()}set onZoomChange(i){this._fnZoomChanges.push(i)}zoomChange(i){this._fnZoomChanges.forEach(n=>n(i))}}var fe=f(644);class ve{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){(0,fe.sV)({callback:i=>{this._fill=(null==i?void 0:i.fill)||this._fill,this._stroke=(null==i?void 0:i.stroke)||this._stroke,this._strokeWidth=(null==i?void 0:i.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==i?void 0:i.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==i?void 0:i.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){(0,fe.qp)({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(i){this._fill=i,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(i){this._stroke=i,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(i){this._strokeWidth=i,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(i){this._strokeLinecap=i}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(i){this._strokeLinejoin=i}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(i){this._fnChangeFills.push(i)}changeFill(i){this._fnChangeFills.forEach(n=>n(i)),this.saveConfig()}set onchangestroke(i){this._fnChangeStrokes.push(i)}changeStroke(i){this._fnChangeStrokes.forEach(n=>n(i)),this.saveConfig()}set onchangestrokewidth(i){this._fnChangeStrokeWidths.push(i)}changeStrokeWidth(i){this._fnChangeStrokeWidths.forEach(n=>n(i)),this.saveConfig()}}var Oe=f(1690),ri=f(5973),li=f(4787),Ae=function(M){return M&&JSON.parse(JSON.stringify(M))},Ge=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],Xe=[],oi={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},He={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class ei{constructor(){this._data_variables=Ae(Ge).concat(Ae(Xe)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=i=>{"function"==typeof i&&this.GetActionExecuteds.push(i)},this.OnGetActionExecuted=i=>{this.GetActionExecuteds.forEach(n=>{n(i)})},this.SetActionExecutings=[],this.FuncSetExecutings=i=>{"function"==typeof i&&this.SetActionExecutings.push(i)},this.OnSetActionExecuting=i=>{this.SetActionExecutings.forEach(n=>{n(i)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=i=>{"function"==typeof i&&this.SetActionExecuteds.push(i)},this.OnSetActionExecuted=i=>{for(var n of(this.SetActionExecuteds.forEach(r=>{r(i)}),this.getCondition(i.key)||[]))n.if&&n.if.length>0&&(this.checkValueConditions(n.if)?this.setValueOperators(n.then||[]):this.setValueOperators(n.else||[]))}}renew(){this._data_variables=Ae(Ge).concat(Ae(Xe)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(i){if(!i)return;let n={};"string"==typeof i?n=JSON.parse(i):"object"==typeof i&&(n=i),this._data_variables=n.variables||[],this._data_conditions=n.conditions||(r=>(this._data_variables.map(a=>a.change||[]).forEach(a=>{r=r.concat(a)}),r))([]),Ge.forEach(r=>{var a=this._data_variables.filter(o=>o.key==r.key);a.length?a.forEach(function(o,v,p){o.type=r.type,o.readonly=r.readonly,o.system=r.system}):this._data_variables.push(r)})}getVariableTemp(){return Ae(oi)}getConditionTemp(){return Ae(He)}getKeys(){return this._data_variables.map(function(i){return i.key}).sort(function(i,n){return i.localeCompare(n)})}getVariableAll(){return this._data_variables.length?Ae((M=this._data_variables,i="key",function(n){for(var r of M.map(function(a){return a[i]}).sort())M.filter(function(a){return a[i]==r}).forEach(function(a){n.push(a)}),M=M.filter(function(a){return a[i]!=r});return n}([]))):Ae(Ge).concat(Ae(Xe));var M,i}setVariableAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_variables=i),Ge.forEach(n=>{var r=this._data_variables.filter(a=>a.key==n.key);r.length?r.forEach((a,o,v)=>{a.type=n.type,a.readonly=n.readonly,a.system=n.system}):this._data_variables.push(n)}))}getVariable(i){return i?Ae(this._data_variables.filter(n=>n.key==i)[0]||{}):{}}setVariable(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(o=>o.key==i)[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(o=>o.key==i);a.length?a.forEach(function(o,v,p){o.value=n,o.type=r}):this._data_variables.push({key:i,value:n,type:r})}}getValue(i,n){if(!i)return"";var r=this._data_variables.filter(function(v){return v.key==i});if(r.length){var o,a=r[0]||{};switch(this.OnGetActionExecuting(a),n||(n=a.type||null),n){case"string":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":"string"==typeof a.value?a.value||"":a.value.toString().trim();break;case"number":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?0:"number"==typeof a.value?a.value||0:parseFloat(a.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(a.value)>=0?o=!1:"boolean"==typeof a.value?o=a.value:(o=(a.value+"").toLowerCase(),o="1"==a.value||"true"==a.value||"yes"==a.value||"dung"==a.value);break;case"audio-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></audio>`:"";break;case"video-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></video>`:"";break;case"img-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<img style="width:100%;vertical-align:middle;" src="${a.value}"/>`:"";break;default:o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value}return this.OnGetActionExecuted(a),o}return null}setValue(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(function(v){return v.key==i})[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(function(v){return v.key==i});if(a.length){var o=a[0];this.OnSetActionExecuting(o),o&&(o.value=n),this.OnSetActionExecuted(o)}}}getConditionAll(){return Ae(this._data_conditions.sort(function(i,n){return i.idx-n.idx}))}setConditionAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_conditions=i))}getCondition(i){return i?Ae(this._data_conditions.filter(n=>n.variable==i||(n.variables||[]).indexOf(i)>=0).sort(function(n,r){return n.idx-r.idx})):{}}switchCondition(i,n,r){switch(i){case"==":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,o){return a+o})>0):n==r;case"!=":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),0==r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,o){return a+o})):n!=r;case">=":return n>=r;case"<=":return n<=r;case">":return n>r;case"<":return n<r;case"\u2208":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,o){return a+o})>0;case"\u2209":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),0==r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,o){return a+o});default:return!1}}switchOperator(i,n,r){switch(i){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return n/r;case"=":return r;case"=!":return!r;case"==":return n==r;case"!=":return n!=r}}switchFormula(i,n){switch(i){case"sum":return n.reduce(function(a,o){return a+o});case"sub":return n.reduce(function(a,o){return a-o});case"pro":return n.reduce(function(a,o){return a*o});case"div":return n.reduce(function(a,o){return a/o});case"avg":var r=n.reduce(function(a,o){return a+o})/(n.length||1);return Math.round(1e4*(r+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,n);case"max":return Math.max.apply(null,n);case"and":return n.reduce(function(a,o){return a&&o});case"or":return n.reduce(function(a,o){return a||o});default:return 0}}switchValueType_Condition(i){switch(i.valuetype){case"value":return this.switchCondition(i.condition,this.getValue(i.variable),i.value);case"variable":return this.switchCondition(i.condition,this.getValue(i.variable),this.getValue(i.value));default:return 0}}switchValueType_Operator(i){switch(i.valuetype){case"value":return this.switchOperator(i.operator,this.getValue(i.variable),i.value);case"variable":return this.switchOperator(i.operator,this.getValue(i.variable),this.getValue(i.value));case"variables":var n=this.switchFormula(i.valueformula,i.value.map(r=>this.getValue(r)));return this.switchOperator(i.operator,this.getValue(i.variable),n)}}checkValueCondition(i){return this.switchValueType_Condition(i)}getValueOperator(i){return this.switchValueType_Operator(i)}setValueOperator(i){null!=i&&i.variable&&this.setValue(i.variable,this.getValueOperator(i))}checkValueConditions(i){return 0==i.map(n=>{switch(n.type){case"variable":return this.switchValueType_Condition(n)?0:1;case"variables":return 0==n.variables.map(r=>this.switchValueType_Condition(Object.assign(Ae(n),{variable:r}))?0:1).reduce(function(r,a){return r+a})?0:1;default:return 0}}).reduce((n,r)=>(null!=n?n:0)+(null!=r?r:0))}setValueOperators(i){for(var n of i)switch(n.type){case"variable":this.setValue(n.variable,this.getValueOperator(n));break;case"variables":for(var r of n.variables)this.setValue(r,this.getValueOperator(Object.assign(Ae(n),{variable:r})));break;case"slide":Oe.$.runSlide(void 0,void 0,n.slide);break;case"node":{var a;(0,li.L5)({id:n.node,nodeStatus:Oe.$.nodeStatus,slideStatus:Oe.$.slideStatus});let o=Oe.$.findNode(n.node);null!=o&&null!==(a=o.interactive)&&void 0!==a&&a.click&&(0,ri.F)(o,Oe.$.nodeStatus,Oe.$.slideStatus);break}}}FuncGetExecutings(i){"function"==typeof i&&this.GetActionExecutings.push(i)}OnGetActionExecuting(i){this.GetActionExecutings.forEach(n=>{n(i)})}}class Ye{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(i,n,r){if(this._pointer_type=i,n)switch(i){case z._.PEN:this._pen_type=n;break;case z._.SHAPE:this._shape_type=n,r&&n===T.$.POLYGON&&(this._polygon_type=r)}}get pointer_type(){return this._pointer_type}set pointer_type(i){this._pointer_type=i,this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(i){this._pointer_type_temp=i,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(i){this._pen_type=i,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(i){this._shape_type=i,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(i){this._polygon_type=i,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(i){this._fnChangePointerTypes.push(i)}changePointerType(i,n,r){this._fnChangePointerTypes.forEach(a=>a(i,n,r))}set onchangePointerTypeTemp(i){this._fnChangePointerTypeTemps.push(i)}changePointerTypeTemp(i,n,r){this._fnChangePointerTypeTemps.forEach(a=>a(i,n,r))}set onchangePenType(i){this._fnChangePenTypes.push(i)}changePenType(i,n,r){this._fnChangePenTypes.forEach(a=>a(i,n,r))}set onchangeShapeType(i){this._fnChangeShapeTypes.push(i)}changeShapeType(i,n,r){this._fnChangeShapeTypes.forEach(a=>a(i,n,r))}set onchangePolygonType(i){this._fnChangePolygonTypes.push(i)}changePolygonType(i,n,r){this._fnChangePolygonTypes.forEach(a=>a(i,n,r))}set onchange(i){this._fnChanges.push(i)}change(i,n,r){this._fnChanges.forEach(a=>a(i,n,r))}}const wt=new class si{constructor(){this._container="",this._svg="",this._screen=Ee.prototype,this._data=Jt.prototype,this._dataSelect=Tt.prototype,this._slide=jt.prototype,this._history=ye.prototype,this._attribute=ve.prototype,this._pointer=Ye.prototype,this._variable=ei.prototype,this._data=new Jt,this._dataSelect=new Tt,this._slide=new jt,this._history=new ye,this._attribute=new ve,this._pointer=new Ye,this._variable=new ei,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._pointer.onchangePointerTypeTemp=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(i){this._config=i}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,resources:this._data.getResource,variable:this._variable.get,info:{}}}set dataSource(i){this._screen.set=i.screen||{width:1080,height:1080},this._data.set=i.data||{},this._variable.set=i.variable||{}}get container(){return this._container}set container(i){this._container=i}get svg(){return this._svg}set svg(i){this._svg=i}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var i,n,r,a,o;this._screen.screen=(i=jQuery(this._container).offset(),n=jQuery(this._container).width(),r=jQuery(this._container).height(),console.log("reloadView",JSON.stringify({offset:i,width:n,height:r})),{offset:{x:null!==(a=null==i?void 0:i.left)&&void 0!==a?a:0,y:null!==(o=null==i?void 0:i.top)&&void 0!==o?o:0},width:null!=n?n:0,height:null!=r?r:0})}init(i){this._container=i.container,this._svg=i.target,this._screen=new Ee,(M=>{new x.Mh(M.container,M.target),wt.pointer.onchange=(r,a,o)=>{switch(r){case z._.POINTER:jQuery(M.target).css({cursor:"auto"});break;case z._.HAND:jQuery(M.target).css({cursor:"grab"});break;case z._.PEN:switch(a){case k.D.DRAW:jQuery(M.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case k.D.HIGHTLIGH:jQuery(M.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case z._.ERASER:jQuery(M.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case z._.SHAPE:jQuery(M.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case z._.TEXT:case z._.FOREIGNOBJECT:jQuery(M.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}},jQuery(M.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{wt.pointer.pointer_type==z._.HAND&&jQuery(M.target).css({cursor:"grabbing"})}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{wt.pointer.pointer_type==z._.HAND&&jQuery(M.target).css({cursor:"grab"})}),jQuery(M.container).off("mousewheel.icdt-init").on("mousewheel.icdt-init",r=>{var a;r.preventDefault();var o=wt.screen.scale,v=(null!==(a=r.originalEvent)&&void 0!==a?a:r).deltaY>0?1:-1;wt.screen.scaleTo(o-.04*o*v,(0,X.p)({x:r.clientX,y:r.clientY},1,{x:0,y:0},wt.screen.offset))}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{wt.screen.actived=!!jQuery(r.target).parents("app-main").length}),jQuery(M.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{wt.screen.actived=!0}),jQuery(M.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{wt.screen.actived=!1}),jQuery(M.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(M.container.includes("#")&&M.container.includes(r.target.getAttribute("id"))||M.container.includes(".")&&M.container.includes(r.target.getAttribute("class"))||M.container.includes(r.target.nodeName))&&(wt.pointer.pointer_type_temp||wt.pointer.pointer_type)===z._.POINTER&&(wt.dataSelect.ids=[])}),jQuery(M.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const i=r=>{switch(wt.pointer.pointer_type_temp||wt.pointer.pointer_type){case z._.POINTER:S(r);break;case z._.HAND:(M=>{(0,c.A)(M,new et,1,{x:0,y:0})})(r);break;case z._.PEN:(0,pt.i)(r);break;case z._.SHAPE:(M=>{var i=null;switch(wt.pointer.shape_type){case T.$.CIRCLE:i=new rt;break;case T.$.ELLIPSE:i=new mt;break;case T.$.LINE:i=new Dt;break;case T.$.RECT:i=new q;break;case T.$.POLYGON:var n;i=new Wt(null===(n=Q.find(r=>r.type==wt.pointer.polygon_type))||void 0===n?void 0:n.ratios);break;case T.$.FOREIGNOBJECT:i=new ht;break;case T.$.IMAGE:i=new Et;break;case T.$.TEXT:case T.$.PATH:i=new Mt}i&&(0,c.A)(M,i)})(r);break;case z._.FOREIGNOBJECT:(M=>{(0,c.A)(M,new ht)})(r);break;case z._.IMAGE:(M=>{(0,c.A)(M,new Et)})(r);break;case z._.TEXT:(M=>{(0,c.A)(M,new G)})(r);break;case z._.ERASER:(M=>{(0,c.A)(M,new j)})(r);break;case z._.INDEX:(0,J.s)(r)}};let n=!1;jQuery(M.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,i({touchEvent:r})}),jQuery(M.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);i({mouseEvent:r})}}),M.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{wt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Yt.t)(r))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{wt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Yt.t)(r))}))})({container:i.container,target:i.target,iskeyboard:i.iskeyboard})}}},4113:(he,At,f)=>{f.d(At,{s:()=>E,Q:()=>m});var z=f(1687),x=f(4981),dt=f(4318),T=f(6816),Z=f(4080);const E=S=>{var w,et,K,Q;let at=(null===(w=S.mouseEvent)||void 0===w?void 0:w.target)||(null===(et=S.touchEvent)||void 0===et?void 0:et.target),I=(null==at?void 0:at.getAttribute("id"))||"",rt=null==at?void 0:at.nodeName,gt=jQuery(at).parents("g[id]").attr("id")||"";if(![z.O.INDEX_GROUP].includes(gt))if(null!==(K=S.mouseEvent)&&void 0!==K&&K.altKey||null!==(Q=S.touchEvent)&&void 0!==Q&&Q.altKey||!I||I.match(/[^0-9]/)||!x.icdt.dataSelect.nodeName.includes(rt)){var mt;x.icdt.dataSelect.ids.length&&(x.icdt.dataSelect.ids=[]),(0==(null===(mt=S.mouseEvent)||void 0===mt?void 0:mt.button)||S.touchEvent)&&((S,w)=>{let I=(0,Z.g1)(z.O.SCAN_GROUP,"g"),rt=(0,dt.bH)(0,0,1,1);(0,Z.vl)(I,rt),((S,w,et,K)=>{(0,T.A)(S,{start:I=>{},move:(I,rt)=>{((I,rt,gt,mt)=>{w=(0,dt.bH)(I,rt,gt,mt),(0,Z.vl)(et,w)})(rt[0][0],rt[0][1],I.x,I.y)},end:(I,rt)=>{null==et||et.remove(),x.icdt.dataSelect.ids=x.icdt.data.getNodeInArea(Math.min(rt[0][0],I.x),Math.min(rt[0][1],I.y),Math.max(rt[0][0],I.x),Math.max(rt[0][1],I.y)),K(x.icdt.dataSelect.nodes)}})})(S,rt,I,w)})(S,Y)}else{var ct,q;let D=parseFloat(I||"0");x.icdt.dataSelect.ids=null!==(ct=S.mouseEvent)&&void 0!==ct&&ct.shiftKey||null!==(q=S.touchEvent)&&void 0!==q&&q.shiftKey?[D].concat(x.icdt.dataSelect.ids).filter((Lt,Dt,Vt)=>Vt.indexOf(Lt)==Dt):[D],Y(x.icdt.dataSelect.nodes)}},Y=S=>{var w,et;let K=1;var Q,at;if(S.length&&(K=Math.max.apply(null,null!==(Q=null===(at=x.icdt.data.slide)||void 0===at||null===(at=at.svg)||void 0===at?void 0:at.nodes.map(rt=>{var gt;return null!==(gt=rt.idx)&&void 0!==gt?gt:0}))&&void 0!==Q?Q:[0])+1),1==S.length)S[0].idx||(S[0].idx=K,S[0].time=0);else if(S.length>=0){let rt=S.map(mt=>{var ct;return null!==(ct=mt.idx)&&void 0!==ct?ct:0}).filter(mt=>mt>0),gt=rt.length?Math.min.apply(null,rt):K;S.forEach(mt=>{var ct;mt.idx=gt,mt.time=null!==(ct=mt.time)&&void 0!==ct?ct:0})}let I=(0,Z.g1)(z.O.INDEX_GROUP,"g");(0,Z.mo)(I,null!==(w=null===(et=x.icdt.data.slide)||void 0===et||null===(et=et.svg)||void 0===et?void 0:et.nodes)&&void 0!==w?w:[])},m=S=>{var w,et,K;null!=S&&null!==(w=S.svg)&&void 0!==w&&w.nodes&&S.svg.nodes.forEach(at=>{at.idx=0,at.time=null});let Q=(0,Z.g1)(z.O.INDEX_GROUP,"g");(0,Z.mo)(Q,null!==(et=null===(K=x.icdt.data.slide)||void 0===K||null===(K=K.svg)||void 0===K?void 0:K.nodes)&&void 0!==et?et:[])}},4578:(he,At,f)=>{f.d(At,{h:()=>w,t:()=>et});var z=f(644),x=f(7308),dt=f(968),T=f(4981),Z=f(666),c=f(2966),C=f(5226),E=f(3423),Y=f(5811),m=f(3385);const w=new class S{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:x.s.Escape,fn:()=>{T.icdt.dataSelect.ids.length&&(T.icdt.dataSelect.ids=[])}},this.onchange={type:"keydown",key:x.s.Delete,fn:()=>{T.icdt.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:x.s.Space,fn:()=>{T.icdt.pointer.pointer_type_temp=dt._.HAND}},this.onchange={type:"keyup",key:x.s.Space,fn:()=>{T.icdt.pointer.pointer_type_temp=dt._.POINTER}},this.onchange={type:"keydown",key:x.s.ArrowLeft,fn:()=>{T.icdt.dataSelect.ids.length||T.icdt.data.backSlide()}},this.onchange={type:"keydown",key:x.s.ArrowRight,fn:()=>{T.icdt.dataSelect.ids.length||T.icdt.data.nextSlide()}},this.onchange={type:"keydown",key:x.s.ArrowLeft,fn:()=>{T.icdt.dataSelect.ids.length&&(T.icdt.dataSelect.nodes.forEach(Q=>{(0,m.k6)(Q,(0,Y.q)(Q.size.x-(0,E.v)(1)))}),1==T.icdt.dataSelect.ids.length?(0,Z.y)(T.icdt.dataSelect.nodes[0]):(0,c.Q)(T.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:x.s.ArrowRight,fn:()=>{T.icdt.dataSelect.ids.length&&(T.icdt.dataSelect.nodes.forEach(Q=>{(0,m.k6)(Q,(0,Y.q)(Q.size.x+(0,E.v)(1)))}),1==T.icdt.dataSelect.ids.length?(0,Z.y)(T.icdt.dataSelect.nodes[0]):(0,c.Q)(T.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:x.s.ArrowUp,fn:()=>{T.icdt.dataSelect.ids.length&&(T.icdt.dataSelect.nodes.forEach(Q=>{(0,m.co)(Q,(0,Y.q)(Q.size.y-(0,E.v)(1)))}),1==T.icdt.dataSelect.ids.length?(0,Z.y)(T.icdt.dataSelect.nodes[0]):(0,c.Q)(T.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:x.s.ArrowDown,fn:()=>{T.icdt.dataSelect.ids.length&&(T.icdt.dataSelect.nodes.forEach(Q=>{(0,m.co)(Q,(0,Y.q)(Q.size.y+(0,E.v)(1)))}),1==T.icdt.dataSelect.ids.length?(0,Z.y)(T.icdt.dataSelect.nodes[0]):(0,c.Q)(T.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:x.s.Digit1,fn:Q=>{Q.shiftKey&&(T.icdt.reloadView(),T.icdt.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:x.s.KeyA,fn:Q=>{if(Q.ctrlKey){T.icdt.dataSelect.ids=T.icdt.data.getNodeAll();let at=T.icdt.dataSelect.nodes;1==at.length?(0,Z.y)(at[0]):at.length>1&&(0,c.Q)(at)}}},this.onchange={type:"keydown",key:x.s.KeyC,fn:Q=>{if(Q.ctrlKey){let at=T.icdt.dataSelect.nodes;at&&(0,z.yR)({params:{type:"nodes",nodes:at}})}}},this.onchange={type:"keydown",key:x.s.KeyV,fn:Q=>{Q.ctrlKey&&(0,z.aY)({callback:at=>{var I,rt;"nodes"==(null==at?void 0:at.type)&&null!=at&&null!==(I=at.nodes)&&void 0!==I&&I.length&&(null==at||null===(rt=at.nodes)||void 0===rt||rt.forEach(gt=>{gt.id=Math.ceil(1e9*Math.random()),T.icdt.data.node=gt}),(0,C.E)(T.icdt.data.slide))}})}},this.onchange={type:"keydown",key:x.s.KeyZ,fn:Q=>{Q.ctrlKey&&Q.shiftKey?T.icdt.history.redo():Q.ctrlKey&&T.icdt.history.undo()}}}set onchange(Q){let at=this._fnChanges.find(I=>I.eventType==Q.type&&I.eventKey==Q.key);at?at.fns.push(Q.fn):this._fnChanges.push({eventType:Q.type,eventKey:Q.key,fns:[Q.fn]})}change(Q,at,I){var rt;null===(rt=this._fnChanges.find(gt=>gt.eventType==Q&&gt.eventKey==at))||void 0===rt||rt.fns.forEach(gt=>gt(I))}},et=K=>{w.change(K.type,K.keyCode||K.which||K.charCode||0,K)}},410:(he,At,f)=>{f.d(At,{a:()=>E});var z=f(4318),x=f(8419),dt=f(9054),T=f(4080),Z=f(511),c=f(3423),C=f(1687);class E{constructor(m){var S;let w={stroke:"#FF0000",strokeWidth:(0,c.v)(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,c.v)(8)},{element:K,attribute:Q,size:at}=(0,x.G)(Math.ceil(1e9*Math.random()),{size:m});window.document.getElementById(C.O.INTERACTIVE_GROUP).querySelectorAll("path").forEach(ct=>null==ct?void 0:ct.remove()),null===(S=window.document.getElementById(C.O.INTERACTIVE_GROUP))||void 0===S||S.appendChild(K),(0,T.__)(K,w);let rt="";return{start:ct=>{rt=`M ${ct.x} ${ct.y} L ${ct.x} ${ct.y}`},move:(ct,q)=>{((ct,q)=>{rt+=` ${ct} ${q}`,K.setAttribute("d",rt)})(ct.x,ct.y)},end:(ct,q)=>{(ct=>{let D=Z.jvg().x(Wt=>Wt[0]).y(Wt=>Wt[1]).curve(Z.$0Z)(ct);K.setAttribute("d",D),ct.length>=2&&(window.interactivePoints=ct)})(q),(ct=>{let q=9999,D=9999,Wt=-9999,Lt=-9999;ct.forEach(Dt=>{q=Math.min(q,Dt[0]),D=Math.min(D,Dt[1]),Wt=Math.max(Wt,Dt[0]),Lt=Math.max(Lt,Dt[1])}),at=(0,z.bH)(q,D,Wt,Lt,{points:ct}),Object.assign(Q,(0,z.sg)(dt.$.PATH,at),w)})(q)}}}}},9623:(he,At,f)=>{f.d(At,{U:()=>K,i:()=>et});var z=f(1687),x=f(9125),dt=f(4981),T=f(6816),Z=f(4080),c=f(4318),C=f(8419),E=f(9054),Y=f(511);class m{constructor(){let at={strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:I,element:rt,attribute:gt,size:mt}=(0,C.G)(Math.ceil(1e9*Math.random()));(0,Z.__)(rt,gt);let q="";return{start:Lt=>{q=`M ${Lt.x} ${Lt.y} L ${Lt.x} ${Lt.y}`},move:(Lt,Dt)=>{((Lt,Dt)=>{q+=` ${Lt} ${Dt}`,rt.setAttribute("d",q)})(Lt.x,Lt.y)},end:(Lt,Dt)=>{(Lt=>{let Vt=Y.jvg().x(Mt=>Mt[0]).y(Mt=>Mt[1]).curve(Y.$0Z)(Lt);rt.setAttribute("d",Vt)})(Dt),(Lt=>{let Dt=9999,Vt=9999,Mt=-9999,Gt=-9999;Lt.forEach(ht=>{Dt=Math.min(Dt,ht[0]),Vt=Math.min(Vt,ht[1]),Mt=Math.max(Mt,ht[0]),Gt=Math.max(Gt,ht[1])}),mt=(0,c.bH)(Dt,Vt,Mt,Gt,{points:Lt}),Object.assign(gt,(0,c.sg)(E.$.PATH,mt),at)})(Dt),dt.icdt.data.node=Object.assign({id:I,type:E.$.PATH,name:"Path"},{size:mt,attribute:gt})}}}}class S{constructor(){let at={strokeOpacity:.4,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:I,element:rt,attribute:gt,size:mt}=(0,C.G)(Math.ceil(1e9*Math.random()));(0,Z.__)(rt,gt);let q="";var D=(Wt,Lt)=>{q+=` ${Wt} ${Lt}`,rt.setAttribute("d",q)};return{start:Wt=>{q=`M ${Wt.x} ${Wt.y} L ${Wt.x} ${Wt.y}`},move:(Wt,Lt)=>{D(Wt.x,Wt.y)},end:(Wt,Lt)=>{D(Wt.x,Wt.y),(Wt=>{let Lt=9999,Dt=9999,Vt=-9999,Mt=-9999;Wt.forEach(Gt=>{Lt=Math.min(Lt,Gt[0]),Dt=Math.min(Dt,Gt[1]),Vt=Math.max(Vt,Gt[0]),Mt=Math.max(Mt,Gt[1])}),mt=(0,c.bH)(Lt,Dt,Vt,Mt,{points:Wt}),Object.assign(gt,(0,c.sg)(E.$.PATH,mt),at)})(Lt),dt.icdt.data.node=Object.assign({id:I,type:E.$.PATH,name:"Path"},{size:mt,attribute:gt})}}}}var w=f(410);const et=Q=>{switch(dt.icdt.pointer.pen_type){case x.D.DRAW:(0,T.A)(Q,new m);break;case x.D.HIGHTLIGH:(0,T.A)(Q,new S);break;case x.D.INTERACTIVE:K(Q)}},K=Q=>{var at,I;let rt=(0,Z.g1)(z.O.INTERACTIVE_GROUP,"g"),gt=null!==(at=null===(I=dt.icdt.data.slide)||void 0===I||null===(I=I.svg)||void 0===I?void 0:I.viewBox)&&void 0!==at?at:(()=>{let{width:mt,height:ct}=dt.icdt.screen.get;return{x:0,y:0,width:mt,height:ct}})();(0,Z.XH)(rt,gt),Q&&(0,T.A)(Q,new w.a)}},666:(he,At,f)=>{f.d(At,{y:()=>C});var z=f(1687),x=f(4981),dt=f(4318),T=f(6816),Z=f(4080),c=f(5811);const C=m=>{let S=(0,Z.g1)(z.O.RESIZE_GROUP,"g");(0,Z.hJ)(S,m).forEach(w=>{E(w.element,w.posType,m,S)})},E=(m,S,w,et)=>{let K=!1;null==m||m.addEventListener("touchstart",Q=>{K=!0,Y({touchEvent:Q},S,w,et)}),null==m||m.addEventListener("mousedown",Q=>{if(0==Q.button){if(K)return void(K=!1);Y({mouseEvent:Q},S,w,et)}})},Y=(m,S,w,et)=>{let D,{id:K,type:Q,size:at,attribute:I}=w,{x:rt,y:gt,width:mt,height:ct}=at,q=(mt||1)/(ct||1),Lt=null,Mt=!1;(0,T.A)(m,{start:ht=>{Lt=JSON.parse(JSON.stringify({id:K,size:at,attribute:I}))},move:(ht,it)=>{((ht,it,Et,St)=>{switch(S){case"rect-center":var Yt,pt;D=null!==(Yt=m.mouseEvent)&&void 0!==Yt&&Yt.shiftKey||null!==(pt=m.touchEvent)&&void 0!==pt&&pt.shiftKey?Math.abs(Et-ht)>=Math.abs(St-it)?{x:rt+Et-ht,y:gt,width:mt,height:ct}:{x:rt,y:gt+St-it,width:mt,height:ct}:{x:rt+Et-ht,y:gt+St-it,width:mt,height:ct};break;case"rect-top-left":var ne,U,P,h,H,yt,ft,Ot;D=(null!==(ne=m.mouseEvent)&&void 0!==ne&&ne.shiftKey||null!==(U=m.touchEvent)&&void 0!==U&&U.shiftKey)&&(null!==(P=m.mouseEvent)&&void 0!==P&&P.altKey||null!==(h=m.touchEvent)&&void 0!==h&&h.altKey)?q>=1?{x:rt+(Et-ht),y:gt+(Et-ht)/q,width:mt-2*(Et-ht),height:ct-2*(Et-ht)/q}:{x:rt+(St-it)*q,y:gt+(St-it),width:mt-2*(St-it)*q,height:ct-2*(St-it)}:null!==(H=m.mouseEvent)&&void 0!==H&&H.shiftKey||null!==(yt=m.touchEvent)&&void 0!==yt&&yt.shiftKey?q>=1?{x:rt+(Et-ht),y:gt+(Et-ht)/q,width:mt-(Et-ht),height:ct-(Et-ht)/q}:{x:rt+(St-it)*q,y:gt+(St-it),width:mt-(St-it)*q,height:ct-(St-it)}:null!==(ft=m.mouseEvent)&&void 0!==ft&&ft.altKey||null!==(Ot=m.touchEvent)&&void 0!==Ot&&Ot.altKey?{x:rt+(Et-ht),y:gt+(St-it),width:mt-2*(Et-ht),height:ct-2*(St-it)}:{x:rt+(Et-ht),y:gt+(St-it),width:mt-(Et-ht),height:ct-(St-it)};break;case"rect-top-right":var Qt,zt,xt,_t,qt,Pt,re,j;D=(null!==(Qt=m.mouseEvent)&&void 0!==Qt&&Qt.shiftKey||null!==(zt=m.touchEvent)&&void 0!==zt&&zt.shiftKey)&&(null!==(xt=m.mouseEvent)&&void 0!==xt&&xt.altKey||null!==(_t=m.touchEvent)&&void 0!==_t&&_t.altKey)?q>=1?{x:rt-(Et-ht),y:gt-(Et-ht)/q,width:mt+2*(Et-ht),height:ct+2*(Et-ht)/q}:{x:rt+(St-it)*q,y:gt+(St-it),width:mt-2*(St-it)*q,height:ct-2*(St-it)}:null!==(qt=m.mouseEvent)&&void 0!==qt&&qt.shiftKey||null!==(Pt=m.touchEvent)&&void 0!==Pt&&Pt.shiftKey?q>=1?{x:rt,y:gt-(Et-ht)/q,width:mt+(Et-ht),height:ct+(Et-ht)/q}:{x:rt,y:gt+(St-it),width:mt-(St-it)*q,height:ct-(St-it)}:null!==(re=m.mouseEvent)&&void 0!==re&&re.altKey||null!==(j=m.touchEvent)&&void 0!==j&&j.altKey?{x:rt-(Et-ht),y:gt+(St-it),width:mt+2*(Et-ht),height:ct-2*(St-it)}:{x:rt,y:gt+(St-it),width:mt+(Et-ht),height:ct-(St-it)};break;case"rect-bottom-left":var d,O,G,V,B,A,J,k;D=(null!==(d=m.mouseEvent)&&void 0!==d&&d.shiftKey||null!==(O=m.touchEvent)&&void 0!==O&&O.shiftKey)&&(null!==(G=m.mouseEvent)&&void 0!==G&&G.altKey||null!==(V=m.touchEvent)&&void 0!==V&&V.altKey)?q>=1?{x:rt+(Et-ht),y:gt+(Et-ht)/q,width:mt-2*(Et-ht),height:ct-2*(Et-ht)/q}:{x:rt-(St-it)*q,y:gt-(St-it),width:mt+2*(St-it)*q,height:ct+2*(St-it)}:null!==(B=m.mouseEvent)&&void 0!==B&&B.shiftKey||null!==(A=m.touchEvent)&&void 0!==A&&A.shiftKey?q>=1?{x:rt+(Et-ht),y:gt,width:mt-(Et-ht),height:ct-(Et-ht)/q}:{x:rt-(St-it)*q,y:gt,width:mt+(St-it)*q,height:ct+(St-it)}:null!==(J=m.mouseEvent)&&void 0!==J&&J.altKey||null!==(k=m.touchEvent)&&void 0!==k&&k.altKey?{x:rt+(Et-ht),y:gt-(St-it),width:mt-2*(Et-ht),height:ct+2*(St-it)}:{x:rt+(Et-ht),y:gt,width:mt-(Et-ht),height:ct+(St-it)};break;case"rect-bottom-right":var X,bt,Kt,Tt,Rt,jt,Ut,Jt;D=(null!==(X=m.mouseEvent)&&void 0!==X&&X.shiftKey||null!==(bt=m.touchEvent)&&void 0!==bt&&bt.shiftKey)&&(null!==(Kt=m.mouseEvent)&&void 0!==Kt&&Kt.altKey||null!==(Tt=m.touchEvent)&&void 0!==Tt&&Tt.altKey)?q>=1?{x:rt-(Et-ht),y:gt-(Et-ht)/q,width:mt+2*(Et-ht),height:ct+2*(Et-ht)/q}:{x:rt-(St-it)*q,y:gt-(St-it),width:mt+2*(St-it)*q,height:ct+2*(St-it)}:null!==(Rt=m.mouseEvent)&&void 0!==Rt&&Rt.shiftKey||null!==(jt=m.touchEvent)&&void 0!==jt&&jt.shiftKey?q>=1?{x:rt,y:gt,width:mt+(Et-ht),height:ct+(Et-ht)/q}:{x:rt,y:gt,width:mt+(St-it)*q,height:ct+(St-it)}:null!==(Ut=m.mouseEvent)&&void 0!==Ut&&Ut.altKey||null!==(Jt=m.touchEvent)&&void 0!==Jt&&Jt.altKey?{x:rt-(Et-ht),y:gt-(St-it),width:mt+2*(Et-ht),height:ct+2*(St-it)}:{x:rt,y:gt,width:mt+(Et-ht),height:ct+(St-it)};break;default:D={x:rt+Et-ht,y:gt+St-it,width:mt,height:ct}}D.width<0&&(D.width=0),D.height<0&&(D.height=0),D.x=(0,c.q)(D.x),D.y=(0,c.q)(D.y),D.width=(0,c.q)(D.width),D.height=(0,c.q)(D.height),Object.assign(at,D),Object.assign(I,(0,dt.sg)(Q,at)),(0,Z.__)(window.document.getElementById(K),I),(0,Z.hJ)(et,w)})(it[0][0],it[0][1],ht.x,ht.y),Mt=!0},end:(ht,it)=>{Mt&&Lt&&x.icdt.history.push([{type:"size",from:Lt,to:JSON.parse(JSON.stringify({id:K,size:at,attribute:I}))}])}})}},2966:(he,At,f)=>{f.d(At,{Q:()=>E});var z=f(1687),x=f(4981),dt=f(4318),T=f(6816),Z=f(4080),c=f(3423),C=f(5811);const E=S=>{let w=999999,et=999999,K=-999999,Q=-999999;null==S||S.forEach(rt=>{w=Math.min(w,rt.size.x),et=Math.min(et,rt.size.y),K=Math.max(K,rt.size.x+rt.size.width),Q=Math.max(Q,rt.size.y+rt.size.height)});let at=(0,Z.g1)(z.O.SELECT_GROUP,"g"),I=(0,dt.bH)(w,et,K,Q);(0,Z.yD)(at,S,I).forEach(rt=>{Y(rt.element,rt.posType,I,S,at)})},Y=(S,w,et,K,Q)=>{let at=!1;null==S||S.addEventListener("touchstart",I=>{at=!0,m({touchEvent:I},w,et,K,Q)}),null==S||S.addEventListener("mousedown",I=>{if(0==I.button){if(at)return void(at=!1);m({mouseEvent:I},w,et,K,Q)}})},m=(S,w,et,K,Q)=>{let{x:at,y:I,width:rt,height:gt}=et,mt=K.map(Dt=>Object.assign({},Dt.size)),q=[];(0,T.A)(S,{start:Dt=>{K.forEach((Dt,Vt)=>{let{id:Mt,size:ht,attribute:it}=Dt;q.push(JSON.parse(JSON.stringify({id:Mt,size:ht,attribute:it})))})},move:(Dt,Vt)=>{((Dt,Vt,Mt,Gt)=>{(()=>{let ht;ht="rect-center"===w?{x:at+Mt-Dt,y:I+Gt-Vt,width:rt,height:gt}:{x:at,y:I,width:rt,height:gt},(0,c.v)(x.icdt.screen.width),(0,c.v)(x.icdt.screen.height),ht.width<0&&(ht.width=0),ht.height<0&&(ht.height=0),Object.assign(et,ht),(0,Z.yD)(Q,K,et)})(),K.forEach((ht,it)=>{let H,{x:Et,y:St,width:Yt,height:pt}=mt[it],{id:ne,type:U,size:P,attribute:h}=ht;H="rect-center"===w?{x:Et+Mt-Dt,y:St+Gt-Vt,width:Yt,height:pt}:{x:Et,y:St,width:Yt,height:pt},(0,c.v)(x.icdt.screen.width),(0,c.v)(x.icdt.screen.height),H.width<0&&(H.width=0),H.height<0&&(H.height=0),H.x=(0,C.q)(H.x),H.y=(0,C.q)(H.y),H.width=(0,C.q)(H.width),H.height=(0,C.q)(H.height),Object.assign(P,H),Object.assign(h,(0,dt.sg)(U,P)),(0,Z.__)(window.document.getElementById(ne),h)})})(Vt[0][0],Vt[0][1],Dt.x,Dt.y)},end:(Dt,Vt)=>{q.length&&x.icdt.history.push(K.map((Dt,Vt)=>{let{id:Mt,size:ht,attribute:it}=Dt;return{type:"size",from:q[Vt],to:JSON.parse(JSON.stringify({id:Mt,size:ht,attribute:it}))}}))}})}},5226:(he,At,f)=>{f.d(At,{E:()=>Q,T:()=>at});var z=f(1687),x=f(8619),dt=f(8785),T=f(2282),Z=f(8054),c=f(4921),C=f(6358),E=f(9054),Y=f(8419),m=f(1105),S=f(2875),w=f(7210),et=f(4981),K=f(4080);const Q=(I,rt)=>{var gt;if(rt&&!window.document.getElementById(rt))return;if(rt){let ct=window.document.getElementById(rt);jQuery(ct).find("#"+z.O.BACKGROUND_GROUP).empty();let q=(0,K.g1)(z.O.BACKGROUND_GROUP,"g",void 0,ct);(0,K.x0)(q,I)}else{jQuery(et.icdt.target).find("#"+z.O.BACKGROUND_GROUP).empty();let ct=(0,K.g1)(z.O.BACKGROUND_GROUP,"g",void 0,et.icdt.target);(0,K.x0)(ct,I)}let mt=(ct,q)=>{q=q?parseFloat(`${rt}0${q}`):rt,null==ct||ct.forEach(D=>{let Wt=rt?parseFloat(`${rt}0${D.id}`):D.id;var Lt;if(D.isdeleted)null===(Lt=window.document.getElementById(Wt))||void 0===Lt||Lt.remove();else switch(D.type){case E.$.GROUP:(0,C.m)(Wt,{},q?window.document.getElementById(q):null),mt(D.nodes,D.id);break;case E.$.CIRCLE:(0,x._)(Wt,{size:D.size,attribute:D.attribute},q?window.document.getElementById(q):null);break;case E.$.ELLIPSE:(0,dt.r)(Wt,{size:D.size,attribute:D.attribute},q?window.document.getElementById(q):null);break;case E.$.LINE:(0,c.W)(Wt,{size:D.size,attribute:D.attribute},q?window.document.getElementById(q):null);break;case E.$.RECT:(0,Z.f)(Wt,{size:D.size,attribute:D.attribute},q?window.document.getElementById(q):null);break;case E.$.POLYGON:(0,T.l)(Wt,{size:D.size,attribute:D.attribute},q?window.document.getElementById(q):null);break;case E.$.FOREIGNOBJECT:(0,S.e)(Wt,{size:D.size,attribute:D.attribute,style:D.style,source:D.source},q?window.document.getElementById(q):null);break;case E.$.IMAGE:(0,w.G)(Wt,{size:D.size,attribute:D.attribute,source:D.source},q?window.document.getElementById(q):null);break;case E.$.TEXT:(0,m.$)(Wt,{size:D.size,attribute:D.attribute,source:D.source},q?window.document.getElementById(q):null);break;case E.$.PATH:(0,Y.G)(Wt,{size:D.size,attribute:D.attribute},q?window.document.getElementById(q):null)}})};mt(null==I||null===(gt=I.svg)||void 0===gt?void 0:gt.nodes)},at=(I,rt)=>{var gt;if(rt&&!window.document.getElementById(rt))return;let mt=(ct,q)=>{q=q?parseFloat(`${rt}0${q}`):rt,null==ct||ct.forEach(D=>{let Wt=rt?parseFloat(`${rt}0${D.id}`):D.id;jQuery("#"+Wt).appendTo(q?window.document.getElementById(q):et.icdt.target),D.type==E.$.GROUP&&mt(D.nodes,D.id)})};mt(null==I||null===(gt=I.svg)||void 0===gt?void 0:gt.nodes)}},8619:(he,At,f)=>{f.d(At,{_:()=>Z});var z=f(9054),x=f(4981),dt=f(4318),T=f(4080);const Z=(c,C,E)=>{let Y=(null==C?void 0:C.size)||{x:0,y:0,width:10,height:10},m=(null==C?void 0:C.attribute)||{fill:x.icdt.attribute.fill,stroke:x.icdt.attribute.stroke,strokeWidth:x.icdt.attribute.strokeWidth};return Object.assign(m,(0,dt.sg)(z.$.CIRCLE,Y)),{nodeId:c,element:(0,T.it)(c,z.$.CIRCLE,"circle",{size:Y,attribute:m},E),size:Y,attribute:m}}},8785:(he,At,f)=>{f.d(At,{r:()=>Z});var z=f(9054),x=f(4981),dt=f(4318),T=f(4080);const Z=(c,C,E)=>{let Y=(null==C?void 0:C.size)||{x:0,y:0,width:10,height:10},m=(null==C?void 0:C.attribute)||{fill:x.icdt.attribute.fill,stroke:x.icdt.attribute.stroke,strokeWidth:x.icdt.attribute.strokeWidth};return Object.assign(m,(0,dt.sg)(z.$.ELLIPSE,Y)),{nodeId:c,element:(0,T.it)(c,z.$.ELLIPSE,"ellipse",{size:Y,attribute:m},E),size:Y,attribute:m}}},2875:(he,At,f)=>{f.d(At,{e:()=>T});var z=f(9054),x=f(4318),dt=f(4080);const T=(Z,c,C)=>{let E=(null==c?void 0:c.size)||{x:0,y:0,width:180,height:180},Y=(null==c?void 0:c.attribute)||{};Object.assign(Y,(0,x.sg)(z.$.FOREIGNOBJECT,E));let m=(null==c?void 0:c.source)||{type:"html",html:{htmlContent:'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>'}},S=(null==c?void 0:c.style)||{};return{nodeId:Z,element:(0,dt.it)(Z,z.$.FOREIGNOBJECT,"foreignObject",{size:E,attribute:Y,style:S,source:m},C),size:E,attribute:Y,style:S,source:m}}},6358:(he,At,f)=>{f.d(At,{m:()=>T});var z=f(9054),x=f(4318),dt=f(4080);const T=(Z,c,C)=>{let E=(null==c?void 0:c.size)||{x:0,y:0,width:10,height:10},Y=(null==c?void 0:c.attribute)||{};return Object.assign(Y,(0,x.sg)(z.$.GROUP,E)),{nodeId:Z,element:(0,dt.it)(Z,z.$.GROUP,"g",{size:E,attribute:Y},C),size:E,attribute:Y}}},7210:(he,At,f)=>{f.d(At,{G:()=>T});var z=f(9054),x=f(4318),dt=f(4080);const T=(Z,c,C)=>{let E=(null==c?void 0:c.size)||{x:0,y:0,width:100,height:100},Y=(null==c?void 0:c.attribute)||{preserveAspectRatio:"none"};Object.assign(Y,(0,x.sg)(z.$.IMAGE,E));let m=(null==c?void 0:c.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:Z,element:(0,dt.it)(Z,z.$.IMAGE,"image",{size:E,attribute:Y,source:m},C),size:E,attribute:Y,source:m}}},4921:(he,At,f)=>{f.d(At,{W:()=>Z});var z=f(9054),x=f(4981),dt=f(4318),T=f(4080);const Z=(c,C,E)=>{let Y=(null==C?void 0:C.size)||{x:0,y:0,width:10,height:10},m=(null==C?void 0:C.attribute)||{stroke:x.icdt.attribute.stroke,strokeWidth:x.icdt.attribute.strokeWidth,strokeLinecap:x.icdt.attribute.strokeLinecap};return Object.assign(m,(0,dt.sg)(z.$.LINE,Y)),{nodeId:c,element:(0,T.it)(c,z.$.LINE,"line",{size:Y,attribute:m},E),size:Y,attribute:m}}},8419:(he,At,f)=>{f.d(At,{G:()=>Z});var z=f(9054),x=f(4981),dt=f(4318),T=f(4080);const Z=(c,C,E)=>{let Y=(null==C?void 0:C.size)||{x:0,y:0,width:10,height:10},m=(null==C?void 0:C.attribute)||{stroke:x.icdt.attribute.stroke,strokeWidth:x.icdt.attribute.strokeWidth};return Object.assign(m,(0,dt.sg)(z.$.PATH,Y)),{nodeId:c,element:(0,T.it)(c,z.$.PATH,"path",{size:Y,attribute:m},E),size:Y,attribute:m}}},2282:(he,At,f)=>{f.d(At,{l:()=>Z});var z=f(9054),x=f(4981),dt=f(4318),T=f(4080);const Z=(c,C,E)=>{let Y=(null==C?void 0:C.size)||{x:0,y:0,width:10,height:10},m=(null==C?void 0:C.attribute)||{fill:x.icdt.attribute.fill,stroke:x.icdt.attribute.stroke,strokeWidth:x.icdt.attribute.strokeWidth};return Object.assign(m,(0,dt.sg)(z.$.POLYGON,Y)),{nodeId:c,element:(0,T.it)(c,z.$.POLYGON,"polygon",{size:Y,attribute:m},E),size:Y,attribute:m}}},8054:(he,At,f)=>{f.d(At,{f:()=>Z});var z=f(9054),x=f(4981),dt=f(4318),T=f(4080);const Z=(c,C,E)=>{let Y=(null==C?void 0:C.size)||{x:0,y:0,width:10,height:10},m=(null==C?void 0:C.attribute)||{fill:x.icdt.attribute.fill,stroke:x.icdt.attribute.stroke,strokeWidth:x.icdt.attribute.strokeWidth};return Object.assign(m,(0,dt.sg)(z.$.RECT,Y)),{nodeId:c,element:(0,T.it)(c,z.$.RECT,"rect",{size:Y,attribute:m},E),size:Y,attribute:m}}},1105:(he,At,f)=>{f.d(At,{$:()=>Z});var z=f(9054),x=f(4981),dt=f(4318),T=f(4080);const Z=(c,C,E)=>{let Y=(null==C?void 0:C.size)||{x:0,y:0,width:100,height:50},m=(null==C?void 0:C.attribute)||{fill:x.icdt.attribute.stroke,fontFamily:x.icdt.attribute.fontFamily,fontSize:x.icdt.attribute.fontSize,textLength:x.icdt.attribute.textLength};Object.assign(m,(0,dt.sg)(z.$.TEXT,Y));let S=(null==C?void 0:C.source)||{type:"text",text:{textContent:"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!"}};return{nodeId:c,element:(0,T.it)(c,z.$.TEXT,"text",{size:Y,attribute:m,source:S},E),size:Y,attribute:m,source:S}}},4318:(he,At,f)=>{f.d(At,{bH:()=>x,sg:()=>dt});var z=f(9054);const x=(Z,c,C,E,Y)=>{let m={x:Math.min(Z,C),y:Math.min(c,E),width:Math.abs(C-Z)||1,height:Math.abs(E-c)||1};return null!=Y&&Y.ratio&&(m.width<=m.height?m.height=m.width*(null==Y?void 0:Y.ratio):m.width=m.height/(null==Y?void 0:Y.ratio)),Object.assign(m,{ratios:(null==Y?void 0:Y.ratios)||[[(Z-m.x)/(m.width||1),(c-m.y)/(m.height||1)],[(C-m.x)/(m.width||1),(E-m.y)/(m.height||1)]]}),null!=Y&&Y.points&&(m.points=null==Y?void 0:Y.points),m},dt=(Z,c,C)=>{var E=(()=>{switch(Z){case z.$.CIRCLE:return{cx:c.x+c.width/2,cy:c.y+c.height/2,r:Math.min(c.width/2,c.height/2)};case z.$.ELLIPSE:return{cx:c.x+c.width/2,cy:c.y+c.height/2,rx:c.width/2,ry:c.height/2};case z.$.LINE:{var Y;let w={};return null===(Y=c.ratios)||void 0===Y||Y.forEach((et,K)=>{w[`x${K+1}`]=c.x+c.width*et[0],w[`y${K+1}`]=c.y+c.height*et[1]}),w}case z.$.RECT:return{x:c.x,y:c.y,width:c.width,height:c.height};case z.$.POLYGON:var m;return{points:((null===(m=c.ratios)||void 0===m?void 0:m.map(w=>[c.x+c.width*w[0],c.y+c.height*w[1]]))||[]).map(w=>w.join(" ")).join(",")};case z.$.FOREIGNOBJECT:case z.$.IMAGE:return{x:c.x,y:c.y,width:c.width,height:c.height};case z.$.TEXT:return{x:c.x,y:c.y};case z.$.PATH:{var S;let w=null!==(S=c.points)&&void 0!==S?S:[];return w.length?{d:`M ${w[0][0]} ${w[0][1]} L `+(w.map(et=>[et[0],et[1]])||[]).map(et=>et.join(" ")).join(" ")}:{d:""}}}return{}})();return c.rotate?(E.transform=`rotate(${c.rotate})`,E.transformOrigin=`${c.x+c.width/2} ${c.y+c.height/2}`):(E.transform=null,E.transformOrigin=null),E}},5811:(he,At,f)=>{f.d(At,{q:()=>z});const z=(x,dt)=>{var T;return dt=null!==(T=dt)&&void 0!==T?T:100,Math.round((x+Number.EPSILON)*dt)/dt}},3423:(he,At,f)=>{f.d(At,{v:()=>dt});var z=f(4981),x=f(5811);const dt=T=>(0,x.q)(T/z.icdt.screen.scale)},3385:(he,At,f)=>{f.d(At,{Vs:()=>E,co:()=>c,k6:()=>Z,lO:()=>C,mr:()=>Y});var z=f(4981),x=f(4080),dt=f(4318),T=f(5811);const Z=(m,S)=>{let{id:w,type:et,size:K,attribute:Q}=m,at=JSON.parse(JSON.stringify({id:w,size:K,attribute:Q}));K.x=(0,T.q)(S),Object.assign(Q,(0,dt.sg)(et,K)),(0,x.__)(window.document.getElementById(w),Q),z.icdt.history.push([{type:"size",from:at,to:JSON.parse(JSON.stringify({id:w,size:K,attribute:Q}))}])},c=(m,S)=>{let{id:w,type:et,size:K,attribute:Q}=m,at=JSON.parse(JSON.stringify({id:w,size:K,attribute:Q}));K.y=(0,T.q)(S),Object.assign(Q,(0,dt.sg)(et,K)),(0,x.__)(window.document.getElementById(w),Q),z.icdt.history.push([{type:"size",from:at,to:JSON.parse(JSON.stringify({id:w,size:K,attribute:Q}))}])},C=(m,S,w)=>{let{id:et,type:K,size:Q,attribute:at}=m,I=JSON.parse(JSON.stringify({id:et,size:Q,attribute:at}));w&&(Q.height=(0,T.q)(S*Q.height/Q.width)),Q.width=(0,T.q)(S),Object.assign(at,(0,dt.sg)(K,Q)),(0,x.__)(window.document.getElementById(et),at),z.icdt.history.push([{type:"size",from:I,to:JSON.parse(JSON.stringify({id:et,size:Q,attribute:at}))}])},E=(m,S,w)=>{let{id:et,type:K,size:Q,attribute:at}=m,I=JSON.parse(JSON.stringify({id:et,size:Q,attribute:at}));w&&(Q.width=(0,T.q)(S*Q.width/Q.height)),Q.height=(0,T.q)(S),Object.assign(at,(0,dt.sg)(K,Q)),(0,x.__)(window.document.getElementById(et),at),z.icdt.history.push([{type:"size",from:I,to:JSON.parse(JSON.stringify({id:et,size:Q,attribute:at}))}])},Y=(m,S)=>{let{id:w,type:et,size:K,attribute:Q}=m,at=JSON.parse(JSON.stringify({id:w,size:K,attribute:Q}));K.rotate=(0,T.q)(S),Object.assign(Q,(0,dt.sg)(et,K)),(0,x.__)(window.document.getElementById(w),Q),z.icdt.history.push([{type:"size",from:at,to:JSON.parse(JSON.stringify({id:w,size:K,attribute:Q}))}])}},6816:(he,At,f)=>{f.d(At,{A:()=>c});var z=f(968),x=f(4981);class dt{constructor(E){this._points=[],this._options=E}start(E){this._points.length=0,this._points.push([E.x,E.y]),this._options.start(E)}move(E){this._points.push([E.x,E.y]),this._options.move(E,this._points)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(E=this._points[0])[0],y:E[1]}:{x:0,y:0};var E}get offsetLast(){return this._points.length>=1?{x:(E=this._points[this._points.length-1])[0],y:E[1]}:{x:0,y:0};var E}}var T=f(7797);const c=(C,E,Y,m,S)=>{var w,et,K;let Q=null,at=0,I=0;C.mouseEvent?(Q=C.mouseEvent.target,at=C.mouseEvent.offsetX,I=C.mouseEvent.offsetY):C.touchEvent&&(Q=C.touchEvent.target,C.touchEvent.touches.length&&(at=C.touchEvent.touches[0].clientX,I=C.touchEvent.touches[0].clientY));let rt=null!=Y?Y:x.icdt.screen.scale,gt=null!=m?m:x.icdt.screen.dislocation,mt=null!=S?S:x.icdt.screen.offset,ct=()=>{};var q=new dt({start:null!==(w=null==E?void 0:E.start)&&void 0!==w?w:ct,move:null!==(et=null==E?void 0:E.move)&&void 0!==et?et:ct,end:null!==(K=null==E?void 0:E.end)&&void 0!==K?K:ct});C.mouseEvent?q.start((0,T.p)({x:at,y:I},rt,gt,{x:0,y:0})):C.touchEvent&&q.start((0,T.p)({x:at,y:I},rt,gt,mt));let D=ht=>{q.move((0,T.p)({x:ht.clientX,y:ht.clientY},rt,gt,mt))},Wt=ht=>{q.end(),[z._.SHAPE,z._.FOREIGNOBJECT,z._.IMAGE,z._.TEXT].includes(x.icdt.pointer.pointer_type)&&(ht.shiftKey||(x.icdt.pointer.pointer_type=z._.POINTER))},Lt=ht=>{ht.touches.length&&D({clientX:ht.touches[0].clientX,clientY:ht.touches[0].clientY})},Dt=ht=>{Wt({shiftKey:ht.shiftKey,ctrlKey:ht.ctrlKey,altKey:ht.altKey}),window.removeEventListener("touchmove",Lt,!1),window.removeEventListener("touchend",Dt,!1)},Vt=ht=>{0==ht.button&&D({clientX:ht.clientX,clientY:ht.clientY})},Mt=ht=>{0==ht.button&&(Wt({shiftKey:ht.shiftKey,ctrlKey:ht.ctrlKey,altKey:ht.altKey}),window.removeEventListener("mousemove",Vt,!1),window.removeEventListener("mouseup",Mt,!1))};if(C.mouseEvent)window.addEventListener("mousemove",Vt,!1),window.addEventListener("mouseup",Mt,!1);else if(C.touchEvent){var Gt;window.addEventListener("touchmove",Lt,!1),window.addEventListener("touchend",Dt,!1),null===(Gt=Q)||void 0===Gt||Gt.addEventListener("touchmove",function(ht){ht.preventDefault()})}}},7797:(he,At,f)=>{f.d(At,{p:()=>x});var z=f(5811);const x=(dt,T,Z,c)=>(dt.x-=c.x,dt.y-=c.y,dt.x/=T,dt.y/=T,dt.x-=Z.x,dt.y-=Z.y,dt.x=(0,z.q)(dt.x),dt.y=(0,z.q)(dt.y),dt)},1690:(he,At,f)=>{f.d(At,{$:()=>Pt,U:()=>re});var z=f(1687),x=f(4981),dt=f(9054),T=f(5973),Z=f(2336),c=f(861),C=f(157),E=f(4787),m=f(1105),S=f(6358);const rt=function(j){var d,O,G=jQuery("#"+j),V=null===(d=G.attr("class"))||void 0===d?void 0:d.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),B=null===(O=G.attr("class"))||void 0===O?void 0:O.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);V&&V.forEach(function(J){jQuery(G).removeClass(J)}),B&&B.forEach(function(J){jQuery(G).removeClass(J)});let A=G.attr("data-class");A&&(G.attr("class",A),G.removeAttr("data-class")),jQuery(G).data("animation-running",!1)};var gt=f(7210),mt=f(5811);const ct=(j,d,O)=>{var G,V,B,A;let J=1,k=new Image;k.onload=()=>{var X,bt,Kt,Tt;J=(0,mt.q)(k.naturalWidth/k.naturalHeight,100);let Rt=0,jt=0,Ut=0,Jt=0;var ae,ye,Ee,fe;J>=1?(Ut=Math.min(k.naturalWidth,null!==(ae=null===(ye=Pt.slide.svg)||void 0===ye||null===(ye=ye.viewBox)||void 0===ye?void 0:ye.width)&&void 0!==ae?ae:0),Jt=Ut/J):(Jt=Math.min(k.naturalHeight,null!==(Ee=null===(fe=Pt.slide.svg)||void 0===fe||null===(fe=fe.viewBox)||void 0===fe?void 0:fe.height)&&void 0!==Ee?Ee:0),Ut=Jt/J),Rt=((null!==(X=null===(bt=Pt.slide.svg)||void 0===bt||null===(bt=bt.viewBox)||void 0===bt?void 0:bt.width)&&void 0!==X?X:0)-Ut)/2,jt=((null!==(Kt=null===(Tt=Pt.slide.svg)||void 0===Tt||null===(Tt=Tt.viewBox)||void 0===Tt?void 0:Tt.height)&&void 0!==Kt?Kt:0)-Jt)/2,d.size={x:Rt,y:jt,width:Ut,height:Jt},q(d,O)},k.onerror=X=>{console.error(`ImgSrc load failed -> ${JSON.stringify(d.source)}`,X)},k.src=null!==(G=null!==(V=null===(B=d.source)||void 0===B?void 0:B.url)&&void 0!==V?V:null===(A=d.source)||void 0===A?void 0:A.path)&&void 0!==G?G:""},q=(j,d)=>{if(j.slideStatus!=Pt.slideStatus)return void d();let{element:O}=(0,gt.G)(Math.ceil(1e9*Math.random()),{size:j.size,source:{type:"image",image:null==j?void 0:j.source}});setTimeout(()=>{null==O||O.remove(),d()},3e3)},D=(j,d,O)=>{var G,V,B,A;let J=new Image;J.onload=()=>{Wt(j,{width:J.naturalWidth,height:J.naturalHeight},d,O)},J.onerror=k=>{console.error(`ImgSrc load failed -> ${JSON.stringify(d.source)}`,k),O()},J.src=null!==(G=null!==(V=null===(B=d.source)||void 0===B?void 0:B.url)&&void 0!==V?V:null===(A=d.source)||void 0===A?void 0:A.path)&&void 0!==G?G:""},Wt=(j,d,O,G)=>{if(O.slideStatus!=Pt.slideStatus)return void G();let V=(0,mt.q)(d.width/d.height,100),B=0,A=0,J=0,k=0;V>=1?(J=d.width,J=Math.max(J,40),J=Math.min(J,100),k=J/V):(k=d.height,k=Math.max(k,40),k=Math.min(k,100),J=k/V);let{size:X}=j;B=X.x+X.width/2-J/2,A=X.y+X.height/2-k/2;let{element:bt}=(0,gt.G)(Math.ceil(1e9*Math.random()),{size:{x:B,y:A,width:J,height:k},source:{type:"image",image:null==O?void 0:O.source}});setTimeout(()=>{null==bt||bt.remove(),G()},3e3)};var Lt=f(4080);const Dt=(j,d,O)=>{var G,V,B;if(d.slideStatus!=Pt.slideStatus)return void O();if(null===(G=d.source)||void 0===G||!G.url)return console.warn(`${j.id} -> audio no source!`),void O();var A=jQuery("#"+j.id);let J=null!==(V=d.iteration)&&void 0!==V?V:0;if(J<0&&(O(),O=function(){}),!(A.data("audio-running")&&J<0)){A.data("audio-running",!0);var k=new Audio;return k.autoplay=!0,k.loop=0!=J,k.preload="auto",k.controls=!0,k.setAttributeNode(document.createAttribute("playsinline")),k.addEventListener("canplay",function(){var X=k.play();X&&X.then(function(bt){A.data("audio-running",!0)}).catch(function(bt){A.data("audio-running",!1),d.slideStatus===Pt.slideStatus&&O()})}),k.addEventListener("timeupdate",function(){var bt;d.slideStatus!==Pt.slideStatus&&((bt=this).pause(),bt.remove(),A.data("audio-running",!1))}),k.addEventListener("canplaythrough",function(){this.loop&&(J>0?J--:0==J&&(this.loop=!1))}),k.addEventListener("play",function(){}),k.addEventListener("pause",function(){}),k.addEventListener("ended",function(){this.remove(),A.data("audio-running",!1),d.slideStatus===Pt.slideStatus&&O()}),k.onerror=function(){this.remove(),A.data("audio-running",!1),d.slideStatus===Pt.slideStatus&&O()},k.src=(null===(B=d.source)||void 0===B?void 0:B.url)||"",k}};var Vt=f(9942);const Yt=(j,d,O)=>{var G;null===(G=d.test)||void 0===G||null===(G=G.answer)||void 0===G||null===(G=G.matching)||void 0===G||G.filter(V=>V.value==O.key).forEach(V=>V.value="")},ne=(j,d,O,G,V,B)=>{var A,J,k,X,bt,Kt,Tt,Rt,jt,Ut,Jt,ae;V.iscorrect?(null!==(A=d.test)&&void 0!==A&&null!==(A=A.audiotrue)&&void 0!==A&&A.path&&Dt(j,{source:(0,Vt.I)(null===(X=d.test)||void 0===X?void 0:X.audiotrue),iteration:0,nodeStatus:O,slideStatus:G},B),null!==(J=d.test)&&void 0!==J&&null!==(J=J.icontrue)&&void 0!==J&&J.path&&D(j,{source:(0,Vt.I)(null===(bt=d.test)||void 0===bt?void 0:bt.icontrue),iteration:0,nodeStatus:O,slideStatus:G},B),null!==(k=d.test)&&void 0!==k&&null!==(k=k.effecttrue)&&void 0!==k&&k.path&&ct(0,{source:(0,Vt.I)(null===(Kt=d.test)||void 0===Kt?void 0:Kt.effecttrue),iteration:0,nodeStatus:O,slideStatus:G},B)):(null!==(Tt=d.test)&&void 0!==Tt&&null!==(Tt=Tt.audiofalse)&&void 0!==Tt&&Tt.path&&Dt(j,{source:(0,Vt.I)(null===(Ut=d.test)||void 0===Ut?void 0:Ut.audiofalse),iteration:0,nodeStatus:O,slideStatus:G},B),null!==(Rt=d.test)&&void 0!==Rt&&null!==(Rt=Rt.iconfalse)&&void 0!==Rt&&Rt.path&&D(j,{source:(0,Vt.I)(null===(Jt=d.test)||void 0===Jt?void 0:Jt.iconfalse),iteration:0,nodeStatus:O,slideStatus:G},B),null!==(jt=d.test)&&void 0!==jt&&null!==(jt=jt.effectfalse)&&void 0!==jt&&jt.path&&ct(0,{source:(0,Vt.I)(null===(ae=d.test)||void 0===ae?void 0:ae.effectfalse),iteration:0,nodeStatus:O,slideStatus:G},B))},U=(j,d,O,G)=>{var V,B,A,J,k,X,Kt,Rt,Tt;null!==(V=d.animate)&&void 0!==V&&V.value&&((j,d,O)=>{var G;let{value:B}=null!==(G=j.animate)&&void 0!==G?G:{};((j,d,O)=>{var G;let V=jQuery("#"+j),B="",A=null!==(G=d.iteration)&&void 0!==G?G:0,J=[];(d.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?J.push(d.value):d.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(d.value)?(J.push("animation"),J.push(`animation-${d.value}`)):(J.push("animate__animated"),J.push(`animate__${d.value}`)):(J.push("animation"),J.push("animation-fadein")),A<0?(J.push("animation-iteration-infinite"),O(),O=function(){}):A>0&&J.push("animation-iteration-"+(A+1)),B=J.join(" "),function(X){let bt=function(){V.data("animate-running")?V.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){V.data("animate-running",!1),setTimeout(function(){X()},100)}):X()};V.hasClass("animation")?setTimeout(function(){bt()}):bt()}(function(){var X;rt(j),(A>0||A<0)&&V.one("animationiteration",function(){d.slideStatus===Pt.slideStatus||(V.data("animate-running",!1),rt(j),d.slideStatus===Pt.slideStatus&&O())}),V.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(V.data("animate-running",!1),rt(j),d.finish){default:case 0:case 1:break;case 2:V.addClass("hide")}d.slideStatus===Pt.slideStatus&&O()}),V.attr("data-class",null!==(X=V.attr("class"))&&void 0!==X?X:""),V.addClass(B),V.data("animate-running",!0)})})(j.id,{value:B,nodeStatus:d,slideStatus:O},()=>{})})(d,O.nodeStatus,O.slideStatus),null!==(B=d.interactive)&&void 0!==B&&B.show?((j,d,O,G)=>{var V,B,A;console.log("icdt_Run_Interactive_NodeShow",j,d,O);let J={total:0,counter:0},{triggershow:k,triggerrun:X,triggerhide:bt,action:Kt,audio:Tt}=null!==(V=null===(B=j.interactive)||void 0===B?void 0:B.show)&&void 0!==V?V:{};if(k){let{id:jt,ids:Ut,time:Jt,async:ae}=k;"asynctrue"==ae?setTimeout(()=>{(0,E.L5)({id:jt,ids:Ut,nodeStatus:d,slideStatus:O})}):"time"==ae&&setTimeout(()=>{(0,E.L5)({id:jt,ids:Ut,nodeStatus:d,slideStatus:O})},1e3*(null!=Jt?Jt:0))}if(X){let{id:jt,ids:Ut,time:Jt,async:ae}=X;"asynctrue"==ae?setTimeout(()=>{(0,E.Ar)({id:jt,ids:Ut,nodeStatus:d,slideStatus:O})}):"time"==ae&&setTimeout(()=>{(0,E.Ar)({id:jt,ids:Ut,nodeStatus:d,slideStatus:O})},1e3*(null!=Jt?Jt:0))}if(bt){let{id:jt,ids:Ut,time:Jt,async:ae}=bt;"asynctrue"==ae?setTimeout(()=>{(0,E.WT)({id:jt,ids:Ut,nodeStatus:d,slideStatus:O})}):"time"==ae&&setTimeout(()=>{(0,E.WT)({id:jt,ids:Ut,nodeStatus:d,slideStatus:O})},1e3*(null!=Jt?Jt:0))}let Rt=()=>{setTimeout(()=>{if(J.counter>=J.total){if(G&&G(),k){let{id:jt,ids:Ut,async:Jt}=k;"asyncfalse"==Jt&&(0,E.L5)({id:jt,ids:Ut,nodeStatus:d,slideStatus:O})}if(X){let{id:jt,ids:Ut,async:Jt}=X;"asyncfalse"==Jt&&(0,E.Ar)({id:jt,ids:Ut,nodeStatus:d,slideStatus:O})}if(bt){let{id:jt,ids:Ut,async:Jt}=bt;"asyncfalse"==Jt&&(0,E.WT)({id:jt,ids:Ut,nodeStatus:d,slideStatus:O})}}})};if(null!=Kt&&Kt.value){J.total+=1;let jt=()=>{J.counter+=1,Rt()};switch(null==Kt?void 0:Kt.value){case"hide":jQuery("#"+j.id).addClass("hide"),jt();break;case"points":{let{points:Ut,time:Jt,iteration:ae,finish:ye}=Kt;(0,c.G)(j.id,{points:Ut,time:Jt,iteration:ae,finish:ye,nodeStatus:d,slideStatus:O},jt);break}default:{let{value:Ut,time:Jt,iteration:ae,finish:ye}=Kt;(0,Z.Q)(j.id,{value:Ut,time:Jt,iteration:ae,finish:ye,nodeStatus:d,slideStatus:O},jt);break}}}if(null!=Tt&&null!==(A=Tt.source)&&void 0!==A&&A.path){J.total+=1;let jt=()=>{J.counter+=1,Rt()};(0,C.R)(j.id,Tt,J,{nodeStatus:d,slideStatus:O},jt)}J.total||Rt()})(d,O.nodeStatus,O.slideStatus,G):G&&G(),null!==(A=d.interactive)&&void 0!==A&&A.click&&(Rt=null===(Kt=d.interactive)||void 0===Kt?void 0:Kt.click,Object.keys(null!=Rt?Rt:{}).map(Ut=>Rt[Ut]?1:0).includes(1)&&jQuery("#"+d.id).addClass("interactive-click"),jQuery("#"+d.id).click(Rt=>{Rt.preventDefault(),O.nodeStatus=Pt.refreshNodeStatus(),(0,T.F)(d,O.nodeStatus,O.slideStatus)})),null!==(J=d.variable)&&void 0!==J&&J.input&&jQuery("#"+d.id).on("change","input,textarea",Rt=>{Rt.preventDefault(),((j,d,O)=>{var G,V;x.icdt.variable.setValue(null!==(G=null===(V=d.variable)||void 0===V||null===(V=V.input)||void 0===V?void 0:V.variable)&&void 0!==G?G:"",j),(j=>{var d;let O=(G,V)=>{null==G||G.forEach(B=>{switch(B.type){case dt.$.GROUP:(0,S.m)(B.id,{},V?window.document.getElementById(V):null),O(B.nodes,B.id);break;case dt.$.POLYGON:break;case dt.$.TEXT:(0,m.$)(B.id,{size:B.size,attribute:B.attribute,source:B.source},V?window.document.getElementById(V):null)}})};O(null===(d=j.svg)||void 0===d?void 0:d.nodes)})(O)})(Rt.target.value,d,j)}),null!==(k=d.variable)&&void 0!==k&&k.click&&(null!==(Tt=d.variable)&&void 0!==Tt&&null!==(Tt=Tt.click)&&void 0!==Tt&&Tt.variable&&jQuery("#"+d.id).addClass("variable-click"),jQuery("#"+d.id).click(Rt=>{Rt.preventDefault(),((j,d)=>{var O;x.icdt.variable.setValueOperator(null===(O=j.variable)||void 0===O?void 0:O.click),(j=>{var d;let O=(G,V)=>{null==G||G.forEach(B=>{switch(B.type){case dt.$.GROUP:(0,S.m)(B.id,{},V?window.document.getElementById(V):null),O(B.nodes,B.id);break;case dt.$.POLYGON:break;case dt.$.TEXT:(0,m.$)(B.id,{size:B.size,attribute:B.attribute,source:B.source},V?window.document.getElementById(V):null)}})};O(null===(d=j.svg)||void 0===d?void 0:d.nodes)})(d)})(d,j)})),"test"==(null===(X=d.source)||void 0===X?void 0:X.type)&&((j,d)=>{var O;let G=()=>{};switch(null===(O=j.source)||void 0===O||null===(O=O.test)||void 0===O?void 0:O.type){case"truefalse":var V;if(jQuery("#"+j.id).click(k=>{k.preventDefault(),((j,d,O,G,V)=>{var B,A;let J=null===(B=j.source)||void 0===B||null===(B=B.test)||void 0===B||null===(B=B.truefalse)||void 0===B?void 0:B.iscorrect;if(null!==(A=d.svg)&&void 0!==A&&A.nodes.find(k=>{var X;return"submit"==(null===(X=k.source)||void 0===X||null===(X=X.test)||void 0===X?void 0:X.type)})||ne(j,d,O,G,{iscorrect:J},V),d.test?d.test.answer?d.test.answer.truefalse={value:j.id,iscorrect:J}:d.test.answer={truefalse:{value:j.id,iscorrect:J}}:d.test={answer:{truefalse:{value:j.id,iscorrect:J}}},d.test.showselection){let k=(0,Lt.g1)(z.O.TEST_GROUP,"g",void 0,x.icdt.target);(0,Lt.Yw)(k,d)}console.log("node source ->",j.source),console.log("slide test ->",d.test)})(j,d,Pt.nodeStatus,Pt.slideStatus,G)}),null!==(V=d.test)&&void 0!==V&&V.showselection){let k=(0,Lt.g1)(z.O.TEST_GROUP,"g",void 0,x.icdt.target);(0,Lt.Yw)(k,d)}break;case"singlechoice":var B;if(jQuery("#"+j.id).click(k=>{k.preventDefault(),((j,d,O,G,V)=>{var B,A;let J=null===(B=j.source)||void 0===B||null===(B=B.test)||void 0===B||null===(B=B.singlechoice)||void 0===B?void 0:B.iscorrect;if(null!==(A=d.svg)&&void 0!==A&&A.nodes.find(k=>{var X;return"submit"==(null===(X=k.source)||void 0===X||null===(X=X.test)||void 0===X?void 0:X.type)})||ne(j,d,O,G,{iscorrect:J},V),d.test?d.test.answer?d.test.answer.singlechoice={value:j.id,iscorrect:J}:d.test.answer={singlechoice:{value:j.id,iscorrect:J}}:d.test={answer:{singlechoice:{value:j.id,iscorrect:J}}},d.test.showselection){let k=(0,Lt.g1)(z.O.TEST_GROUP,"g",void 0,x.icdt.target);(0,Lt.Yw)(k,d)}console.log("node source ->",j.source),console.log("slide test ->",d.test)})(j,d,Pt.nodeStatus,Pt.slideStatus,G)}),null!==(B=d.test)&&void 0!==B&&B.showselection){let k=(0,Lt.g1)(z.O.TEST_GROUP,"g",void 0,x.icdt.target);(0,Lt.Yw)(k,d)}break;case"multichoice":var A;if(jQuery("#"+j.id).click(k=>{k.preventDefault(),((j,d,O,G,V)=>{var B,A;let k,J=null===(B=j.source)||void 0===B||null===(B=B.test)||void 0===B||null===(B=B.multichoice)||void 0===B?void 0:B.iscorrect;if(null!==(A=d.svg)&&void 0!==A&&A.nodes.find(X=>{var bt;return"submit"==(null===(bt=X.source)||void 0===bt||null===(bt=bt.test)||void 0===bt?void 0:bt.type)})||ne(j,d,O,G,{iscorrect:J},V),d.test?d.test.answer?d.test.answer.multichoice?d.test.answer.multichoice.find(X=>X.value==j.id)?(d.test.answer.multichoice=d.test.answer.multichoice.filter(X=>X.value!=j.id),k=!0):d.test.answer.multichoice.push({value:j.id,iscorrect:J}):d.test.answer.multichoice=[{value:j.id,iscorrect:J}]:d.test.answer={multichoice:[{value:j.id,iscorrect:J}]}:d.test={answer:{multichoice:[{value:j.id,iscorrect:J}]}},d.test.showselection){let X=(0,Lt.g1)(z.O.TEST_GROUP,"g",void 0,x.icdt.target);(0,Lt.Yw)(X,d)}console.log("node source ->",j.source),console.log("slide test ->",d.test)})(j,d,Pt.nodeStatus,Pt.slideStatus,G)}),null!==(A=d.test)&&void 0!==A&&A.showselection){let k=(0,Lt.g1)(z.O.TEST_GROUP,"g",void 0,x.icdt.target);(0,Lt.Yw)(k,d)}break;case"fill":var J;jQuery("#"+j.id).on("keyup",'input[type="text"]',k=>{var X;let bt=jQuery("<div/>").css({"font-size":jQuery(k.target).css("font-size"),visibility:"hidden",float:"left"}).text(k.target.value).appendTo(window.document.body);jQuery(k.target).css({width:(null!==(X=bt.width())&&void 0!==X?X:0)+30})}).on("keypress",'input[type="text"]',k=>{13===(k.keyCode||k.charCode||k.which)&&(k.preventDefault(),k.stopPropagation(),jQuery(k.target).blur())}).on("change",'input[type="text"]',k=>{var X,bt;let Kt=Pt.nodeStatus,Tt=Pt.slideStatus,Rt=null===(X=k.target)||void 0===X?void 0:X.getAttribute("data-key"),jt=null===(bt=k.target)||void 0===bt||null===(bt=bt.value)||void 0===bt?void 0:bt.trim();((j,d,O,G,V,B)=>{var A,J,k,X;let{value:bt}=null!==(A=null===(J=j.source)||void 0===J||null===(J=J.test)||void 0===J||null===(J=J.fill)||void 0===J?void 0:J.find(Tt=>Tt.key==`[[${V.key}]]`))&&void 0!==A?A:{},Kt=bt&&bt.map(Tt=>null==Tt?void 0:Tt.toLocaleLowerCase()).includes(null===(k=V.value)||void 0===k?void 0:k.toLocaleLowerCase());null!==(X=d.svg)&&void 0!==X&&X.nodes.find(Tt=>{var Rt;return"submit"==(null===(Rt=Tt.source)||void 0===Rt||null===(Rt=Rt.test)||void 0===Rt?void 0:Rt.type)})||ne(j,d,O,G,{iscorrect:Kt},B),V.iscorrect=Kt,d.test?d.test.answer?d.test.answer.fill?d.test.answer.fill.find(Tt=>Tt.key==V.key)?d.test.answer.fill.filter(Tt=>Tt.key==V.key).forEach(Tt=>{Tt.value=V.value,Tt.iscorrect=V.iscorrect}):d.test.answer.fill.push(V):d.test.answer.fill=[V]:d.test.answer={fill:[V]}:d.test={answer:{fill:[V]}},console.log("node source ->",j.source),console.log("slide test ->",d.test)})(j,d,Kt,Tt,{key:Rt,value:jt},G),jQuery("#"+j.id).find(`input[type="text"][data-key="${Rt}"]`).val(jt)}),null!==(J=d.test)&&void 0!==J&&J.showselection||jQuery("#"+j.id).addClass("hide-selection");break;case"matching-empty":jQuery("#"+j.id).on("touchmove",".ondrag-item",function(k){k.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(k){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${j.size.height/j.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${k.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(k){var X;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(X=d.test)&&void 0!==X&&X.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(k){},dragend:function(k){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${j.id} .ondrop-here`).kendoDropTarget({dragenter:function(k){k.dropTarget.hasClass("actived")&&k.dropTarget.addClass("focused")},dragleave:function(k){k.dropTarget.hasClass("actived")&&k.dropTarget.removeClass("focused")},drop:function(k){if(!k.dropTarget.hasClass("actived"))return;k.dropTarget.removeClass("focused");let X=k.dropTarget,bt=k.draggable.currentTarget;X.is(":empty")||X.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),bt.appendTo(X),((j,d,O,G,V,B)=>{var A,J,k;let{key:X}=null!==(A=null===(J=j.source)||void 0===J||null===(J=J.test)||void 0===J?void 0:J.matching)&&void 0!==A?A:{key:"KIEN"},bt=V.key==X;null!==(k=d.svg)&&void 0!==k&&k.nodes.find(Tt=>{var Rt;return"submit"==(null===(Rt=Tt.source)||void 0===Rt||null===(Rt=Rt.test)||void 0===Rt?void 0:Rt.type)})||ne(j,d,O,G,{iscorrect:bt},B),Yt(j,d,V);let Kt={key:null!=X?X:"",value:V.key};d.test?d.test.answer?d.test.answer.matching?d.test.answer.matching.find(Tt=>Tt.key==X)?d.test.answer.matching.filter(Tt=>Tt.key==X).forEach(Tt=>Tt.value=Kt.value):d.test.answer.matching.push(Kt):d.test.answer.matching=[Kt]:d.test.answer={matching:[Kt]}:d.test={answer:{matching:[Kt]}},console.log("node source ->",j.source),console.log("slide test ->",d.test)})(j,d,Pt.nodeStatus,Pt.slideStatus,{key:bt.data("key")},G)}});break;case"matching-content":jQuery("#"+j.id).on("touchmove",".ondrag-item",function(k){k.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(k){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${j.size.height/j.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${k.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(k){var X;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(X=d.test)&&void 0!==X&&X.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(k){},dragend:function(k){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${j.id} .ondrop-here`).kendoDropTarget({dragenter:function(k){k.dropTarget.hasClass("actived")&&k.dropTarget.addClass("focused")},dragleave:function(k){k.dropTarget.hasClass("actived")&&k.dropTarget.removeClass("focused")},drop:function(k){if(!k.dropTarget.hasClass("actived"))return;k.dropTarget.removeClass("focused");let bt=k.draggable.currentTarget;bt.appendTo(k.dropTarget),Yt(j,d,{key:bt.data("key")})}});break;case"speech":break;case"submit":jQuery("#"+j.id).click(k=>{k.preventDefault(),((j,d,O,G,V)=>{var B,A,J,k,X;let bt;var Kt;if(null!=d&&null!==(B=d.test)&&void 0!==B&&null!==(B=B.answer)&&void 0!==B&&B.truefalse)bt=null==d||null===(Kt=d.test)||void 0===Kt||null===(Kt=Kt.answer)||void 0===Kt||null===(Kt=Kt.truefalse)||void 0===Kt?void 0:Kt.iscorrect;else if(null!=d&&null!==(A=d.test)&&void 0!==A&&null!==(A=A.answer)&&void 0!==A&&A.singlechoice){var Tt;bt=null==d||null===(Tt=d.test)||void 0===Tt||null===(Tt=Tt.answer)||void 0===Tt||null===(Tt=Tt.singlechoice)||void 0===Tt?void 0:Tt.iscorrect}else if(null!=d&&null!==(J=d.test)&&void 0!==J&&null!==(J=J.answer)&&void 0!==J&&J.multichoice){var Rt,jt,Ut;bt=1==[null==d||null===(Rt=d.test)||void 0===Rt||null===(Rt=Rt.answer)||void 0===Rt||null===(Rt=Rt.multichoice)||void 0===Rt?void 0:Rt.length,null==d||null===(jt=d.test)||void 0===jt||null===(jt=jt.answer)||void 0===jt||null===(jt=jt.multichoice)||void 0===jt||null===(jt=jt.map(fe=>fe.iscorrect?1:0))||void 0===jt?void 0:jt.reduce((fe,ve)=>fe+ve),null==d||null===(Ut=d.svg)||void 0===Ut||null===(Ut=Ut.nodes)||void 0===Ut||null===(Ut=Ut.filter(fe=>{var ve,Oe;return"multichoice"==(null===(ve=fe.source)||void 0===ve||null===(ve=ve.test)||void 0===ve?void 0:ve.type)&&(null===(Oe=fe.source)||void 0===Oe||null===(Oe=Oe.test)||void 0===Oe||null===(Oe=Oe.multichoice)||void 0===Oe?void 0:Oe.iscorrect)}))||void 0===Ut?void 0:Ut.length].filter((fe,ve,Oe)=>Oe.indexOf(fe)==ve).length}else if(null!=d&&null!==(k=d.test)&&void 0!==k&&null!==(k=k.answer)&&void 0!==k&&k.fill){var Jt,ae;bt=(null==d||null===(Jt=d.test)||void 0===Jt||null===(Jt=Jt.answer)||void 0===Jt||null===(Jt=Jt.fill)||void 0===Jt||null===(Jt=Jt.map(fe=>fe.iscorrect?1:0))||void 0===Jt?void 0:Jt.reduce((fe,ve)=>fe+ve))==(null===(ae=d.svg)||void 0===ae||null===(ae=ae.nodes)||void 0===ae||null===(ae=ae.filter(fe=>{var ve;return"fill"==(null===(ve=fe.source)||void 0===ve||null===(ve=ve.test)||void 0===ve?void 0:ve.type)}))||void 0===ae?void 0:ae.length)}else if(null!=d&&null!==(X=d.test)&&void 0!==X&&null!==(X=X.answer)&&void 0!==X&&X.matching){var ye,Ee;bt=(null===(ye=d.svg)||void 0===ye||null===(ye=ye.nodes)||void 0===ye||null===(ye=ye.filter(fe=>{var ve;return"matching-empty"==(null===(ve=fe.source)||void 0===ve||null===(ve=ve.test)||void 0===ve?void 0:ve.type)}))||void 0===ye?void 0:ye.length)==((null==d||null===(Ee=d.test)||void 0===Ee||null===(Ee=Ee.answer)||void 0===Ee?void 0:Ee.matching)||[]).map(fe=>fe.key==fe.value?1:0).reduce((fe,ve)=>fe+ve)}ne(j,d,O,G,{iscorrect:bt},V),console.log("node source ->",j.source),console.log("slide test ->",d.test)})(j,d,Pt.nodeStatus,Pt.slideStatus,G)})}})(d,j)};var P=f(8619),h=f(8785),H=f(4921),yt=f(8054),ft=f(2282),Ot=f(2875),Qt=f(8419);const xt=(j,d,O)=>{if(O.slideStatus!=Pt.slideStatus||!d.length)return;let G=d.shift(),V=j.filter(k=>k.idx==G);if(!V.length)return;let B=Math.max.apply(null,V.map(k=>{var X;return null!==(X=k.time)&&void 0!==X?X:0})),A=!1,J=B<.5?0:setTimeout(()=>{A||(A=!0,xt(j,d,O))},1e3*B);_t(j,d,V,0,O,{idx:G,total:V.length,counter:0,isRecursive:A,timeoutRecursive:J,maxTimeCoundown:B,uid:Math.floor(1e9*Math.random())})},_t=(j,d,O,G,V,B)=>{if(V.slideStatus!=Pt.slideStatus)return;let A=O[G];if(A){switch(A.type){case dt.$.GROUP:break;case dt.$.CIRCLE:(0,P._)(A.id,{size:A.size,attribute:A.attribute},A.pid?window.document.getElementById(A.pid):null);break;case dt.$.ELLIPSE:(0,h.r)(A.id,{size:A.size,attribute:A.attribute},A.pid?window.document.getElementById(A.pid):null);break;case dt.$.LINE:(0,H.W)(A.id,{size:A.size,attribute:A.attribute},A.pid?window.document.getElementById(A.pid):null);break;case dt.$.RECT:(0,yt.f)(A.id,{size:A.size,attribute:A.attribute},A.pid?window.document.getElementById(A.pid):null);break;case dt.$.POLYGON:(0,ft.l)(A.id,{size:A.size,attribute:A.attribute},A.pid?window.document.getElementById(A.pid):null);break;case dt.$.FOREIGNOBJECT:(0,Ot.e)(A.id,{size:A.size,attribute:A.attribute,style:A.style,source:A.source},A.pid?window.document.getElementById(A.pid):null);break;case dt.$.IMAGE:(0,gt.G)(A.id,{size:A.size,attribute:A.attribute,source:A.source},A.pid?window.document.getElementById(A.pid):null);break;case dt.$.TEXT:(0,m.$)(A.id,{size:A.size,attribute:A.attribute,source:A.source},A.pid?window.document.getElementById(A.pid):null);break;case dt.$.PATH:(0,Qt.G)(A.id,{size:A.size,attribute:A.attribute},A.pid?window.document.getElementById(A.pid):null)}U(V.slide,A,V,()=>{B.counter+=1,B.maxTimeCoundown<.5&&B.counter>=B.total&&(B.total=B.counter=0,B.isRecursive||(clearTimeout(B.timeoutRecursive),B.isRecursive=!0,setTimeout(()=>{xt(j,d,V)},250)))}),_t(j,d,O,++G,V,B)}},Pt=new class qt{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(d){this._dataSource=d.data||{},x.icdt.variable.set=d.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var d,O;return null!==(d=null===(O=this._dataSource)||void 0===O||null===(O=O.slides)||void 0===O?void 0:O.length)&&void 0!==d?d:0}get slides(){var d;return(null===(d=this._dataSource)||void 0===d?void 0:d.slides)||[]}get slide(){var d;return((null===(d=this._dataSource)||void 0===d?void 0:d.slides)||[])[this._slideIdx]||{}}findNode(d){var O;let G=null===(O=this._dataSource)||void 0===O||null===(O=O.slides)||void 0===O?void 0:O.find((Tt,Rt)=>Rt==this._slideIdx),V=null==G?void 0:G.svg,B=(Tt,Rt)=>{let jt=null==Tt?void 0:Tt.find(ae=>ae.id==d);if(jt)return jt.pid=Rt,jt;let Ut=0,Jt=Tt.length||0;for(;Ut<Jt&&!jt&&(jt=B(Tt[Ut].nodes||[],Tt[Ut].id),!jt);)Ut++;return jt},A=B((null==V?void 0:V.nodes)||[]);var J,k,X,bt,Kt;return A?(A.style=null!==(J=A.style)&&void 0!==J?J:{},A.source=null!==(k=A.source)&&void 0!==k?k:{},A.animate=null!==(X=A.animate)&&void 0!==X?X:{},A.interactive=null!==(bt=A.interactive)&&void 0!==bt?bt:{},A.variable=null!==(Kt=A.variable)&&void 0!==Kt?Kt:{},A):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(d,O,G){var V;let B;var A,J;if(this.refreshNodeStatus(),this.refreshSlideStatus(),G)B=null===(A=this._dataSource)||void 0===A||null===(A=A.slides)||void 0===A?void 0:A.find(Kt=>Kt.code==G||Kt.id==G),B&&(this._slideIdx=(null===(J=this._dataSource)||void 0===J||null===(J=J.slides)||void 0===J?void 0:J.indexOf(B))||0);else if(O){var k,X;B=null===(k=this._dataSource)||void 0===k||null===(k=k.slides)||void 0===k?void 0:k.find(Kt=>Kt.id==O),B&&(this._slideIdx=(null===(X=this._dataSource)||void 0===X||null===(X=X.slides)||void 0===X?void 0:X.indexOf(B))||0)}else this._slideIdx=Math.min(Math.max(d||0,0),this.slideTotal-1),B=this.slide;if(B){var bt;re(x.icdt.container,x.icdt.svg,B,!0),null===(bt=jQuery(x.icdt.svg).find("#"+z.O.BACKGROUND_GROUP))||void 0===bt||bt.empty();let Kt=(0,Lt.g1)(z.O.BACKGROUND_GROUP,"g",void 0,x.icdt.svg);(0,Lt.x0)(Kt,B),(j=>{var d,O,G,V;let B=Pt.nodeStatus,A=Pt.slideStatus;null===(d=j.svg)||void 0===d||d.nodes.forEach(k=>{k.pid=Math.ceil(1e9*Math.random()),(0,S.m)(k.pid)});let J=null===(O=j.svg)||void 0===O||null===(O=O.nodes)||void 0===O?void 0:O.map(k=>k.idx).filter((k,X,bt)=>bt.indexOf(k)==X).sort((k,X)=>(null!=k?k:0)-(null!=X?X:0));xt(null!==(G=null===(V=j.svg)||void 0===V?void 0:V.nodes)&&void 0!==G?G:[],null!=J?J:[],{slide:j,nodeStatus:B,slideStatus:A})})(B)}this.changeSlide(this.slides,null===(V=this.slide)||void 0===V?void 0:V.id,this.slideIdx,this.slides.length,B)}set onChangeSlide(d){this._fnChangeSlides.push(d)}changeSlide(d,O,G,V,B){this._fnChangeSlides.forEach(A=>A(d,O,G,V,B))}},re=(j,d,O,G)=>{var V,B,A,J;let k=window.document.querySelector(d);var X;k||(k=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(X=window.document.querySelector(j))||void 0===X||X.appendChild(k)),G&&(k.textContent=null);let{x:bt,y:Kt,width:Tt,height:Rt}=null!==(V=null==O||null===(B=O.svg)||void 0===B?void 0:B.viewBox)&&void 0!==V?V:x.icdt.screen.frameSize;k.setAttributeNS(null,"viewBox",bt+" "+Kt+" "+Tt+" "+Rt),k.setAttribute("id",d.replace("#",""));var ye,Ee,jt=null!==(A=jQuery(j).width())&&void 0!==A?A:1080,Ut=null!==(J=jQuery(j).height())&&void 0!==J?J:1080,ae=Tt/Rt;ae>=jt/Ut?Ee=(ye=jt)/ae:ye=(Ee=Ut)*ae,k.setAttributeNS(null,"width",ye.toString()),k.setAttributeNS(null,"height",Ee.toString())}},2336:(he,At,f)=>{f.d(At,{Q:()=>x});var z=f(1690);const x=(T,Z,c)=>{var C;if(!Z.value)return void c();let E=jQuery("#"+T),Y="",m=null!==(C=Z.iteration)&&void 0!==C?C:0,S=[];(Z.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?S.push(Z.value):(S.push("animation"),S.push(Z.value?"animation-"+Z.value:"animation-fadein")),m<0?(S.push("animation-iteration-infinite"),c(),c=function(){}):m>0&&S.push("animation-iteration-"+(m+1)),Y=S.join(" "),function(et){let K=function(){E.data("animate-running")?E.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){E.data("animate-running",!1),setTimeout(function(){et()},100)}):et()};E.hasClass("animation")?setTimeout(function(){K()}):K()}(function(){var et;dt(T),(m>0||m<0)&&E.one("animationiteration",function(){Z.slideStatus===z.$.slideStatus||(E.data("animate-running",!1),dt(T),Z.slideStatus===z.$.slideStatus&&c())}),E.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(E.data("animate-running",!1),dt(T),Z.finish){default:case 0:case 1:break;case 2:E.addClass("hide")}Z.slideStatus===z.$.slideStatus&&c()}),E.attr("data-class",null!==(et=E.attr("class"))&&void 0!==et?et:""),E.addClass(Y),E.data("animate-running",!0)})},dt=function(T){var Z,c=jQuery("#"+T),C=null===(Z=c.attr("class"))||void 0===Z?void 0:Z.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);C&&C.forEach(function(Y){jQuery(c).removeClass(Y)});let E=c.attr("data-class");E&&(c.attr("class",E),c.removeAttr("data-class")),jQuery(c).data("animation-running",!1)}},861:(he,At,f)=>{f.d(At,{G:()=>T});var z=f(4318),x=f(1690),dt=f(4080);const T=(c,C,E)=>{var Y;if(!C.points||!C.points.length)return void E();let m=jQuery("#"+c),S=function Z(c){let C=[];2===c.length&&c.splice(1,0,[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2]);let w,et,K,E=1,Y=c.length;for(;E<Y;){if(w=c[E-1],et=c[E],K=c[E+1],(Math.abs(w[0]-et[0])>=15||Math.abs(w[1]-et[1])>=15)&&Math.pow(w[0]-et[0],2)+Math.pow(w[1]-et[1],2)>=Math.pow(15,2)&&K&&(Math.abs(w[0]-K[0])<=20||Math.abs(w[1]-K[1])<=20)&&Math.pow(w[0]-K[0],2)+Math.pow(w[1]-K[1],2)<=Math.pow(20,2))C.push(et);else{let at=et[0]-w[0],I=et[1]-w[1],rt=Math.max(Math.abs(at),Math.abs(I));for(var Q=0;Q<rt;Q+=15)C.push([w[0]+at*Q/rt,w[1]+I*Q/rt])}E++}return Y>0&&(C.splice(0,0,c[0]),C.push(c[Y-1])),C}(C.points||[]),w=null!==(Y=C.iteration)&&void 0!==Y?Y:0;if(w<0&&(E(),E=function(){}),m.data("work-running")&&w<0)return;m.data("work-running",!0);let gt,et=S.length,K=Math.max(20,1e3*(C.time||3)/et),{id:Q,type:at,size:I,attribute:rt}=x.$.findNode(c),mt=function(ct){if(C.slideStatus!==x.$.slideStatus)return m.data("work-running",!1),void(C.slideStatus===x.$.slideStatus&&E());if(ct<et){let q=S[ct];q&&(gt=Object.assign({},I,{x:q[0]-I.width/2,y:q[1]-I.height/2}),Object.assign(rt,(0,z.sg)(at,gt)),(0,dt.__)(window.document.getElementById(Q),rt),setTimeout(function(){mt(++ct)},K))}else if(w>0)w--,mt(1);else if(w<0)mt(1);else switch(m.data("work-running",!1),C.slideStatus===x.$.slideStatus&&E(),C.finish){default:case 0:break;case 1:Object.assign(rt,(0,z.sg)(at,I)),(0,dt.__)(window.document.getElementById(Q),rt);break;case 2:m.addClass("hide")}};mt(1)}},157:(he,At,f)=>{f.d(At,{R:()=>x});var z=f(1690);const x=(T,Z,c,C,E)=>{var Y,m,S;if(C.slideStatus!=z.$.slideStatus)return Z.async&&"change-slide"!=Z.async?void 0:void E();if(C.nodeStatus!=z.$.nodeStatus&&(!Z.async||"change-node"==Z.async))return void E();if(null===(Y=Z.source)||void 0===Y||!Y.url)return console.warn(`${T} -> audio no source!`),E(),void(E=()=>{});var w=jQuery("#"+T);let et=null!==(m=Z.iteration)&&void 0!==m?m:0;if(et<0&&(E(),E=function(){}),!(w.data("audio-running")&&et<0)){w.data("audio-running",!0);var K=function(at){at.pause(),at.remove(),w.data("audio-running",!1)},Q=new Audio;return Q.autoplay=!0,Q.loop=0!=et,Q.preload="auto",Q.controls=!0,Q.setAttributeNode(document.createAttribute("playsinline")),Q.addEventListener("canplay",function(){var at=Q.play();at&&at.then(function(I){var rt;w.data("audio-running",!0),"time"==Z.async?setTimeout(()=>{K(Q),E(),E=()=>{}},1e3*(null!==(rt=Z.time)&&void 0!==rt?rt:1)):"non-stop"==Z.async&&(E(),E=()=>{})}).catch(function(I){w.data("audio-running",!1),C.slideStatus===z.$.slideStatus&&(E(),E=()=>{})})}),Q.addEventListener("timeupdate",function(){switch(Z.async){case"time":case"non-stop":break;case"finish-action":c.total>=2&&c.total-c.counter==1&&(K(this),E(),E=()=>{});break;default:case"change-node":C.nodeStatus!==z.$.nodeStatus&&(K(this),E(),E=()=>{});break;case"change-slide":C.slideStatus!==z.$.slideStatus&&(K(this),E(),E=()=>{})}}),Q.addEventListener("canplaythrough",function(){this.loop&&(et>0?et--:0==et&&(this.loop=!1))}),Q.addEventListener("play",function(){}),Q.addEventListener("pause",function(){}),Q.addEventListener("ended",function(){this.remove(),w.data("audio-running",!1),C.slideStatus===z.$.slideStatus&&(E(),E=()=>{})}),Q.onerror=function(){this.remove(),w.data("audio-running",!1),C.slideStatus===z.$.slideStatus&&(E(),E=()=>{})},Q.src=(null===(S=Z.source)||void 0===S?void 0:S.url)||"",Q}}},5973:(he,At,f)=>{f.d(At,{F:()=>E});var z=f(4981),x=f(1690),dt=f(2336),T=f(861),Z=f(157),c=f(4787),C=f(370);const E=(Y,m,S,w)=>{var et,K,Q;let at={total:0,counter:0},{triggershow:I,triggerrun:rt,triggerhide:gt,action:mt,audio:ct,slide:q,media:D}=null!==(et=null===(K=Y.interactive)||void 0===K?void 0:K.click)&&void 0!==et?et:{};if(I){let{id:Vt,ids:Mt,time:Gt,async:ht}=I;"asynctrue"==ht?(0,c.L5)({id:Vt,ids:Mt,nodeStatus:m,slideStatus:S}):"time"==ht&&setTimeout(()=>{(0,c.L5)({id:Vt,ids:Mt,nodeStatus:m,slideStatus:S})},1e3*(null!=Gt?Gt:0))}if(rt){let{id:Vt,ids:Mt,time:Gt,async:ht}=rt;"asynctrue"==ht?(0,c.Ar)({id:Vt,ids:Mt,nodeStatus:m,slideStatus:S}):"time"==ht&&setTimeout(()=>{(0,c.Ar)({id:Vt,ids:Mt,nodeStatus:m,slideStatus:S})},1e3*(null!=Gt?Gt:0))}if(gt){let{id:Vt,ids:Mt,time:Gt,async:ht}=gt;"asynctrue"==ht?(0,c.WT)({id:Vt,ids:Mt,nodeStatus:m,slideStatus:S}):"time"==ht&&setTimeout(()=>{(0,c.WT)({id:Vt,ids:Mt,nodeStatus:m,slideStatus:S})},1e3*(null!=Gt?Gt:0))}let Wt=()=>{setTimeout(()=>{if(at.counter>=at.total){if(w&&w(),I){let{id:Vt,ids:Mt,async:Gt}=I;"asyncfalse"==Gt&&(0,c.L5)({id:Vt,ids:Mt,nodeStatus:m,slideStatus:S})}if(rt){let{id:Vt,ids:Mt,async:Gt}=rt;"asyncfalse"==Gt&&(0,c.Ar)({id:Vt,ids:Mt,nodeStatus:m,slideStatus:S})}if(gt){let{id:Vt,ids:Mt,async:Gt}=gt;"asyncfalse"==Gt&&(0,c.WT)({id:Vt,ids:Mt,nodeStatus:m,slideStatus:S})}}})};if(null!=mt&&mt.value){at.total+=1;let Vt=()=>{at.counter+=1,Wt()};switch(mt.value){case"hide":jQuery("#"+Y.id).addClass("hide"),Vt();break;case"points":{let{points:Mt,time:Gt,iteration:ht,finish:it}=mt;Mt&&(0,T.G)(Y.id,{points:Mt,time:Gt,iteration:ht,finish:it,nodeStatus:m,slideStatus:S},Vt);break}default:{let{value:Mt,time:Gt,iteration:ht,finish:it}=mt;(0,dt.Q)(Y.id,{value:Mt,time:Gt,iteration:ht,finish:it,nodeStatus:m,slideStatus:S},Vt);break}}}if(null!=ct&&null!==(Q=ct.source)&&void 0!==Q&&Q.path){at.total+=1;let Vt=()=>{at.counter+=1,Wt()};(0,Z.R)(Y.id,ct,at,{nodeStatus:m,slideStatus:S},Vt)}if(at.total||Wt(),null!=q&&q.id)switch(console.log(`InteractiveNode #${Y.id} slide(undefined,${q.id},${q.code}) success!`),q.id){case-1:x.$.runSlide(x.$.slideIdx-1);break;case-2:x.$.runSlide(x.$.slideIdx+1);break;default:var Lt;x.$.runSlide(void 0,q.id,null===(Lt=q.code)||void 0===Lt?void 0:Lt.toString())}if(null!=D&&D.type){var Dt;let Mt=`<div class="popup-media-viewer"><iframe src="${(0,C.e)({readfileuploadurl:null===(Dt=z.icdt.config)||void 0===Dt?void 0:Dt.readfileuploadurl,type:null==D?void 0:D.type,oss:null==D?void 0:D.oss,path:null==D?void 0:D.path,pathExtract:null==D?void 0:D.pathExtract,url:null==D?void 0:D.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,Gt=jQuery(Mt).appendTo(window.document.body);Gt.find(".btn-close").click(function(ht){ht.preventDefault(),Gt.remove()})}}},4787:(he,At,f)=>{f.d(At,{Ar:()=>T,L5:()=>dt,WT:()=>Z});var z=f(1690),x=f(5973);const dt=c=>{console.log("icdt_Run_Interactive_TriggerShow",c),c.id?jQuery("#"+c.id).removeClass("hide"):c.ids&&c.ids.forEach(C=>{jQuery("#"+C).removeClass("hide")})},T=c=>{console.log("icdt_Run_Interactive_TriggerRun",c),c.id?(jQuery("#"+c.id).removeClass("hide"),(0,x.F)(z.$.findNode(c.id),c.nodeStatus,c.slideStatus)):c.ids&&c.ids.forEach(C=>{jQuery("#"+C).removeClass("hide"),(0,x.F)(z.$.findNode(C),c.nodeStatus,c.slideStatus)})},Z=c=>{console.log("icdt_Run_Interactive_TriggerHide",c),c.id?jQuery("#"+c.id).addClass("hide"):c.ids&&c.ids.forEach(C=>{jQuery("#"+C).addClass("hide")})}},4080:(he,At,f)=>{f.d(At,{Mh:()=>gt,wM:()=>q,xo:()=>mt,it:()=>D,g1:()=>Mt,__:()=>Wt,QI:()=>Dt,DB:()=>Lt,eb:()=>ct,x0:()=>pt,g$:()=>Gt,mo:()=>Yt,XH:()=>St,hJ:()=>ht,vl:()=>Et,yD:()=>it,Yw:()=>ne});var z=f(9054),x=f(1687),Z=/^#?[a-fA-F0-9]+$/;const E=(U,P)=>{var h;if("none"==(U=null!==(h=U)&&void 0!==h?h:""))return"none";if("transparent"==U)return"rgba(0,0,0,0)";if(U.includes("rgba("))return U;if(U.includes("rgb(")&&(U=((U,P)=>{if(!U)return"";let h=U.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),H=(h&&h[4]||"").trim(),yt=h?(256|h[1]).toString(16).slice(1)+(256|h[2]).toString(16).slice(1)+(256|h[3]).toString(16).slice(1):U;return"0"==H?"transparent":`#${yt}`})(U)),!(U=U.replace(/[^0-9a-fA-F]/g,"")))return"";if(!Z.test(U))return console.error(`hex2rgba -> ${U}: first argument has invalid hexadecimal characters`),"";if("#"===U[0]&&(U=U.slice(1)),3===U.length){let yt=U.split("");yt.splice(2,0,U[2]),yt.splice(1,0,U[1]),yt.splice(0,0,U[0]),U=yt.join("")}if(6!==U.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var H=[parseInt(U.slice(0,2),16),parseInt(U.slice(2,4),16),parseInt(U.slice(4,6),16)];return P="number"==typeof P?P:parseFloat(P),H.push(P>=0&&P<=1?P:1),"rgba("+H.join(",")+")"};var Y=f(370),m=f(1814),S=f(4981),w=f(3423),et=f(8054),K=f(7210),Q=f(8619),at=f(1690),I=f(2875),rt=f(1105);class gt{constructor(P,h){let H=window.document.querySelector(h);var yt;H||(H=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(yt=window.document.querySelector(P))||void 0===yt||yt.appendChild(H));let{svgViewBox:ft,svgSize:Ot}=S.icdt.screen.init();H.setAttributeNS(null,"viewBox",`${ft.x} ${ft.y} ${ft.width} ${ft.height}`),H.setAttribute("id",h.replace("#","")),H.style.display="block",H.style.position="absolute",H.style.left=`${Ot.x}px`,H.style.top=`${Ot.y}px`,H.style.width=`${Ot.width}px`,H.style.height=`${Ot.height}px`,H.style.backgroundColor="#fafafa",H.style.cursor="default"}}const mt=U=>{jQuery(S.icdt.target).find("#"+x.O.BACKGROUND_GROUP).empty();let P=Mt(x.O.BACKGROUND_GROUP,"g",void 0,S.icdt.target);pt(P,U),(()=>{let h=window.document.getElementById(null==U?void 0:U.id);jQuery(h).find("#"+x.O.BACKGROUND_GROUP).empty();let H=Mt(x.O.BACKGROUND_GROUP,"g",void 0,h);pt(H,U)})()},ct=()=>{let U=S.icdt.screen.svgViewBox,P=S.icdt.screen.svgSize;S.icdt.target&&(S.icdt.target.setAttributeNS(null,"viewBox",`${U.x} ${U.y} ${U.width} ${U.height}`),S.icdt.target.style.left=`${P.x}px`,S.icdt.target.style.top=`${P.y}px`,S.icdt.target.style.width=`${P.width}px`,S.icdt.target.style.height=`${P.height}px`)},q=()=>{jQuery(S.icdt.target).find(">*:not(defs)").remove()},D=(U,P,h,H,yt)=>{let ft;return U?(ft=jQuery(yt||S.icdt.target).find("#"+U).get(0),ft||(ft=window.document.createElementNS("http://www.w3.org/2000/svg",h),ft.setAttribute("id",U),jQuery(ft).appendTo(yt||S.icdt.target))):(ft=window.document.createElementNS("http://www.w3.org/2000/svg",h),jQuery(ft).appendTo(yt||S.icdt.target)),null!=H&&H.attribute&&Wt(ft,null==H?void 0:H.attribute),null!=H&&H.style&&Lt(ft,null==H?void 0:H.style),null!=H&&H.source&&Dt(ft,P,null==H?void 0:H.source),ft},Wt=(U,P)=>{return jQuery(U).attr((h=Object.assign({},P||{}),null===(H=Object.keys(h))||void 0===H||H.forEach(Ot=>{switch(Ot){case"fill":break;case"stroke":var Qt;Object.assign(h,{"stroke-width":null!==(Qt=h.strokeWidth)&&void 0!==Qt?Qt:null,strokeWidth:null});break;case"strokeLinecap":var zt;Object.assign(h,{"stroke-linecap":null!==(zt=h.strokeLinecap)&&void 0!==zt?zt:null,strokeLinecap:null});break;case"strokeLinejoin":var xt;Object.assign(h,{"stroke-linejoin":null!==(xt=h.strokeLinejoin)&&void 0!==xt?xt:null,strokeLinejoin:null});break;case"strokeDasharray":var _t;Object.assign(h,{"stroke-dasharray":null!==(_t=h.strokeDasharray)&&void 0!==_t?_t:null,strokeDasharray:null});break;case"strokeDasharrays":var qt,Pt;Object.assign(h,{"stroke-dasharray":null!==(qt=null===(Pt=h.strokeDasharrays)||void 0===Pt?void 0:Pt.join(" "))&&void 0!==qt?qt:null,strokeDasharrays:null});break;case"fontFamily":var re;Object.assign(h,{"font-family":null!==(re=h.fontFamily)&&void 0!==re?re:null,fontFamily:null});break;case"fontSize":var j;Object.assign(h,{"font-size":null!==(j=h.fontSize)&&void 0!==j?j:null,fontSize:null});break;case"textLength":Object.assign(h,{textLength:h.textLength?`${h.textLength}px`:null});break;case"transformOrigin":var d;Object.assign(h,{"transform-origin":null!==(d=h.transformOrigin)&&void 0!==d?d:null,transformOrigin:null})}}),Object.assign({},null!=h?h:{},{fill:null!=h&&h.fill?E(h.fill,null!==(yt=null==h?void 0:h.fillOpacity)&&void 0!==yt?yt:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=h&&h.stroke?E(h.stroke,null!==(ft=null==h?void 0:h.strokeOpacity)&&void 0!==ft?ft:1):"rgba(0,0,0,0)",strokeOpacity:null}))),U;var h,H,yt,ft},Lt=(U,P)=>{return jQuery(U).css((h=Object.assign({},P||{}),null===(H=Object.keys(h))||void 0===H||H.forEach(yt=>{switch(yt){case"padding":Object.assign(h,{padding:h.padding?`${h.padding}px`:null});break;case"borderWidth":var ft;Object.assign(h,h.borderWidth&&h.borderStyle&&h.borderColor?{"border-width":`${h.borderWidth}px`,"border-style":h.borderStyle,"border-color":E(h.borderColor,null!==(ft=h.borderOpacity)&&void 0!==ft?ft:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(h,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(h,{"border-radius":h.borderRadius?`${h.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var Ot;h.backgroundColor&&Object.assign(h,{"background-color":E(h.backgroundColor,null!==(Ot=h.backgroundOpacity)&&void 0!==Ot?Ot:1)}),Object.assign(h,{backgroundColor:null,backgroundOpacity:null})}}),h)),U;var h,H},Dt=(U,P,h)=>{switch(P){case z.$.TEXT:var H,yt;jQuery(U).text(null!==(H=null==h||null===(yt=h.text)||void 0===yt?void 0:yt.textContent)&&void 0!==H?H:"");break;case z.$.IMAGE:var ft,Ot,Qt,zt,xt;jQuery(U).attr("href",(null==h||null===(ft=h.image)||void 0===ft?void 0:ft.base64)||(null!=h&&null!==(Ot=h.image)&&void 0!==Ot&&Ot.path?(null===(Qt=S.icdt.config)||void 0===Qt?void 0:Qt.readfileuploadurl)+(null==h||null===(zt=h.image)||void 0===zt?void 0:zt.path):null==h||null===(xt=h.image)||void 0===xt?void 0:xt.url)||"");break;case z.$.FOREIGNOBJECT:switch(null==h?void 0:h.type){case"text":var _t,qt;if(null!==(_t=h.text)&&void 0!==_t&&_t.variableKeywords&&null!==(qt=h.text)&&void 0!==qt&&qt.variableKeywords.length){var Pt;let n=S.icdt.variable.getKeys(),r=(null===(Pt=h.text)||void 0===Pt?void 0:Pt.textContent)||"";h.text.variableKeywords.forEach(a=>{var o=a.replace(/[^a-zA-Z0-9_]/gm,"");if(n.indexOf(o)>=0){var v=S.icdt.variable.getValue(o);r=r.replace(a,v)}}),jQuery(U).text(r)}else{var re;jQuery(U).text((null===(re=h.text)||void 0===re?void 0:re.textContent)||"")}break;case"html":{var j,d,O;let n=(null==h||null===(j=h.html)||void 0===j?void 0:j.htmlContent)||"";if(null!==(d=h.html)&&void 0!==d&&d.variableKeywords&&null!==(O=h.html)&&void 0!==O&&O.variableKeywords.length){let r=S.icdt.variable.getKeys();h.html.variableKeywords.forEach(a=>{var o=a.replace(/[^a-zA-Z0-9_]/gm,"");if(r.indexOf(o)>=0){var v=S.icdt.variable.getValue(o);n=n.replace(a,v)}})}jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${n}</div>`).find("img[path],video[path],iframe[path]").each((r,a)=>{var o,v;a.setAttribute("src",(null!==(o=null===(v=S.icdt.config)||void 0===v?void 0:v.readfileuploadurl)&&void 0!==o?o:"")+a.getAttribute("path")),a.removeAttribute("path")});break}case"input":var G,V,B,A;if(null!==(G=h.input)&&void 0!==G&&G.input)jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(B=null===(A=h.input)||void 0===A?void 0:A.placeholder)&&void 0!==B?B:""}" maxlength="100" /></div>`);else if(null!==(V=h.input)&&void 0!==V&&V.textarea){var J,k;jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(J=null===(k=h.input)||void 0===k?void 0:k.placeholder)&&void 0!==J?J:""}" maxlength="1000"></textarea></div>`)}break;case"image":var X,bt,Kt,Tt,Rt;jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(X=h.image)||void 0===X?void 0:X.base64)||(null!==(bt=h.image)&&void 0!==bt&&bt.path?(null===(Kt=S.icdt.config)||void 0===Kt?void 0:Kt.readfileuploadurl)+(null===(Tt=h.image)||void 0===Tt?void 0:Tt.path):null===(Rt=h.image)||void 0===Rt?void 0:Rt.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var jt,Ut,Jt,ae;jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${(null!==(jt=h.iframe)&&void 0!==jt&&jt.path?(null===(Ut=S.icdt.config)||void 0===Ut?void 0:Ut.readfileuploadurl)+(null===(Jt=h.iframe)||void 0===Jt?void 0:Jt.path):null===(ae=h.iframe)||void 0===ae?void 0:ae.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var ye,Ee,fe,ve,Oe,ri;let n=(0,Y.e)({readfileuploadurl:null===(ye=S.icdt.config)||void 0===ye?void 0:ye.readfileuploadurl,type:null===(Ee=h.embed)||void 0===Ee?void 0:Ee.type,oss:null===(fe=h.embed)||void 0===fe?void 0:fe.oss,path:null===(ve=h.embed)||void 0===ve?void 0:ve.path,pathExtract:null===(Oe=h.embed)||void 0===Oe?void 0:Oe.pathExtract,url:null===(ri=h.embed)||void 0===ri?void 0:ri.url});jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${n}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var li,vi;jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(li=null===(vi=h.svg)||void 0===vi?void 0:vi.svgContent)&&void 0!==li?li:""}</div>`);break;case"test":{var Ae,ai,Ge,Xe;let n=(null==h||null===(Ae=h.html)||void 0===Ae?void 0:Ae.htmlContent)||"";if(null!==(ai=h.html)&&void 0!==ai&&ai.variableKeywords&&null!==(Ge=h.html)&&void 0!==Ge&&Ge.variableKeywords.length){let r=S.icdt.variable.getKeys();h.html.variableKeywords.forEach(a=>{var o=a.replace(/[^a-zA-Z0-9_]/gm,"");if(r.indexOf(o)>=0){var v=S.icdt.variable.getValue(o);n=n.replace(a,v)}})}switch(null==h||null===(Xe=h.test)||void 0===Xe?void 0:Xe.type){case"truefalse":case"singlechoice":case"multichoice":jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${n}</div></div></div>`);break;case"matching-empty":jQuery(U).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty"></div>');break;case"matching-content":var oi,He;jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content"><div class="ondrag-item" data-key="${null!==(oi=null==h||null===(He=h.test)||void 0===He||null===(He=He.matching)||void 0===He?void 0:He.key)&&void 0!==oi?oi:"KIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${n}</div></div></div></div>`);break;case"fill":var ei;((null===(ei=h.html)||void 0===ei?void 0:ei.fillKeywords)||[]).forEach(r=>{var a=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${r.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;n=n.replace(new RegExp(r.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),a)}),jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${n}</div></div></div>`);break;case"speech":jQuery(U).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var Ye,si,wt,M,i;jQuery(U).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(Ye=null!==(si=h.image)&&void 0!==si&&si.path?(null===(wt=S.icdt.config)||void 0===wt?void 0:wt.readfileuploadurl)+(null===(M=h.image)||void 0===M?void 0:M.path):null===(i=h.image)||void 0===i?void 0:i.url)&&void 0!==Ye?Ye:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(U).find("img[path],video[path],iframe[path]").each((r,a)=>{var o,v;a.setAttribute("src",(null!==(o=null===(v=S.icdt.config)||void 0===v?void 0:v.readfileuploadurl)&&void 0!==o?o:"")+a.getAttribute("path")),a.removeAttribute("path")})}}}},Mt=(U,P,h,H)=>{let yt=jQuery(H||S.icdt.target).find("#"+U).get(0);return yt||(yt=window.document.createElementNS("http://www.w3.org/2000/svg",P),yt.setAttribute("id",U),jQuery(yt).appendTo(H||S.icdt.target)),jQuery(yt).attr((null==h?void 0:h.attribute)||{}),jQuery(yt).css((null==h?void 0:h.style)||{}),yt},Gt=(U,P)=>{let h=(0,w.v)(2),H={fill:m.S3.fill,stroke:m.S3.stroke,"stroke-width":(0,w.v)(m.S3.strokeWidth)};return[{element:Mt("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:P.x-h,y:P.y-h,width:P.width+2*h,height:P.height+2*h},H)},U),posType:"rect-center"}]},ht=(U,P)=>{let{size:h}=P,H=(0,w.v)(1),yt=(0,w.v)(2),ft=(0,w.v)(5),Ot={stroke:m.NV.stroke,"stroke-width":(0,w.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},Qt={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,w.v)(m.Mo.strokeWidth)},zt={fill:m.In.fill,stroke:m.In.stroke,"stroke-width":(0,w.v)(m.In.strokeWidth),width:(0,w.v)(m.In.width),height:(0,w.v)(m.In.height)};return Mt("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:h.x-H,y1:h.y,x2:h.x-H,y2:h.y+h.height},Ot)},U),Mt("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:h.x,y1:h.y-H,x2:h.x+h.width,y2:h.y-H},Ot)},U),Mt("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:h.x+h.width+H,y1:h.y,x2:h.x+h.width+H,y2:h.y+h.height},Ot)},U),Mt("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:h.x,y1:h.y+h.height+H,x2:h.x+h.width,y2:h.y+h.height+H},Ot)},U),[{element:Mt("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:h.x,y:h.y,width:h.width,height:h.height},Qt),style:{cursor:"move"}},U),posType:"rect-center"},{element:Mt("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:h.x-ft,y:h.y-ft},zt),style:{cursor:"nw-resize"}},U),posType:"rect-top-left"},{element:Mt("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:h.x+h.width-yt,y:h.y-ft},zt),style:{cursor:"ne-resize"}},U),posType:"rect-top-right"},{element:Mt("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:h.x-ft,y:h.y+h.height-yt},zt),style:{cursor:"sw-resize"}},U),posType:"rect-bottom-left"},{element:Mt("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:h.x+h.width-yt,y:h.y+h.height-yt},zt),style:{cursor:"se-resize"}},U),posType:"rect-bottom-right"}]},it=(U,P,h)=>{let H=(0,w.v)(1),yt={stroke:m.NV.stroke,"stroke-width":(0,w.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},ft={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,w.v)(m.Mo.strokeWidth)},Ot={fill:m.dt.fill,stroke:m.dt.stroke,"stroke-width":(0,w.v)(m.dt.strokeWidth)},qt=(Mt("icdt-temp-select-line-left","line",{attribute:Object.assign({x1:h.x-H,y1:h.y,x2:h.x-H,y2:h.y+h.height},yt)},U),Mt("icdt-temp-select-line-top","line",{attribute:Object.assign({x1:h.x,y1:h.y-H,x2:h.x+h.width,y2:h.y-H},yt)},U),Mt("icdt-temp-select-line-right","line",{attribute:Object.assign({x1:h.x+h.width+H,y1:h.y,x2:h.x+h.width+H,y2:h.y+h.height},yt)},U),Mt("icdt-temp-select-line-bottom","line",{attribute:Object.assign({x1:h.x,y1:h.y+h.height+H,x2:h.x+h.width,y2:h.y+h.height+H},yt)},U),Mt("icdt-temp-select-rect-center","rect",{attribute:Object.assign({x:h.x,y:h.y,width:h.width,height:h.height},ft)},U));return P.forEach(Pt=>{let{size:re}=Pt;Mt("icdt-temp-select-rect-node-"+Pt.id,"rect",{attribute:Object.assign({x:re.x,y:re.y,width:re.width,height:re.height},Ot)},U)}),[{element:qt,posType:"rect-center"}]},Et=(U,P)=>{let h=(0,w.v)(1),H={stroke:m.NV.stroke,"stroke-width":(0,w.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},yt={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,w.v)(m.Mo.strokeWidth)};return Mt("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:P.x-h,y1:P.y,x2:P.x-h,y2:P.y+P.height},H)},U),Mt("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:P.x,y1:P.y-h,x2:P.x+P.width,y2:P.y-h},H)},U),Mt("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:P.x+P.width+h,y1:P.y,x2:P.x+P.width+h,y2:P.y+P.height},H)},U),Mt("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:P.x,y1:P.y+P.height+h,x2:P.x+P.width,y2:P.y+P.height+h},H)},U),[{element:Mt("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:P.x,y:P.y,width:P.width,height:P.height},yt)},U),posType:"rect-center"}]},St=(U,P)=>{let h=(0,w.v)(-1),H={stroke:m.h8.stroke,"stroke-width":(0,w.v)(m.h8.strokeWidth),"stroke-linecap":m.h8.strokeLinecap,"stroke-dasharray":(0,w.v)(m.h8.strokeDasharray)},yt={fill:m.MA.fill};return Mt("icdt-temp-interactive-line-left","line",{attribute:Object.assign({x1:P.x-h,y1:P.y,x2:P.x-h,y2:P.y+P.height},H)},U),Mt("icdt-temp-interactive-line-top","line",{attribute:Object.assign({x1:P.x,y1:P.y-h,x2:P.x+P.width,y2:P.y-h},H)},U),Mt("icdt-temp-interactive-line-right","line",{attribute:Object.assign({x1:P.x+P.width+h,y1:P.y,x2:P.x+P.width+h,y2:P.y+P.height},H)},U),Mt("icdt-temp-interactive-line-bottom","line",{attribute:Object.assign({x1:P.x,y1:P.y+P.height+h,x2:P.x+P.width,y2:P.y+P.height+h},H)},U),Mt("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:P.x,y:P.y,width:P.width,height:P.height},yt)},U),[]},Yt=(U,P)=>{let h={fill:m.k0.fill,stroke:m.k0.stroke,"stroke-width":(0,w.v)(m.k0.strokeWidth),"stroke-dasharray":(0,w.v)(m.k0.strokeDasharray)};jQuery(U).empty(),P.forEach(H=>{var yt,ft;let{size:Ot}=H;if(!H.idx)return;Mt("icdt-temp-index-rect-node-"+H.id,"rect",{attribute:Object.assign({x:Ot.x-5,y:Ot.y-5,width:Ot.width+10,height:Ot.height+10},h)},U);let{element:Qt}=(0,I.e)(Math.ceil(1e9*Math.random()),{size:{x:Ot.x-76,y:Ot.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(yt=H.idx)&&void 0!==yt?yt:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(ft=H.time)&&void 0!==ft?ft:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},U);Qt.classList.add("node-input"),jQuery(Qt).on("change",'input[name="idx"]',zt=>{var xt;H.idx=parseInt(null!==(xt=zt.target.value)&&void 0!==xt?xt:"0")}).on("change",'input[name="time"]',zt=>{var xt;H.time=parseFloat(null!==(xt=zt.target.value)&&void 0!==xt?xt:"0")}).on("click",'button[name="remove"]',zt=>{H.idx=0,H.time=null,Yt(U,P)})})},pt=(U,P)=>{var h,H,yt,ft,Ot,Qt;let{color:zt,opacity:xt,path:_t,url:qt,base64:Pt}=null!==(h=null==P||null===(H=P.svg)||void 0===H?void 0:H.background)&&void 0!==h?h:{},{x:re,y:j,width:d,height:O}=null!==(yt=null==P||null===(ft=P.svg)||void 0===ft?void 0:ft.viewBox)&&void 0!==yt?yt:{x:0,y:0,width:0,height:0};(0,rt.$)(void 0,{size:{x:0,y:-7,width:d,height:O},attribute:{fill:"#999",fontSize:14,class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(Ot=null!==(Qt=null==P?void 0:P.name)&&void 0!==Qt?Qt:null==P?void 0:P.code)&&void 0!==Ot?Ot:void 0}}},U),(0,et.f)(void 0,{size:{x:re,y:j,width:d,height:O},attribute:{fill:"#fff",stroke:"#999",strokeWidth:1,strokeDasharray:10,class:"hide-on-viewer"}},U),zt&&(0,et.f)(void 0,{size:{x:re,y:j,width:d,height:O},attribute:{fill:zt,fillOpacity:xt}},U),_t&&(0,K.G)(void 0,{size:{x:re,y:j,width:d,height:O},source:{type:"image",image:{path:_t,url:qt,base64:Pt}}},U)},ne=(U,P)=>{var h;switch(jQuery(U).empty(),null===(h=P.test)||void 0===h?void 0:h.type){case"truefalse":{var H,yt,ft;let j=null==P||null===(H=P.test)||void 0===H||null===(H=H.answer)||void 0===H||null===(H=H.truefalse)||void 0===H?void 0:H.value;null===(yt=P.svg)||void 0===yt||yt.nodes.filter(d=>{var O;return"truefalse"==(null===(O=d.source)||void 0===O||null===(O=O.test)||void 0===O?void 0:O.type)&&d.id!=j}).forEach(d=>{var O;let{x:V,y:B,width:A,height:J}=null!==(O=null==d?void 0:d.size)&&void 0!==O?O:{x:0,y:0,width:0,height:0};(0,Q._)(Math.ceil(1e9*Math.random()),{size:{x:V-.5,y:B-.5,width:A+1,height:J+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},U)}),null!=P&&null!==(ft=P.test)&&void 0!==ft&&null!==(ft=ft.answer)&&void 0!==ft&&ft.truefalse&&j&&(d=>{let O=at.$.findNode(j),{x:V,y:B,width:A,height:J}=null!==(d=null==O?void 0:O.size)&&void 0!==d?d:{x:0,y:0,width:0,height:0};(0,Q._)(Math.ceil(1e9*Math.random()),{size:{x:V-2,y:B-2,width:A+4,height:J+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},U)})();break}case"singlechoice":{var Ot,Qt,zt;let j=null==P||null===(Ot=P.test)||void 0===Ot||null===(Ot=Ot.answer)||void 0===Ot||null===(Ot=Ot.singlechoice)||void 0===Ot?void 0:Ot.value;null===(Qt=P.svg)||void 0===Qt||Qt.nodes.filter(d=>{var O;return"singlechoice"==(null===(O=d.source)||void 0===O||null===(O=O.test)||void 0===O?void 0:O.type)&&d.id!=j}).forEach(d=>{var O;let{x:V,y:B,width:A,height:J}=null!==(O=null==d?void 0:d.size)&&void 0!==O?O:{x:0,y:0,width:0,height:0};(0,Q._)(Math.ceil(1e9*Math.random()),{size:{x:V-.5,y:B-.5,width:A+1,height:J+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},U)}),null!=P&&null!==(zt=P.test)&&void 0!==zt&&null!==(zt=zt.answer)&&void 0!==zt&&zt.singlechoice&&j&&(d=>{let O=at.$.findNode(j),{x:V,y:B,width:A,height:J}=null!==(d=null==O?void 0:O.size)&&void 0!==d?d:{x:0,y:0,width:0,height:0};(0,Q._)(Math.ceil(1e9*Math.random()),{size:{x:V-2,y:B-2,width:A+4,height:J+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},U)})();break}case"multichoice":{var xt,_t,qt,Pt;let j=null!==(xt=null==P||null===(_t=P.test)||void 0===_t||null===(_t=_t.answer)||void 0===_t||null===(_t=_t.multichoice)||void 0===_t?void 0:_t.map(d=>d.value))&&void 0!==xt?xt:[];var re;null===(qt=P.svg)||void 0===qt||qt.nodes.filter(d=>{var O;return"multichoice"==(null===(O=d.source)||void 0===O||null===(O=O.test)||void 0===O?void 0:O.type)&&!j.includes(d.id)}).forEach(d=>{var O;let{x:V,y:B,width:A,height:J}=null!==(O=null==d?void 0:d.size)&&void 0!==O?O:{x:0,y:0,width:0,height:0};(0,et.f)(Math.ceil(1e9*Math.random()),{size:{x:V-.5,y:B-.5,width:A+1,height:J+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},U)}),null!=P&&null!==(Pt=P.test)&&void 0!==Pt&&null!==(Pt=Pt.answer)&&void 0!==Pt&&Pt.multichoice&&j.length&&(null==P||null===(re=P.test)||void 0===re||null===(re=re.answer)||void 0===re||re.multichoice.forEach(d=>{var O;let G=at.$.findNode(d.value),{x:B,y:A,width:J,height:k}=null!==(O=null==G?void 0:G.size)&&void 0!==O?O:{x:0,y:0,width:0,height:0};(0,et.f)(Math.ceil(1e9*Math.random()),{size:{x:B-2,y:A-2,width:J+4,height:k+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},U)}));break}}}},370:(he,At,f)=>{f.d(At,{e:()=>dt});const dt=c=>{switch(null==c?void 0:c.type){case 901:return"assets/iframe/lib/mk-image-viewer/viewer.html?url="+c.readfileuploadurl+c.path;case 902:return"assets/iframe/lib/mk-audio-player/player.html?url="+c.readfileuploadurl+c.path;case 903:return"assets/iframe/lib/mk-video-player/player.html?url="+c.readfileuploadurl+c.path;case 908:return"https://view.officeapps.live.com/op/view.aspx?src="+c.readfileuploadurl+c.path;case 909:return"assets/iframe/lib/PDFReader/web/viewer.html?file="+c.readfileuploadurl+c.path;case 906:case 911:case 910:return""+c.readfileuploadurl+c.path;case 905:var C;return"imsmanifest.xml"==(null===(C=c.pathExtract)||void 0===C||null===(C=C.split("/"))||void 0===C?void 0:C.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+c.readfileuploadurl+c.pathExtract:""+c.readfileuploadurl+c.path;case 907:case 900:return""+c.readfileuploadurl+c.path;case 904:switch(c.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+c.url;case 1002:var E;return null!==(E=T(c.url))&&void 0!==E?E:"";case 1005:var Y;return null!==(Y=c.url)&&void 0!==Y?Y:"";default:var m;return null!==(m=c.url)&&void 0!==m?m:""}default:return""+c.readfileuploadurl+c.path}},T=c=>{let C=Z(c);return C?"https://www.youtube.com/embed/"+C+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},Z=c=>{let C=null==c?void 0:c.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return C&&C.length>=2?C[1]:null}},511:(he,At,f)=>{function z(){}function x(t){return null==t?z:function(){return this.querySelector(t)}}function Z(){return[]}function c(t){return null==t?Z:function(){return this.querySelectorAll(t)}}function Y(t){return function(){return this.matches(t)}}function m(t){return function(e){return e.matches(t)}}f.d(At,{$0Z:()=>aa,jvg:()=>la});var S=Array.prototype.find;function et(){return this.firstElementChild}var Q=Array.prototype.filter;function at(){return Array.from(this.children)}function mt(t){return new Array(t.length)}function q(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Wt(t,e,l,s,u,y){for(var N,_=0,L=e.length,nt=y.length;_<nt;++_)(N=e[_])?(N.__data__=y[_],s[_]=N):l[_]=new q(t,y[_]);for(;_<L;++_)(N=e[_])&&(u[_]=N)}function Lt(t,e,l,s,u,y,_){var N,L,Zt,nt=new Map,st=e.length,It=y.length,Nt=new Array(st);for(N=0;N<st;++N)(L=e[N])&&(Nt[N]=Zt=_.call(L,L.__data__,N,e)+"",nt.has(Zt)?u[N]=L:nt.set(Zt,L));for(N=0;N<It;++N)Zt=_.call(t,y[N],N,y)+"",(L=nt.get(Zt))?(s[N]=L,L.__data__=y[N],nt.delete(Zt)):l[N]=new q(t,y[N]);for(N=0;N<st;++N)(L=e[N])&&nt.get(Nt[N])===L&&(u[N]=L)}function Dt(t){return t.__data__}function Mt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Yt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}q.prototype={constructor:q,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var yt="http://www.w3.org/1999/xhtml";const ft={svg:"http://www.w3.org/2000/svg",xhtml:yt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ot(t){var e=t+="",l=e.indexOf(":");return l>=0&&"xmlns"!==(e=t.slice(0,l))&&(t=t.slice(l+1)),ft.hasOwnProperty(e)?{space:ft[e],local:t}:t}function Qt(t){return function(){this.removeAttribute(t)}}function zt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function xt(t,e){return function(){this.setAttribute(t,e)}}function _t(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function qt(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttribute(t):this.setAttribute(t,l)}}function Pt(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,l)}}function j(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function d(t){return function(){this.style.removeProperty(t)}}function O(t,e,l){return function(){this.style.setProperty(t,e,l)}}function G(t,e,l){return function(){var s=e.apply(this,arguments);null==s?this.style.removeProperty(t):this.style.setProperty(t,s,l)}}function B(t,e){return t.style.getPropertyValue(e)||j(t).getComputedStyle(t,null).getPropertyValue(e)}function A(t){return function(){delete this[t]}}function J(t,e){return function(){this[t]=e}}function k(t,e){return function(){var l=e.apply(this,arguments);null==l?delete this[t]:this[t]=l}}function bt(t){return t.trim().split(/^|\s+/)}function Kt(t){return t.classList||new Tt(t)}function Tt(t){this._node=t,this._names=bt(t.getAttribute("class")||"")}function Rt(t,e){for(var l=Kt(t),s=-1,u=e.length;++s<u;)l.add(e[s])}function jt(t,e){for(var l=Kt(t),s=-1,u=e.length;++s<u;)l.remove(e[s])}function Ut(t){return function(){Rt(this,t)}}function Jt(t){return function(){jt(this,t)}}function ae(t,e){return function(){(e.apply(this,arguments)?Rt:jt)(this,t)}}function Ee(){this.textContent=""}function fe(t){return function(){this.textContent=t}}function ve(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ri(){this.innerHTML=""}function li(t){return function(){this.innerHTML=t}}function vi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ai(){this.nextSibling&&this.parentNode.appendChild(this)}function Xe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function He(t){return function(){var e=this.ownerDocument,l=this.namespaceURI;return l===yt&&e.documentElement.namespaceURI===yt?e.createElement(t):e.createElementNS(l,t)}}function ei(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ye(t){var e=Ot(t);return(e.local?ei:He)(e)}function wt(){return null}function i(){var t=this.parentNode;t&&t.removeChild(this)}function r(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function a(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function R(t){return function(){var e=this.__on;if(e){for(var y,l=0,s=-1,u=e.length;l<u;++l)y=e[l],t.type&&y.type!==t.type||y.name!==t.name?e[++s]=y:this.removeEventListener(y.type,y.listener,y.options);++s?e.length=s:delete this.__on}}}function b(t,e,l){return function(){var u,s=this.__on,y=function p(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var _=0,N=s.length;_<N;++_)if((u=s[_]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.options),this.addEventListener(u.type,u.listener=y,u.options=l),void(u.value=e);this.addEventListener(t.type,y,l),u={type:t.type,name:t.name,value:e,listener:y,options:l},s?s.push(u):this.__on=[u]}}function W(t,e,l){var s=j(t),u=s.CustomEvent;"function"==typeof u?u=new u(e,l):(u=s.document.createEvent("Event"),l?(u.initEvent(e,l.bubbles,l.cancelable),u.detail=l.detail):u.initEvent(e,!1,!1)),t.dispatchEvent(u)}function lt(t,e){return function(){return W(this,t,e)}}function ut(t,e){return function(){return W(this,t,e.apply(this,arguments))}}Tt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var oe=[null];function ce(t,e){this._groups=t,this._parents=e}function pe(){return new ce([[document.documentElement]],oe)}ce.prototype=pe.prototype={constructor:ce,select:function dt(t){"function"!=typeof t&&(t=x(t));for(var e=this._groups,l=e.length,s=new Array(l),u=0;u<l;++u)for(var L,nt,y=e[u],_=y.length,N=s[u]=new Array(_),st=0;st<_;++st)(L=y[st])&&(nt=t.call(L,L.__data__,st,y))&&("__data__"in L&&(nt.__data__=L.__data__),N[st]=nt);return new ce(s,this._parents)},selectAll:function E(t){t="function"==typeof t?function C(t){return function(){return function T(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):c(t);for(var e=this._groups,l=e.length,s=[],u=[],y=0;y<l;++y)for(var L,_=e[y],N=_.length,nt=0;nt<N;++nt)(L=_[nt])&&(s.push(t.call(L,L.__data__,nt,_)),u.push(L));return new ce(s,u)},selectChild:function K(t){return this.select(null==t?et:function w(t){return function(){return S.call(this.children,t)}}("function"==typeof t?t:m(t)))},selectChildren:function rt(t){return this.selectAll(null==t?at:function I(t){return function(){return Q.call(this.children,t)}}("function"==typeof t?t:m(t)))},filter:function gt(t){"function"!=typeof t&&(t=Y(t));for(var e=this._groups,l=e.length,s=new Array(l),u=0;u<l;++u)for(var L,y=e[u],_=y.length,N=s[u]=[],nt=0;nt<_;++nt)(L=y[nt])&&t.call(L,L.__data__,nt,y)&&N.push(L);return new ce(s,this._parents)},data:function Vt(t,e){if(!arguments.length)return Array.from(this,Dt);var l=e?Lt:Wt,s=this._parents,u=this._groups;"function"!=typeof t&&(t=function D(t){return function(){return t}}(t));for(var y=u.length,_=new Array(y),N=new Array(y),L=new Array(y),nt=0;nt<y;++nt){var st=s[nt],It=u[nt],Nt=It.length,Zt=Mt(t.call(st,st&&st.__data__,nt,s)),_e=Zt.length,Se=N[nt]=new Array(_e),Ct=_[nt]=new Array(_e);l(st,It,Se,Ct,L[nt]=new Array(Nt),Zt,e);for(var se,ge,ee=0,Xt=0;ee<_e;++ee)if(se=Se[ee]){for(ee>=Xt&&(Xt=ee+1);!(ge=Ct[Xt])&&++Xt<_e;);se._next=ge||null}}return(_=new ce(_,s))._enter=N,_._exit=L,_},enter:function ct(){return new ce(this._enter||this._groups.map(mt),this._parents)},exit:function Gt(){return new ce(this._exit||this._groups.map(mt),this._parents)},join:function ht(t,e,l){var s=this.enter(),u=this,y=this.exit();return"function"==typeof t?(s=t(s))&&(s=s.selection()):s=s.append(t+""),null!=e&&(u=e(u))&&(u=u.selection()),null==l?y.remove():l(y),s&&u?s.merge(u).order():u},merge:function it(t){for(var e=t.selection?t.selection():t,l=this._groups,s=e._groups,u=l.length,_=Math.min(u,s.length),N=new Array(u),L=0;L<_;++L)for(var Zt,nt=l[L],st=s[L],It=nt.length,Nt=N[L]=new Array(It),_e=0;_e<It;++_e)(Zt=nt[_e]||st[_e])&&(Nt[_e]=Zt);for(;L<u;++L)N[L]=l[L];return new ce(N,this._parents)},selection:function be(){return this},order:function Et(){for(var t=this._groups,e=-1,l=t.length;++e<l;)for(var _,s=t[e],u=s.length-1,y=s[u];--u>=0;)(_=s[u])&&(y&&4^_.compareDocumentPosition(y)&&y.parentNode.insertBefore(_,y),y=_);return this},sort:function St(t){function e(It,Nt){return It&&Nt?t(It.__data__,Nt.__data__):!It-!Nt}t||(t=Yt);for(var l=this._groups,s=l.length,u=new Array(s),y=0;y<s;++y){for(var nt,_=l[y],N=_.length,L=u[y]=new Array(N),st=0;st<N;++st)(nt=_[st])&&(L[st]=nt);L.sort(e)}return new ce(u,this._parents).order()},call:function pt(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function ne(){return Array.from(this)},node:function U(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var s=t[e],u=0,y=s.length;u<y;++u){var _=s[u];if(_)return _}return null},size:function P(){let t=0;for(const e of this)++t;return t},empty:function h(){return!this.node()},each:function H(t){for(var e=this._groups,l=0,s=e.length;l<s;++l)for(var N,u=e[l],y=0,_=u.length;y<_;++y)(N=u[y])&&t.call(N,N.__data__,y,u);return this},attr:function re(t,e){var l=Ot(t);if(arguments.length<2){var s=this.node();return l.local?s.getAttributeNS(l.space,l.local):s.getAttribute(l)}return this.each((null==e?l.local?zt:Qt:"function"==typeof e?l.local?Pt:qt:l.local?_t:xt)(l,e))},style:function V(t,e,l){return arguments.length>1?this.each((null==e?d:"function"==typeof e?G:O)(t,e,null==l?"":l)):B(this.node(),t)},property:function X(t,e){return arguments.length>1?this.each((null==e?A:"function"==typeof e?k:J)(t,e)):this.node()[t]},classed:function ye(t,e){var l=bt(t+"");if(arguments.length<2){for(var s=Kt(this.node()),u=-1,y=l.length;++u<y;)if(!s.contains(l[u]))return!1;return!0}return this.each(("function"==typeof e?ae:e?Ut:Jt)(l,e))},text:function Oe(t){return arguments.length?this.each(null==t?Ee:("function"==typeof t?ve:fe)(t)):this.node().textContent},html:function Ae(t){return arguments.length?this.each(null==t?ri:("function"==typeof t?vi:li)(t)):this.node().innerHTML},raise:function Ge(){return this.each(ai)},lower:function oi(){return this.each(Xe)},append:function si(t){var e="function"==typeof t?t:Ye(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function M(t,e){var l="function"==typeof t?t:Ye(t),s=null==e?wt:"function"==typeof e?e:x(e);return this.select(function(){return this.insertBefore(l.apply(this,arguments),s.apply(this,arguments)||null)})},remove:function n(){return this.each(i)},clone:function o(t){return this.select(t?a:r)},datum:function v(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function F(t,e,l){var u,_,s=function g(t){return t.trim().split(/^|\s+/).map(function(e){var l="",s=e.indexOf(".");return s>=0&&(l=e.slice(s+1),e=e.slice(0,s)),{type:e,name:l}})}(t+""),y=s.length;if(!(arguments.length<2)){for(N=e?b:R,u=0;u<y;++u)this.each(N(s[u],e,l));return this}var N=this.node().__on;if(N)for(var st,L=0,nt=N.length;L<nt;++L)for(u=0,st=N[L];u<y;++u)if((_=s[u]).type===st.type&&_.name===st.name)return st.value},dispatch:function ot(t,e){return this.each(("function"==typeof e?ut:lt)(t,e))},[Symbol.iterator]:function*Ft(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var _,s=t[e],u=0,y=s.length;u<y;++u)(_=s[u])&&(yield _)}};const me=pe;var ke={value:()=>{}};function vn(){for(var s,t=0,e=arguments.length,l={};t<e;++t){if(!(s=arguments[t]+"")||s in l||/[\s.]/.test(s))throw new Error("illegal type: "+s);l[s]=[]}return new Pi(l)}function Pi(t){this._=t}function ar(t,e){for(var u,l=0,s=t.length;l<s;++l)if((u=t[l]).name===e)return u.value}function gn(t,e,l){for(var s=0,u=t.length;s<u;++s)if(t[s].name===e){t[s]=ke,t=t.slice(0,s).concat(t.slice(s+1));break}return null!=l&&t.push({name:e,value:l}),t}Pi.prototype=vn.prototype={constructor:Pi,on:function(t,e){var u,l=this._,s=function lr(t,e){return t.trim().split(/^|\s+/).map(function(l){var s="",u=l.indexOf(".");if(u>=0&&(s=l.slice(u+1),l=l.slice(0,u)),l&&!e.hasOwnProperty(l))throw new Error("unknown type: "+l);return{type:l,name:s}})}(t+"",l),y=-1,_=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++y<_;)if(u=(t=s[y]).type)l[u]=gn(l[u],t.name,e);else if(null==e)for(u in l)l[u]=gn(l[u],t.name,null);return this}for(;++y<_;)if((u=(t=s[y]).type)&&(u=ar(l[u],t.name)))return u},copy:function(){var t={},e=this._;for(var l in e)t[l]=e[l].slice();return new Pi(t)},call:function(t,e){if((u=arguments.length-2)>0)for(var u,y,l=new Array(u),s=0;s<u;++s)l[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,u=(y=this._[t]).length;s<u;++s)y[s].value.apply(e,l)},apply:function(t,e,l){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],u=0,y=s.length;u<y;++u)s[u].value.apply(e,l)}};const or=vn;var Ri,Oi,gi=0,xi=0,Ei=0,yn=1e3,Li=0,di=0,Di=0,Si="object"==typeof performance&&performance.now?performance:Date,pn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Xi(){return di||(pn(sr),di=Si.now()+Di)}function sr(){di=0}function ji(){this._call=this._time=this._next=null}function mn(t,e,l){var s=new ji;return s.restart(t,e,l),s}function _n(){di=(Li=Si.now())+Di,gi=xi=0;try{!function dr(){Xi(),++gi;for(var e,t=Ri;t;)(e=di-t._time)>=0&&t._call.call(void 0,e),t=t._next;--gi}()}finally{gi=0,function hr(){for(var t,l,e=Ri,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(l=e._next,e._next=null,e=t?t._next=l:Ri=l);Oi=t,Yi(s)}(),di=0}}function ur(){var t=Si.now(),e=t-Li;e>yn&&(Di-=e,Li=t)}function Yi(t){gi||(xi&&(xi=clearTimeout(xi)),t-di>24?(t<1/0&&(xi=setTimeout(_n,t-Si.now()-Di)),Ei&&(Ei=clearInterval(Ei))):(Ei||(Li=Si.now(),Ei=setInterval(ur,yn)),gi=1,pn(_n)))}function wn(t,e,l){var s=new ji;return s.restart(u=>{s.stop(),t(u+e)},e=null==e?0:+e,l),s}ji.prototype=mn.prototype={constructor:ji,restart:function(t,e,l){if("function"!=typeof t)throw new TypeError("callback is not a function");l=(null==l?Xi():+l)+(null==e?0:+e),!this._next&&Oi!==this&&(Oi?Oi._next=this:Ri=this,Oi=this),this._call=t,this._time=l,Yi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yi())}};var cr=or("start","end","cancel","interrupt"),fr=[],bn=0,zi=3;function Ki(t,e,l,s,u,y){var _=t.__transition;if(_){if(l in _)return}else t.__transition={};!function vr(t,e,l){var u,s=t.__transition;function _(nt){var st,It,Nt,Zt;if(1!==l.state)return L();for(st in s)if((Zt=s[st]).name===l.name){if(Zt.state===zi)return wn(_);4===Zt.state?(Zt.state=6,Zt.timer.stop(),Zt.on.call("interrupt",t,t.__data__,Zt.index,Zt.group),delete s[st]):+st<e&&(Zt.state=6,Zt.timer.stop(),Zt.on.call("cancel",t,t.__data__,Zt.index,Zt.group),delete s[st])}if(wn(function(){l.state===zi&&(l.state=4,l.timer.restart(N,l.delay,l.time),N(nt))}),l.state=2,l.on.call("start",t,t.__data__,l.index,l.group),2===l.state){for(l.state=zi,u=new Array(Nt=l.tween.length),st=0,It=-1;st<Nt;++st)(Zt=l.tween[st].value.call(t,t.__data__,l.index,l.group))&&(u[++It]=Zt);u.length=It+1}}function N(nt){for(var st=nt<l.duration?l.ease.call(null,nt/l.duration):(l.timer.restart(L),l.state=5,1),It=-1,Nt=u.length;++It<Nt;)u[It].call(t,st);5===l.state&&(l.on.call("end",t,t.__data__,l.index,l.group),L())}function L(){for(var nt in l.state=6,l.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=l,l.timer=mn(function y(nt){l.state=1,l.timer.restart(_,l.delay,l.time),l.delay<=nt&&_(nt-l.delay)},0,l.time)}(t,l,{name:e,index:s,group:u,on:cr,tween:fr,time:y.time,delay:y.delay,duration:y.duration,ease:y.ease,timer:null,state:bn})}function tn(t,e){var l=Fe(t,e);if(l.state>bn)throw new Error("too late; already scheduled");return l}function Ve(t,e){var l=Fe(t,e);if(l.state>zi)throw new Error("too late; already running");return l}function Fe(t,e){var l=t.__transition;if(!l||!(l=l[e]))throw new Error("transition not found");return l}function ii(t,e){return t=+t,e=+e,function(l){return t*(1-l)+e*l}}var Wi,On=180/Math.PI,en={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Sn(t,e,l,s,u,y){var _,N,L;return(_=Math.sqrt(t*t+e*e))&&(t/=_,e/=_),(L=t*l+e*s)&&(l-=t*L,s-=e*L),(N=Math.sqrt(l*l+s*s))&&(l/=N,s/=N,L/=N),t*s<e*l&&(t=-t,e=-e,L=-L,_=-_),{translateX:u,translateY:y,rotate:Math.atan2(e,t)*On,skewX:Math.atan(L)*On,scaleX:_,scaleY:N}}function kn(t,e,l,s){function u(nt){return nt.length?nt.pop()+" ":""}return function(nt,st){var It=[],Nt=[];return nt=t(nt),st=t(st),function y(nt,st,It,Nt,Zt,_e){if(nt!==It||st!==Nt){var Se=Zt.push("translate(",null,e,null,l);_e.push({i:Se-4,x:ii(nt,It)},{i:Se-2,x:ii(st,Nt)})}else(It||Nt)&&Zt.push("translate("+It+e+Nt+l)}(nt.translateX,nt.translateY,st.translateX,st.translateY,It,Nt),function _(nt,st,It,Nt){nt!==st?(nt-st>180?st+=360:st-nt>180&&(nt+=360),Nt.push({i:It.push(u(It)+"rotate(",null,s)-2,x:ii(nt,st)})):st&&It.push(u(It)+"rotate("+st+s)}(nt.rotate,st.rotate,It,Nt),function N(nt,st,It,Nt){nt!==st?Nt.push({i:It.push(u(It)+"skewX(",null,s)-2,x:ii(nt,st)}):st&&It.push(u(It)+"skewX("+st+s)}(nt.skewX,st.skewX,It,Nt),function L(nt,st,It,Nt,Zt,_e){if(nt!==It||st!==Nt){var Se=Zt.push(u(Zt)+"scale(",null,",",null,")");_e.push({i:Se-4,x:ii(nt,It)},{i:Se-2,x:ii(st,Nt)})}else(1!==It||1!==Nt)&&Zt.push(u(Zt)+"scale("+It+","+Nt+")")}(nt.scaleX,nt.scaleY,st.scaleX,st.scaleY,It,Nt),nt=st=null,function(Zt){for(var Ct,_e=-1,Se=Nt.length;++_e<Se;)It[(Ct=Nt[_e]).i]=Ct.x(Zt);return It.join("")}}}var _r=kn(function pr(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?en:Sn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),wr=kn(function mr(t){return null!=t&&(Wi||(Wi=document.createElementNS("http://www.w3.org/2000/svg","g")),Wi.setAttribute("transform",t),t=Wi.transform.baseVal.consolidate())?Sn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):en},", ",")",")");function br(t,e){var l,s;return function(){var u=Ve(this,t),y=u.tween;if(y!==l)for(var _=0,N=(s=l=y).length;_<N;++_)if(s[_].name===e){(s=s.slice()).splice(_,1);break}u.tween=s}}function xr(t,e,l){var s,u;if("function"!=typeof l)throw new Error;return function(){var y=Ve(this,t),_=y.tween;if(_!==s){u=(s=_).slice();for(var N={name:e,value:l},L=0,nt=u.length;L<nt;++L)if(u[L].name===e){u[L]=N;break}L===nt&&u.push(N)}y.tween=u}}function nn(t,e,l){var s=t._id;return t.each(function(){var u=Ve(this,s);(u.value||(u.value={}))[e]=l.apply(this,arguments)}),function(u){return Fe(u,s).value[e]}}function rn(t,e,l){t.prototype=e.prototype=l,l.constructor=t}function Mn(t,e){var l=Object.create(t.prototype);for(var s in e)l[s]=e[s];return l}function ki(){}var Ui=1/.7,yi="\\s*([+-]?\\d+)\\s*",Ti="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Je="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Or=/^#([0-9a-f]{3,8})$/,Sr=new RegExp(`^rgb\\(${yi},${yi},${yi}\\)$`),kr=new RegExp(`^rgb\\(${Je},${Je},${Je}\\)$`),Mr=new RegExp(`^rgba\\(${yi},${yi},${yi},${Ti}\\)$`),Tr=new RegExp(`^rgba\\(${Je},${Je},${Je},${Ti}\\)$`),Cr=new RegExp(`^hsl\\(${Ti},${Je},${Je}\\)$`),Ar=new RegExp(`^hsla\\(${Ti},${Je},${Je},${Ti}\\)$`),Tn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Cn(){return this.rgb().formatHex()}function An(){return this.rgb().formatRgb()}function Ci(t){var e,l;return t=(t+"").trim().toLowerCase(),(e=Or.exec(t))?(l=e[1].length,e=parseInt(e[1],16),6===l?In(e):3===l?new ze(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===l?Gi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===l?Gi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Sr.exec(t))?new ze(e[1],e[2],e[3],1):(e=kr.exec(t))?new ze(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Mr.exec(t))?Gi(e[1],e[2],e[3],e[4]):(e=Tr.exec(t))?Gi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Cr.exec(t))?Rn(e[1],e[2]/100,e[3]/100,1):(e=Ar.exec(t))?Rn(e[1],e[2]/100,e[3]/100,e[4]):Tn.hasOwnProperty(t)?In(Tn[t]):"transparent"===t?new ze(NaN,NaN,NaN,0):null}function In(t){return new ze(t>>16&255,t>>8&255,255&t,1)}function Gi(t,e,l,s){return s<=0&&(t=e=l=NaN),new ze(t,e,l,s)}function Fi(t,e,l,s){return 1===arguments.length?function Pr(t){return t instanceof ki||(t=Ci(t)),t?new ze((t=t.rgb()).r,t.g,t.b,t.opacity):new ze}(t):new ze(t,e,l,null==s?1:s)}function ze(t,e,l,s){this.r=+t,this.g=+e,this.b=+l,this.opacity=+s}function Nn(){return`#${hi(this.r)}${hi(this.g)}${hi(this.b)}`}function Pn(){const t=Qi(this.opacity);return`${1===t?"rgb(":"rgba("}${ui(this.r)}, ${ui(this.g)}, ${ui(this.b)}${1===t?")":`, ${t})`}`}function Qi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ui(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function hi(t){return((t=ui(t))<16?"0":"")+t.toString(16)}function Rn(t,e,l,s){return s<=0?t=e=l=NaN:l<=0||l>=1?t=e=NaN:e<=0&&(t=NaN),new Qe(t,e,l,s)}function Ln(t){if(t instanceof Qe)return new Qe(t.h,t.s,t.l,t.opacity);if(t instanceof ki||(t=Ci(t)),!t)return new Qe;if(t instanceof Qe)return t;var e=(t=t.rgb()).r/255,l=t.g/255,s=t.b/255,u=Math.min(e,l,s),y=Math.max(e,l,s),_=NaN,N=y-u,L=(y+u)/2;return N?(_=e===y?(l-s)/N+6*(l<s):l===y?(s-e)/N+2:(e-l)/N+4,N/=L<.5?y+u:2-y-u,_*=60):N=L>0&&L<1?0:_,new Qe(_,N,L,t.opacity)}function Qe(t,e,l,s){this.h=+t,this.s=+e,this.l=+l,this.opacity=+s}function Dn(t){return(t=(t||0)%360)<0?t+360:t}function Hi(t){return Math.max(0,Math.min(1,t||0))}function ln(t,e,l){return 255*(t<60?e+(l-e)*t/60:t<180?l:t<240?e+(l-e)*(240-t)/60:e)}function jn(t,e,l,s,u){var y=t*t,_=y*t;return((1-3*t+3*y-_)*e+(4-6*y+3*_)*l+(1+3*t+3*y-3*_)*s+_*u)/6}rn(ki,Ci,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Cn,formatHex:Cn,formatHex8:function Ir(){return this.rgb().formatHex8()},formatHsl:function Nr(){return Ln(this).formatHsl()},formatRgb:An,toString:An}),rn(ze,Fi,Mn(ki,{brighter(t){return t=null==t?Ui:Math.pow(Ui,t),new ze(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new ze(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ze(ui(this.r),ui(this.g),ui(this.b),Qi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Nn,formatHex:Nn,formatHex8:function Rr(){return`#${hi(this.r)}${hi(this.g)}${hi(this.b)}${hi(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Pn,toString:Pn})),rn(Qe,function Lr(t,e,l,s){return 1===arguments.length?Ln(t):new Qe(t,e,l,null==s?1:s)},Mn(ki,{brighter(t){return t=null==t?Ui:Math.pow(Ui,t),new Qe(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Qe(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,l=this.l,s=l+(l<.5?l:1-l)*e,u=2*l-s;return new ze(ln(t>=240?t-240:t+120,u,s),ln(t,u,s),ln(t<120?t+240:t-120,u,s),this.opacity)},clamp(){return new Qe(Dn(this.h),Hi(this.s),Hi(this.l),Qi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qi(this.opacity);return`${1===t?"hsl(":"hsla("}${Dn(this.h)}, ${100*Hi(this.s)}%, ${100*Hi(this.l)}%${1===t?")":`, ${t})`}`}}));const zn=t=>()=>t;function Kn(t,e){var l=e-t;return l?function Bn(t,e){return function(l){return t+l*e}}(t,l):zn(isNaN(t)?e:t)}const Wn=function t(e){var l=function Br(t){return 1==(t=+t)?Kn:function(e,l){return l-e?function zr(t,e,l){return t=Math.pow(t,l),e=Math.pow(e,l)-t,l=1/l,function(s){return Math.pow(t+s*e,l)}}(e,l,t):zn(isNaN(e)?l:e)}}(e);function s(u,y){var _=l((u=Fi(u)).r,(y=Fi(y)).r),N=l(u.g,y.g),L=l(u.b,y.b),nt=Kn(u.opacity,y.opacity);return function(st){return u.r=_(st),u.g=N(st),u.b=L(st),u.opacity=nt(st),u+""}}return s.gamma=t,s}(1);function Un(t){return function(e){var _,N,l=e.length,s=new Array(l),u=new Array(l),y=new Array(l);for(_=0;_<l;++_)N=Fi(e[_]),s[_]=N.r||0,u[_]=N.g||0,y[_]=N.b||0;return s=t(s),u=t(u),y=t(y),N.opacity=1,function(L){return N.r=s(L),N.g=u(L),N.b=y(L),N+""}}}Un(function Dr(t){var e=t.length-1;return function(l){var s=l<=0?l=0:l>=1?(l=1,e-1):Math.floor(l*e),u=t[s],y=t[s+1];return jn((l-s/e)*e,s>0?t[s-1]:2*u-y,u,y,s<e-1?t[s+2]:2*y-u)}}),Un(function jr(t){var e=t.length;return function(l){var s=Math.floor(((l%=1)<0?++l:l)*e);return jn((l-s/e)*e,t[(s+e-1)%e],t[s%e],t[(s+1)%e],t[(s+2)%e])}});var an=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,on=new RegExp(an.source,"g");function Ur(t,e){var s,u,y,l=an.lastIndex=on.lastIndex=0,_=-1,N=[],L=[];for(t+="",e+="";(s=an.exec(t))&&(u=on.exec(e));)(y=u.index)>l&&(y=e.slice(l,y),N[_]?N[_]+=y:N[++_]=y),(s=s[0])===(u=u[0])?N[_]?N[_]+=u:N[++_]=u:(N[++_]=null,L.push({i:_,x:ii(s,u)})),l=on.lastIndex;return l<e.length&&(y=e.slice(l),N[_]?N[_]+=y:N[++_]=y),N.length<2?L[0]?function Wr(t){return function(e){return t(e)+""}}(L[0].x):function Kr(t){return function(){return t}}(e):(e=L.length,function(nt){for(var It,st=0;st<e;++st)N[(It=L[st]).i]=It.x(nt);return N.join("")})}function Gn(t,e){var l;return("number"==typeof e?ii:e instanceof Ci?Wn:(l=Ci(e))?(e=l,Wn):Ur)(t,e)}function Gr(t){return function(){this.removeAttribute(t)}}function Fr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qr(t,e,l){var s,y,u=l+"";return function(){var _=this.getAttribute(t);return _===u?null:_===s?y:y=e(s=_,l)}}function Hr(t,e,l){var s,y,u=l+"";return function(){var _=this.getAttributeNS(t.space,t.local);return _===u?null:_===s?y:y=e(s=_,l)}}function Vr(t,e,l){var s,u,y;return function(){var _,L,N=l(this);return null==N?void this.removeAttribute(t):(_=this.getAttribute(t))===(L=N+"")?null:_===s&&L===u?y:(u=L,y=e(s=_,N))}}function Jr(t,e,l){var s,u,y;return function(){var _,L,N=l(this);return null==N?void this.removeAttributeNS(t.space,t.local):(_=this.getAttributeNS(t.space,t.local))===(L=N+"")?null:_===s&&L===u?y:(u=L,y=e(s=_,N))}}function $r(t,e){var l,s;function u(){var y=e.apply(this,arguments);return y!==s&&(l=(s=y)&&function Yr(t,e){return function(l){this.setAttributeNS(t.space,t.local,e.call(this,l))}}(t,y)),l}return u._value=e,u}function qr(t,e){var l,s;function u(){var y=e.apply(this,arguments);return y!==s&&(l=(s=y)&&function Xr(t,e){return function(l){this.setAttribute(t,e.call(this,l))}}(t,y)),l}return u._value=e,u}function el(t,e){return function(){tn(this,t).delay=+e.apply(this,arguments)}}function il(t,e){return e=+e,function(){tn(this,t).delay=e}}function rl(t,e){return function(){Ve(this,t).duration=+e.apply(this,arguments)}}function ll(t,e){return e=+e,function(){Ve(this,t).duration=e}}var wl=me.prototype.constructor;function Fn(t){return function(){this.style.removeProperty(t)}}var zl=0;function $e(t,e,l,s){this._groups=t,this._parents=e,this._name=l,this._id=s}function Qn(){return++zl}var qe=me.prototype;$e.prototype=function Bl(t){return me().transition(t)}.prototype={constructor:$e,select:function ml(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=x(t));for(var s=this._groups,u=s.length,y=new Array(u),_=0;_<u;++_)for(var st,It,N=s[_],L=N.length,nt=y[_]=new Array(L),Nt=0;Nt<L;++Nt)(st=N[Nt])&&(It=t.call(st,st.__data__,Nt,N))&&("__data__"in st&&(It.__data__=st.__data__),nt[Nt]=It,Ki(nt[Nt],e,l,Nt,nt,Fe(st,l)));return new $e(y,this._parents,e,l)},selectAll:function _l(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=c(t));for(var s=this._groups,u=s.length,y=[],_=[],N=0;N<u;++N)for(var st,L=s[N],nt=L.length,It=0;It<nt;++It)if(st=L[It]){for(var Zt,Nt=t.call(st,st.__data__,It,L),_e=Fe(st,l),Se=0,Ct=Nt.length;Se<Ct;++Se)(Zt=Nt[Se])&&Ki(Zt,e,l,Se,Nt,_e);y.push(Nt),_.push(st)}return new $e(y,_,e,l)},selectChild:qe.selectChild,selectChildren:qe.selectChildren,filter:function hl(t){"function"!=typeof t&&(t=Y(t));for(var e=this._groups,l=e.length,s=new Array(l),u=0;u<l;++u)for(var L,y=e[u],_=y.length,N=s[u]=[],nt=0;nt<_;++nt)(L=y[nt])&&t.call(L,L.__data__,nt,y)&&N.push(L);return new $e(s,this._parents,this._name,this._id)},merge:function cl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,l=t._groups,s=e.length,y=Math.min(s,l.length),_=new Array(s),N=0;N<y;++N)for(var Nt,L=e[N],nt=l[N],st=L.length,It=_[N]=new Array(st),Zt=0;Zt<st;++Zt)(Nt=L[Zt]||nt[Zt])&&(It[Zt]=Nt);for(;N<s;++N)_[N]=e[N];return new $e(_,this._parents,this._name,this._id)},selection:function bl(){return new wl(this._groups,this._parents)},transition:function Dl(){for(var t=this._name,e=this._id,l=Qn(),s=this._groups,u=s.length,y=0;y<u;++y)for(var L,_=s[y],N=_.length,nt=0;nt<N;++nt)if(L=_[nt]){var st=Fe(L,e);Ki(L,t,l,nt,_,{time:st.time+st.delay+st.duration,delay:0,duration:st.duration,ease:st.ease})}return new $e(s,this._parents,t,l)},call:qe.call,nodes:qe.nodes,node:qe.node,size:qe.size,empty:qe.empty,each:qe.each,on:function gl(t,e){var l=this._id;return arguments.length<2?Fe(this.node(),l).on.on(t):this.each(function vl(t,e,l){var s,u,y=function fl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var l=e.indexOf(".");return l>=0&&(e=e.slice(0,l)),!e||"start"===e})}(e)?tn:Ve;return function(){var _=y(this,t),N=_.on;N!==s&&(u=(s=N).copy()).on(e,l),_.on=u}}(l,t,e))},attr:function Zr(t,e){var l=Ot(t),s="transform"===l?wr:Gn;return this.attrTween(t,"function"==typeof e?(l.local?Jr:Vr)(l,s,nn(this,"attr."+t,e)):null==e?(l.local?Fr:Gr)(l):(l.local?Hr:Qr)(l,s,e))},attrTween:function tl(t,e){var l="attr."+t;if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==e)return this.tween(l,null);if("function"!=typeof e)throw new Error;var s=Ot(t);return this.tween(l,(s.local?$r:qr)(s,e))},style:function kl(t,e,l){var s="transform"==(t+="")?_r:Gn;return null==e?this.styleTween(t,function xl(t,e){var l,s,u;return function(){var y=B(this,t),_=(this.style.removeProperty(t),B(this,t));return y===_?null:y===l&&_===s?u:u=e(l=y,s=_)}}(t,s)).on("end.style."+t,Fn(t)):"function"==typeof e?this.styleTween(t,function Ol(t,e,l){var s,u,y;return function(){var _=B(this,t),N=l(this),L=N+"";return null==N&&(this.style.removeProperty(t),L=N=B(this,t)),_===L?null:_===s&&L===u?y:(u=L,y=e(s=_,N))}}(t,s,nn(this,"style."+t,e))).each(function Sl(t,e){var l,s,u,N,y="style."+e,_="end."+y;return function(){var L=Ve(this,t),nt=L.on,st=null==L.value[y]?N||(N=Fn(e)):void 0;(nt!==l||u!==st)&&(s=(l=nt).copy()).on(_,u=st),L.on=s}}(this._id,t)):this.styleTween(t,function El(t,e,l){var s,y,u=l+"";return function(){var _=B(this,t);return _===u?null:_===s?y:y=e(s=_,l)}}(t,s,e),l).on("end.style."+t,null)},styleTween:function Cl(t,e,l){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(null==e)return this.tween(s,null);if("function"!=typeof e)throw new Error;return this.tween(s,function Tl(t,e,l){var s,u;function y(){var _=e.apply(this,arguments);return _!==u&&(s=(u=_)&&function Ml(t,e,l){return function(s){this.style.setProperty(t,e.call(this,s),l)}}(t,_,l)),s}return y._value=e,y}(t,e,null==l?"":l))},text:function Nl(t){return this.tween("text","function"==typeof t?function Il(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(nn(this,"text",t)):function Al(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function Ll(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function Rl(t){var e,l;function s(){var u=t.apply(this,arguments);return u!==l&&(e=(l=u)&&function Pl(t){return function(e){this.textContent=t.call(this,e)}}(u)),e}return s._value=t,s}(t))},remove:function pl(){return this.on("end.remove",function yl(t){return function(){var e=this.parentNode;for(var l in this.__transition)if(+l!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function Er(t,e){var l=this._id;if(t+="",arguments.length<2){for(var _,s=Fe(this.node(),l).tween,u=0,y=s.length;u<y;++u)if((_=s[u]).name===t)return _.value;return null}return this.each((null==e?br:xr)(l,t,e))},delay:function nl(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?el:il)(e,t)):Fe(this.node(),e).delay},duration:function al(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?rl:ll)(e,t)):Fe(this.node(),e).duration},ease:function sl(t){var e=this._id;return arguments.length?this.each(function ol(t,e){if("function"!=typeof e)throw new Error;return function(){Ve(this,t).ease=e}}(e,t)):Fe(this.node(),e).ease},easeVarying:function ul(t){if("function"!=typeof t)throw new Error;return this.each(function dl(t,e){return function(){var l=e.apply(this,arguments);if("function"!=typeof l)throw new Error;Ve(this,t).ease=l}}(this._id,t))},end:function jl(){var t,e,l=this,s=l._id,u=l.size();return new Promise(function(y,_){var N={value:_},L={value:function(){0==--u&&y()}};l.each(function(){var nt=Ve(this,s),st=nt.on;st!==t&&((e=(t=st).copy())._.cancel.push(N),e._.interrupt.push(N),e._.end.push(L)),nt.on=e}),0===u&&y()})},[Symbol.iterator]:qe[Symbol.iterator]};var Wl={time:null,delay:0,duration:250,ease:function Kl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Ul(t,e){for(var l;!(l=t.__transition)||!(l=l[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return l}me.prototype.interrupt=function yr(t){return this.each(function(){!function gr(t,e){var s,u,_,l=t.__transition,y=!0;if(l){for(_ in e=null==e?null:e+"",l)(s=l[_]).name===e?(u=s.state>2&&s.state<5,s.state=6,s.timer.stop(),s.on.call(u?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete l[_]):y=!1;y&&delete t.__transition}}(this,t)})},me.prototype.transition=function Gl(t){var e,l;t instanceof $e?(e=t._id,t=t._name):(e=Qn(),(l=Wl).time=Xi(),t=null==t?null:t+"");for(var s=this._groups,u=s.length,y=0;y<u;++y)for(var L,_=s[y],N=_.length,nt=0;nt<N;++nt)(L=_[nt])&&Ki(L,t,e,nt,_,l||Ul(L,e));return new $e(s,this._parents,t,e)};Math;function Ai(t){return{type:t}}function _i(t){return function(){return t}}function Yn(t){this._context=t}function $l(t){return new Yn(t)}["w","e"].map(Ai),["n","s"].map(Ai),["n","w","e","s","nw","ne","sw","se"].map(Ai),Yn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const cn=Math.PI,fn=2*cn,ci=1e-6,ql=fn-ci;function $n(t){this._+=t[0];for(let e=1,l=t.length;e<l;++e)this._+=arguments[e]+t[e]}class Zi{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?$n:function ta(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return $n;const l=10**e;return function(s){this._+=s[0];for(let u=1,y=s.length;u<y;++u)this._+=Math.round(arguments[u]*l)/l+s[u]}}(e)}moveTo(e,l){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,l){this._append`L${this._x1=+e},${this._y1=+l}`}quadraticCurveTo(e,l,s,u){this._append`Q${+e},${+l},${this._x1=+s},${this._y1=+u}`}bezierCurveTo(e,l,s,u,y,_){this._append`C${+e},${+l},${+s},${+u},${this._x1=+y},${this._y1=+_}`}arcTo(e,l,s,u,y){if(e=+e,l=+l,s=+s,u=+u,(y=+y)<0)throw new Error(`negative radius: ${y}`);let _=this._x1,N=this._y1,L=s-e,nt=u-l,st=_-e,It=N-l,Nt=st*st+It*It;if(null===this._x1)this._append`M${this._x1=e},${this._y1=l}`;else if(Nt>ci)if(Math.abs(It*L-nt*st)>ci&&y){let Zt=s-_,_e=u-N,Se=L*L+nt*nt,Ct=Zt*Zt+_e*_e,kt=Math.sqrt(Se),ee=Math.sqrt(Nt),Xt=y*Math.tan((cn-Math.acos((Se+Nt-Ct)/(2*kt*ee)))/2),se=Xt/ee,ge=Xt/kt;Math.abs(se-1)>ci&&this._append`L${e+se*st},${l+se*It}`,this._append`A${y},${y},0,0,${+(It*Zt>st*_e)},${this._x1=e+ge*L},${this._y1=l+ge*nt}`}else this._append`L${this._x1=e},${this._y1=l}`}arc(e,l,s,u,y,_){if(e=+e,l=+l,_=!!_,(s=+s)<0)throw new Error(`negative radius: ${s}`);let N=s*Math.cos(u),L=s*Math.sin(u),nt=e+N,st=l+L,It=1^_,Nt=_?u-y:y-u;null===this._x1?this._append`M${nt},${st}`:(Math.abs(this._x1-nt)>ci||Math.abs(this._y1-st)>ci)&&this._append`L${nt},${st}`,s&&(Nt<0&&(Nt=Nt%fn+fn),Nt>ql?this._append`A${s},${s},0,1,${It},${e-N},${l-L}A${s},${s},0,1,${It},${this._x1=nt},${this._y1=st}`:Nt>ci&&this._append`A${s},${s},0,${+(Nt>=cn)},${It},${this._x1=e+s*Math.cos(y)},${this._y1=l+s*Math.sin(y)}`)}rect(e,l,s,u){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}h${s=+s}v${+u}h${-s}Z`}toString(){return this._}}function na(t){return t[0]}function ra(t){return t[1]}function la(t,e){var l=_i(!0),s=null,u=$l,y=null,_=function ia(t){let e=3;return t.digits=function(l){if(!arguments.length)return e;if(null==l)e=null;else{const s=Math.floor(l);if(!(s>=0))throw new RangeError(`invalid digits: ${l}`);e=s}return t},()=>new Zi(e)}(N);function N(L){var nt,It,Zt,st=(L=function Yl(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(L)).length,Nt=!1;for(null==s&&(y=u(Zt=_())),nt=0;nt<=st;++nt)!(nt<st&&l(It=L[nt],nt,L))===Nt&&((Nt=!Nt)?y.lineStart():y.lineEnd()),Nt&&y.point(+t(It,nt,L),+e(It,nt,L));if(Zt)return y=null,Zt+""||null}return t="function"==typeof t?t:void 0===t?na:_i(t),e="function"==typeof e?e:void 0===e?ra:_i(e),N.x=function(L){return arguments.length?(t="function"==typeof L?L:_i(+L),N):t},N.y=function(L){return arguments.length?(e="function"==typeof L?L:_i(+L),N):e},N.defined=function(L){return arguments.length?(l="function"==typeof L?L:_i(!!L),N):l},N.curve=function(L){return arguments.length?(u=L,null!=s&&(y=u(s)),N):u},N.context=function(L){return arguments.length?(null==L?s=y=null:y=u(s=L),N):s},N}function qn(t,e,l){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+l)/6)}function tr(t){this._context=t}function aa(t){return new tr(t)}function wi(t,e,l){this.k=t,this.x=e,this.y=l}tr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:qn(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:qn(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},wi.prototype={constructor:wi,scale:function(t){return 1===t?this:new wi(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new wi(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new wi(1,0,0)}}]);