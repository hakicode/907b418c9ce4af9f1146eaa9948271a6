"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4981],{1814:(le,At,f)=>{f.d(At,{In:()=>dt,MA:()=>p,Mo:()=>P,NV:()=>E,S3:()=>z,dt:()=>it,h8:()=>h,k0:()=>k});const z={fill:"transparent",stroke:"#129bff",strokeWidth:1},E={stroke:"#5F6CE1",strokeWidth:1,strokeLinecap:"round",strokeDasharrays:[4,2,1,2]},dt={fill:"#FFFFFF",stroke:"#5F6CE1",strokeWidth:1,width:7,height:7},P={fill:"transparent",stroke:"transparent",strokeWidth:1},it={fill:"none",stroke:"#5F6CE1",strokeWidth:1},h={stroke:"#129bff",strokeWidth:1,strokeLinecap:"round",strokeDasharray:8},p={fill:"transparent"},k={fill:"none",stroke:"#999",strokeWidth:1,strokeDasharray:2}},9942:(le,At,f)=>{f.d(At,{w:()=>nt,I:()=>S});var z=f(4981),E=f(9054),dt=f(5811),P=/^#[a-fA-F0-9]+$/i,it=/^rgba\((\d+),(\d+),(\d+),(\d+)\)$/i,h=/^rgb\((\d+),(\d+),(\d+)\)$/i;const p=N=>{let F=null,rt=null;if(N)if("transparent"==N)F="#000000",rt=0;else if(N.match(P))F=N;else{let M=(N=N.replace(/\s+/g,"")).match(it);if(M)F="#"+(256|M[1]).toString(16).slice(1)+(256|M[2]).toString(16).slice(1)+(256|M[3]).toString(16).slice(1),rt=(0,dt.q)(parseFloat(M[4]),100);else{let q=N.match(h);q&&(F="#"+(256|q[1]).toString(16).slice(1)+(256|q[2]).toString(16).slice(1)+(256|q[3]).toString(16).slice(1))}}return{hex:F,alpha:rt}},S=N=>x(null==N?void 0:N.url,null==N?void 0:N.path,null==N?void 0:N.src);var x=(N,F,rt)=>{var M,q;let vt,gt,ft,Y;var C,Lt;return N&&(vt=N.replace(/\\/g,"/")),F&&(gt=F.replace(/\\/g,"/")),rt&&(ft=rt.replace(/\\/g,"/")),gt&&!vt&&(vt=(null===(C=z.icdt.config)||void 0===C?void 0:C.readfileuploadurl)+gt),!ft||gt||vt||(gt=ft.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),vt=(null===(Lt=z.icdt.config)||void 0===Lt?void 0:Lt.readfileuploadurl)+gt),Y=(null!==(M=vt)&&void 0!==M?M:"").split("/").pop()||(null!==(q=gt)&&void 0!==q?q:"").split("/").pop()||"",{url:vt,path:gt,name:Y}};const nt=N=>{let F={x:0,y:0,width:N.screen.w,height:N.screen.h},rt=[];return N.data.forEach((M,q)=>{var vt,gt;let ft={id:"number"==typeof M.id?M.id:z.icdt.data.newSlideId,code:null===(vt=M.id)||void 0===vt?void 0:vt.toString(),name:"string"==typeof M.id?M.id:`Trang ${q+1}`,svg:{viewBox:F,nodes:[]},test:(Y=M.test2,Y?(Y.audiotrue&&(Y.audiotrue=S({path:Y.audiotrue.path})),Y.audiofalse&&(Y.audiofalse=S({path:Y.audiofalse.path})),Y.effecttrue&&(Y.effecttrue=S({path:Y.effecttrue.path})),Y.effectfalse&&(Y.effectfalse=S({path:Y.effectfalse.path})),Y.icontrue&&(Y.icontrue=S({path:Y.icontrue.path})),Y.iconfalse&&(Y.iconfalse=S({path:Y.iconfalse.path})),Y):{})};var Y;M.background&&ft.svg&&(ft.svg.background=function(N){return N&&(null!==N.match(/#([a-zA-Z0-9]+)/)||null!==N.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==N.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9]+\)/))}(M.background)?{color:M.background}:function(N){return N&&null!==N.match(/data:[^;]+;base64,/)}(M.background)?{base64:M.background}:function(N){return N&&null!==N.match(/http(s)?:\/\//)}(M.background)?x(M.background):x(void 0,M.background)),jQuery(null!==(gt=M.svg)&&void 0!==gt?gt:"").find(".svg-node").each((Y,C)=>{var Lt,Bt;let Dt=jQuery(C).parents(".indexs"),ae=Dt.attr("data-index"),Tt=Dt.attr("data-time"),Ft=null!==(Lt=C.getAttribute("id"))&&void 0!==Lt?Lt:"0",ut={id:parseInt(Ft),code:`${C.nodeName}-${C.getAttribute("id")}`,name:C.nodeName,idx:ae?parseInt(ae):0,time:Tt?parseFloat(Tt):0,type:(()=>{switch(C.nodeName){case"polygon":return E.$.POLYGON;case"circle":return E.$.CIRCLE;case"ellipse":return E.$.ELLIPSE;case"line":return E.$.LINE;case"rect":return E.$.RECT;case"foreignObject":return E.$.FOREIGNOBJECT}return 0})(),size:(X=>{let Et=0,kt=0,Ht=0,wt=0,re=null,Q=null,D=parseFloat((null===(X=C.getAttribute("transform"))||void 0===X?void 0:X.replace("rotate(","").replace(")",""))||"0")||null;switch(C.nodeName){case"polygon":{var d,Z;let _t=[],pt=[],St=999999999,Kt=999999999,jt=0,Ot=0;re=JSON.parse(C.getAttribute("ratios")||"[]"),Q=null!==(d=null===(Z=C.getAttribute("points"))||void 0===Z?void 0:Z.split(",").map(function(ht){return ht.split(" ").map(function(Yt){return parseFloat(Yt)})}))&&void 0!==d?d:[],Q.forEach(function(ht){_t.push(ht[0]),pt.push(ht[1])}),St=Math.min.apply(null,_t),Kt=Math.min.apply(null,pt),jt=Math.max.apply(null,_t),Ot=Math.max.apply(null,pt),Et=St,kt=Kt,Ht=jt-Et,wt=Ot-kt;break}case"circle":{let _t=parseFloat(C.getAttribute("cx")||"0"),pt=parseFloat(C.getAttribute("cy")||"0"),St=parseFloat(C.getAttribute("r")||"0");Et=_t-St,kt=pt-St,Ht=2*St,wt=2*St;break}case"ellipse":{let _t=parseFloat(C.getAttribute("cx")||"0"),pt=parseFloat(C.getAttribute("cy")||"0"),St=parseFloat(C.getAttribute("rx")||"0"),Kt=parseFloat(C.getAttribute("ry")||"0");Et=_t-St,kt=pt-Kt,Ht=2*St,wt=2*Kt;break}case"line":{let _t=parseFloat(C.getAttribute("x1")||"0"),pt=parseFloat(C.getAttribute("y1")||"0"),St=parseFloat(C.getAttribute("x2")||"0"),Kt=parseFloat(C.getAttribute("y2")||"0"),jt=999999999,Ot=999999999,ht=0,Yt=0;jt=Math.min(_t,St),Ot=Math.min(pt,Kt),ht=Math.max(_t,St),Yt=Math.max(pt,Kt),Et=jt,kt=Ot,Ht=ht-Et,wt=Yt-kt,re=[[(_t-Et)/(Ht||1),(pt-kt)/(wt||1)],[(St-Et)/(Ht||1),(Kt-kt)/(wt||1)]];break}case"rect":case"foreignObject":Et=parseFloat(C.getAttribute("x")||"0"),kt=parseFloat(C.getAttribute("y")||"0"),Ht=parseFloat(C.getAttribute("width")||"0"),wt=parseFloat(C.getAttribute("height")||"0")}return Object.assign({},{x:Et,y:kt,width:Ht,height:wt,ratios:re,points:Q,rotate:D})})(),attribute:(()=>{let X={};switch(C.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var Et,kt,Ht,wt,re,Q;let D=null!==(Et=C.getAttribute("fill"))&&void 0!==Et?Et:null,d=null!==(kt=C.getAttribute("stroke"))&&void 0!==kt?kt:null,Z=null!==(Ht=parseFloat(C.getAttribute("stroke-width")||"0"))&&void 0!==Ht?Ht:null,_t=null!==(wt=C.getAttribute("stroke-linecap"))&&void 0!==wt?wt:null,pt=null!==(re=C.getAttribute("stroke-linejoin"))&&void 0!==re?re:null,St=null!==(Q=parseFloat(C.getAttribute("stroke-dasharray")||"0"))&&void 0!==Q?Q:null;Object.assign(X,{fill:D,stroke:d,strokeWidth:Z,strokeLinecap:_t,strokeLinejoin:pt,strokeDasharray:St});break}}return X})(),style:(()=>{let X={};switch(C.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let re=jQuery(C).find(".svg-container");if(re.length){var Et,kt;let D=null!==(Et=parseFloat(re.css("border-width")||"0"))&&void 0!==Et?Et:null,d=null!==(kt=re.css("border-style"))&&void 0!==kt?kt:null,Z=re.css("border-color")||null,_t=null,pt=re.css("background-color")||null,St=null;(()=>{let{hex:Kt,alpha:jt}=p(Z);Z=Kt,_t=jt})(),(()=>{let{hex:Kt,alpha:jt}=p(pt);pt=Kt,St=jt})(),Object.assign(X,{borderWidth:D,borderStyle:d,borderColor:Z,borderOpacity:_t,backgroundColor:pt,backgroundOpacity:St})}let Q=jQuery(C).find(".svg-editor-content");if(Q.length){var Ht,wt;let D=JSON.parse((Q.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:d,alpha:Z}=p(D.TextColor);Object.assign(X,{fontFamily:null!==(Ht=D.FontFamily)&&void 0!==Ht?Ht:null,fontSize:null!==(wt=D.FontSize)&&void 0!==wt?wt:null,color:d,opacity:Z})}break}}return X})(),source:(()=>{let X={};switch(C.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(Dt.hasClass("editors")){let Ot=jQuery(C).find(".svg-editor-content");if(Ot.length){var Et;let ht=Ot.html(),Yt=null!==(Et=(null!=ht?ht:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==Et?Et:[];Object.assign(X,{type:"html",html:{htmlContent:ht,variableKeywords:Yt}})}}else if(Dt.hasClass("inputs")||Dt.hasClass("textareas"))Object.assign(X,{type:"input",input:{input:!!jQuery(C).find("input").length,textarea:!!jQuery(C).find("textarea").length}});else if(Dt.hasClass("tests")){let Ot=jQuery(C).find(".svg-test");if(Dt.hasClass("tests-truefalse")){var kt,Ht;let ht=Ot.find(".svg-editor-content").html(),Yt=null!==(kt=(null!=ht?ht:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==kt?kt:[];Object.assign(X,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(Ht=M.test2.truefalse)||void 0===Ht?void 0:Ht.includes(Ft)}},html:{htmlContent:ht,variableKeywords:Yt}})}else if(Dt.hasClass("tests-singlechoice")){var wt,re;let ht=Ot.find(".svg-editor-content").html(),Yt=null!==(wt=(null!=ht?ht:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==wt?wt:[];Object.assign(X,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(re=M.test2.singlechoice)||void 0===re?void 0:re.includes(Ft)}},html:{htmlContent:ht,variableKeywords:Yt}})}else if(Dt.hasClass("tests-multichoice")){var Q,D;let ht=Ot.find(".svg-editor-content").html(),Yt=null!==(Q=(null!=ht?ht:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==Q?Q:[];Object.assign(X,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(D=M.test2.multichoice)||void 0===D?void 0:D.includes(Ft)}},html:{htmlContent:ht,variableKeywords:Yt}})}else if(Dt.hasClass("tests-fill")){var d,Z;let ht=Ot.find(".svg-editor-content").html(),Yt=null!==(d=(null!=ht?ht:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==d?d:[],J=null!==(Z=(null!=ht?ht:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==Z?Z:[];J=J.filter((c,U,H)=>H.indexOf(c)==U),Object.assign(X,{type:"test",test:{type:"fill",fill:J.map(c=>{var U;return{key:c,value:null===(U=M.test2.fill)||void 0===U||null===(U=U.find(H=>H.id==Ft))||void 0===U||null===(U=U.vals)||void 0===U?void 0:U.map(H=>H.text).filter(H=>!["",null,void 0,NaN].includes(H))}})},html:{htmlContent:ht,variableKeywords:Yt,fillKeywords:J}})}else if(Dt.hasClass("tests-matching")){if(Ot.hasClass("svg-test-empty"))Object.assign(X,{type:"test",test:{type:"matching-empty",matching:{key:Ot.attr("data-name")||null}}});else if(Ot.hasClass("svg-test-content")){var _t;let ht=Ot.find(".svg-editor-content").html(),Yt=null!==(_t=(null!=ht?ht:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==_t?_t:[];Object.assign(X,{type:"test",test:{type:"matching-content",matching:{key:Ot.attr("data-name")||null}},html:{htmlContent:ht,variableKeywords:Yt}})}}else if(Dt.hasClass("tests-speech")){var pt;Object.assign(X,{type:"speech",speech:{value:null===(pt=M.test2.speech)||void 0===pt||null===(pt=pt.find(ht=>ht.id==Ft))||void 0===pt||null===(pt=pt.vals)||void 0===pt?void 0:pt.map(ht=>ht.text).filter(ht=>!["",null,void 0,NaN].includes(ht))}})}else if(Dt.hasClass("tests-submit")){let ht=jQuery(C).find(".svg-container img");Object.assign(X,{type:"test",test:{type:"submit"},image:x(ht.attr("url"),ht.attr("path"),ht.attr("src"))})}}else if(Dt.hasClass("images")){let Ot=jQuery(C).find(".svg-editor-content img");if(Ot.length)Object.assign(X,{type:"image",image:x(Ot.attr("url"),Ot.attr("path"),Ot.attr("src"))});else{let ht=jQuery(C).find("iframe");Object.assign(X,{type:"iframe",iframe:x(ht.attr("url"),ht.attr("path"),ht.attr("src"))})}}else if(Dt.hasClass("sounds")){let Ot=jQuery(C).find(".svg-editor-content img");Ot.length&&Object.assign(X,{type:"image",image:x(Ot.attr("url"),Ot.attr("path"),Ot.attr("src"))})}else if(Dt.hasClass("htmls")){let Ot=jQuery(C).find("iframe");Ot.length&&Object.assign(X,{type:"iframe",iframe:x(Ot.attr("url"),Ot.attr("path"),Ot.attr("src"))})}else if(Dt.hasClass("svgs")){let Ot=jQuery(C).find("svg");var St,Kt;Ot.length&&Object.assign(X,{type:"svg",svg:Object.assign(x(Ot.attr("url"),Ot.attr("path"),Ot.attr("src")),{svgContent:null!==(St=null===(Kt=Ot.get(0))||void 0===Kt?void 0:Kt.outerHTML)&&void 0!==St?St:null})})}else if(Dt.hasClass("medias")){let Ot=jQuery(C).find(".media-item");if(Ot.length)switch(Ot.attr("type")){case"audio":Object.assign(X,{type:"audio",audio:x(Ot.attr("url"),Ot.attr("path"),Ot.attr("src"))});break;case"video":Object.assign(X,{type:"video",video:x(Ot.attr("url"),Ot.attr("path"),Ot.attr("src"))});break;case"file":Object.assign(X,{type:"file",file:x(Ot.attr("url"),Ot.attr("path"),Ot.attr("src"))});break;default:var jt;Object.assign(X,{type:"link",link:{url:null!==(jt=Ot.attr("url"))&&void 0!==jt?jt:null}})}let ht=jQuery(C).find("img");ht.length&&(Object.assign(X,{image:x(ht.attr("url"),ht.attr("path"),ht.attr("src"))}),X.type||Object.assign(X,{type:"image"}))}}return X})(),animate:(X=>{let Et={},kt=null===(X=M.animates)||void 0===X?void 0:X.find(Ht=>Ht.elementId==Ft);return kt&&Object.assign(Et,{value:kt.value}),Et})(),interactive:(()=>{let X={},Et=M.actions.show.filter(Ht=>Ht.elementId==Ft&&Ht.active);Et.length&&(X.show={},Et.forEach(Ht=>{let{source:wt}=Ht;switch(null==wt?void 0:wt.type){case"work":var re,Q,D,d,Z;X.show.action={},Object.assign(X.show.action,{value:null!==(re=wt.value)&&void 0!==re?re:null,iteration:null!==(Q=wt.iteration)&&void 0!==Q?Q:null,finish:null!==(D=wt.end)&&void 0!==D?D:null,time:null!==(d=wt.time)&&void 0!==d?d:null,points:null!==(Z=wt.points)&&void 0!==Z?Z:null});break;case"audio":var _t,pt,St;X.show.audio={},Object.assign(X.show.audio,{source:x(null,null,wt.url),iteration:null!==(_t=wt.iteration)&&void 0!==_t?_t:null,finish:null!==(pt=wt.end)&&void 0!==pt?pt:null,time:null!==(St=wt.time)&&void 0!==St?St:null,async:-1==wt.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Kt,jt,Ot,ht,Yt,J,c,U,H,W,R,B,tt,I,V;wt.options.includes("show")&&(X.show.triggershow={},Object.assign(X.show.triggershow,{id:null!==(Kt=parseInt(null!==(jt=wt.id)&&void 0!==jt?jt:"0"))&&void 0!==Kt?Kt:null,ids:null===(Ot=wt.ids)||void 0===Ot?void 0:Ot.map(yt=>parseInt(yt)),async:null!==(ht=wt.async)&&void 0!==ht?ht:null,time:null!==(Yt=wt.time)&&void 0!==Yt?Yt:null})),wt.options.includes("run")&&(X.show.triggerrun={},Object.assign(X.show.triggerrun,{id:null!==(J=parseInt(null!==(c=wt.id)&&void 0!==c?c:"0"))&&void 0!==J?J:null,ids:null===(U=wt.ids)||void 0===U?void 0:U.map(yt=>parseInt(yt)),async:null!==(H=wt.async)&&void 0!==H?H:null,time:null!==(W=wt.time)&&void 0!==W?W:null})),wt.options.includes("hide")&&(X.show.triggerhide={},Object.assign(X.show.triggerhide,{id:null!==(R=parseInt(null!==(B=wt.id)&&void 0!==B?B:"0"))&&void 0!==R?R:null,ids:null===(tt=wt.ids)||void 0===tt?void 0:tt.map(yt=>parseInt(yt)),async:null!==(I=wt.async)&&void 0!==I?I:null,time:null!==(V=wt.time)&&void 0!==V?V:null}))}}));let kt=M.actions.click.filter(Ht=>Ht.elementId==Ft&&Ht.active);return kt&&(X.click={},kt.forEach(Ht=>{let{source:wt}=Ht;switch(null==wt?void 0:wt.type){case"work":var re,Q,D,d,Z;X.click.action={},Object.assign(X.click.action,{value:null!==(re=wt.value)&&void 0!==re?re:null,iteration:null!==(Q=wt.iteration)&&void 0!==Q?Q:null,finish:null!==(D=wt.end)&&void 0!==D?D:null,time:null!==(d=wt.time)&&void 0!==d?d:null,points:null!==(Z=wt.points)&&void 0!==Z?Z:null});break;case"audio":var _t,pt,St;X.click.audio={},Object.assign(X.click.audio,{source:x(null,null,wt.url),iteration:null!==(_t=wt.iteration)&&void 0!==_t?_t:null,finish:null!==(pt=wt.end)&&void 0!==pt?pt:null,time:null!==(St=wt.time)&&void 0!==St?St:null,async:-1==wt.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Kt,jt,Ot,ht,Yt,J,c,U,H,W,R,B,tt,I,V;wt.options.includes("show")&&(X.click.triggershow={},Object.assign(X.click.triggershow,{id:null!==(Kt=parseInt(null!==(jt=wt.id)&&void 0!==jt?jt:"0"))&&void 0!==Kt?Kt:null,ids:null===(Ot=wt.ids)||void 0===Ot?void 0:Ot.map(It=>parseInt(It)),async:null!==(ht=wt.async)&&void 0!==ht?ht:null,time:null!==(Yt=wt.time)&&void 0!==Yt?Yt:null})),wt.options.includes("run")&&(X.click.triggerrun={},Object.assign(X.click.triggerrun,{id:null!==(J=parseInt(null!==(c=wt.id)&&void 0!==c?c:"0"))&&void 0!==J?J:null,ids:null===(U=wt.ids)||void 0===U?void 0:U.map(It=>parseInt(It)),async:null!==(H=wt.async)&&void 0!==H?H:null,time:null!==(W=wt.time)&&void 0!==W?W:null})),wt.options.includes("hide")&&(X.click.triggerhide={},Object.assign(X.click.triggerhide,{id:null!==(R=parseInt(null!==(B=wt.id)&&void 0!==B?B:"0"))&&void 0!==R?R:null,ids:null===(tt=wt.ids)||void 0===tt?void 0:tt.map(It=>parseInt(It)),async:null!==(I=wt.async)&&void 0!==I?I:null,time:null!==(V=wt.time)&&void 0!==V?V:null}));break;case"slide":var yt;X.click.slide={},Object.assign(X.click.slide,{id:parseInt(null!==(yt=wt.id)&&void 0!==yt?yt:"0")||wt.num||null,code:wt.id})}})),X})(),variable:(X=>{let Et={};var kt;C.getAttribute("data-variable")&&(Et.input={},Object.assign(Et.input,{variable:null!==(kt=C.getAttribute("data-variable"))&&void 0!==kt?kt:null}));let Ht=null===(X=M.nodes)||void 0===X||null===(X=X.find(d=>d.id==Ft))||void 0===X?void 0:X.variable;var wt,re,Q,D;return Ht&&(Et.click={},Object.assign(Et.click,{variable:null!==(wt=Ht.variable)&&void 0!==wt?wt:null,operator:null!==(re=Ht.operator)&&void 0!==re?re:null,valuetype:null!==(Q=Ht.valuetype)&&void 0!==Q?Q:null,value:null!==(D=Ht.value)&&void 0!==D?D:null})),Et})()};null===(Bt=ft.svg)||void 0===Bt||Bt.nodes.push(ut)}),rt.push(ft)}),console.log(rt),{screen:{width:N.screen.w,height:N.screen.h},data:{slides:rt},variable:N.variable}}},644:(le,At,f)=>{f.d(At,{Dx:()=>h,aY:()=>O,qp:()=>k,qz:()=>it,sV:()=>p,yR:()=>m});var z=f(5861),E=f(9422);E.config({driver:[E.INDEXEDDB,E.LOCALSTORAGE,E.WEBSQL],name:"_localDataDB",version:1});const P={create:(S=(0,z.Z)(function*(){return E}),function(){return S.apply(this,arguments)}),get:function(){var S=(0,z.Z)(function*(x){return E.getItem(x)});return function(nt){return S.apply(this,arguments)}}(),set:function(){var S=(0,z.Z)(function*(x,nt){return E.setItem(x,nt)});return function(nt,N){return S.apply(this,arguments)}}()},it=function(){var S=(0,z.Z)(function*(x){yield P.create();var nt=(yield P.get("icdt-data"))||[];"function"==typeof x.callback&&x.callback(nt)});return function(nt){return S.apply(this,arguments)}}(),h=function(){var S=(0,z.Z)(function*(x){yield P.create(),x.params=x.params||{};try{yield P.set("icdt-data",x.params),"function"==typeof x.callback&&x.callback(x.params)}catch(nt){"function"==typeof x.callback&&x.callback(null),console.error(nt)}});return function(nt){return S.apply(this,arguments)}}(),p=function(){var S=(0,z.Z)(function*(x){yield P.create();try{var nt=(yield P.get("icdt-config"))||{};"function"==typeof x.callback&&x.callback(nt)}catch(N){"function"==typeof x.callback&&x.callback(null),console.error(N)}});return function(nt){return S.apply(this,arguments)}}(),k=function(){var S=(0,z.Z)(function*(x){yield P.create(),x.params=x.params||{};try{yield P.set("icdt-config",x.params),"function"==typeof x.callback&&x.callback(x.params)}catch(nt){"function"==typeof x.callback&&x.callback(null),console.error(nt)}});return function(nt){return S.apply(this,arguments)}}(),O=function(){var S=(0,z.Z)(function*(x){yield P.create();try{var nt=(yield P.get("icdt-clipboard"))||{};"function"==typeof x.callback&&x.callback(nt)}catch(N){"function"==typeof x.callback&&x.callback(null),console.error(N)}});return function(nt){return S.apply(this,arguments)}}(),m=function(){var S=(0,z.Z)(function*(x){yield P.create(),x.params=x.params||{};try{yield P.set("icdt-clipboard",x.params),"function"==typeof x.callback&&x.callback(x.params)}catch(nt){"function"==typeof x.callback&&x.callback(null),console.error(nt)}});return function(nt){return S.apply(this,arguments)}}();var S},1687:(le,At,f)=>{f.d(At,{O:()=>z});const z={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"}},9125:(le,At,f)=>{f.d(At,{D:()=>z});const z={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3}},968:(le,At,f)=>{f.d(At,{_:()=>z});const z={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8}},4714:(le,At,f)=>{f.d(At,{D:()=>z});const z={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306}},9054:(le,At,f)=>{f.d(At,{$:()=>z});const z={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,PATH:8}},4981:(le,At,f)=>{f.d(At,{icdt:()=>xt});var z=f(968),E=f(4080),dt=f(1687),P=f(9054),it=f(4318),h=f(6816),p=f(666),k=f(2966);const S=A=>{var i,n,r,a,o;let y=(null===(i=A.mouseEvent)||void 0===i?void 0:i.target)||(null===(n=A.touchEvent)||void 0===n?void 0:n.target),g=(null==y?void 0:y.getAttribute("id"))||"",v=null==y?void 0:y.nodeName,T=(null==y||null===(r=y.parentNode)||void 0===r?void 0:r.getAttribute("id"))||"";var _,K;if([dt.O.RESIZE_GROUP,dt.O.SELECT_GROUP].includes(T))return null===(_=A.mouseEvent)||void 0===_||_.stopPropagation(),void(null===(K=A.mouseEvent)||void 0===K||K.preventDefault());if(null!==(a=A.mouseEvent)&&void 0!==a&&a.altKey||null!==(o=A.touchEvent)&&void 0!==o&&o.altKey||!g||g.match(/[^0-9]/)||!xt.dataSelect.nodeName.includes(v)){var G;xt.dataSelect.ids.length&&(xt.dataSelect.ids=[]),(0==(null===(G=A.mouseEvent)||void 0===G?void 0:G.button)||A.touchEvent)&&(A=>{let o=(0,E.g1)(dt.O.SCAN_GROUP,"g"),y=(0,it.bH)(0,0,1,1);(0,E.vl)(o,y),((A,i,n)=>{(0,h.A)(A,{start:o=>{},move:(o,y)=>{((o,y,g,v)=>{i=(0,it.bH)(o,y,g,v),(0,E.vl)(n,i)})(y[0][0],y[0][1],o.x,o.y)},end:(o,y)=>{null==n||n.remove(),xt.dataSelect.ids=xt.data.getNodeInArea(Math.min(y[0][0],o.x),Math.min(y[0][1],o.y),Math.max(y[0][0],o.x),Math.max(y[0][1],o.y));let g=xt.dataSelect.nodes;1==g.length?(0,p.y)(g[0]):g.length>1&&(0,k.Q)(g)}})})(A,y,o)})(A)}else{var at,ct;let ot=parseFloat(g||"0");xt.dataSelect.ids=null!==(at=A.mouseEvent)&&void 0!==at&&at.shiftKey||null!==(ct=A.touchEvent)&&void 0!==ct&&ct.shiftKey?[ot].concat(xt.dataSelect.ids).filter((oe,he,ge)=>ge.indexOf(oe)==he):[ot];let Gt=xt.dataSelect.nodes;Gt.length>1||1==Gt.length&&Gt[0].type==P.$.PATH?(0,k.Q)(Gt):1==Gt.length&&(0,p.y)(Gt[0])}};class nt{constructor(){let{x:i,y:n}=xt.screen.dislocation;var r=(a,o,y,g)=>{xt.screen.move({x:i,y:n},{x:y-a,y:g-o})};return{start:a=>{},move:(a,o)=>{r(o[0][0],o[0][1],a.x,a.y)},end:(a,o)=>{r(o[0][0],o[0][1],a.x,a.y)}}}}var N=f(4714);const F=[{name:"tam gi\xe1c vu\xf4ng",type:N.D.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:N.D.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:N.D.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:N.D.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:N.D.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:N.D.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:N.D.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:N.D.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:N.D.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:N.D.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:N.D.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:N.D.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:N.D.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}];var rt=f(8619),M=f(5811);class q{constructor(){let i=(0,E.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,rt._)(Math.ceil(1e9*Math.random())),y=(g,v,T,_)=>{o=(0,it.bH)(g,v,T,_,{ratio:1}),o.x=(0,M.q)(o.x),o.y=(0,M.q)(o.y),o.width=(0,M.q)(o.width),o.height=(0,M.q)(o.height),Object.assign(a,(0,it.sg)(P.$.CIRCLE,o)),(0,E.__)(r,a),(0,E.g$)(i,o)};return{start:g=>{r.setAttribute("cx",g.x.toString()),r.setAttribute("cy",g.y.toString()),r.setAttribute("r","1")},move:(g,v)=>{y(v[0][0],v[0][1],g.x,g.y)},end:(g,v)=>{y(v[0][0],v[0][1],g.x,g.y),xt.data.node=Object.assign({id:n,type:P.$.CIRCLE,name:"Circle"},{size:o,attribute:a}),null==i||i.remove()}}}}var vt=f(8785);class gt{constructor(){let i=(0,E.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,vt.r)(Math.ceil(1e9*Math.random()));var y=(g,v,T,_)=>{o=(0,it.bH)(g,v,T,_),o.x=(0,M.q)(o.x),o.y=(0,M.q)(o.y),o.width=(0,M.q)(o.width),o.height=(0,M.q)(o.height),Object.assign(a,(0,it.sg)(P.$.ELLIPSE,o)),(0,E.__)(r,a),(0,E.g$)(i,o)};return{start:g=>{r.setAttribute("cx",g.x.toString()),r.setAttribute("cy",g.y.toString()),r.setAttribute("rx","1"),r.setAttribute("ry","1")},move:(g,v)=>{y(v[0][0],v[0][1],g.x,g.y)},end:(g,v)=>{y(v[0][0],v[0][1],g.x,g.y),xt.data.node=Object.assign({id:n,type:P.$.ELLIPSE,name:"Ellipse"},{size:o,attribute:a}),null==i||i.remove()}}}}var ft=f(8054);class Y{constructor(){let i=(0,E.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,ft.f)(Math.ceil(1e9*Math.random()));var y=(g,v,T,_)=>{o=(0,it.bH)(g,v,T,_),o.x=(0,M.q)(o.x),o.y=(0,M.q)(o.y),o.width=(0,M.q)(o.width),o.height=(0,M.q)(o.height),Object.assign(a,(0,it.sg)(P.$.RECT,o)),(0,E.__)(r,a),(0,E.g$)(i,o)};return{start:g=>{y(g.x,g.y,g.x+o.width,g.y+o.height)},move:(g,v)=>{y(v[0][0],v[0][1],g.x,g.y)},end:(g,v)=>{o.width>=10&&o.height>=10?xt.data.node=Object.assign({id:n,type:P.$.RECT,name:"Rect"},{size:o,attribute:a}):null==r||r.remove(),null==i||i.remove()}}}}var C=f(2282);class Lt{constructor(i){let n=(0,E.g1)(dt.O.CREATE_GROUP,"g"),r=i||[[0,0],[1,1],[0,1]],{nodeId:a,element:o,attribute:y,size:g}=(0,C.l)(Math.ceil(1e9*Math.random()));g.ratios=r;var v=(T,_,K,G)=>{g=(0,it.bH)(T,_,K,G,{ratios:r}),g.x=(0,M.q)(g.x),g.y=(0,M.q)(g.y),g.width=(0,M.q)(g.width),g.height=(0,M.q)(g.height),Object.assign(y,(0,it.sg)(P.$.POLYGON,g)),(0,E.__)(o,y),(0,E.g$)(n,g)};return{start:T=>{},move:(T,_)=>{v(_[0][0],_[0][1],T.x,T.y)},end:(T,_)=>{v(_[0][0],_[0][1],T.x,T.y),xt.data.node=Object.assign({id:a,type:P.$.POLYGON,name:"Polygon"},{size:g,attribute:y}),null==n||n.remove()}}}}var Bt=f(4921);class Dt{constructor(){let i=(0,E.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,Bt.W)(Math.ceil(1e9*Math.random()));var y=(g,v,T,_)=>{o=(0,it.bH)(g,v,T,_),o.x=(0,M.q)(o.x),o.y=(0,M.q)(o.y),o.width=(0,M.q)(o.width),o.height=(0,M.q)(o.height),Object.assign(a,(0,it.sg)(P.$.LINE,o)),(0,E.__)(r,a),(0,E.g$)(i,o)};return{start:g=>{},move:(g,v)=>{y(v[0][0],v[0][1],g.x,g.y)},end:(g,v)=>{y(v[0][0],v[0][1],g.x,g.y),xt.data.node=Object.assign({id:n,type:P.$.LINE,name:"Line"},{size:o,attribute:a}),null==i||i.remove()}}}}var ae=f(8419);class Tt{constructor(){let{nodeId:i,element:n,attribute:r,size:a}=(0,ae.G)(Math.ceil(1e9*Math.random())),y="";var g=(v,T)=>{y+=` ${v} ${T}`,n.setAttribute("d",y)};return{start:v=>{y=`M ${v.x} ${v.y} L ${v.x} ${v.y}`},move:(v,T)=>{g(v.x,v.y)},end:(v,T)=>{g(v.x,v.y),(v=>{let T=9999,_=9999,K=-9999,G=-9999;v.forEach(at=>{T=Math.min(T,at[0]),_=Math.min(_,at[1]),K=Math.max(K,at[0]),G=Math.max(G,at[1])}),a=(0,it.bH)(T,_,K,G,{points:v}),Object.assign(r,(0,it.sg)(P.$.PATH,a)),(0,E.__)(n,r)})(T),xt.data.node=Object.assign({id:i,type:P.$.PATH,name:"Path"},{size:a,attribute:r})}}}}var Ft=f(2875);class ut{constructor(){let i=(0,E.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,size:a,attribute:o,style:y,source:g}=(0,Ft.e)(Math.ceil(1e9*Math.random()));var v=(T,_,K,G)=>{a=(0,it.bH)(T,_,K,G),a.x=(0,M.q)(a.x),a.y=(0,M.q)(a.y),a.width=(0,M.q)(a.width),a.height=(0,M.q)(a.height),Object.assign(o,(0,it.sg)(P.$.FOREIGNOBJECT,a)),(0,E.__)(r,o),(0,E.g$)(i,a)};return{start:T=>{v(T.x,T.y,T.x+a.width,T.y+a.height)},move:(T,_)=>{v(_[0][0],_[0][1],T.x,T.y)},end:(T,_)=>{a.width>=10&&a.height>=10?xt.data.node=Object.assign({id:n,type:P.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:y,source:g}):null==r||r.remove(),null==i||i.remove()}}}}var X=f(7210);class Et{constructor(){var i,n;let r=(0,E.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:a,element:o,size:y,attribute:g,source:v}=(0,X.G)(Math.ceil(1e9*Math.random())),T=1;(K=>{if(!K)return;let G=new Image;G.onload=()=>{T=(0,M.q)(G.naturalWidth/G.naturalHeight,100)},G.onerror=at=>{console.error(`ImgSrc load failed -> ${K}`,at)},G.src=K})(null!==(i=null===(n=v.image)||void 0===n?void 0:n.url)&&void 0!==i?i:"");var _=(K,G,at,ct)=>{y=(0,it.bH)(K,G,at,ct,{ratio:T}),y.x=(0,M.q)(y.x),y.y=(0,M.q)(y.y),y.width=(0,M.q)(y.width),y.height=(0,M.q)(y.height),Object.assign(g,(0,it.sg)(P.$.IMAGE,y)),(0,E.__)(o,g),(0,E.g$)(r,y)};return{start:K=>{_(K.x,K.y,K.x+y.width,K.y+y.height)},move:(K,G)=>{_(G[0][0],G[0][1],K.x,K.y)},end:(K,G)=>{y.width>=10&&y.height>=10?xt.data.node=Object.assign({id:a,type:P.$.IMAGE,name:"Image"},{size:y,attribute:g,source:v}):null==o||o.remove(),null==r||r.remove()}}}}var Ht=f(4578),wt=f(9623);function D(A,i,n,r){return Math.sqrt(Math.pow(n-A,2)+Math.pow(r-i,2))}function d(A,i,n,r,a){return D(A,i,n,r)<a?1:0}function _t(A,i,n,r,a,o,y){var g=[];return g.push(d(A,i,n,r,y)),g.push(d(A,i,a,o,y)),g.push(function Z(A,i,n,r,a,o,y){var g=[a-n,o-r],v=[A-n,i-r],T=[-g[1],g[0]],_=Math.sqrt(Math.pow(T[0],2)+Math.pow(T[1],2)),K=[T[0]/_,T[1]/_],G=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),at=[g[0]/G,g[1]/G],ct=v[0]*at[0]+v[1]*at[1];if(ct<=0||ct>=G)return 0;var ot=v[0]*K[0]+v[1]*K[1];return ot>=y||ot<=-y?0:1}(A,i,n,r,a,o,y)),g}function pt(A,i,n,r,a){var o=[n-A,r-i],y=[-o[1],o[0]],g=Math.sqrt(Math.pow(y[0],2)+Math.pow(y[1],2)),v=[y[0]/g,y[1]/g];return[[A+a*v[0],i+a*v[1]],[A-a*v[0],i-a*v[1]],[n-a*v[0],r-a*v[1]],[n+a*v[0],r+a*v[1]]]}function St(A,i,n,r,a,o,y){var ct,g=[a-A,o-i],v=[n-A,r-i],T=Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2)),_=[v[0]/T,v[1]/T],K=g[0]*_[0]+g[1]*_[1],G=[A+K*_[0],i+K*_[1]],at=Math.sqrt(Math.pow(a-G[0],2)+Math.pow(o-G[1],2));ct=0===at?y:Math.sqrt(Math.pow(y,2)-Math.pow(at,2));var ot=[A+K*_[0]+ct*_[0],i+K*_[1]+ct*_[1]];return ot[0]===A&&ot[1]===i?null:ot}function Kt(A,i,n,r,a,o,y){var g=[a-A,o-i],v=[n-A,r-i],T=[-v[1],v[0]],_=Math.sqrt(Math.pow(T[0],2)+Math.pow(T[1],2)),K=[T[0]/_,T[1]/_],G=g[0]*K[0]+g[1]*K[1],at=c([A,i],[n,r],[a,o]);if(Yt([at[0]-a,at[1]-o])>=y)return null;var ot=Math.sqrt(Math.pow(y,2)-Math.pow(G,2)),Gt=[a-G*K[0],o-G*K[1]],oe=Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2)),he=[v[0]/oe,v[1]/oe],ge=[[Gt[0]-he[0]*ot,Gt[1]-he[1]*ot],[Gt[0]+he[0]*ot,Gt[1]+he[1]*ot]];return ge[0][0]===A&&ge[0][1]===i?null:ge}function jt(A,i,n,r,a,o,y,g){var v,T,_,K,G,at;return-(_=y-a)*(T=r-i)+(v=n-A)*(K=g-o)==0?null:(at=(_*(i-o)-K*(A-a))/(-_*T+v*K),(G=(-T*(A-a)+v*(i-o))/(-_*T+v*K))>=0&&G<=1&&at>=0&&at<=1?[A+at*v,i+at*T]:null)}function Ot(A,i,n,r,a,o,y,g,v,T){var _=pt(o,y,g,v,T),K=[];if(n[0]&&!n[1])K.push(St(A,i,r,a,o,y,T)),K.push(jt(A,i,r,a,_[0][0],_[0][1],_[3][0],_[3][1])),K.push(jt(A,i,r,a,_[1][0],_[1][1],_[2][0],_[2][1])),(G=Kt(A,i,r,a,g,v,T))&&K.push(G[0],G[1]);else if(!n[0]&&n[1])K.push(St(A,i,r,a,g,v,T)),K.push(jt(A,i,r,a,_[0][0],_[0][1],_[3][0],_[3][1])),K.push(jt(A,i,r,a,_[1][0],_[1][1],_[2][0],_[2][1])),(G=Kt(A,i,r,a,o,y,T))&&K.push(G[0],G[1]);else if(n[0]&&n[1])K.push(St(A,i,r,a,o,y,T)),K.push(jt(A,i,r,a,_[0][0],_[0][1],_[3][0],_[3][1])),K.push(jt(A,i,r,a,_[1][0],_[1][1],_[2][0],_[2][1])),K.push(St(A,i,r,a,g,v,T));else{var G=Kt(A,i,r,a,g,v,T),at=Kt(A,i,r,a,o,y,T);G&&K.push(G[0],G[1]),at&&K.push(at[0],at[1]),K.push(jt(A,i,r,a,_[0][0],_[0][1],_[3][0],_[3][1])),K.push(jt(A,i,r,a,_[1][0],_[1][1],_[2][0],_[2][1]))}for(var ct=[A,i],ot=0;ot<K.length;ot++)K[ot]&&D(K[ot][0],K[ot][1],r,a)<D(ct[0],ct[1],r,a)&&(ct=K[ot]);return ct[0]===A&&ct[1]===i?null:ct}function ht(A,i,n,r,a,o,y,g,v){var T=pt(a,o,y,g,v),_=[],K=Kt(A,i,n,r,a,o,v);K&&_.push(K[0],K[1]),(K=Kt(A,i,n,r,y,g,v))&&_.push(K[0],K[1]),_.push(jt(A,i,n,r,T[0][0],T[0][1],T[3][0],T[3][1])),_.push(jt(A,i,n,r,T[1][0],T[1][1],T[2][0],T[2][1]));for(var G=[n,r],at=[A,i],ct=0;ct<_.length;ct++)_[ct]&&D(_[ct][0],_[ct][1],A,i)<D(G[0],G[1],A,i)&&(G=_[ct]);for(var ot=0;ot<_.length;ot++)_[ot]&&D(_[ot][0],_[ot][1],n,r)<D(at[0],at[1],n,r)&&(at=_[ot]);return G[0]===n&&G[1]===r||at[0]===A&&at[1]===i?null:[G,at]}var Yt=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])},c=function(A,i,n){var r=[i[0]-A[0],i[1]-A[1]],a=Yt(r);if(a<1e-6)return A;var o=[n[0]-A[0],n[1]-A[1]],y=(r[0]*o[0]+r[1]*o[1])/a;return y<0?A:y>a?i:[A[0]+r[0]*y/a,A[1]+r[1]*y/a]};class U{constructor(){let{element:r,size:o}=(0,ae.G)(Math.ceil(1e9*Math.random()));(0,E.__)(r,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let y="";return{start:T=>{y=`M ${T.x} ${T.y} L ${T.x} ${T.y}`},move:(T,_)=>{((T,_)=>{y+=` ${T} ${_}`,r.setAttribute("d",y)})(T.x,T.y)},end:(T,_)=>{r.remove(),(T=>{let _=9999,K=9999,G=-9999,at=-9999;T.forEach(ot=>{_=Math.min(_,ot[0]),K=Math.min(K,ot[1]),G=Math.max(G,ot[0]),at=Math.max(at,ot[1])}),o=(0,it.bH)(_,K,G,at,{points:T}),xt.data.getNodeInArea(0,0,1920,1920,P.$.PATH).forEach(ot=>{let oe=((A,i,n)=>{n=n||20;var r=[],a=function(_){var K=i[0][0],G=i[0][1],at=0,ct=0;if(1!==_.length||d(_[0][0],_[0][1],K,G,n)){for(var ot;at<_.length-1;){var Gt=_[at],oe=_[at+1],he=d(Gt[0],Gt[1],K,G,n),ge=d(oe[0],oe[1],K,G,n);if(he&&ge)ct=++at;else if(he&&!ge)(we=St(Gt[0],Gt[1],oe[0],oe[1],K,G,n))?(_[at]=we,ct=at):at++;else if(!he&&ge){var we;(we=St(oe[0],oe[1],Gt[0],Gt[1],K,G,n))&&((ot=_.slice(ct,at+1)).push(we),r.push(ot)),ct=++at}else{var ye=Kt(Gt[0],Gt[1],oe[0],oe[1],K,G,n);ye?(((ot=_.slice(ct,at+1))[ot.length-1][0]!==ye[0][0]||ot[ot.length-1][1]!==ye[0][1])&&ot.push(ye[0]),ot.length>1&&r.push(ot),_[at]=ye[1],_[at+1]&&_[at+1][0]==ye[1][0]&&_[at+1][1]==ye[1][1]&&at++,ct=at):at++}}ct!==at&&(ot=_.slice(ct,_.length))&&r.push(ot)}else r.push(_)},o=function(_,K){var oe,G=i[K],at=i[K+1],ct=0,ot=0;if(1!==_.length||-1!==(Gt=_t(_[0][0],_[0][1],G[0],G[1],at[0],at[1],n)).indexOf(1)){for(;ct<_.length-1;){var he=_[ct],ge=_[ct+1],Gt=_t(he[0],he[1],G[0],G[1],at[0],at[1],n),we=_t(ge[0],ge[1],G[0],G[1],at[0],at[1],n);if(-1!==Gt.indexOf(1)&&-1!==we.indexOf(1))ot=++ct;else if(-1!==Gt.indexOf(1)&&-1===we.indexOf(1))(ye=Ot(he[0],he[1],Gt,ge[0],ge[1],G[0],G[1],at[0],at[1],n))?(_[ct]=ye,ot=ct):ct++;else if(-1===Gt.indexOf(1)&&-1!==we.indexOf(1)){var ye;(ye=Ot(ge[0],ge[1],we,he[0],he[1],G[0],G[1],at[0],at[1],n))?((oe=_.slice(ot,ct+1)).push(ye),r.push(oe),ot=++ct):ct++}else{var Ee=ht(he[0],he[1],ge[0],ge[1],G[0],G[1],at[0],at[1],n);Ee?(((oe=_.slice(ot,ct+1))[oe.length-1][0]!==Ee[0][0]||oe[oe.length-1][1]!==Ee[0][1])&&oe.push(Ee[0]),oe.length>1&&r.push(oe),_[ct]=Ee[1],_[ct+1]&&_[ct+1][0]==Ee[1][0]&&_[ct+1][1]==Ee[1][1]&&ct++,ot=ct):ct++}}ot!==ct&&(oe=_.slice(ot,_.length))&&r.push(oe)}else r.push(_)};if(i=function Q(A){var i=[];if(1===A.length)i=A;else{for(var n=0;n<A.length-1;)(A[n][0]!==A[n+1][0]||A[n][1]!==A[n+1][1])&&i.push(A[n]),n++;0!==A.length&&0===i.length&&i.push(A[0]),(A[A.length-1][0]!==A[i.length-1][0]||A[A.length-1][1]!==A[i.length-1][1])&&i.push(A[n])}return i}(i),1===i.length){for(var y=0;y<A.length;y++)a(A[y]);A=r}else for(var g=0;g<i.length-1;g++){for(y=0;y<A.length;y++)o(A[y],g);A=r,r=[]}for(var v=0;v<A.length;v++)for(var T=0;T<A[v].length;T++)A[v][T][0]=Math.round(A[v][T][0]),A[v][T][1]=Math.round(A[v][T][1]);return A})(xt.data.getNode(ot).size.points,T,2);console.log(oe)})})(_)}}}}var W=f(1105);class R{constructor(){let i=(0,E.g1)(dt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o,source:y}=(0,W.$)(Math.ceil(1e9*Math.random())),g=(v,T,_,K)=>{o=(0,it.bH)(v,T,_,K),o.x=(0,M.q)(o.x),o.y=(0,M.q)(o.y),o.width=(0,M.q)(o.width),o.height=(0,M.q)(o.height),Object.assign(a,(0,it.sg)(P.$.TEXT,o)),(0,E.__)(r,a),(0,E.g$)(i,o)};return{start:v=>{g(v.x,v.y,v.x+o.width,v.y+o.height)},move:(v,T)=>{g(T[0][0],T[0][1],v.x,v.y)},end:(v,T)=>{o.width>=10&&o.height>=10?xt.data.node=Object.assign({id:n,type:P.$.TEXT,name:"Text"},{size:o,attribute:a,source:y}):null==r||r.remove(),null==i||i.remove()}}}}var V=f(4113),yt=f(9125),It=f(7797);var Nt=f(6358);class Zt{constructor(){this._nodeName=["circle","ellipse","line","polygon","rect","text","path","foreignObject","image"],this._selected_Ids=[],this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(i){this._selected_Ids=i,this.change(this.ids)}get nodes(){return this._selected_Ids.map(i=>xt.data.getNode(i)).filter(i=>!i.isfake)}set onchange(i){this._fnChanges.push(i)}change(i){var n,r,a,o,y;null===(n=window.document.getElementById(dt.O.RESIZE_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(dt.O.SELECT_GROUP))||void 0===r||r.remove(),null===(a=window.document.getElementById(dt.O.SCAN_GROUP))||void 0===a||a.remove(),null===(o=window.document.getElementById(dt.O.CREATE_GROUP))||void 0===o||o.remove(),null===(y=window.document.getElementById(dt.O.INTERACTIVE_GROUP))||void 0===y||y.remove(),jQuery('[id^="icdt-temp-"]').remove(),this._fnChanges.forEach(g=>g(i))}deleteNode(){for(let i of this._selected_Ids){let n=xt.data.deleteNode(i);xt.history.push([{type:"delete",from:{id:n},to:{id:n}}])}xt.dataSelect.ids=[]}groupNode(){let i=[];if(xt.dataSelect.ids.length>=2){let n=xt.data.getNode(xt.dataSelect.ids[0]),{nodeId:r,attribute:a,size:o}=(0,Nt.m)(Math.ceil(1e9*Math.random()),void 0,n.pid?window.document.getElementById(n.pid):null);xt.data.node=Object.assign({id:r,type:P.$.GROUP,name:"G"},{size:o,attribute:a});for(let y of xt.dataSelect.ids)i.push(xt.data.addGroup(y,r))}if(i.length){xt.dataSelect.ids=i;let n=xt.dataSelect.nodes;1==n.length?(0,p.y)(n[0]):n.length>1&&(0,k.Q)(n)}}ungroupNode(){let i=[];for(let n of xt.dataSelect.ids)i.push(xt.data.unGroup(n));if(i.length){xt.dataSelect.ids=i;let n=xt.dataSelect.nodes;1==n.length?(0,p.y)(n[0]):n.length>1&&(0,k.Q)(n)}}}var Ut=f(9942);class Xt{createNodeImage(i,n){var r,a,o,y;let{nodeId:v,element:T,size:_,attribute:K,source:G}=(0,X.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},source:{type:"image",image:(0,Ut.I)(i)}});(at=>{if(!at)return;let ct=new Image;ct.onload=()=>{let ot=(0,M.q)(ct.naturalWidth/ct.naturalHeight,100);ot>=1?(_.width=Math.min(ct.naturalWidth,512),_.height=(0,M.q)(_.width/ot,100)):(_.height=Math.min(ct.naturalHeight,512),_.width=(0,M.q)(_.height*ot,100)),_.x=(0,M.q)(_.x+50-_.width/2,100),_.y=(0,M.q)(_.y+50-_.height/2,100),Object.assign(K,(0,it.sg)(P.$.IMAGE,_)),(0,E.__)(T,K),xt.data.node=Object.assign({id:v,type:P.$.IMAGE,name:"Image"},{size:_,attribute:K,source:G})},ct.onerror=ot=>{console.error(`ImgSrc load failed -> ${at}`,ot),null==T||T.remove()},ct.src=at})(null!==(o=null===(y=G.image)||void 0===y?void 0:y.url)&&void 0!==o?o:"")}createNodeIframe(i,n){var r,a;let{nodeId:y,element:g,size:v,attribute:T,style:_,source:K}=(0,Ft.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:(0,Ut.I)(i)}});(G=>{let at=(null===(G=xt.data.slide)||void 0===G||null===(G=G.svg)||void 0===G?void 0:G.viewBox)||{x:0,y:0,width:100,height:100},ct=(0,M.q)(at.width/at.height,100);ct>=1?(v.width=Math.min(at.width,512),v.height=(0,M.q)(v.width/ct,100)):(v.height=Math.min(at.height,512),v.width=(0,M.q)(v.height*ct,100)),v.x=(0,M.q)(v.x+50-v.width/2,100),v.y=(0,M.q)(v.y+50-v.height/2,100),Object.assign(T,(0,it.sg)(P.$.IMAGE,v)),(0,E.__)(g,T),xt.data.node=Object.assign({id:y,type:P.$.FOREIGNOBJECT,name:"ForeignObject"},{size:v,attribute:T,style:_,source:K})})()}createNodeEmbed(i,n){var r,a;let{nodeId:y,element:g,size:v,attribute:T,style:_,source:K}=(0,Ft.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},style:{},source:{type:"embed",embed:Object.assign(i,(0,Ut.I)(i))}});(G=>{let at=(null===(G=xt.data.slide)||void 0===G||null===(G=G.svg)||void 0===G?void 0:G.viewBox)||{x:0,y:0,width:100,height:100},ct=(0,M.q)(at.width/at.height,100);ct>=1?(v.width=Math.min(at.width,512),v.height=(0,M.q)(v.width/ct,100)):(v.height=Math.min(at.height,512),v.width=(0,M.q)(v.height*ct,100)),v.x=(0,M.q)(v.x+50-v.width/2,100),v.y=(0,M.q)(v.y+50-v.height/2,100),Object.assign(T,(0,it.sg)(P.$.IMAGE,v)),(0,E.__)(g,T),xt.data.node=Object.assign({id:y,type:P.$.FOREIGNOBJECT,name:"ForeignObject"},{size:v,attribute:T,style:_,source:K})})()}createNodeMedia(i,n){var r,a,o,y;let{nodeId:v,element:T,size:_,attribute:K,source:G}=(0,X.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},source:{type:"image",image:(0,Ut.I)(i.cover)}}),at={click:{media:i.media}};(ct=>{if(!ct)return;let ot=new Image;ot.onload=()=>{let Gt=(0,M.q)(ot.naturalWidth/ot.naturalHeight,100);Gt>=1?(_.width=Math.min(ot.naturalWidth,512),_.height=(0,M.q)(_.width/Gt,100)):(_.height=Math.min(ot.naturalHeight,512),_.width=(0,M.q)(_.height*Gt,100)),_.x=(0,M.q)(_.x+50-_.width/2,100),_.y=(0,M.q)(_.y+50-_.height/2,100),Object.assign(K,(0,it.sg)(P.$.IMAGE,_)),(0,E.__)(T,K),xt.data.node=Object.assign({id:v,type:P.$.IMAGE,name:"Image"},{size:_,attribute:K,source:G,interactive:at})},ot.onerror=Gt=>{console.error(`ImgSrc load failed -> ${ct}`,Gt),null==T||T.remove()},ot.src=ct})(null!==(o=null===(y=G.image)||void 0===y?void 0:y.url)&&void 0!==o?o:"")}insert(i){var n;if(xt.data.insertSlide(xt.data.slideId,1),i.title){let{nodeId:r,size:a,attribute:o,style:y,source:g}=(0,Ft.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${i.title}</span>`}}});xt.data.node=Object.assign({id:r,type:P.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:y,source:g})}if(i.description){let{nodeId:r,size:a,attribute:o,style:y,source:g}=(0,Ft.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${i.description.replace(/\n/g,"<br/>")}</span>`}}});xt.data.node=Object.assign({id:r,type:P.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:y,source:g})}null!==(n=i.media)&&void 0!==n&&n.prompt&&((()=>{let{nodeId:r,size:a,attribute:o}=(0,ft.f)(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});xt.data.node=Object.assign({id:r,type:P.$.RECT,name:"Rect"},{size:a,attribute:o})})(),(r=>{let{nodeId:a,size:o,attribute:y,style:g,source:v}=(0,Ft.e)(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(r=i.media)||void 0===r?void 0:r.prompt}</i></span>`}}});xt.data.node=Object.assign({id:a,type:P.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:y,style:g,source:v})})())}}var Wt=f(5226);class ie{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:xt.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var i;let n=null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((o,y)=>y==this._slideIdx),r=null==n?void 0:n.svg,a=o=>{let y=[];return o.filter(g=>!g.isdeleted).forEach(g=>{g.type==P.$.GROUP?y=y.concat(a(g.nodes||[])):y.push(g.id)}),y};return a((null==r?void 0:r.nodes)||[])}}get get(){var i;let n=r=>{var a,o;return null===(a=r)||void 0===a||a.filter(y=>y.type==P.$.GROUP).forEach(y=>{var g;y.nodes=n(null===(g=y.nodes)||void 0===g?void 0:g.filter(v=>!v.isdeleted))}),(r=null===(o=r)||void 0===o?void 0:o.filter(y=>{var g,v;return y.type!=P.$.GROUP||(null!==(g=null===(v=y.nodes)||void 0===v?void 0:v.length)&&void 0!==g?g:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(o=>!o.isdeleted)))}),this._dataSource}get getResource(){var i;let n=[];return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a,o,y,g,v,T,_,K;n.push(null===(a=r.svg)||void 0===a||null===(a=a.background)||void 0===a?void 0:a.path),null===(o=r.svg)||void 0===o||o.nodes.forEach(G=>{var at,ct,ot,Gt,oe,he,ge,we,ye,Ee;n.push(null===(at=G.source)||void 0===at||null===(at=at.image)||void 0===at?void 0:at.path),n.push(null===(ct=G.source)||void 0===ct||null===(ct=ct.audio)||void 0===ct?void 0:ct.path),n.push(null===(ot=G.source)||void 0===ot||null===(ot=ot.video)||void 0===ot?void 0:ot.path),n.push(null===(Gt=G.source)||void 0===Gt||null===(Gt=Gt.file)||void 0===Gt?void 0:Gt.path),n.push(null===(oe=G.source)||void 0===oe||null===(oe=oe.iframe)||void 0===oe?void 0:oe.path),n.push(null===(he=G.source)||void 0===he||null===(he=he.track)||void 0===he?void 0:he.path),n.push(null===(ge=G.interactive)||void 0===ge||null===(ge=ge.show)||void 0===ge||null===(ge=ge.audio)||void 0===ge||null===(ge=ge.source)||void 0===ge?void 0:ge.path),n.push(null===(we=G.interactive)||void 0===we||null===(we=we.click)||void 0===we||null===(we=we.audio)||void 0===we||null===(we=we.source)||void 0===we?void 0:we.path),n.push(null===(ye=G.interactive)||void 0===ye||null===(ye=ye.click)||void 0===ye||null===(ye=ye.image)||void 0===ye||null===(ye=ye.source)||void 0===ye?void 0:ye.path),n.push(null===(Ee=G.interactive)||void 0===Ee||null===(Ee=Ee.click)||void 0===Ee||null===(Ee=Ee.video)||void 0===Ee||null===(Ee=Ee.source)||void 0===Ee?void 0:Ee.path)}),n.push(null===(y=r.test)||void 0===y||null===(y=y.audiotrue)||void 0===y?void 0:y.path),n.push(null===(g=r.test)||void 0===g||null===(g=g.audiofalse)||void 0===g?void 0:g.path),n.push(null===(v=r.test)||void 0===v||null===(v=v.effecttrue)||void 0===v?void 0:v.path),n.push(null===(T=r.test)||void 0===T||null===(T=T.effectfalse)||void 0===T?void 0:T.path),n.push(null===(_=r.test)||void 0===_||null===(_=_.icontrue)||void 0===_?void 0:_.path),n.push(null===(K=r.test)||void 0===K||null===(K=K.iconfalse)||void 0===K?void 0:K.path)}),n.filter(r=>r).map(r=>r.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((r,a,o)=>o.indexOf(r)==a)}set set(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,E.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var i;let n=r=>{var a,o;return null===(a=r)||void 0===a||a.filter(y=>y.type==P.$.GROUP).forEach(y=>{var g;y.nodes=n(null===(g=y.nodes)||void 0===g?void 0:g.filter(v=>!v.isdeleted))}),(r=null===(o=r)||void 0===o?void 0:o.filter(y=>{var g,v;return y.type!=P.$.GROUP||(null!==(g=null===(v=y.nodes)||void 0===v?void 0:v.length)&&void 0!==g?g:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(o=>!o.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,E.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var i,n;return null!==(i=null===(n=this.slide)||void 0===n?void 0:n.id)&&void 0!==i?i:0}get slideIdx(){return this._slideIdx}get slide(){var i;return null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((n,r)=>r==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var i,n;this._slideIdx<(null!==(i=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==i?i:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}refreshSlide(){(0,E.wM)(),(0,Wt.E)(this.slide)}openSlide(i,n){var r,a,o,y;if(i)for(let K=0,G=null!==(g=null===(v=this._dataSource.slides)||void 0===v?void 0:v.length)&&void 0!==g?g:0;K<G;K++){var g,v,T;if((null!==(T=this._dataSource.slides)&&void 0!==T?T:[])[K].id==i){this._slideIdx=K;break}}else if(n&&n>=0&&n<(null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.length)&&void 0!==r?r:0))this._slideIdx=null!=n?n:0;else{var _;this._slideIdx=0,null!==(_=this._dataSource.slides)&&void 0!==_&&_.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}(0,E.wM)(),(0,Wt.E)(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(o=null===(y=this._dataSource.slides)||void 0===y?void 0:y.length)&&void 0!==o?o:0,this.slide)}addSlide(){var i,n,r;null===(i=this._dataSource.slides)||void 0===i||i.push(this._defaultSlide),this._slideIdx=(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1,this.openSlide(void 0,this._slideIdx)}tryReplaceSlide(i,n,r){var a,o,y,g,v;let T=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(K=>K.id==i);if(!r||!T||null!=T&&null!==(o=T.svg)&&void 0!==o&&o.nodes.filter(K=>!K.isdeleted).length)return this.insertSlide(i,n,r);let _=null!==(y=null===(g=this._dataSource.slides)||void 0===g?void 0:g.indexOf(T))&&void 0!==y?y:0;null===(v=this._dataSource.slides)||void 0===v||v.splice(_,1,r),this._slideIdx=_,this.openSlide(void 0,this._slideIdx)}insertSlide(i,n,r){var a,o,y,g,v;let T=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(G=>G.id==i))&&void 0!==a?a:this._defaultSlide,_=(null!==(y=null===(g=this._dataSource.slides)||void 0===g?void 0:g.indexOf(T))&&void 0!==y?y:0)+n;var K;r?(r.id=this.newSlideId,r.code=void 0,r.name||(r.name="Trang m\u1edbi"),null!==(K=r.svg)&&void 0!==K&&K.viewBox||r.svg&&(r.svg.viewBox=xt.screen.frameSize)):r=this._defaultSlide,null===(v=this._dataSource.slides)||void 0===v||v.splice(_,0,r),this._slideIdx=_,this.openSlide(void 0,this._slideIdx)}copySlide(i){var n,r,a,o,y,g,v;let T=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(G=>G.id==i))&&void 0!==n?n:this._defaultSlide,_=(null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(T))&&void 0!==a?a:0)+1,K=Object.assign(JSON.parse(JSON.stringify(T)),{id:this.newSlideId,code:void 0,name:`${T.name} + (Copy)`});null===(y=this._dataSource.slides)||void 0===y||y.splice(_,0,K),this.changeSlide(this.slides,this.slideIdx,null!==(g=null===(v=this._dataSource.slides)||void 0===v?void 0:v.length)&&void 0!==g?g:0,this.slide)}moveSlide(i,n){var r,a,o,y,g,v;let T=null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(K=>K.id==i))&&void 0!==r?r:this._defaultSlide,_=null!==(o=null===(y=this._dataSource.slides)||void 0===y?void 0:y.indexOf(T))&&void 0!==o?o:0;null===(g=this._dataSource.slides)||void 0===g||g.splice(_+n,0,null===(v=this._dataSource.slides)||void 0===v?void 0:v.splice(_,1)[0])}deleteSlide(i){var n,r,a,o,y,g;let v=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(G=>G.id==i))&&void 0!==n?n:this._defaultSlide,T=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(v))&&void 0!==a?a:0;if(null===(y=this._dataSource.slides)||void 0===y||y.splice(T,1),null!==(g=this._dataSource.slides)&&void 0!==g&&g.length)if(T<this._slideIdx){var _,K;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(_=null===(K=this._dataSource.slides)||void 0===K?void 0:K.length)&&void 0!==_?_:0,this.slide)}else T==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(i){var n,r,a,o,y;let g=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(T=>T.id==i))&&void 0!==n?n:this._defaultSlide,v=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(g))&&void 0!==a?a:0;if(g.isdeleted=!0,null!==(y=this._dataSource.slides)&&void 0!==y&&null!==(y=y.filter(T=>!T.isdeleted))&&void 0!==y&&y.length){let T=!0;for(;g.isdeleted;)T?v++:v--,this._dataSource.slides[v]?g=this._dataSource.slides[v]:T=!T;this.openSlide(g.id)}else this.addSlide()}set onChangeSlide(i){this._fnChangeSlides.push(i)}changeSlide(i,n,r,a){this._fnChangeSlides.forEach(o=>o(i,n,r,a))}set node(i){var n,r;let a=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((y,g)=>g==this._slideIdx),o=null==a?void 0:a.svg;null!=o&&o.nodes&&(null==o||o.nodes.push(i)),xt.history.push([{type:"add",from:{id:i.id},to:{id:i.id}}]),(0,Wt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id)}findNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((G,at)=>at==this._slideIdx),a=null==r?void 0:r.svg,o=(G,at)=>{let ct=null==G?void 0:G.find(oe=>oe.id==i);if(ct)return ct.pid=at,ct;let ot=0,Gt=G.length||0;for(;ot<Gt&&!ct&&(ct=o(G[ot].nodes||[],G[ot].id),!ct);)ot++;return ct},y=o((null==a?void 0:a.nodes)||[]);var g,v,T,_,K;return y?(y.style=null!==(g=y.style)&&void 0!==g?g:{},y.source=null!==(v=y.source)&&void 0!==v?v:{},y.animate=null!==(T=y.animate)&&void 0!==T?T:{},y.interactive=null!==(_=y.interactive)&&void 0!==_?_:{},y.variable=null!==(K=y.variable)&&void 0!==K?K:{},y):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((g,v)=>v==this._slideIdx),a=null==r?void 0:r.svg,y=g=>{let v=(null==g?void 0:g.find(ct=>ct.id==i))||(g=>{let v=null,T=0,_=g.length||0;for(;T<_&&!v;){if(v=y(g[T].nodes),v){v.pid=g[T].id;break}T++}var K,G,at,ct,ot;return v&&(v.style=null!==(K=v.style)&&void 0!==K?K:{},v.source=null!==(G=v.source)&&void 0!==G?G:{},v.animate=null!==(at=v.animate)&&void 0!==at?at:{},v.interactive=null!==(ct=v.interactive)&&void 0!==ct?ct:{},v.variable=null!==(ot=v.variable)&&void 0!==ot?ot:{}),v})((null==g?void 0:g.filter(ct=>ct.type==P.$.GROUP))||[]);var T,_,K,G,at;return v&&(v.style=null!==(T=v.style)&&void 0!==T?T:{},v.source=null!==(_=v.source)&&void 0!==_?_:{},v.animate=null!==(K=v.animate)&&void 0!==K?K:{},v.interactive=null!==(G=v.interactive)&&void 0!==G?G:{},v.variable=null!==(at=v.variable)&&void 0!==at?at:{}),v};return y((null==a?void 0:a.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(i,n,r,a,o){var y;let g=null===(y=this._dataSource.slides)||void 0===y?void 0:y.find((_,K)=>K==this._slideIdx),v=null==g?void 0:g.svg,T=_=>{let K=[];return _.filter(G=>!G.isdeleted).forEach(G=>{G.type==P.$.GROUP?K=K.concat(T(G.nodes||[])):i>G.size.x||n>G.size.y||r<G.size.x+G.size.width||a<G.size.y+G.size.height||(o?G.type==o&&K.push(G.id):K.push(G.id))}),K};return T((null==v?void 0:v.nodes)||[])}getNodeOnArea(i,n,r,a,o){var y;let g=null===(y=this._dataSource.slides)||void 0===y?void 0:y.find((_,K)=>K==this._slideIdx),v=null==g?void 0:g.svg,T=_=>{let K=[];return _.filter(G=>!G.isdeleted).forEach(G=>{G.type==P.$.GROUP?K=K.concat(T(G.nodes||[])):G.size.x+G.size.width<i||G.size.y+G.size.height<n||G.size.x>r||G.size.y>a||(o?G.type==o&&K.push(G.id):K.push(G.id))}),K};return T((null==v?void 0:v.nodes)||[])}deleteNode(i,n){var r;return this.getNode(i).isdeleted=null==n||n,(0,Wt.E)(this.slide),(0,Wt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),i}unGroup(i){var n,r;let a=this.getNode(i),o=Math.ceil(1e9*Math.random());return null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:o})),Object.assign(a,{isdeleted:!0}),(0,Wt.E)(this.slide),(0,Wt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),o}addGroup(i,n){var r;let a=this.getNode(i),o=this.getNode(n);o.nodes=o.nodes||[];let y=Math.ceil(1e9*Math.random());return o.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:y})),Object.assign(a,{isdeleted:!0}),(0,Wt.E)(this.slide),(0,Wt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),y}setNodeP(i,n){var r;let a=null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r?void 0:r.nodes.find(o=>o.id==i);a&&(a.pid=n||null)}bringToFront(i){var n,r,a;let o=i.map(at=>xt.data.getNode(at)).filter(at=>!at.isfake),{x1:y,y1:g,x2:v,y2:T}=pe(o),_=this.getNodeOnArea(y,g,v,T);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((at,ct)=>{at.index=ct+1});let K=_.map(at=>{var ct,ot;return null!==(ct=null===(ot=this.slide)||void 0===ot||null===(ot=ot.svg)||void 0===ot||null===(ot=ot.nodes.find(Gt=>Gt.id==at))||void 0===ot?void 0:ot.index)&&void 0!==ct?ct:0}),G=Math.max.apply(null,K);i.forEach((at,ct)=>{var ot;null===(ot=this.slide)||void 0===ot||null===(ot=ot.svg)||void 0===ot||ot.nodes.filter(Gt=>Gt.id==at).forEach(Gt=>{Gt.index=G+(ct+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((at,ct)=>{var ot,Gt;return(null!==(ot=at.index)&&void 0!==ot?ot:0)-(null!==(Gt=ct.index)&&void 0!==Gt?Gt:0)}),(0,Wt.T)(this.slide),null===(a=window.document.getElementById(dt.O.SELECT_GROUP))||void 0===a||a.remove(),(0,k.Q)(o)}sendToBack(i){var n,r,a;let o=i.map(at=>xt.data.getNode(at)).filter(at=>!at.isfake),{x1:y,y1:g,x2:v,y2:T}=pe(o),_=this.getNodeOnArea(y,g,v,T);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((at,ct)=>{at.index=ct+1});let K=_.map(at=>{var ct,ot;return null!==(ct=null===(ot=this.slide)||void 0===ot||null===(ot=ot.svg)||void 0===ot||null===(ot=ot.nodes.find(Gt=>Gt.id==at))||void 0===ot?void 0:ot.index)&&void 0!==ct?ct:0}),G=Math.min.apply(null,K)-1;i.forEach((at,ct)=>{var ot;null===(ot=this.slide)||void 0===ot||null===(ot=ot.svg)||void 0===ot||ot.nodes.filter(Gt=>Gt.id==at).forEach(Gt=>{Gt.index=G+(ct+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((at,ct)=>{var ot,Gt;return(null!==(ot=at.index)&&void 0!==ot?ot:0)-(null!==(Gt=ct.index)&&void 0!==Gt?Gt:0)}),(0,Wt.T)(this.slide),null===(a=window.document.getElementById(dt.O.SELECT_GROUP))||void 0===a||a.remove(),(0,k.Q)(o)}}const pe=A=>{let i=999999,n=999999,r=-999999,a=-999999;return A.forEach(o=>{i=Math.min(i,o.size.x),n=Math.min(n,o.size.y),r=Math.max(r,o.size.x+o.size.width),a=Math.max(a,o.size.y+o.size.height)}),{x1:i,y1:n,x2:r,y2:a}};class ce{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":xt.data.deleteNode(n.from.id);break;case"edit":break;case"delete":xt.data.deleteNode(n.from.id,!1);break;case"size":{let{id:r,type:a,size:o,attribute:y}=xt.data.getNode(n.from.id);Object.assign(o,n.from.size),Object.assign(y,(0,it.sg)(a,o)),(0,E.__)(window.document.getElementById(r),y);break}case"attribute":{let{id:r,attribute:a}=xt.data.getNode(n.from.id);Object.assign(a,n.from.attribute),(0,E.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=xt.data.getNode(n.from.id);Object.assign(null!=a?a:{},n.from.style),(0,E.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:o}=xt.data.getNode(n.from.id);Object.assign(null!=o?o:{},n.from.source),(0,E.QI)(window.document.getElementById(r),a,null!=o?o:{});break}case"animate":{let{animate:r}=xt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.animate);break}case"interactive":{let{interactive:r}=xt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.interactive);break}case"variable":{let{variable:r}=xt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.variable);break}}}),xt.dataSelect.ids=[]},this.redoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":xt.data.deleteNode(n.to.id,!1);break;case"edit":break;case"delete":xt.data.deleteNode(n.to.id,!0);break;case"size":{let{id:r,type:a,size:o,attribute:y}=xt.data.getNode(n.to.id);Object.assign(o,n.to.size),Object.assign(y,(0,it.sg)(a,o)),(0,E.__)(window.document.getElementById(r),y);break}case"attribute":{let{id:r,attribute:a}=xt.data.getNode(n.to.id);Object.assign(a,n.to.attribute),(0,E.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=xt.data.getNode(n.to.id);Object.assign(null!=a?a:{},n.to.style),(0,E.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:o}=xt.data.getNode(n.to.id);Object.assign(null!=o?o:{},n.to.source),(0,E.QI)(window.document.getElementById(r),a,null!=o?o:{});break}case"animate":{let{animate:r}=xt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.animate);break}case"interactive":{let{interactive:r}=xt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.interactive);break}case"variable":{let{variable:r}=xt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.variable);break}}}),xt.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(i){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:i}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:i})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(i){this._fnChanges.push(i)}change(){this._fnChanges.forEach(i=>i(this.index,this.total))}}class fe{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(i){this._actived=i}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(i){var n,r;this._frameSize.width=null!==(n=null==i?void 0:i.width)&&void 0!==n?n:1080,this._frameSize.height=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}get frameSize(){return this._frameSize}set frameSize(i){this._frameSize.x=i.x,this._frameSize.y=i.y,this._frameSize.width=i.width,this._frameSize.height=i.height,this.reset()}set screen(i){this._offset=i.offset,this._width=i.width,this._height=i.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(i,n,r){var a;if(!(i<.1||i>10)){if(n=null!==(a=n)&&void 0!==a?a:{x:this._width/2,y:this._height/2},r)this._dislocation.x=this._width/i/2-n.x,this._dislocation.y=this._height/i/2-n.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var o={x:Math.max(0,Math.min((0,M.q)(n.x/this._width,1e3),1)),y:Math.max(0,Math.min((0,M.q)(n.y/this._height,1e3),1))},y={x:(this._width/i-this._width/this._scale)*o.x,y:(this._height/i-this._height/this._scale)*o.y};this._dislocation.x+=y.x,this._dislocation.y+=y.y}this._scale=i,this.change(),this.zoomChange(this.scale)}}set zoomTo(i){"fit"==i?this.scaleTo(Math.min((this._width-60)/this._frameSize.width,(this._height-60)/this._frameSize.height),void 0,!0):"number"==typeof i&&this.scaleTo(i/100,void 0,!0)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(i,n){this._dislocation.x=i.x+n.x/this._scale,this._dislocation.y=i.y+n.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(0,E.eb)()}set onZoomChange(i){this._fnZoomChanges.push(i)}zoomChange(i){this._fnZoomChanges.forEach(n=>n(i))}}var Me=f(644);class qe{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){(0,Me.sV)({callback:i=>{this._fill=(null==i?void 0:i.fill)||this._fill,this._stroke=(null==i?void 0:i.stroke)||this._stroke,this._strokeWidth=(null==i?void 0:i.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==i?void 0:i.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==i?void 0:i.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){(0,Me.qp)({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(i){this._fill=i,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(i){this._stroke=i,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(i){this._strokeWidth=i,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(i){this._strokeLinecap=i}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(i){this._strokeLinejoin=i}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(i){this._fnChangeFills.push(i)}changeFill(i){this._fnChangeFills.forEach(n=>n(i)),this.saveConfig()}set onchangestroke(i){this._fnChangeStrokes.push(i)}changeStroke(i){this._fnChangeStrokes.forEach(n=>n(i)),this.saveConfig()}set onchangestrokewidth(i){this._fnChangeStrokeWidths.push(i)}changeStrokeWidth(i){this._fnChangeStrokeWidths.forEach(n=>n(i)),this.saveConfig()}}var We=f(70),ni=f(5973),ri=f(4787),Te=function(A){return A&&JSON.parse(JSON.stringify(A))},Ue=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],Je=[],ai={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},oi={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class ti{constructor(){this._data_variables=Te(Ue).concat(Te(Je)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=i=>{"function"==typeof i&&this.GetActionExecuteds.push(i)},this.OnGetActionExecuted=i=>{this.GetActionExecuteds.forEach(n=>{n(i)})},this.SetActionExecutings=[],this.FuncSetExecutings=i=>{"function"==typeof i&&this.SetActionExecutings.push(i)},this.OnSetActionExecuting=i=>{this.SetActionExecutings.forEach(n=>{n(i)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=i=>{"function"==typeof i&&this.SetActionExecuteds.push(i)},this.OnSetActionExecuted=i=>{for(var n of(this.SetActionExecuteds.forEach(r=>{r(i)}),this.getCondition(i.key)||[]))n.if&&n.if.length>0&&(this.checkValueConditions(n.if)?this.setValueOperators(n.then||[]):this.setValueOperators(n.else||[]))}}renew(){this._data_variables=Te(Ue).concat(Te(Je)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(i){if(!i)return;let n={};"string"==typeof i?n=JSON.parse(i):"object"==typeof i&&(n=i),this._data_variables=n.variables||[],this._data_conditions=n.conditions||(r=>(this._data_variables.map(a=>a.change||[]).forEach(a=>{r=r.concat(a)}),r))([]),Ue.forEach(r=>{var a=this._data_variables.filter(o=>o.key==r.key);a.length?a.forEach(function(o,y,g){o.type=r.type,o.readonly=r.readonly,o.system=r.system}):this._data_variables.push(r)})}getVariableTemp(){return Te(ai)}getConditionTemp(){return Te(oi)}getKeys(){return this._data_variables.map(function(i){return i.key}).sort(function(i,n){return i.localeCompare(n)})}getVariableAll(){return this._data_variables.length?Te((A=this._data_variables,i="key",function(n){for(var r of A.map(function(a){return a[i]}).sort())A.filter(function(a){return a[i]==r}).forEach(function(a){n.push(a)}),A=A.filter(function(a){return a[i]!=r});return n}([]))):Te(Ue).concat(Te(Je));var A,i}setVariableAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_variables=i),Ue.forEach(n=>{var r=this._data_variables.filter(a=>a.key==n.key);r.length?r.forEach((a,o,y)=>{a.type=n.type,a.readonly=n.readonly,a.system=n.system}):this._data_variables.push(n)}))}getVariable(i){return i?Te(this._data_variables.filter(n=>n.key==i)[0]||{}):{}}setVariable(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(o=>o.key==i)[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(o=>o.key==i);a.length?a.forEach(function(o,y,g){o.value=n,o.type=r}):this._data_variables.push({key:i,value:n,type:r})}}getValue(i,n){if(!i)return"";var r=this._data_variables.filter(function(y){return y.key==i});if(r.length){var o,a=r[0]||{};switch(this.OnGetActionExecuting(a),n||(n=a.type||null),n){case"string":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":"string"==typeof a.value?a.value||"":a.value.toString().trim();break;case"number":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?0:"number"==typeof a.value?a.value||0:parseFloat(a.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(a.value)>=0?o=!1:"boolean"==typeof a.value?o=a.value:(o=(a.value+"").toLowerCase(),o="1"==a.value||"true"==a.value||"yes"==a.value||"dung"==a.value);break;case"audio-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></audio>`:"";break;case"video-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></video>`:"";break;case"img-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<img style="width:100%;vertical-align:middle;" src="${a.value}"/>`:"";break;default:o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value}return this.OnGetActionExecuted(a),o}return null}setValue(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(function(y){return y.key==i})[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(function(y){return y.key==i});if(a.length){var o=a[0];this.OnSetActionExecuting(o),o&&(o.value=n),this.OnSetActionExecuted(o)}}}getConditionAll(){return Te(this._data_conditions.sort(function(i,n){return i.idx-n.idx}))}setConditionAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_conditions=i))}getCondition(i){return i?Te(this._data_conditions.filter(n=>n.variable==i||(n.variables||[]).indexOf(i)>=0).sort(function(n,r){return n.idx-r.idx})):{}}switchCondition(i,n,r){switch(i){case"==":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,o){return a+o})>0):n==r;case"!=":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),0==r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,o){return a+o})):n!=r;case">=":return n>=r;case"<=":return n<=r;case">":return n>r;case"<":return n<r;case"\u2208":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,o){return a+o})>0;case"\u2209":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),0==r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,o){return a+o});default:return!1}}switchOperator(i,n,r){switch(i){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return n/r;case"=":return r;case"=!":return!r;case"==":return n==r;case"!=":return n!=r}}switchFormula(i,n){switch(i){case"sum":return n.reduce(function(a,o){return a+o});case"sub":return n.reduce(function(a,o){return a-o});case"pro":return n.reduce(function(a,o){return a*o});case"div":return n.reduce(function(a,o){return a/o});case"avg":var r=n.reduce(function(a,o){return a+o})/(n.length||1);return Math.round(1e4*(r+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,n);case"max":return Math.max.apply(null,n);case"and":return n.reduce(function(a,o){return a&&o});case"or":return n.reduce(function(a,o){return a||o});default:return 0}}switchValueType_Condition(i){switch(i.valuetype){case"value":return this.switchCondition(i.condition,this.getValue(i.variable),i.value);case"variable":return this.switchCondition(i.condition,this.getValue(i.variable),this.getValue(i.value));default:return 0}}switchValueType_Operator(i){switch(i.valuetype){case"value":return this.switchOperator(i.operator,this.getValue(i.variable),i.value);case"variable":return this.switchOperator(i.operator,this.getValue(i.variable),this.getValue(i.value));case"variables":var n=this.switchFormula(i.valueformula,i.value.map(r=>this.getValue(r)));return this.switchOperator(i.operator,this.getValue(i.variable),n)}}checkValueCondition(i){return this.switchValueType_Condition(i)}getValueOperator(i){return this.switchValueType_Operator(i)}setValueOperator(i){null!=i&&i.variable&&this.setValue(i.variable,this.getValueOperator(i))}checkValueConditions(i){return 0==i.map(n=>{switch(n.type){case"variable":return this.switchValueType_Condition(n)?0:1;case"variables":return 0==n.variables.map(r=>this.switchValueType_Condition(Object.assign(Te(n),{variable:r}))?0:1).reduce(function(r,a){return r+a})?0:1;default:return 0}}).reduce((n,r)=>(null!=n?n:0)+(null!=r?r:0))}setValueOperators(i){for(var n of i)switch(n.type){case"variable":this.setValue(n.variable,this.getValueOperator(n));break;case"variables":for(var r of n.variables)this.setValue(r,this.getValueOperator(Object.assign(Te(n),{variable:r})));break;case"slide":We.$.runSlide(void 0,void 0,n.slide);break;case"node":{var a;(0,ri.L5)({id:n.node,nodeStatus:We.$.nodeStatus,slideStatus:We.$.slideStatus});let o=We.$.findNode(n.node);null!=o&&null!==(a=o.interactive)&&void 0!==a&&a.click&&(0,ni.F)(o,We.$.nodeStatus,We.$.slideStatus);break}}}FuncGetExecutings(i){"function"==typeof i&&this.GetActionExecutings.push(i)}OnGetActionExecuting(i){this.GetActionExecutings.forEach(n=>{n(i)})}}class Ze{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(i,n,r){if(this._pointer_type=i,n)switch(i){case z._.PEN:this._pen_type=n;break;case z._.SHAPE:this._shape_type=n,r&&n===P.$.POLYGON&&(this._polygon_type=r)}}get pointer_type(){return this._pointer_type}set pointer_type(i){this._pointer_type=i,this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(i){this._pointer_type_temp=i,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(i){this._pen_type=i,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(i){this._shape_type=i,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(i){this._polygon_type=i,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(i){this._fnChangePointerTypes.push(i)}changePointerType(i,n,r){this._fnChangePointerTypes.forEach(a=>a(i,n,r))}set onchangePointerTypeTemp(i){this._fnChangePointerTypeTemps.push(i)}changePointerTypeTemp(i,n,r){this._fnChangePointerTypeTemps.forEach(a=>a(i,n,r))}set onchangePenType(i){this._fnChangePenTypes.push(i)}changePenType(i,n,r){this._fnChangePenTypes.forEach(a=>a(i,n,r))}set onchangeShapeType(i){this._fnChangeShapeTypes.push(i)}changeShapeType(i,n,r){this._fnChangeShapeTypes.forEach(a=>a(i,n,r))}set onchangePolygonType(i){this._fnChangePolygonTypes.push(i)}changePolygonType(i,n,r){this._fnChangePolygonTypes.forEach(a=>a(i,n,r))}set onchange(i){this._fnChanges.push(i)}change(i,n,r){this._fnChanges.forEach(a=>a(i,n,r))}}const xt=new class si{constructor(){this._container="",this._svg="",this._screen=fe.prototype,this._data=ie.prototype,this._dataSelect=Zt.prototype,this._slide=Xt.prototype,this._history=ce.prototype,this._attribute=qe.prototype,this._pointer=Ze.prototype,this._variable=ti.prototype,this._data=new ie,this._dataSelect=new Zt,this._slide=new Xt,this._history=new ce,this._attribute=new qe,this._pointer=new Ze,this._variable=new ti,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._pointer.onchangePointerTypeTemp=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(i){this._config=i}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,resources:this._data.getResource,variable:this._variable.get,info:{}}}set dataSource(i){this._screen.set=i.screen||{width:1080,height:1080},this._data.set=i.data||{},this._variable.set=i.variable||{}}get container(){return this._container}set container(i){this._container=i}get svg(){return this._svg}set svg(i){this._svg=i}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var i,n,r,a,o;this._screen.screen=(i=jQuery(this._container).offset(),n=jQuery(this._container).width(),r=jQuery(this._container).height(),console.log("reloadView",JSON.stringify({offset:i,width:n,height:r})),{offset:{x:null!==(a=null==i?void 0:i.left)&&void 0!==a?a:0,y:null!==(o=null==i?void 0:i.top)&&void 0!==o?o:0},width:null!=n?n:0,height:null!=r?r:0})}init(i){this._container=i.container,this._svg=i.target,this._screen=new fe,(A=>{new E.Mh(A.container,A.target),xt.pointer.onchange=(r,a,o)=>{switch(r){case z._.POINTER:jQuery(A.target).css({cursor:"auto"});break;case z._.HAND:jQuery(A.target).css({cursor:"grab"});break;case z._.PEN:switch(a){case yt.D.DRAW:jQuery(A.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case yt.D.HIGHTLIGH:jQuery(A.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case z._.ERASER:jQuery(A.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case z._.SHAPE:jQuery(A.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case z._.TEXT:case z._.FOREIGNOBJECT:jQuery(A.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}},jQuery(A.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{xt.pointer.pointer_type==z._.HAND&&jQuery(A.target).css({cursor:"grabbing"})}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{xt.pointer.pointer_type==z._.HAND&&jQuery(A.target).css({cursor:"grab"})}),jQuery(A.container).off("mousewheel.icdt-init").on("mousewheel.icdt-init",r=>{var a;r.preventDefault();var o=xt.screen.scale,y=(null!==(a=r.originalEvent)&&void 0!==a?a:r).deltaY>0?1:-1;xt.screen.scaleTo(o-.04*o*y,(0,It.p)({x:r.clientX,y:r.clientY},1,{x:0,y:0},xt.screen.offset))}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{xt.screen.actived=!!jQuery(r.target).parents("app-main").length}),jQuery(A.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{xt.screen.actived=!0}),jQuery(A.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{xt.screen.actived=!1}),jQuery(A.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(A.container.includes("#")&&A.container.includes(r.target.getAttribute("id"))||A.container.includes(".")&&A.container.includes(r.target.getAttribute("class"))||A.container.includes(r.target.nodeName))&&(xt.pointer.pointer_type_temp||xt.pointer.pointer_type)===z._.POINTER&&(xt.dataSelect.ids=[])}),jQuery(A.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const i=r=>{switch(xt.pointer.pointer_type_temp||xt.pointer.pointer_type){case z._.POINTER:S(r);break;case z._.HAND:(A=>{(0,h.A)(A,new nt,1,{x:0,y:0})})(r);break;case z._.PEN:(0,wt.i)(r);break;case z._.SHAPE:(A=>{var i=null;switch(xt.pointer.shape_type){case P.$.CIRCLE:i=new q;break;case P.$.ELLIPSE:i=new gt;break;case P.$.LINE:i=new Dt;break;case P.$.RECT:i=new Y;break;case P.$.POLYGON:var n;i=new Lt(null===(n=F.find(r=>r.type==xt.pointer.polygon_type))||void 0===n?void 0:n.ratios);break;case P.$.FOREIGNOBJECT:i=new ut;break;case P.$.IMAGE:i=new Et;break;case P.$.TEXT:case P.$.PATH:i=new Tt}i&&(0,h.A)(A,i)})(r);break;case z._.FOREIGNOBJECT:(A=>{(0,h.A)(A,new ut)})(r);break;case z._.IMAGE:(A=>{(0,h.A)(A,new Et)})(r);break;case z._.TEXT:(A=>{(0,h.A)(A,new R)})(r);break;case z._.ERASER:(A=>{(0,h.A)(A,new U)})(r);break;case z._.INDEX:(0,V.s)(r)}};let n=!1;jQuery(A.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,i({touchEvent:r})}),jQuery(A.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);i({mouseEvent:r})}}),A.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{xt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Ht.t)(r))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{xt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Ht.t)(r))}))})({container:i.container,target:i.target,iskeyboard:i.iskeyboard})}}},4113:(le,At,f)=>{f.d(At,{s:()=>k,Q:()=>m});var z=f(1687),E=f(4981),dt=f(4318),P=f(6816),it=f(4080);const k=S=>{var x,nt,N,F;let rt=(null===(x=S.mouseEvent)||void 0===x?void 0:x.target)||(null===(nt=S.touchEvent)||void 0===nt?void 0:nt.target),M=(null==rt?void 0:rt.getAttribute("id"))||"",q=null==rt?void 0:rt.nodeName,vt=jQuery(rt).parents("g[id]").attr("id")||"";if(![z.O.INDEX_GROUP].includes(vt))if(null!==(N=S.mouseEvent)&&void 0!==N&&N.altKey||null!==(F=S.touchEvent)&&void 0!==F&&F.altKey||!M||M.match(/[^0-9]/)||!E.icdt.dataSelect.nodeName.includes(q)){var gt;E.icdt.dataSelect.ids.length&&(E.icdt.dataSelect.ids=[]),(0==(null===(gt=S.mouseEvent)||void 0===gt?void 0:gt.button)||S.touchEvent)&&((S,x)=>{let M=(0,it.g1)(z.O.SCAN_GROUP,"g"),q=(0,dt.bH)(0,0,1,1);(0,it.vl)(M,q),((S,x,nt,N)=>{(0,P.A)(S,{start:M=>{},move:(M,q)=>{((M,q,vt,gt)=>{x=(0,dt.bH)(M,q,vt,gt),(0,it.vl)(nt,x)})(q[0][0],q[0][1],M.x,M.y)},end:(M,q)=>{null==nt||nt.remove(),E.icdt.dataSelect.ids=E.icdt.data.getNodeInArea(Math.min(q[0][0],M.x),Math.min(q[0][1],M.y),Math.max(q[0][0],M.x),Math.max(q[0][1],M.y)),N(E.icdt.dataSelect.nodes)}})})(S,q,M,x)})(S,O)}else{var ft,Y;let C=parseFloat(M||"0");E.icdt.dataSelect.ids=null!==(ft=S.mouseEvent)&&void 0!==ft&&ft.shiftKey||null!==(Y=S.touchEvent)&&void 0!==Y&&Y.shiftKey?[C].concat(E.icdt.dataSelect.ids).filter((Bt,Dt,ae)=>ae.indexOf(Bt)==Dt):[C],O(E.icdt.dataSelect.nodes)}},O=S=>{var x,nt;let N=1;var F,rt;if(S.length&&(N=Math.max.apply(null,null!==(F=null===(rt=E.icdt.data.slide)||void 0===rt||null===(rt=rt.svg)||void 0===rt?void 0:rt.nodes.map(q=>{var vt;return null!==(vt=q.idx)&&void 0!==vt?vt:0}))&&void 0!==F?F:[0])+1),1==S.length)S[0].idx||(S[0].idx=N,S[0].time=0);else if(S.length>=0){let q=S.map(gt=>{var ft;return null!==(ft=gt.idx)&&void 0!==ft?ft:0}).filter(gt=>gt>0),vt=q.length?Math.min.apply(null,q):N;S.forEach(gt=>{var ft;gt.idx=vt,gt.time=null!==(ft=gt.time)&&void 0!==ft?ft:0})}let M=(0,it.g1)(z.O.INDEX_GROUP,"g");(0,it.mo)(M,null!==(x=null===(nt=E.icdt.data.slide)||void 0===nt||null===(nt=nt.svg)||void 0===nt?void 0:nt.nodes)&&void 0!==x?x:[])},m=S=>{var x,nt,N;null!=S&&null!==(x=S.svg)&&void 0!==x&&x.nodes&&S.svg.nodes.forEach(rt=>{rt.idx=0,rt.time=null});let F=(0,it.g1)(z.O.INDEX_GROUP,"g");(0,it.mo)(F,null!==(nt=null===(N=E.icdt.data.slide)||void 0===N||null===(N=N.svg)||void 0===N?void 0:N.nodes)&&void 0!==nt?nt:[])}},4578:(le,At,f)=>{f.d(At,{h:()=>x,t:()=>nt});var z=f(644),E=f(7308),dt=f(968),P=f(4981),it=f(666),h=f(2966),p=f(5226),k=f(3423),O=f(5811),m=f(3385);const x=new class S{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:E.s.Escape,fn:()=>{P.icdt.dataSelect.ids.length&&(P.icdt.dataSelect.ids=[])}},this.onchange={type:"keydown",key:E.s.Delete,fn:()=>{P.icdt.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:E.s.Space,fn:()=>{P.icdt.pointer.pointer_type_temp=dt._.HAND}},this.onchange={type:"keyup",key:E.s.Space,fn:()=>{P.icdt.pointer.pointer_type_temp=dt._.POINTER}},this.onchange={type:"keydown",key:E.s.ArrowLeft,fn:()=>{P.icdt.dataSelect.ids.length||P.icdt.data.backSlide()}},this.onchange={type:"keydown",key:E.s.ArrowRight,fn:()=>{P.icdt.dataSelect.ids.length||P.icdt.data.nextSlide()}},this.onchange={type:"keydown",key:E.s.ArrowLeft,fn:()=>{P.icdt.dataSelect.ids.length&&(P.icdt.dataSelect.nodes.forEach(F=>{(0,m.k6)(F,(0,O.q)(F.size.x-(0,k.v)(1)))}),1==P.icdt.dataSelect.ids.length?(0,it.y)(P.icdt.dataSelect.nodes[0]):(0,h.Q)(P.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:E.s.ArrowRight,fn:()=>{P.icdt.dataSelect.ids.length&&(P.icdt.dataSelect.nodes.forEach(F=>{(0,m.k6)(F,(0,O.q)(F.size.x+(0,k.v)(1)))}),1==P.icdt.dataSelect.ids.length?(0,it.y)(P.icdt.dataSelect.nodes[0]):(0,h.Q)(P.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:E.s.ArrowUp,fn:()=>{P.icdt.dataSelect.ids.length&&(P.icdt.dataSelect.nodes.forEach(F=>{(0,m.co)(F,(0,O.q)(F.size.y-(0,k.v)(1)))}),1==P.icdt.dataSelect.ids.length?(0,it.y)(P.icdt.dataSelect.nodes[0]):(0,h.Q)(P.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:E.s.ArrowDown,fn:()=>{P.icdt.dataSelect.ids.length&&(P.icdt.dataSelect.nodes.forEach(F=>{(0,m.co)(F,(0,O.q)(F.size.y+(0,k.v)(1)))}),1==P.icdt.dataSelect.ids.length?(0,it.y)(P.icdt.dataSelect.nodes[0]):(0,h.Q)(P.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:E.s.Digit1,fn:F=>{F.shiftKey&&(P.icdt.reloadView(),P.icdt.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:E.s.KeyA,fn:F=>{if(F.ctrlKey){P.icdt.dataSelect.ids=P.icdt.data.getNodeAll();let rt=P.icdt.dataSelect.nodes;1==rt.length?(0,it.y)(rt[0]):rt.length>1&&(0,h.Q)(rt)}}},this.onchange={type:"keydown",key:E.s.KeyC,fn:F=>{if(F.ctrlKey){let rt=P.icdt.dataSelect.nodes;rt&&(0,z.yR)({params:{type:"nodes",nodes:rt}})}}},this.onchange={type:"keydown",key:E.s.KeyV,fn:F=>{F.ctrlKey&&(0,z.aY)({callback:rt=>{var M,q;"nodes"==(null==rt?void 0:rt.type)&&null!=rt&&null!==(M=rt.nodes)&&void 0!==M&&M.length&&(null==rt||null===(q=rt.nodes)||void 0===q||q.forEach(vt=>{vt.id=Math.ceil(1e9*Math.random()),P.icdt.data.node=vt}),(0,p.E)(P.icdt.data.slide))}})}},this.onchange={type:"keydown",key:E.s.KeyZ,fn:F=>{F.ctrlKey&&F.shiftKey?P.icdt.history.redo():F.ctrlKey&&P.icdt.history.undo()}}}set onchange(F){let rt=this._fnChanges.find(M=>M.eventType==F.type&&M.eventKey==F.key);rt?rt.fns.push(F.fn):this._fnChanges.push({eventType:F.type,eventKey:F.key,fns:[F.fn]})}change(F,rt,M){var q;null===(q=this._fnChanges.find(vt=>vt.eventType==F&&vt.eventKey==rt))||void 0===q||q.fns.forEach(vt=>vt(M))}},nt=N=>{x.change(N.type,N.keyCode||N.which||N.charCode||0,N)}},410:(le,At,f)=>{f.d(At,{a:()=>k});var z=f(4318),E=f(8419),dt=f(9054),P=f(4080),it=f(511),h=f(3423),p=f(1687);class k{constructor(m){var S;let x={stroke:"#FF0000",strokeWidth:(0,h.v)(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,h.v)(8)},{element:N,attribute:F,size:rt}=(0,E.G)(Math.ceil(1e9*Math.random()),{size:m});window.document.getElementById(p.O.INTERACTIVE_GROUP).querySelectorAll("path").forEach(ft=>null==ft?void 0:ft.remove()),null===(S=window.document.getElementById(p.O.INTERACTIVE_GROUP))||void 0===S||S.appendChild(N),(0,P.__)(N,x);let q="";return{start:ft=>{q=`M ${ft.x} ${ft.y} L ${ft.x} ${ft.y}`},move:(ft,Y)=>{((ft,Y)=>{q+=` ${ft} ${Y}`,N.setAttribute("d",q)})(ft.x,ft.y)},end:(ft,Y)=>{(ft=>{let C=it.jvg().x(Lt=>Lt[0]).y(Lt=>Lt[1]).curve(it.$0Z)(ft);N.setAttribute("d",C),ft.length>=2&&(window.interactivePoints=ft)})(Y),(ft=>{let Y=9999,C=9999,Lt=-9999,Bt=-9999;ft.forEach(Dt=>{Y=Math.min(Y,Dt[0]),C=Math.min(C,Dt[1]),Lt=Math.max(Lt,Dt[0]),Bt=Math.max(Bt,Dt[1])}),rt=(0,z.bH)(Y,C,Lt,Bt,{points:ft}),Object.assign(F,(0,z.sg)(dt.$.PATH,rt),x)})(Y)}}}}},9623:(le,At,f)=>{f.d(At,{U:()=>N,i:()=>nt});var z=f(1687),E=f(9125),dt=f(4981),P=f(6816),it=f(4080),h=f(4318),p=f(8419),k=f(9054),O=f(511);class m{constructor(){let rt={strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:M,element:q,attribute:vt,size:gt}=(0,p.G)(Math.ceil(1e9*Math.random()));(0,it.__)(q,vt);let Y="";return{start:Bt=>{Y=`M ${Bt.x} ${Bt.y} L ${Bt.x} ${Bt.y}`},move:(Bt,Dt)=>{((Bt,Dt)=>{Y+=` ${Bt} ${Dt}`,q.setAttribute("d",Y)})(Bt.x,Bt.y)},end:(Bt,Dt)=>{(Bt=>{let ae=O.jvg().x(Tt=>Tt[0]).y(Tt=>Tt[1]).curve(O.$0Z)(Bt);q.setAttribute("d",ae)})(Dt),(Bt=>{let Dt=9999,ae=9999,Tt=-9999,Ft=-9999;Bt.forEach(ut=>{Dt=Math.min(Dt,ut[0]),ae=Math.min(ae,ut[1]),Tt=Math.max(Tt,ut[0]),Ft=Math.max(Ft,ut[1])}),gt=(0,h.bH)(Dt,ae,Tt,Ft,{points:Bt}),Object.assign(vt,(0,h.sg)(k.$.PATH,gt),rt)})(Dt),dt.icdt.data.node=Object.assign({id:M,type:k.$.PATH,name:"Path"},{size:gt,attribute:vt})}}}}class S{constructor(){let rt={strokeOpacity:.4,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:M,element:q,attribute:vt,size:gt}=(0,p.G)(Math.ceil(1e9*Math.random()));(0,it.__)(q,vt);let Y="";var C=(Lt,Bt)=>{Y+=` ${Lt} ${Bt}`,q.setAttribute("d",Y)};return{start:Lt=>{Y=`M ${Lt.x} ${Lt.y} L ${Lt.x} ${Lt.y}`},move:(Lt,Bt)=>{C(Lt.x,Lt.y)},end:(Lt,Bt)=>{C(Lt.x,Lt.y),(Lt=>{let Bt=9999,Dt=9999,ae=-9999,Tt=-9999;Lt.forEach(Ft=>{Bt=Math.min(Bt,Ft[0]),Dt=Math.min(Dt,Ft[1]),ae=Math.max(ae,Ft[0]),Tt=Math.max(Tt,Ft[1])}),gt=(0,h.bH)(Bt,Dt,ae,Tt,{points:Lt}),Object.assign(vt,(0,h.sg)(k.$.PATH,gt),rt)})(Bt),dt.icdt.data.node=Object.assign({id:M,type:k.$.PATH,name:"Path"},{size:gt,attribute:vt})}}}}var x=f(410);const nt=F=>{switch(dt.icdt.pointer.pen_type){case E.D.DRAW:(0,P.A)(F,new m);break;case E.D.HIGHTLIGH:(0,P.A)(F,new S);break;case E.D.INTERACTIVE:N(F)}},N=F=>{var rt,M;let q=(0,it.g1)(z.O.INTERACTIVE_GROUP,"g"),vt=null!==(rt=null===(M=dt.icdt.data.slide)||void 0===M||null===(M=M.svg)||void 0===M?void 0:M.viewBox)&&void 0!==rt?rt:(()=>{let{width:gt,height:ft}=dt.icdt.screen.get;return{x:0,y:0,width:gt,height:ft}})();(0,it.XH)(q,vt),F&&(0,P.A)(F,new x.a)}},666:(le,At,f)=>{f.d(At,{y:()=>p});var z=f(1687),E=f(4981),dt=f(4318),P=f(6816),it=f(4080),h=f(5811);const p=m=>{let S=(0,it.g1)(z.O.RESIZE_GROUP,"g");(0,it.hJ)(S,m).forEach(x=>{k(x.element,x.posType,m,S)})},k=(m,S,x,nt)=>{let N=!1;null==m||m.addEventListener("touchstart",F=>{N=!0,O({touchEvent:F},S,x,nt)}),null==m||m.addEventListener("mousedown",F=>{if(0==F.button){if(N)return void(N=!1);O({mouseEvent:F},S,x,nt)}})},O=(m,S,x,nt)=>{let C,{id:N,type:F,size:rt,attribute:M}=x,{x:q,y:vt,width:gt,height:ft}=rt,Y=(gt||1)/(ft||1),Bt=null,Tt=!1;(0,P.A)(m,{start:ut=>{Bt=JSON.parse(JSON.stringify({id:N,size:rt,attribute:M}))},move:(ut,X)=>{((ut,X,Et,kt)=>{switch(S){case"rect-center":var Ht,wt;C=null!==(Ht=m.mouseEvent)&&void 0!==Ht&&Ht.shiftKey||null!==(wt=m.touchEvent)&&void 0!==wt&&wt.shiftKey?Math.abs(Et-ut)>=Math.abs(kt-X)?{x:q+Et-ut,y:vt,width:gt,height:ft}:{x:q,y:vt+kt-X,width:gt,height:ft}:{x:q+Et-ut,y:vt+kt-X,width:gt,height:ft};break;case"rect-top-left":var re,Q,D,d,Z,_t,pt,St;C=(null!==(re=m.mouseEvent)&&void 0!==re&&re.shiftKey||null!==(Q=m.touchEvent)&&void 0!==Q&&Q.shiftKey)&&(null!==(D=m.mouseEvent)&&void 0!==D&&D.altKey||null!==(d=m.touchEvent)&&void 0!==d&&d.altKey)?Y>=1?{x:q+(Et-ut),y:vt+(Et-ut)/Y,width:gt-2*(Et-ut),height:ft-2*(Et-ut)/Y}:{x:q+(kt-X)*Y,y:vt+(kt-X),width:gt-2*(kt-X)*Y,height:ft-2*(kt-X)}:null!==(Z=m.mouseEvent)&&void 0!==Z&&Z.shiftKey||null!==(_t=m.touchEvent)&&void 0!==_t&&_t.shiftKey?Y>=1?{x:q+(Et-ut),y:vt+(Et-ut)/Y,width:gt-(Et-ut),height:ft-(Et-ut)/Y}:{x:q+(kt-X)*Y,y:vt+(kt-X),width:gt-(kt-X)*Y,height:ft-(kt-X)}:null!==(pt=m.mouseEvent)&&void 0!==pt&&pt.altKey||null!==(St=m.touchEvent)&&void 0!==St&&St.altKey?{x:q+(Et-ut),y:vt+(kt-X),width:gt-2*(Et-ut),height:ft-2*(kt-X)}:{x:q+(Et-ut),y:vt+(kt-X),width:gt-(Et-ut),height:ft-(kt-X)};break;case"rect-top-right":var Kt,jt,Ot,ht,Yt,J,c,U;C=(null!==(Kt=m.mouseEvent)&&void 0!==Kt&&Kt.shiftKey||null!==(jt=m.touchEvent)&&void 0!==jt&&jt.shiftKey)&&(null!==(Ot=m.mouseEvent)&&void 0!==Ot&&Ot.altKey||null!==(ht=m.touchEvent)&&void 0!==ht&&ht.altKey)?Y>=1?{x:q-(Et-ut),y:vt-(Et-ut)/Y,width:gt+2*(Et-ut),height:ft+2*(Et-ut)/Y}:{x:q+(kt-X)*Y,y:vt+(kt-X),width:gt-2*(kt-X)*Y,height:ft-2*(kt-X)}:null!==(Yt=m.mouseEvent)&&void 0!==Yt&&Yt.shiftKey||null!==(J=m.touchEvent)&&void 0!==J&&J.shiftKey?Y>=1?{x:q,y:vt-(Et-ut)/Y,width:gt+(Et-ut),height:ft+(Et-ut)/Y}:{x:q,y:vt+(kt-X),width:gt-(kt-X)*Y,height:ft-(kt-X)}:null!==(c=m.mouseEvent)&&void 0!==c&&c.altKey||null!==(U=m.touchEvent)&&void 0!==U&&U.altKey?{x:q-(Et-ut),y:vt+(kt-X),width:gt+2*(Et-ut),height:ft-2*(kt-X)}:{x:q,y:vt+(kt-X),width:gt+(Et-ut),height:ft-(kt-X)};break;case"rect-bottom-left":var H,W,R,B,tt,I,V,yt;C=(null!==(H=m.mouseEvent)&&void 0!==H&&H.shiftKey||null!==(W=m.touchEvent)&&void 0!==W&&W.shiftKey)&&(null!==(R=m.mouseEvent)&&void 0!==R&&R.altKey||null!==(B=m.touchEvent)&&void 0!==B&&B.altKey)?Y>=1?{x:q+(Et-ut),y:vt+(Et-ut)/Y,width:gt-2*(Et-ut),height:ft-2*(Et-ut)/Y}:{x:q-(kt-X)*Y,y:vt-(kt-X),width:gt+2*(kt-X)*Y,height:ft+2*(kt-X)}:null!==(tt=m.mouseEvent)&&void 0!==tt&&tt.shiftKey||null!==(I=m.touchEvent)&&void 0!==I&&I.shiftKey?Y>=1?{x:q+(Et-ut),y:vt,width:gt-(Et-ut),height:ft-(Et-ut)/Y}:{x:q-(kt-X)*Y,y:vt,width:gt+(kt-X)*Y,height:ft+(kt-X)}:null!==(V=m.mouseEvent)&&void 0!==V&&V.altKey||null!==(yt=m.touchEvent)&&void 0!==yt&&yt.altKey?{x:q+(Et-ut),y:vt-(kt-X),width:gt-2*(Et-ut),height:ft+2*(kt-X)}:{x:q+(Et-ut),y:vt,width:gt-(Et-ut),height:ft+(kt-X)};break;case"rect-bottom-right":var It,bt,Nt,Zt,Ut,Xt,Wt,ie;C=(null!==(It=m.mouseEvent)&&void 0!==It&&It.shiftKey||null!==(bt=m.touchEvent)&&void 0!==bt&&bt.shiftKey)&&(null!==(Nt=m.mouseEvent)&&void 0!==Nt&&Nt.altKey||null!==(Zt=m.touchEvent)&&void 0!==Zt&&Zt.altKey)?Y>=1?{x:q-(Et-ut),y:vt-(Et-ut)/Y,width:gt+2*(Et-ut),height:ft+2*(Et-ut)/Y}:{x:q-(kt-X)*Y,y:vt-(kt-X),width:gt+2*(kt-X)*Y,height:ft+2*(kt-X)}:null!==(Ut=m.mouseEvent)&&void 0!==Ut&&Ut.shiftKey||null!==(Xt=m.touchEvent)&&void 0!==Xt&&Xt.shiftKey?Y>=1?{x:q,y:vt,width:gt+(Et-ut),height:ft+(Et-ut)/Y}:{x:q,y:vt,width:gt+(kt-X)*Y,height:ft+(kt-X)}:null!==(Wt=m.mouseEvent)&&void 0!==Wt&&Wt.altKey||null!==(ie=m.touchEvent)&&void 0!==ie&&ie.altKey?{x:q-(Et-ut),y:vt-(kt-X),width:gt+2*(Et-ut),height:ft+2*(kt-X)}:{x:q,y:vt,width:gt+(Et-ut),height:ft+(kt-X)};break;default:C={x:q+Et-ut,y:vt+kt-X,width:gt,height:ft}}C.width<0&&(C.width=0),C.height<0&&(C.height=0),C.x=(0,h.q)(C.x),C.y=(0,h.q)(C.y),C.width=(0,h.q)(C.width),C.height=(0,h.q)(C.height),Object.assign(rt,C),Object.assign(M,(0,dt.sg)(F,rt)),(0,it.__)(window.document.getElementById(N),M),(0,it.hJ)(nt,x)})(X[0][0],X[0][1],ut.x,ut.y),Tt=!0},end:(ut,X)=>{Tt&&Bt&&E.icdt.history.push([{type:"size",from:Bt,to:JSON.parse(JSON.stringify({id:N,size:rt,attribute:M}))}])}})}},2966:(le,At,f)=>{f.d(At,{Q:()=>k});var z=f(1687),E=f(4981),dt=f(4318),P=f(6816),it=f(4080),h=f(3423),p=f(5811);const k=S=>{let x=999999,nt=999999,N=-999999,F=-999999;null==S||S.forEach(q=>{x=Math.min(x,q.size.x),nt=Math.min(nt,q.size.y),N=Math.max(N,q.size.x+q.size.width),F=Math.max(F,q.size.y+q.size.height)});let rt=(0,it.g1)(z.O.SELECT_GROUP,"g"),M=(0,dt.bH)(x,nt,N,F);(0,it.yD)(rt,S,M).forEach(q=>{O(q.element,q.posType,M,S,rt)})},O=(S,x,nt,N,F)=>{let rt=!1;null==S||S.addEventListener("touchstart",M=>{rt=!0,m({touchEvent:M},x,nt,N,F)}),null==S||S.addEventListener("mousedown",M=>{if(0==M.button){if(rt)return void(rt=!1);m({mouseEvent:M},x,nt,N,F)}})},m=(S,x,nt,N,F)=>{let{x:rt,y:M,width:q,height:vt}=nt,gt=N.map(Dt=>Object.assign({},Dt.size)),Y=[];(0,P.A)(S,{start:Dt=>{N.forEach((Dt,ae)=>{let{id:Tt,size:ut,attribute:X}=Dt;Y.push(JSON.parse(JSON.stringify({id:Tt,size:ut,attribute:X})))})},move:(Dt,ae)=>{((Dt,ae,Tt,Ft)=>{(()=>{let ut;ut="rect-center"===x?{x:rt+Tt-Dt,y:M+Ft-ae,width:q,height:vt}:{x:rt,y:M,width:q,height:vt},(0,h.v)(E.icdt.screen.width),(0,h.v)(E.icdt.screen.height),ut.width<0&&(ut.width=0),ut.height<0&&(ut.height=0),Object.assign(nt,ut),(0,it.yD)(F,N,nt)})(),N.forEach((ut,X)=>{let Z,{x:Et,y:kt,width:Ht,height:wt}=gt[X],{id:re,type:Q,size:D,attribute:d}=ut;Z="rect-center"===x?{x:Et+Tt-Dt,y:kt+Ft-ae,width:Ht,height:wt}:{x:Et,y:kt,width:Ht,height:wt},(0,h.v)(E.icdt.screen.width),(0,h.v)(E.icdt.screen.height),Z.width<0&&(Z.width=0),Z.height<0&&(Z.height=0),Z.x=(0,p.q)(Z.x),Z.y=(0,p.q)(Z.y),Z.width=(0,p.q)(Z.width),Z.height=(0,p.q)(Z.height),Object.assign(D,Z),Object.assign(d,(0,dt.sg)(Q,D)),(0,it.__)(window.document.getElementById(re),d)})})(ae[0][0],ae[0][1],Dt.x,Dt.y)},end:(Dt,ae)=>{Y.length&&E.icdt.history.push(N.map((Dt,ae)=>{let{id:Tt,size:ut,attribute:X}=Dt;return{type:"size",from:Y[ae],to:JSON.parse(JSON.stringify({id:Tt,size:ut,attribute:X}))}}))}})}},5226:(le,At,f)=>{f.d(At,{E:()=>F,T:()=>rt});var z=f(1687),E=f(8619),dt=f(8785),P=f(2282),it=f(8054),h=f(4921),p=f(6358),k=f(9054),O=f(8419),m=f(1105),S=f(2875),x=f(7210),nt=f(4981),N=f(4080);const F=(M,q)=>{var vt;if(q&&!window.document.getElementById(q))return;if("localhost"==location.hostname&&console.log("aaaaaaaaaaaaaaa s\u1ee3 qu\xe1 \u0111iiiiiiiiiiiiiiiiiiiiiiiiiii!",q),q){let ft=window.document.getElementById(q);jQuery(ft).find("#"+z.O.BACKGROUND_GROUP).empty();let Y=(0,N.g1)(z.O.BACKGROUND_GROUP,"g",void 0,ft);(0,N.x0)(Y,M)}else{jQuery(nt.icdt.target).find("#"+z.O.BACKGROUND_GROUP).empty();let ft=(0,N.g1)(z.O.BACKGROUND_GROUP,"g",void 0,nt.icdt.target);(0,N.x0)(ft,M)}let gt=(ft,Y)=>{Y=Y?parseFloat(`${q}0${Y}`):q,null==ft||ft.forEach(C=>{let Lt=q?parseFloat(`${q}0${C.id}`):C.id;var Bt;if(C.isdeleted)null===(Bt=window.document.getElementById(Lt))||void 0===Bt||Bt.remove();else switch(C.type){case k.$.GROUP:(0,p.m)(Lt,{},Y?window.document.getElementById(Y):null),gt(C.nodes,C.id);break;case k.$.CIRCLE:(0,E._)(Lt,{size:C.size,attribute:C.attribute},Y?window.document.getElementById(Y):null);break;case k.$.ELLIPSE:(0,dt.r)(Lt,{size:C.size,attribute:C.attribute},Y?window.document.getElementById(Y):null);break;case k.$.LINE:(0,h.W)(Lt,{size:C.size,attribute:C.attribute},Y?window.document.getElementById(Y):null);break;case k.$.RECT:(0,it.f)(Lt,{size:C.size,attribute:C.attribute},Y?window.document.getElementById(Y):null);break;case k.$.POLYGON:(0,P.l)(Lt,{size:C.size,attribute:C.attribute},Y?window.document.getElementById(Y):null);break;case k.$.FOREIGNOBJECT:(0,S.e)(Lt,{size:C.size,attribute:C.attribute,style:C.style,source:C.source},Y?window.document.getElementById(Y):null);break;case k.$.IMAGE:(0,x.G)(Lt,{size:C.size,attribute:C.attribute,source:C.source},Y?window.document.getElementById(Y):null);break;case k.$.TEXT:(0,m.$)(Lt,{size:C.size,attribute:C.attribute,source:C.source},Y?window.document.getElementById(Y):null);break;case k.$.PATH:(0,O.G)(Lt,{size:C.size,attribute:C.attribute},Y?window.document.getElementById(Y):null)}})};gt(null==M||null===(vt=M.svg)||void 0===vt?void 0:vt.nodes)},rt=(M,q)=>{var vt;if(q&&!window.document.getElementById(q))return;let gt=(ft,Y)=>{Y=Y?parseFloat(`${q}0${Y}`):q,null==ft||ft.forEach(C=>{let Lt=q?parseFloat(`${q}0${C.id}`):C.id;jQuery("#"+Lt).appendTo(Y?window.document.getElementById(Y):nt.icdt.target),C.type==k.$.GROUP&&gt(C.nodes,C.id)})};gt(null==M||null===(vt=M.svg)||void 0===vt?void 0:vt.nodes)}},8619:(le,At,f)=>{f.d(At,{_:()=>it});var z=f(9054),E=f(4981),dt=f(4318),P=f(4080);const it=(h,p,k)=>{let O=(null==p?void 0:p.size)||{x:0,y:0,width:10,height:10},m=(null==p?void 0:p.attribute)||{fill:E.icdt.attribute.fill,stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth};return Object.assign(m,(0,dt.sg)(z.$.CIRCLE,O)),{nodeId:h,element:(0,P.it)(h,z.$.CIRCLE,"circle",{size:O,attribute:m},k),size:O,attribute:m}}},8785:(le,At,f)=>{f.d(At,{r:()=>it});var z=f(9054),E=f(4981),dt=f(4318),P=f(4080);const it=(h,p,k)=>{let O=(null==p?void 0:p.size)||{x:0,y:0,width:10,height:10},m=(null==p?void 0:p.attribute)||{fill:E.icdt.attribute.fill,stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth};return Object.assign(m,(0,dt.sg)(z.$.ELLIPSE,O)),{nodeId:h,element:(0,P.it)(h,z.$.ELLIPSE,"ellipse",{size:O,attribute:m},k),size:O,attribute:m}}},2875:(le,At,f)=>{f.d(At,{e:()=>P});var z=f(9054),E=f(4318),dt=f(4080);const P=(it,h,p)=>{let k=(null==h?void 0:h.size)||{x:0,y:0,width:180,height:180},O=(null==h?void 0:h.attribute)||{};Object.assign(O,(0,E.sg)(z.$.FOREIGNOBJECT,k));let m=(null==h?void 0:h.source)||{type:"html",html:{htmlContent:'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>'}},S=(null==h?void 0:h.style)||{};return{nodeId:it,element:(0,dt.it)(it,z.$.FOREIGNOBJECT,"foreignObject",{size:k,attribute:O,style:S,source:m},p),size:k,attribute:O,style:S,source:m}}},6358:(le,At,f)=>{f.d(At,{m:()=>P});var z=f(9054),E=f(4318),dt=f(4080);const P=(h,p,k)=>{let O=(null==p?void 0:p.size)||{x:0,y:0,width:10,height:10},m=(null==p?void 0:p.attribute)||{};return Object.assign(m,(0,E.sg)(z.$.GROUP,O)),{nodeId:h,element:(0,dt.it)(h,z.$.GROUP,"g",{size:O,attribute:m},k),size:O,attribute:m}}},7210:(le,At,f)=>{f.d(At,{G:()=>P});var z=f(9054),E=f(4318),dt=f(4080);const P=(it,h,p)=>{let k=(null==h?void 0:h.size)||{x:0,y:0,width:100,height:100},O=(null==h?void 0:h.attribute)||{preserveAspectRatio:"none"};Object.assign(O,(0,E.sg)(z.$.IMAGE,k));let m=(null==h?void 0:h.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:it,element:(0,dt.it)(it,z.$.IMAGE,"image",{size:k,attribute:O,source:m},p),size:k,attribute:O,source:m}}},4921:(le,At,f)=>{f.d(At,{W:()=>it});var z=f(9054),E=f(4981),dt=f(4318),P=f(4080);const it=(h,p,k)=>{let O=(null==p?void 0:p.size)||{x:0,y:0,width:10,height:10},m=(null==p?void 0:p.attribute)||{stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth,strokeLinecap:E.icdt.attribute.strokeLinecap};return Object.assign(m,(0,dt.sg)(z.$.LINE,O)),{nodeId:h,element:(0,P.it)(h,z.$.LINE,"line",{size:O,attribute:m},k),size:O,attribute:m}}},8419:(le,At,f)=>{f.d(At,{G:()=>it});var z=f(9054),E=f(4981),dt=f(4318),P=f(4080);const it=(h,p,k)=>{let O=(null==p?void 0:p.size)||{x:0,y:0,width:10,height:10},m=(null==p?void 0:p.attribute)||{stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth};return Object.assign(m,(0,dt.sg)(z.$.PATH,O)),{nodeId:h,element:(0,P.it)(h,z.$.PATH,"path",{size:O,attribute:m},k),size:O,attribute:m}}},2282:(le,At,f)=>{f.d(At,{l:()=>it});var z=f(9054),E=f(4981),dt=f(4318),P=f(4080);const it=(h,p,k)=>{let O=(null==p?void 0:p.size)||{x:0,y:0,width:10,height:10},m=(null==p?void 0:p.attribute)||{fill:E.icdt.attribute.fill,stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth};return Object.assign(m,(0,dt.sg)(z.$.POLYGON,O)),{nodeId:h,element:(0,P.it)(h,z.$.POLYGON,"polygon",{size:O,attribute:m},k),size:O,attribute:m}}},8054:(le,At,f)=>{f.d(At,{f:()=>it});var z=f(9054),E=f(4981),dt=f(4318),P=f(4080);const it=(h,p,k)=>{let O=(null==p?void 0:p.size)||{x:0,y:0,width:10,height:10},m=(null==p?void 0:p.attribute)||{fill:E.icdt.attribute.fill,stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth};return Object.assign(m,(0,dt.sg)(z.$.RECT,O)),{nodeId:h,element:(0,P.it)(h,z.$.RECT,"rect",{size:O,attribute:m},k),size:O,attribute:m}}},1105:(le,At,f)=>{f.d(At,{$:()=>it});var z=f(9054),E=f(4981),dt=f(4318),P=f(4080);const it=(h,p,k)=>{let O=(null==p?void 0:p.size)||{x:0,y:0,width:100,height:50},m=(null==p?void 0:p.attribute)||{fill:E.icdt.attribute.stroke,fontFamily:E.icdt.attribute.fontFamily,fontSize:E.icdt.attribute.fontSize,textLength:E.icdt.attribute.textLength};Object.assign(m,(0,dt.sg)(z.$.TEXT,O));let S=(null==p?void 0:p.source)||{type:"text",text:{textContent:"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!"}};return{nodeId:h,element:(0,P.it)(h,z.$.TEXT,"text",{size:O,attribute:m,source:S},k),size:O,attribute:m,source:S}}},4318:(le,At,f)=>{f.d(At,{bH:()=>E,sg:()=>dt});var z=f(9054);const E=(it,h,p,k,O)=>{let m={x:Math.min(it,p),y:Math.min(h,k),width:Math.abs(p-it)||1,height:Math.abs(k-h)||1};return null!=O&&O.ratio&&(m.width<=m.height?m.height=m.width*(null==O?void 0:O.ratio):m.width=m.height/(null==O?void 0:O.ratio)),Object.assign(m,{ratios:(null==O?void 0:O.ratios)||[[(it-m.x)/(m.width||1),(h-m.y)/(m.height||1)],[(p-m.x)/(m.width||1),(k-m.y)/(m.height||1)]]}),null!=O&&O.points&&(m.points=null==O?void 0:O.points),m},dt=(it,h,p)=>{var k=(()=>{switch(it){case z.$.CIRCLE:return{cx:h.x+h.width/2,cy:h.y+h.height/2,r:Math.min(h.width/2,h.height/2)};case z.$.ELLIPSE:return{cx:h.x+h.width/2,cy:h.y+h.height/2,rx:h.width/2,ry:h.height/2};case z.$.LINE:{var O;let x={};return null===(O=h.ratios)||void 0===O||O.forEach((nt,N)=>{x[`x${N+1}`]=h.x+h.width*nt[0],x[`y${N+1}`]=h.y+h.height*nt[1]}),x}case z.$.RECT:return{x:h.x,y:h.y,width:h.width,height:h.height};case z.$.POLYGON:var m;return{points:((null===(m=h.ratios)||void 0===m?void 0:m.map(x=>[h.x+h.width*x[0],h.y+h.height*x[1]]))||[]).map(x=>x.join(" ")).join(",")};case z.$.FOREIGNOBJECT:case z.$.IMAGE:return{x:h.x,y:h.y,width:h.width,height:h.height};case z.$.TEXT:return{x:h.x,y:h.y};case z.$.PATH:{var S;let x=null!==(S=h.points)&&void 0!==S?S:[];return x.length?{d:`M ${x[0][0]} ${x[0][1]} L `+(x.map(nt=>[nt[0],nt[1]])||[]).map(nt=>nt.join(" ")).join(" ")}:{d:""}}}return{}})();return h.rotate?(k.transform=`rotate(${h.rotate})`,k.transformOrigin=`${h.x+h.width/2} ${h.y+h.height/2}`):(k.transform=null,k.transformOrigin=null),k}},5811:(le,At,f)=>{f.d(At,{q:()=>z});const z=(E,dt)=>{var P;return dt=null!==(P=dt)&&void 0!==P?P:100,Math.round((E+Number.EPSILON)*dt)/dt}},3423:(le,At,f)=>{f.d(At,{v:()=>dt});var z=f(4981),E=f(5811);const dt=P=>(0,E.q)(P/z.icdt.screen.scale)},3385:(le,At,f)=>{f.d(At,{Vs:()=>k,co:()=>h,k6:()=>it,lO:()=>p,mr:()=>O});var z=f(4981),E=f(4080),dt=f(4318),P=f(5811);const it=(m,S)=>{let{id:x,type:nt,size:N,attribute:F}=m,rt=JSON.parse(JSON.stringify({id:x,size:N,attribute:F}));N.x=(0,P.q)(S),Object.assign(F,(0,dt.sg)(nt,N)),(0,E.__)(window.document.getElementById(x),F),z.icdt.history.push([{type:"size",from:rt,to:JSON.parse(JSON.stringify({id:x,size:N,attribute:F}))}])},h=(m,S)=>{let{id:x,type:nt,size:N,attribute:F}=m,rt=JSON.parse(JSON.stringify({id:x,size:N,attribute:F}));N.y=(0,P.q)(S),Object.assign(F,(0,dt.sg)(nt,N)),(0,E.__)(window.document.getElementById(x),F),z.icdt.history.push([{type:"size",from:rt,to:JSON.parse(JSON.stringify({id:x,size:N,attribute:F}))}])},p=(m,S,x)=>{let{id:nt,type:N,size:F,attribute:rt}=m,M=JSON.parse(JSON.stringify({id:nt,size:F,attribute:rt}));x&&(F.height=(0,P.q)(S*F.height/F.width)),F.width=(0,P.q)(S),Object.assign(rt,(0,dt.sg)(N,F)),(0,E.__)(window.document.getElementById(nt),rt),z.icdt.history.push([{type:"size",from:M,to:JSON.parse(JSON.stringify({id:nt,size:F,attribute:rt}))}])},k=(m,S,x)=>{let{id:nt,type:N,size:F,attribute:rt}=m,M=JSON.parse(JSON.stringify({id:nt,size:F,attribute:rt}));x&&(F.width=(0,P.q)(S*F.width/F.height)),F.height=(0,P.q)(S),Object.assign(rt,(0,dt.sg)(N,F)),(0,E.__)(window.document.getElementById(nt),rt),z.icdt.history.push([{type:"size",from:M,to:JSON.parse(JSON.stringify({id:nt,size:F,attribute:rt}))}])},O=(m,S)=>{let{id:x,type:nt,size:N,attribute:F}=m,rt=JSON.parse(JSON.stringify({id:x,size:N,attribute:F}));N.rotate=(0,P.q)(S),Object.assign(F,(0,dt.sg)(nt,N)),(0,E.__)(window.document.getElementById(x),F),z.icdt.history.push([{type:"size",from:rt,to:JSON.parse(JSON.stringify({id:x,size:N,attribute:F}))}])}},6816:(le,At,f)=>{f.d(At,{A:()=>h});var z=f(968),E=f(4981);class dt{constructor(k){this._points=[],this._options=k}start(k){this._points.length=0,this._points.push([k.x,k.y]),this._options.start(k)}move(k){this._points.push([k.x,k.y]),this._options.move(k,this._points)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(k=this._points[0])[0],y:k[1]}:{x:0,y:0};var k}get offsetLast(){return this._points.length>=1?{x:(k=this._points[this._points.length-1])[0],y:k[1]}:{x:0,y:0};var k}}var P=f(7797);const h=(p,k,O,m,S)=>{var x,nt,N;let F=null,rt=0,M=0;p.mouseEvent?(F=p.mouseEvent.target,rt=p.mouseEvent.offsetX,M=p.mouseEvent.offsetY):p.touchEvent&&(F=p.touchEvent.target,p.touchEvent.touches.length&&(rt=p.touchEvent.touches[0].clientX,M=p.touchEvent.touches[0].clientY));let q=null!=O?O:E.icdt.screen.scale,vt=null!=m?m:E.icdt.screen.dislocation,gt=null!=S?S:E.icdt.screen.offset,ft=()=>{};var Y=new dt({start:null!==(x=null==k?void 0:k.start)&&void 0!==x?x:ft,move:null!==(nt=null==k?void 0:k.move)&&void 0!==nt?nt:ft,end:null!==(N=null==k?void 0:k.end)&&void 0!==N?N:ft});p.mouseEvent?Y.start((0,P.p)({x:rt,y:M},q,vt,{x:0,y:0})):p.touchEvent&&Y.start((0,P.p)({x:rt,y:M},q,vt,gt));let C=ut=>{Y.move((0,P.p)({x:ut.clientX,y:ut.clientY},q,vt,gt))},Lt=ut=>{Y.end(),[z._.SHAPE,z._.FOREIGNOBJECT,z._.IMAGE,z._.TEXT].includes(E.icdt.pointer.pointer_type)&&(ut.shiftKey||(E.icdt.pointer.pointer_type=z._.POINTER))},Bt=ut=>{ut.touches.length&&C({clientX:ut.touches[0].clientX,clientY:ut.touches[0].clientY})},Dt=ut=>{Lt({shiftKey:ut.shiftKey,ctrlKey:ut.ctrlKey,altKey:ut.altKey}),window.removeEventListener("touchmove",Bt,!1),window.removeEventListener("touchend",Dt,!1)},ae=ut=>{0==ut.button&&C({clientX:ut.clientX,clientY:ut.clientY})},Tt=ut=>{0==ut.button&&(Lt({shiftKey:ut.shiftKey,ctrlKey:ut.ctrlKey,altKey:ut.altKey}),window.removeEventListener("mousemove",ae,!1),window.removeEventListener("mouseup",Tt,!1))};if(p.mouseEvent)window.addEventListener("mousemove",ae,!1),window.addEventListener("mouseup",Tt,!1);else if(p.touchEvent){var Ft;window.addEventListener("touchmove",Bt,!1),window.addEventListener("touchend",Dt,!1),null===(Ft=F)||void 0===Ft||Ft.addEventListener("touchmove",function(ut){ut.preventDefault()})}}},7797:(le,At,f)=>{f.d(At,{p:()=>E});var z=f(5811);const E=(dt,P,it,h)=>(dt.x-=h.x,dt.y-=h.y,dt.x/=P,dt.y/=P,dt.x-=it.x,dt.y-=it.y,dt.x=(0,z.q)(dt.x),dt.y=(0,z.q)(dt.y),dt)},70:(le,At,f)=>{f.d(At,{$:()=>ht,U:()=>Yt});var z=f(1687),E=f(4981),dt=f(9054),P=f(5973),it=f(2336),h=f(861),p=f(157),k=f(4787),m=f(1105),S=f(6358);var rt=f(7267),M=f(7210),q=f(5811);const vt=(J,c,U)=>{var H,W,R,B;let tt=1,I=new Image;I.onload=()=>{var V,yt,It,bt;tt=(0,q.q)(I.naturalWidth/I.naturalHeight,100);let Nt=0,Zt=0,Ut=0,Xt=0;var Wt,ie,pe,ce;tt>=1?(Ut=Math.min(I.naturalWidth,null!==(Wt=null===(ie=ht.slide.svg)||void 0===ie||null===(ie=ie.viewBox)||void 0===ie?void 0:ie.width)&&void 0!==Wt?Wt:0),Xt=Ut/tt):(Xt=Math.min(I.naturalHeight,null!==(pe=null===(ce=ht.slide.svg)||void 0===ce||null===(ce=ce.viewBox)||void 0===ce?void 0:ce.height)&&void 0!==pe?pe:0),Ut=Xt/tt),Nt=((null!==(V=null===(yt=ht.slide.svg)||void 0===yt||null===(yt=yt.viewBox)||void 0===yt?void 0:yt.width)&&void 0!==V?V:0)-Ut)/2,Zt=((null!==(It=null===(bt=ht.slide.svg)||void 0===bt||null===(bt=bt.viewBox)||void 0===bt?void 0:bt.height)&&void 0!==It?It:0)-Xt)/2,c.size={x:Nt,y:Zt,width:Ut,height:Xt},gt(c,U)},I.onerror=V=>{console.error(`ImgSrc load failed -> ${JSON.stringify(c.source)}`,V)},I.src=(null!==(H=c.source)&&void 0!==H&&H.path?(null===(W=E.icdt.config)||void 0===W?void 0:W.readfileuploadurl)+(null===(R=c.source)||void 0===R?void 0:R.path):null===(B=c.source)||void 0===B?void 0:B.url)||""},gt=(J,c)=>{if(J.slideStatus!=ht.slideStatus)return void c();let{element:U}=(0,M.G)(Math.ceil(1e9*Math.random()),{size:J.size,source:{type:"image",image:null==J?void 0:J.source}});setTimeout(()=>{null==U||U.remove(),c()},3e3)},ft=(J,c,U)=>{var H,W,R,B;let tt=new Image;tt.onload=()=>{Y(J,{width:tt.naturalWidth,height:tt.naturalHeight},c,U)},tt.onerror=I=>{console.error(`ImgSrc load failed -> ${JSON.stringify(c.source)}`,I),U()},tt.src=(null!==(H=c.source)&&void 0!==H&&H.path?(null===(W=E.icdt.config)||void 0===W?void 0:W.readfileuploadurl)+(null===(R=c.source)||void 0===R?void 0:R.path):null===(B=c.source)||void 0===B?void 0:B.url)||""},Y=(J,c,U,H)=>{if(U.slideStatus!=ht.slideStatus)return void H();let W=(0,q.q)(c.width/c.height,100),R=0,B=0,tt=0,I=0;W>=1?(tt=c.width,tt=Math.max(tt,40),tt=Math.min(tt,100),I=tt/W):(I=c.height,I=Math.max(I,40),I=Math.min(I,100),tt=I/W);let{size:V}=J;R=V.x+V.width/2-tt/2,B=V.y+V.height/2-I/2;let{element:yt}=(0,M.G)(Math.ceil(1e9*Math.random()),{size:{x:R,y:B,width:tt,height:I},source:{type:"image",image:null==U?void 0:U.source}});setTimeout(()=>{null==yt||yt.remove(),H()},3e3)};var C=f(4080);const Lt=(J,c,U)=>{var H,W,R,B,tt,I,V;if(c.slideStatus!=ht.slideStatus)return void U();if(!(null!==(H=c.source)&&void 0!==H&&H.path||null!==(W=c.source)&&void 0!==W&&W.url))return console.warn(`${J.id} -> audio no source!`),void U();var yt=jQuery("#"+J.id);let It=null!==(R=c.iteration)&&void 0!==R?R:0;if(It<0&&(U(),U=function(){}),!(yt.data("audio-running")&&It<0)){yt.data("audio-running",!0);var bt=new Audio;return bt.autoplay=!0,bt.loop=0!=It,bt.preload="auto",bt.controls=!0,bt.setAttributeNode(document.createAttribute("playsinline")),bt.addEventListener("canplay",function(){var Nt=bt.play();Nt&&Nt.then(function(Zt){yt.data("audio-running",!0)}).catch(function(Zt){yt.data("audio-running",!1),c.slideStatus===ht.slideStatus&&U()})}),bt.addEventListener("timeupdate",function(){var Zt;c.slideStatus!==ht.slideStatus&&((Zt=this).pause(),Zt.remove(),yt.data("audio-running",!1))}),bt.addEventListener("canplaythrough",function(){this.loop&&(It>0?It--:0==It&&(this.loop=!1))}),bt.addEventListener("play",function(){}),bt.addEventListener("pause",function(){}),bt.addEventListener("ended",function(){this.remove(),yt.data("audio-running",!1),c.slideStatus===ht.slideStatus&&U()}),bt.onerror=function(){this.remove(),yt.data("audio-running",!1),c.slideStatus===ht.slideStatus&&U()},bt.src=(null!==(B=c.source)&&void 0!==B&&B.path?(null===(tt=E.icdt.config)||void 0===tt?void 0:tt.readfileuploadurl)+(null===(I=c.source)||void 0===I?void 0:I.path):null===(V=c.source)||void 0===V?void 0:V.url)||"",bt}};var Bt=f(9942);const Et=(J,c,U)=>{var H;null===(H=c.test)||void 0===H||null===(H=H.answer)||void 0===H||null===(H=H.matching)||void 0===H||H.filter(W=>W.value==U.key).forEach(W=>W.value="")},Ht=(J,c,U,H,W,R)=>{var B,tt,I,V,yt,It,bt,Nt,Zt,Ut,Xt,Wt;W.iscorrect?(null!==(B=c.test)&&void 0!==B&&null!==(B=B.audiotrue)&&void 0!==B&&B.path&&Lt(J,{source:(0,Bt.I)(null===(V=c.test)||void 0===V?void 0:V.audiotrue),iteration:0,nodeStatus:U,slideStatus:H},R),null!==(tt=c.test)&&void 0!==tt&&null!==(tt=tt.icontrue)&&void 0!==tt&&tt.path&&ft(J,{source:(0,Bt.I)(null===(yt=c.test)||void 0===yt?void 0:yt.icontrue),iteration:0,nodeStatus:U,slideStatus:H},R),null!==(I=c.test)&&void 0!==I&&null!==(I=I.effecttrue)&&void 0!==I&&I.path&&vt(0,{source:(0,Bt.I)(null===(It=c.test)||void 0===It?void 0:It.effecttrue),iteration:0,nodeStatus:U,slideStatus:H},R)):(null!==(bt=c.test)&&void 0!==bt&&null!==(bt=bt.audiofalse)&&void 0!==bt&&bt.path&&Lt(J,{source:(0,Bt.I)(null===(Ut=c.test)||void 0===Ut?void 0:Ut.audiofalse),iteration:0,nodeStatus:U,slideStatus:H},R),null!==(Nt=c.test)&&void 0!==Nt&&null!==(Nt=Nt.iconfalse)&&void 0!==Nt&&Nt.path&&ft(J,{source:(0,Bt.I)(null===(Xt=c.test)||void 0===Xt?void 0:Xt.iconfalse),iteration:0,nodeStatus:U,slideStatus:H},R),null!==(Zt=c.test)&&void 0!==Zt&&null!==(Zt=Zt.effectfalse)&&void 0!==Zt&&Zt.path&&vt(0,{source:(0,Bt.I)(null===(Wt=c.test)||void 0===Wt?void 0:Wt.effectfalse),iteration:0,nodeStatus:U,slideStatus:H},R))},wt=(J,c,U,H)=>{var W,R,B,tt,I,V,It,Nt,bt;null!==(W=c.animate)&&void 0!==W&&W.value&&(0,rt.Z)(c,U.nodeStatus,U.slideStatus),null!==(R=c.interactive)&&void 0!==R&&R.show?((J,c,U,H)=>{var W,R,B;console.log("icdt_Run_Interactive_NodeShow",J,c,U);let tt={total:0,counter:0},{triggershow:I,triggerrun:V,triggerhide:yt,action:It,audio:bt}=null!==(W=null===(R=J.interactive)||void 0===R?void 0:R.show)&&void 0!==W?W:{};if(I){let{id:Ut,ids:Xt,time:Wt,async:ie}=I;"asynctrue"==ie?setTimeout(()=>{(0,k.L5)({id:Ut,ids:Xt,nodeStatus:c,slideStatus:U})}):"time"==ie&&setTimeout(()=>{(0,k.L5)({id:Ut,ids:Xt,nodeStatus:c,slideStatus:U})},1e3*(null!=Wt?Wt:0))}if(V){let{id:Ut,ids:Xt,time:Wt,async:ie}=V;"asynctrue"==ie?setTimeout(()=>{(0,k.Ar)({id:Ut,ids:Xt,nodeStatus:c,slideStatus:U})}):"time"==ie&&setTimeout(()=>{(0,k.Ar)({id:Ut,ids:Xt,nodeStatus:c,slideStatus:U})},1e3*(null!=Wt?Wt:0))}if(yt){let{id:Ut,ids:Xt,time:Wt,async:ie}=yt;"asynctrue"==ie?setTimeout(()=>{(0,k.WT)({id:Ut,ids:Xt,nodeStatus:c,slideStatus:U})}):"time"==ie&&setTimeout(()=>{(0,k.WT)({id:Ut,ids:Xt,nodeStatus:c,slideStatus:U})},1e3*(null!=Wt?Wt:0))}let Nt=()=>{setTimeout(()=>{if(tt.counter>=tt.total){if(H&&H(),I){let{id:Ut,ids:Xt,async:Wt}=I;"asyncfalse"==Wt&&(0,k.L5)({id:Ut,ids:Xt,nodeStatus:c,slideStatus:U})}if(V){let{id:Ut,ids:Xt,async:Wt}=V;"asyncfalse"==Wt&&(0,k.Ar)({id:Ut,ids:Xt,nodeStatus:c,slideStatus:U})}if(yt){let{id:Ut,ids:Xt,async:Wt}=yt;"asyncfalse"==Wt&&(0,k.WT)({id:Ut,ids:Xt,nodeStatus:c,slideStatus:U})}}})};if(null!=It&&It.value){tt.total+=1;let Ut=()=>{tt.counter+=1,Nt()};switch(null==It?void 0:It.value){case"hide":jQuery("#"+J.id).addClass("hide"),Ut();break;case"points":{let{points:Xt,time:Wt,iteration:ie,finish:pe}=It;(0,h.G)(J.id,{node:J,points:Xt,time:Wt,iteration:ie,finish:pe,nodeStatus:c,slideStatus:U},Ut);break}default:{var Zt;let{value:Xt,time:Wt,iteration:ie,finish:pe}=It;(0,it.Q)(null!==(Zt=J.pid)&&void 0!==Zt?Zt:0,{node:J,value:Xt,time:Wt,iteration:ie,finish:pe,nodeStatus:c,slideStatus:U},Ut);break}}}if(null!=bt&&null!==(B=bt.source)&&void 0!==B&&B.path){tt.total+=1;let Ut=()=>{tt.counter+=1,Nt()};(0,p.R)(J.id,bt,tt,{nodeStatus:c,slideStatus:U},Ut)}tt.total||Nt()})(c,U.nodeStatus,U.slideStatus,H):H&&H(),null!==(B=c.interactive)&&void 0!==B&&B.click&&(Nt=null===(It=c.interactive)||void 0===It?void 0:It.click,Object.keys(null!=Nt?Nt:{}).map(Ut=>Nt[Ut]?1:0).includes(1)&&jQuery("#"+c.id).addClass("interactive-click"),jQuery("#"+c.id).click(Nt=>{Nt.preventDefault(),U.nodeStatus=ht.refreshNodeStatus(),(0,P.F)(c,U.nodeStatus,U.slideStatus)})),null!==(tt=c.variable)&&void 0!==tt&&tt.input&&jQuery("#"+c.id).on("change","input,textarea",Nt=>{Nt.preventDefault(),((J,c,U)=>{var H,W;E.icdt.variable.setValue(null!==(H=null===(W=c.variable)||void 0===W||null===(W=W.input)||void 0===W?void 0:W.variable)&&void 0!==H?H:"",J),(J=>{var c;let U=(H,W)=>{null==H||H.forEach(R=>{switch(R.type){case dt.$.GROUP:(0,S.m)(R.id,{},W?window.document.getElementById(W):null),U(R.nodes,R.id);break;case dt.$.POLYGON:break;case dt.$.TEXT:(0,m.$)(R.id,{size:R.size,attribute:R.attribute,source:R.source},W?window.document.getElementById(W):null)}})};U(null===(c=J.svg)||void 0===c?void 0:c.nodes)})(U)})(Nt.target.value,c,J)}),null!==(I=c.variable)&&void 0!==I&&I.click&&(null!==(bt=c.variable)&&void 0!==bt&&null!==(bt=bt.click)&&void 0!==bt&&bt.variable&&jQuery("#"+c.id).addClass("variable-click"),jQuery("#"+c.id).click(Nt=>{Nt.preventDefault(),((J,c)=>{var U;E.icdt.variable.setValueOperator(null===(U=J.variable)||void 0===U?void 0:U.click),(J=>{var c;let U=(H,W)=>{null==H||H.forEach(R=>{switch(R.type){case dt.$.GROUP:(0,S.m)(R.id,{},W?window.document.getElementById(W):null),U(R.nodes,R.id);break;case dt.$.POLYGON:break;case dt.$.TEXT:(0,m.$)(R.id,{size:R.size,attribute:R.attribute,source:R.source},W?window.document.getElementById(W):null)}})};U(null===(c=J.svg)||void 0===c?void 0:c.nodes)})(c)})(c,J)})),"test"==(null===(V=c.source)||void 0===V?void 0:V.type)&&((J,c)=>{var U;let H=()=>{};switch(null===(U=J.source)||void 0===U||null===(U=U.test)||void 0===U?void 0:U.type){case"truefalse":var W;if(jQuery("#"+J.id).click(I=>{I.preventDefault(),((J,c,U,H,W)=>{var R,B;let tt=null===(R=J.source)||void 0===R||null===(R=R.test)||void 0===R||null===(R=R.truefalse)||void 0===R?void 0:R.iscorrect;if(null!==(B=c.svg)&&void 0!==B&&B.nodes.find(I=>{var V;return"submit"==(null===(V=I.source)||void 0===V||null===(V=V.test)||void 0===V?void 0:V.type)})||Ht(J,c,U,H,{iscorrect:tt},W),c.test?c.test.answer?c.test.answer.truefalse={value:J.id,iscorrect:tt}:c.test.answer={truefalse:{value:J.id,iscorrect:tt}}:c.test={answer:{truefalse:{value:J.id,iscorrect:tt}}},c.test.showselection){let I=(0,C.g1)(z.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,C.Yw)(I,c)}console.log("node source ->",J.source),console.log("slide test ->",c.test)})(J,c,ht.nodeStatus,ht.slideStatus,H)}),null!==(W=c.test)&&void 0!==W&&W.showselection){let I=(0,C.g1)(z.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,C.Yw)(I,c)}break;case"singlechoice":var R;if(jQuery("#"+J.id).click(I=>{I.preventDefault(),((J,c,U,H,W)=>{var R,B;let tt=null===(R=J.source)||void 0===R||null===(R=R.test)||void 0===R||null===(R=R.singlechoice)||void 0===R?void 0:R.iscorrect;if(null!==(B=c.svg)&&void 0!==B&&B.nodes.find(I=>{var V;return"submit"==(null===(V=I.source)||void 0===V||null===(V=V.test)||void 0===V?void 0:V.type)})||Ht(J,c,U,H,{iscorrect:tt},W),c.test?c.test.answer?c.test.answer.singlechoice={value:J.id,iscorrect:tt}:c.test.answer={singlechoice:{value:J.id,iscorrect:tt}}:c.test={answer:{singlechoice:{value:J.id,iscorrect:tt}}},c.test.showselection){let I=(0,C.g1)(z.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,C.Yw)(I,c)}console.log("node source ->",J.source),console.log("slide test ->",c.test)})(J,c,ht.nodeStatus,ht.slideStatus,H)}),null!==(R=c.test)&&void 0!==R&&R.showselection){let I=(0,C.g1)(z.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,C.Yw)(I,c)}break;case"multichoice":var B;if(jQuery("#"+J.id).click(I=>{I.preventDefault(),((J,c,U,H,W)=>{var R,B;let I,tt=null===(R=J.source)||void 0===R||null===(R=R.test)||void 0===R||null===(R=R.multichoice)||void 0===R?void 0:R.iscorrect;if(null!==(B=c.svg)&&void 0!==B&&B.nodes.find(V=>{var yt;return"submit"==(null===(yt=V.source)||void 0===yt||null===(yt=yt.test)||void 0===yt?void 0:yt.type)})||Ht(J,c,U,H,{iscorrect:tt},W),c.test?c.test.answer?c.test.answer.multichoice?c.test.answer.multichoice.find(V=>V.value==J.id)?(c.test.answer.multichoice=c.test.answer.multichoice.filter(V=>V.value!=J.id),I=!0):c.test.answer.multichoice.push({value:J.id,iscorrect:tt}):c.test.answer.multichoice=[{value:J.id,iscorrect:tt}]:c.test.answer={multichoice:[{value:J.id,iscorrect:tt}]}:c.test={answer:{multichoice:[{value:J.id,iscorrect:tt}]}},c.test.showselection){let V=(0,C.g1)(z.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,C.Yw)(V,c)}console.log("node source ->",J.source),console.log("slide test ->",c.test)})(J,c,ht.nodeStatus,ht.slideStatus,H)}),null!==(B=c.test)&&void 0!==B&&B.showselection){let I=(0,C.g1)(z.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,C.Yw)(I,c)}break;case"fill":var tt;jQuery("#"+J.id).on("keyup",'input[type="text"]',I=>{var V;let yt=jQuery("<div/>").css({"font-size":jQuery(I.target).css("font-size"),visibility:"hidden",float:"left"}).text(I.target.value).appendTo(window.document.body);jQuery(I.target).css({width:(null!==(V=yt.width())&&void 0!==V?V:0)+30})}).on("keypress",'input[type="text"]',I=>{13===(I.keyCode||I.charCode||I.which)&&(I.preventDefault(),I.stopPropagation(),jQuery(I.target).blur())}).on("change",'input[type="text"]',I=>{var V,yt;let It=ht.nodeStatus,bt=ht.slideStatus,Nt=null===(V=I.target)||void 0===V?void 0:V.getAttribute("data-key"),Zt=null===(yt=I.target)||void 0===yt||null===(yt=yt.value)||void 0===yt?void 0:yt.trim();((J,c,U,H,W,R)=>{var B,tt,I,V;let{value:yt}=null!==(B=null===(tt=J.source)||void 0===tt||null===(tt=tt.test)||void 0===tt||null===(tt=tt.fill)||void 0===tt?void 0:tt.find(bt=>bt.key==`[[${W.key}]]`))&&void 0!==B?B:{},It=yt&&yt.map(bt=>null==bt?void 0:bt.toLocaleLowerCase()).includes(null===(I=W.value)||void 0===I?void 0:I.toLocaleLowerCase());null!==(V=c.svg)&&void 0!==V&&V.nodes.find(bt=>{var Nt;return"submit"==(null===(Nt=bt.source)||void 0===Nt||null===(Nt=Nt.test)||void 0===Nt?void 0:Nt.type)})||Ht(J,c,U,H,{iscorrect:It},R),W.iscorrect=It,c.test?c.test.answer?c.test.answer.fill?c.test.answer.fill.find(bt=>bt.key==W.key)?c.test.answer.fill.filter(bt=>bt.key==W.key).forEach(bt=>{bt.value=W.value,bt.iscorrect=W.iscorrect}):c.test.answer.fill.push(W):c.test.answer.fill=[W]:c.test.answer={fill:[W]}:c.test={answer:{fill:[W]}},console.log("node source ->",J.source),console.log("slide test ->",c.test)})(J,c,It,bt,{key:Nt,value:Zt},H),jQuery("#"+J.id).find(`input[type="text"][data-key="${Nt}"]`).val(Zt)}),null!==(tt=c.test)&&void 0!==tt&&tt.showselection||jQuery("#"+J.id).addClass("hide-selection");break;case"matching-empty":jQuery("#"+J.id).on("touchmove",".ondrag-item",function(I){I.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(I){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${J.size.height/J.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${I.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(I){var V;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(V=c.test)&&void 0!==V&&V.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(I){},dragend:function(I){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${J.id} .ondrop-here`).kendoDropTarget({dragenter:function(I){I.dropTarget.hasClass("actived")&&I.dropTarget.addClass("focused")},dragleave:function(I){I.dropTarget.hasClass("actived")&&I.dropTarget.removeClass("focused")},drop:function(I){if(!I.dropTarget.hasClass("actived"))return;I.dropTarget.removeClass("focused");let V=I.dropTarget,yt=I.draggable.currentTarget;V.is(":empty")||V.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),yt.appendTo(V),((J,c,U,H,W,R)=>{var B,tt,I;let{key:V}=null!==(B=null===(tt=J.source)||void 0===tt||null===(tt=tt.test)||void 0===tt?void 0:tt.matching)&&void 0!==B?B:{key:"KIEN"},yt=W.key==V;null!==(I=c.svg)&&void 0!==I&&I.nodes.find(bt=>{var Nt;return"submit"==(null===(Nt=bt.source)||void 0===Nt||null===(Nt=Nt.test)||void 0===Nt?void 0:Nt.type)})||Ht(J,c,U,H,{iscorrect:yt},R),Et(J,c,W);let It={key:null!=V?V:"",value:W.key};c.test?c.test.answer?c.test.answer.matching?c.test.answer.matching.find(bt=>bt.key==V)?c.test.answer.matching.filter(bt=>bt.key==V).forEach(bt=>bt.value=It.value):c.test.answer.matching.push(It):c.test.answer.matching=[It]:c.test.answer={matching:[It]}:c.test={answer:{matching:[It]}},console.log("node source ->",J.source),console.log("slide test ->",c.test)})(J,c,ht.nodeStatus,ht.slideStatus,{key:yt.data("key")},H)}});break;case"matching-content":jQuery("#"+J.id).on("touchmove",".ondrag-item",function(I){I.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(I){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${J.size.height/J.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${I.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(I){var V;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(V=c.test)&&void 0!==V&&V.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(I){},dragend:function(I){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${J.id} .ondrop-here`).kendoDropTarget({dragenter:function(I){I.dropTarget.hasClass("actived")&&I.dropTarget.addClass("focused")},dragleave:function(I){I.dropTarget.hasClass("actived")&&I.dropTarget.removeClass("focused")},drop:function(I){if(!I.dropTarget.hasClass("actived"))return;I.dropTarget.removeClass("focused");let yt=I.draggable.currentTarget;yt.appendTo(I.dropTarget),Et(J,c,{key:yt.data("key")})}});break;case"speech":break;case"submit":jQuery("#"+J.id).click(I=>{I.preventDefault(),((J,c,U,H,W)=>{var R,B,tt,I,V;let yt;var It;if(null!=c&&null!==(R=c.test)&&void 0!==R&&null!==(R=R.answer)&&void 0!==R&&R.truefalse)yt=null==c||null===(It=c.test)||void 0===It||null===(It=It.answer)||void 0===It||null===(It=It.truefalse)||void 0===It?void 0:It.iscorrect;else if(null!=c&&null!==(B=c.test)&&void 0!==B&&null!==(B=B.answer)&&void 0!==B&&B.singlechoice){var bt;yt=null==c||null===(bt=c.test)||void 0===bt||null===(bt=bt.answer)||void 0===bt||null===(bt=bt.singlechoice)||void 0===bt?void 0:bt.iscorrect}else if(null!=c&&null!==(tt=c.test)&&void 0!==tt&&null!==(tt=tt.answer)&&void 0!==tt&&tt.multichoice){var Nt,Zt,Ut;yt=1==[null==c||null===(Nt=c.test)||void 0===Nt||null===(Nt=Nt.answer)||void 0===Nt||null===(Nt=Nt.multichoice)||void 0===Nt?void 0:Nt.length,null==c||null===(Zt=c.test)||void 0===Zt||null===(Zt=Zt.answer)||void 0===Zt||null===(Zt=Zt.multichoice)||void 0===Zt||null===(Zt=Zt.map(ce=>ce.iscorrect?1:0))||void 0===Zt?void 0:Zt.reduce((ce,fe)=>ce+fe),null==c||null===(Ut=c.svg)||void 0===Ut||null===(Ut=Ut.nodes)||void 0===Ut||null===(Ut=Ut.filter(ce=>{var fe,Me;return"multichoice"==(null===(fe=ce.source)||void 0===fe||null===(fe=fe.test)||void 0===fe?void 0:fe.type)&&(null===(Me=ce.source)||void 0===Me||null===(Me=Me.test)||void 0===Me||null===(Me=Me.multichoice)||void 0===Me?void 0:Me.iscorrect)}))||void 0===Ut?void 0:Ut.length].filter((ce,fe,Me)=>Me.indexOf(ce)==fe).length}else if(null!=c&&null!==(I=c.test)&&void 0!==I&&null!==(I=I.answer)&&void 0!==I&&I.fill){var Xt,Wt;yt=(null==c||null===(Xt=c.test)||void 0===Xt||null===(Xt=Xt.answer)||void 0===Xt||null===(Xt=Xt.fill)||void 0===Xt||null===(Xt=Xt.map(ce=>ce.iscorrect?1:0))||void 0===Xt?void 0:Xt.reduce((ce,fe)=>ce+fe))==(null===(Wt=c.svg)||void 0===Wt||null===(Wt=Wt.nodes)||void 0===Wt||null===(Wt=Wt.filter(ce=>{var fe;return"fill"==(null===(fe=ce.source)||void 0===fe||null===(fe=fe.test)||void 0===fe?void 0:fe.type)}))||void 0===Wt?void 0:Wt.length)}else if(null!=c&&null!==(V=c.test)&&void 0!==V&&null!==(V=V.answer)&&void 0!==V&&V.matching){var ie,pe;yt=(null===(ie=c.svg)||void 0===ie||null===(ie=ie.nodes)||void 0===ie||null===(ie=ie.filter(ce=>{var fe;return"matching-empty"==(null===(fe=ce.source)||void 0===fe||null===(fe=fe.test)||void 0===fe?void 0:fe.type)}))||void 0===ie?void 0:ie.length)==((null==c||null===(pe=c.test)||void 0===pe||null===(pe=pe.answer)||void 0===pe?void 0:pe.matching)||[]).map(ce=>ce.key==ce.value?1:0).reduce((ce,fe)=>ce+fe)}Ht(J,c,U,H,{iscorrect:yt},W),console.log("node source ->",J.source),console.log("slide test ->",c.test)})(J,c,ht.nodeStatus,ht.slideStatus,H)})}})(c,J)};var re=f(8619),Q=f(8785),D=f(4921),d=f(8054),Z=f(2282),_t=f(2875),pt=f(8419);const Kt=(J,c,U)=>{if(U.slideStatus!=ht.slideStatus||!c.length)return;let H=c.shift(),W=J.filter(I=>I.idx==H);if(!W.length)return;let R=Math.max.apply(null,W.map(I=>{var V;return null!==(V=I.time)&&void 0!==V?V:0})),B=!1,tt=R<.5?0:setTimeout(()=>{B||(B=!0,Kt(J,c,U))},1e3*R);jt(J,c,W,0,U,{idx:H,total:W.length,counter:0,isRecursive:B,timeoutRecursive:tt,maxTimeCoundown:R,uid:Math.floor(1e9*Math.random())})},jt=(J,c,U,H,W,R)=>{if(W.slideStatus!=ht.slideStatus)return;let B=U[H];if(B){switch(B.type){case dt.$.GROUP:break;case dt.$.CIRCLE:(0,re._)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null);break;case dt.$.ELLIPSE:(0,Q.r)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null);break;case dt.$.LINE:(0,D.W)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null);break;case dt.$.RECT:(0,d.f)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null);break;case dt.$.POLYGON:(0,Z.l)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null);break;case dt.$.FOREIGNOBJECT:(0,_t.e)(B.id,{size:B.size,attribute:B.attribute,style:B.style,source:B.source},B.pid?window.document.getElementById(B.pid):null);break;case dt.$.IMAGE:(0,M.G)(B.id,{size:B.size,attribute:B.attribute,source:B.source},B.pid?window.document.getElementById(B.pid):null);break;case dt.$.TEXT:(0,m.$)(B.id,{size:B.size,attribute:B.attribute,source:B.source},B.pid?window.document.getElementById(B.pid):null);break;case dt.$.PATH:(0,pt.G)(B.id,{size:B.size,attribute:B.attribute},B.pid?window.document.getElementById(B.pid):null)}wt(W.slide,B,W,()=>{R.counter+=1,R.maxTimeCoundown<.5&&R.counter>=R.total&&(R.total=R.counter=0,R.isRecursive||(clearTimeout(R.timeoutRecursive),R.isRecursive=!0,setTimeout(()=>{Kt(J,c,W)},250)))}),jt(J,c,U,++H,W,R)}},ht=new class Ot{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(c){this._dataSource=c.data||{},E.icdt.variable.set=c.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var c,U;return null!==(c=null===(U=this._dataSource)||void 0===U||null===(U=U.slides)||void 0===U?void 0:U.length)&&void 0!==c?c:0}get slides(){var c;return(null===(c=this._dataSource)||void 0===c?void 0:c.slides)||[]}get slide(){var c;return((null===(c=this._dataSource)||void 0===c?void 0:c.slides)||[])[this._slideIdx]||{}}findNode(c){var U;let H=null===(U=this._dataSource)||void 0===U||null===(U=U.slides)||void 0===U?void 0:U.find((bt,Nt)=>Nt==this._slideIdx),W=null==H?void 0:H.svg,R=(bt,Nt)=>{let Zt=null==bt?void 0:bt.find(Wt=>Wt.id==c);if(Zt)return Zt.pid=Nt,Zt;let Ut=0,Xt=bt.length||0;for(;Ut<Xt&&!Zt&&(Zt=R(bt[Ut].nodes||[],bt[Ut].id),!Zt);)Ut++;return Zt},B=R((null==W?void 0:W.nodes)||[]);var tt,I,V,yt,It;return B?(B.style=null!==(tt=B.style)&&void 0!==tt?tt:{},B.source=null!==(I=B.source)&&void 0!==I?I:{},B.animate=null!==(V=B.animate)&&void 0!==V?V:{},B.interactive=null!==(yt=B.interactive)&&void 0!==yt?yt:{},B.variable=null!==(It=B.variable)&&void 0!==It?It:{},B):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(c,U,H){var W;let R;var B,tt;if(this.refreshNodeStatus(),this.refreshSlideStatus(),H)R=null===(B=this._dataSource)||void 0===B||null===(B=B.slides)||void 0===B?void 0:B.find(It=>It.code==H||It.id==H),R&&(this._slideIdx=(null===(tt=this._dataSource)||void 0===tt||null===(tt=tt.slides)||void 0===tt?void 0:tt.indexOf(R))||0);else if(U){var I,V;R=null===(I=this._dataSource)||void 0===I||null===(I=I.slides)||void 0===I?void 0:I.find(It=>It.id==U),R&&(this._slideIdx=(null===(V=this._dataSource)||void 0===V||null===(V=V.slides)||void 0===V?void 0:V.indexOf(R))||0)}else this._slideIdx=Math.min(Math.max(c||0,0),this.slideTotal-1),R=this.slide;if(R){var yt;Yt(E.icdt.container,E.icdt.svg,R,!0),null===(yt=jQuery(E.icdt.svg).find("#"+z.O.BACKGROUND_GROUP))||void 0===yt||yt.empty();let It=(0,C.g1)(z.O.BACKGROUND_GROUP,"g",void 0,E.icdt.svg);(0,C.x0)(It,R),(J=>{var c,U,H,W;let R=ht.nodeStatus,B=ht.slideStatus;null===(c=J.svg)||void 0===c||c.nodes.forEach(I=>{I.pid=Math.ceil(1e9*Math.random()),(0,S.m)(I.pid)});let tt=null===(U=J.svg)||void 0===U||null===(U=U.nodes)||void 0===U?void 0:U.map(I=>I.idx).filter((I,V,yt)=>yt.indexOf(I)==V).sort((I,V)=>(null!=I?I:0)-(null!=V?V:0));Kt(null!==(H=null===(W=J.svg)||void 0===W?void 0:W.nodes)&&void 0!==H?H:[],null!=tt?tt:[],{slide:J,nodeStatus:R,slideStatus:B})})(R)}this.changeSlide(this.slides,null===(W=this.slide)||void 0===W?void 0:W.id,this.slideIdx,this.slides.length,R)}set onChangeSlide(c){this._fnChangeSlides.push(c)}changeSlide(c,U,H,W,R){this._fnChangeSlides.forEach(B=>B(c,U,H,W,R))}},Yt=(J,c,U,H)=>{var W,R,B,tt;let I=window.document.querySelector(c);var V;I||(I=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(V=window.document.querySelector(J))||void 0===V||V.appendChild(I)),H&&(I.textContent=null);let{x:yt,y:It,width:bt,height:Nt}=null!==(W=null==U||null===(R=U.svg)||void 0===R?void 0:R.viewBox)&&void 0!==W?W:E.icdt.screen.frameSize;I.setAttributeNS(null,"viewBox",yt+" "+It+" "+bt+" "+Nt),I.setAttribute("id",c.replace("#",""));var ie,pe,Zt=null!==(B=jQuery(J).width())&&void 0!==B?B:1080,Ut=null!==(tt=jQuery(J).height())&&void 0!==tt?tt:1080,Wt=bt/Nt;Wt>=Zt/Ut?pe=(ie=Zt)/Wt:ie=(pe=Ut)*Wt,I.setAttributeNS(null,"width",ie.toString()),I.setAttributeNS(null,"height",pe.toString())}},7267:(le,At,f)=>{f.d(At,{E:()=>dt,Z:()=>E});var z=f(70);const E=(it,h,p)=>{var k,O;let{value:S}=null!==(k=it.animate)&&void 0!==k?k:{};dt(null!==(O=it.pid)&&void 0!==O?O:0,{node:it,value:S,nodeStatus:h,slideStatus:p},()=>{})},dt=(it,h,p)=>{var k;if(!h.value)return void p();let O=jQuery("#"+it);if(!O.length)return void p();let m="",S=null!==(k=h.iteration)&&void 0!==k?k:0,x=[];(h.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?x.push(h.value):h.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(h.value)?(x.push("animation"),x.push(`animation-${h.value}`)):(x.push("animate__animated"),x.push(`animate__${h.value}`)):(x.push("animation"),x.push("animation-fadein")),S<0?(x.push("animation-iteration-infinite"),p(),p=function(){}):S>0&&x.push("animation-iteration-"+(S+1)),m=x.join(" "),function(N){let F=function(){O.data("animate-running")?O.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){O.data("animate-running",!1),setTimeout(function(){N()},100)}):N()};O.hasClass("animation")?setTimeout(function(){F()}):F()}(function(){var N;P(it),(S>0||S<0)&&O.one("animationiteration",function(){h.slideStatus===z.$.slideStatus||(O.data("animate-running",!1),P(it),h.slideStatus===z.$.slideStatus&&p())}),O.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(O.data("animate-running",!1),P(it),h.finish){default:case 0:case 1:break;case 2:var F;dt(it,{node:h.node,value:null===(F=h.node.animate)||void 0===F?void 0:F.out,nodeStatus:h.nodeStatus,slideStatus:h.slideStatus},()=>{O.addClass("hide")})}h.slideStatus===z.$.slideStatus&&p()}),O.attr("data-class",null!==(N=O.attr("class"))&&void 0!==N?N:""),O.addClass(m),O.data("animate-running",!0)})},P=function(it){var h,p,k=jQuery("#"+it),O=null===(h=k.attr("class"))||void 0===h?void 0:h.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),m=null===(p=k.attr("class"))||void 0===p?void 0:p.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);O&&O.forEach(function(x){jQuery(k).removeClass(x)}),m&&m.forEach(function(x){jQuery(k).removeClass(x)});let S=k.attr("data-class");S&&(k.attr("class",S),k.removeAttr("data-class")),jQuery(k).data("animation-running",!1)}},2336:(le,At,f)=>{f.d(At,{Q:()=>dt});var z=f(70),E=f(7267);const dt=(it,h,p)=>{var k;if(!h.value)return void p();let O=jQuery("#"+it);if(!O.length)return void p();let m="",S=null!==(k=h.iteration)&&void 0!==k?k:0,x=[];(h.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?x.push(h.value):(x.push("animation"),x.push(h.value?"animation-"+h.value:"animation-fadein")),S<0?(x.push("animation-iteration-infinite"),p(),p=function(){}):S>0&&x.push("animation-iteration-"+(S+1)),m=x.join(" "),function(N){let F=function(){O.data("animate-running")?O.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){O.data("animate-running",!1),setTimeout(function(){N()},100)}):N()};O.hasClass("animation")?setTimeout(function(){F()}):F()}(function(){var N;P(it),(S>0||S<0)&&O.one("animationiteration",function(){h.slideStatus===z.$.slideStatus||(O.data("animate-running",!1),P(it),h.slideStatus===z.$.slideStatus&&p())}),O.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(O.data("animate-running",!1),P(it),h.finish){default:case 0:case 1:break;case 2:var F;(0,E.E)(it,{node:h.node,value:null===(F=h.node.animate)||void 0===F?void 0:F.out,nodeStatus:h.nodeStatus,slideStatus:h.slideStatus},()=>{O.addClass("hide")})}h.slideStatus===z.$.slideStatus&&p()}),O.attr("data-class",null!==(N=O.attr("class"))&&void 0!==N?N:""),O.addClass(m),O.data("animate-running",!0)})},P=function(it){var h,p=jQuery("#"+it),k=null===(h=p.attr("class"))||void 0===h?void 0:h.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);k&&k.forEach(function(m){jQuery(p).removeClass(m)});let O=p.attr("data-class");O&&(p.attr("class",O),p.removeAttr("data-class")),jQuery(p).data("animation-running",!1)}},861:(le,At,f)=>{f.d(At,{G:()=>it});var z=f(4318),E=f(70),dt=f(4080),P=f(7267);const it=(p,k,O)=>{var m;if(!k.points||!k.points.length)return void O();let S=jQuery("#"+p),x=function h(p){let k=[];2===p.length&&p.splice(1,0,[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2]);let nt,N,F,O=1,m=p.length;for(;O<m;){if(nt=p[O-1],N=p[O],F=p[O+1],(Math.abs(nt[0]-N[0])>=15||Math.abs(nt[1]-N[1])>=15)&&Math.pow(nt[0]-N[0],2)+Math.pow(nt[1]-N[1],2)>=Math.pow(15,2)&&F&&(Math.abs(nt[0]-F[0])<=20||Math.abs(nt[1]-F[1])<=20)&&Math.pow(nt[0]-F[0],2)+Math.pow(nt[1]-F[1],2)<=Math.pow(20,2))k.push(N);else{let M=N[0]-nt[0],q=N[1]-nt[1],vt=Math.max(Math.abs(M),Math.abs(q));for(var rt=0;rt<vt;rt+=15)k.push([nt[0]+M*rt/vt,nt[1]+q*rt/vt])}O++}return m>0&&(k.splice(0,0,p[0]),k.push(p[m-1])),k}(k.points||[]),nt=null!==(m=k.iteration)&&void 0!==m?m:0;if(nt<0&&(O(),O=function(){}),S.data("work-running")&&nt<0)return;S.data("work-running",!0);let gt,N=x.length,F=Math.max(20,1e3*(k.time||3)/N),{id:rt,type:M,size:q,attribute:vt}=E.$.findNode(p),ft=function(Y){if(k.slideStatus!==E.$.slideStatus)return S.data("work-running",!1),void(k.slideStatus===E.$.slideStatus&&O());if(Y<N){let Bt=x[Y];Bt&&(gt=Object.assign({},q,{x:Bt[0]-q.width/2,y:Bt[1]-q.height/2}),Object.assign(vt,(0,z.sg)(M,gt)),(0,dt.__)(window.document.getElementById(rt),vt),setTimeout(function(){ft(++Y)},F))}else if(nt>0)nt--,ft(1);else if(nt<0)ft(1);else switch(S.data("work-running",!1),k.slideStatus===E.$.slideStatus&&O(),k.finish){default:case 0:break;case 1:Object.assign(vt,(0,z.sg)(M,q)),(0,dt.__)(window.document.getElementById(rt),vt);break;case 2:var C,Lt;(0,P.E)(null!==(C=k.node.pid)&&void 0!==C?C:0,{node:k.node,value:null===(Lt=k.node.animate)||void 0===Lt?void 0:Lt.out,nodeStatus:k.nodeStatus,slideStatus:k.slideStatus},()=>{S.addClass("hide")})}};ft(1)}},157:(le,At,f)=>{f.d(At,{R:()=>dt});var z=f(4981),E=f(70);const dt=(it,h,p,k,O)=>{var m,S,x,nt,N,F,rt;if(k.slideStatus!=E.$.slideStatus)return h.async&&"change-slide"!=h.async?void 0:void O();if(k.nodeStatus!=E.$.nodeStatus&&(!h.async||"change-node"==h.async))return void O();if(!(null!==(m=h.source)&&void 0!==m&&m.path||null!==(S=h.source)&&void 0!==S&&S.url))return console.warn(`${it} -> audio no source!`),O(),void(O=()=>{});var M=jQuery("#"+it);let q=null!==(x=h.iteration)&&void 0!==x?x:0;if(q<0&&(O(),O=function(){}),!(M.data("audio-running")&&q<0)){M.data("audio-running",!0);var vt=function(ft){ft.pause(),ft.remove(),M.data("audio-running",!1)},gt=new Audio;return gt.autoplay=!0,gt.loop=0!=q,gt.preload="auto",gt.controls=!0,gt.setAttributeNode(document.createAttribute("playsinline")),gt.addEventListener("canplay",function(){var ft=gt.play();ft&&ft.then(function(Y){var C;M.data("audio-running",!0),"time"==h.async?setTimeout(()=>{vt(gt),O(),O=()=>{}},1e3*(null!==(C=h.time)&&void 0!==C?C:1)):"non-stop"==h.async&&(O(),O=()=>{})}).catch(function(Y){M.data("audio-running",!1),k.slideStatus===E.$.slideStatus&&(O(),O=()=>{})})}),gt.addEventListener("timeupdate",function(){switch(h.async){case"time":case"non-stop":break;case"finish-action":p.total>=2&&p.total-p.counter==1&&(vt(this),O(),O=()=>{});break;default:case"change-node":k.nodeStatus!==E.$.nodeStatus&&(vt(this),O(),O=()=>{});break;case"change-slide":k.slideStatus!==E.$.slideStatus&&(vt(this),O(),O=()=>{})}}),gt.addEventListener("canplaythrough",function(){this.loop&&(q>0?q--:0==q&&(this.loop=!1))}),gt.addEventListener("play",function(){}),gt.addEventListener("pause",function(){}),gt.addEventListener("ended",function(){this.remove(),M.data("audio-running",!1),k.slideStatus===E.$.slideStatus&&(O(),O=()=>{})}),gt.onerror=function(){this.remove(),M.data("audio-running",!1),k.slideStatus===E.$.slideStatus&&(O(),O=()=>{})},gt.src=(null!==(nt=h.source)&&void 0!==nt&&nt.path?(null===(N=z.icdt.config)||void 0===N?void 0:N.readfileuploadurl)+(null===(F=h.source)||void 0===F?void 0:F.path):null===(rt=h.source)||void 0===rt?void 0:rt.url)||"",gt}}},5973:(le,At,f)=>{f.d(At,{F:()=>k});var z=f(4981),E=f(70),dt=f(2336),P=f(861),it=f(157),h=f(4787),p=f(370);const k=(O,m,S,x)=>{var nt,N,F;let rt={total:0,counter:0},{triggershow:M,triggerrun:q,triggerhide:vt,action:gt,audio:ft,slide:Y,media:C}=null!==(nt=null===(N=O.interactive)||void 0===N?void 0:N.click)&&void 0!==nt?nt:{};if(M){let{id:Tt,ids:Ft,time:ut,async:X}=M;"asynctrue"==X?(0,h.L5)({id:Tt,ids:Ft,nodeStatus:m,slideStatus:S}):"time"==X&&setTimeout(()=>{(0,h.L5)({id:Tt,ids:Ft,nodeStatus:m,slideStatus:S})},1e3*(null!=ut?ut:0))}if(q){let{id:Tt,ids:Ft,time:ut,async:X}=q;"asynctrue"==X?(0,h.Ar)({id:Tt,ids:Ft,nodeStatus:m,slideStatus:S}):"time"==X&&setTimeout(()=>{(0,h.Ar)({id:Tt,ids:Ft,nodeStatus:m,slideStatus:S})},1e3*(null!=ut?ut:0))}if(vt){let{id:Tt,ids:Ft,time:ut,async:X}=vt;"asynctrue"==X?(0,h.WT)({id:Tt,ids:Ft,nodeStatus:m,slideStatus:S}):"time"==X&&setTimeout(()=>{(0,h.WT)({id:Tt,ids:Ft,nodeStatus:m,slideStatus:S})},1e3*(null!=ut?ut:0))}let Lt=()=>{setTimeout(()=>{if(rt.counter>=rt.total){if(x&&x(),M){let{id:Tt,ids:Ft,async:ut}=M;"asyncfalse"==ut&&(0,h.L5)({id:Tt,ids:Ft,nodeStatus:m,slideStatus:S})}if(q){let{id:Tt,ids:Ft,async:ut}=q;"asyncfalse"==ut&&(0,h.Ar)({id:Tt,ids:Ft,nodeStatus:m,slideStatus:S})}if(vt){let{id:Tt,ids:Ft,async:ut}=vt;"asyncfalse"==ut&&(0,h.WT)({id:Tt,ids:Ft,nodeStatus:m,slideStatus:S})}}})};if(null!=gt&&gt.value){rt.total+=1;let Tt=()=>{rt.counter+=1,Lt()};switch(null==gt?void 0:gt.value){case"hide":jQuery("#"+O.id).addClass("hide"),Tt();break;case"points":{let{points:Ft,time:ut,iteration:X,finish:Et}=gt;Ft&&(0,P.G)(O.id,{node:O,points:Ft,time:ut,iteration:X,finish:Et,nodeStatus:m,slideStatus:S},Tt);break}default:{var Bt;let{value:Ft,time:ut,iteration:X,finish:Et}=gt;(0,dt.Q)(null!==(Bt=O.pid)&&void 0!==Bt?Bt:0,{node:O,value:Ft,time:ut,iteration:X,finish:Et,nodeStatus:m,slideStatus:S},Tt);break}}}if(null!=ft&&null!==(F=ft.source)&&void 0!==F&&F.path){rt.total+=1;let Tt=()=>{rt.counter+=1,Lt()};(0,it.R)(O.id,ft,rt,{nodeStatus:m,slideStatus:S},Tt)}if(rt.total||Lt(),null!=Y&&Y.id)switch(console.log(`InteractiveNode #${O.id} slide(undefined,${Y.id},${Y.code}) success!`),Y.id){case-1:E.$.runSlide(E.$.slideIdx-1);break;case-2:E.$.runSlide(E.$.slideIdx+1);break;default:var Dt;E.$.runSlide(void 0,Y.id,null===(Dt=Y.code)||void 0===Dt?void 0:Dt.toString())}if(null!=C&&C.type){var ae;let Ft=`<div class="popup-media-viewer"><iframe src="${(0,p.e)({readfileuploadurl:null===(ae=z.icdt.config)||void 0===ae?void 0:ae.readfileuploadurl,type:null==C?void 0:C.type,oss:null==C?void 0:C.oss,path:null==C?void 0:C.path,pathExtract:null==C?void 0:C.pathExtract,url:null==C?void 0:C.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,ut=jQuery(Ft).appendTo(window.document.body);ut.find(".btn-close").click(function(X){X.preventDefault(),ut.remove()})}}},4787:(le,At,f)=>{f.d(At,{Ar:()=>it,L5:()=>P,WT:()=>h});var z=f(70),E=f(5973),dt=f(7267);const P=p=>{console.log("icdt_Run_Interactive_TriggerShow",p),p.id?jQuery("#"+p.id).removeClass("hide"):p.ids&&p.ids.forEach(k=>{jQuery("#"+k).removeClass("hide")})},it=p=>{console.log("icdt_Run_Interactive_TriggerRun",p),p.id?(jQuery("#"+p.id).removeClass("hide"),(0,E.F)(z.$.findNode(p.id),p.nodeStatus,p.slideStatus)):p.ids&&p.ids.forEach(k=>{jQuery("#"+k).removeClass("hide"),(0,E.F)(z.$.findNode(k),p.nodeStatus,p.slideStatus)})},h=p=>{if(console.log("icdt_Run_Interactive_TriggerHide",p),p.id){var k,O;let m=z.$.findNode(p.id);(0,dt.E)(null!==(k=jQuery("#"+p.id).parents("g").attr("id"))&&void 0!==k?k:0,{node:m,value:null===(O=m.animate)||void 0===O?void 0:O.out,nodeStatus:p.nodeStatus,slideStatus:p.slideStatus},()=>{jQuery("#"+p.id).addClass("hide")})}else p.ids&&p.ids.forEach(m=>{var S,x;let nt=z.$.findNode(m);(0,dt.E)(null!==(S=jQuery("#"+m).parents("g").attr("id"))&&void 0!==S?S:0,{node:nt,value:null===(x=nt.animate)||void 0===x?void 0:x.out,nodeStatus:p.nodeStatus,slideStatus:p.slideStatus},()=>{jQuery("#"+m).addClass("hide")})})}},4080:(le,At,f)=>{f.d(At,{Mh:()=>vt,wM:()=>Y,xo:()=>gt,it:()=>C,g1:()=>Tt,__:()=>Lt,QI:()=>Dt,DB:()=>Bt,eb:()=>ft,x0:()=>wt,g$:()=>Ft,mo:()=>Ht,XH:()=>kt,hJ:()=>ut,vl:()=>Et,yD:()=>X,Yw:()=>re});var z=f(9054),E=f(1687),it=/^#?[a-fA-F0-9]+$/;const k=(Q,D)=>{var d;if("none"==(Q=null!==(d=Q)&&void 0!==d?d:""))return"none";if("transparent"==Q)return"rgba(0,0,0,0)";if(Q.includes("rgba("))return Q;if(Q.includes("rgb(")&&(Q=((Q,D)=>{if(!Q)return"";let d=Q.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),Z=(d&&d[4]||"").trim(),_t=d?(256|d[1]).toString(16).slice(1)+(256|d[2]).toString(16).slice(1)+(256|d[3]).toString(16).slice(1):Q;return"0"==Z?"transparent":`#${_t}`})(Q)),!(Q=Q.replace(/[^0-9a-fA-F]/g,"")))return"";if(!it.test(Q))return console.error(`hex2rgba -> ${Q}: first argument has invalid hexadecimal characters`),"";if("#"===Q[0]&&(Q=Q.slice(1)),3===Q.length){let _t=Q.split("");_t.splice(2,0,Q[2]),_t.splice(1,0,Q[1]),_t.splice(0,0,Q[0]),Q=_t.join("")}if(6!==Q.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var Z=[parseInt(Q.slice(0,2),16),parseInt(Q.slice(2,4),16),parseInt(Q.slice(4,6),16)];return D="number"==typeof D?D:parseFloat(D),Z.push(D>=0&&D<=1?D:1),"rgba("+Z.join(",")+")"};var O=f(370),m=f(1814),S=f(4981),x=f(3423),nt=f(8054),N=f(7210),F=f(8619),rt=f(70),M=f(2875),q=f(1105);class vt{constructor(D,d){let Z=window.document.querySelector(d);var _t;Z||(Z=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(_t=window.document.querySelector(D))||void 0===_t||_t.appendChild(Z));let{svgViewBox:pt,svgSize:St}=S.icdt.screen.init();Z.setAttributeNS(null,"viewBox",`${pt.x} ${pt.y} ${pt.width} ${pt.height}`),Z.setAttribute("id",d.replace("#","")),Z.style.display="block",Z.style.width=`${St.width}px`,Z.style.height=`${St.height}px`,Z.style.backgroundColor="#fafafa",Z.style.cursor="default"}}const gt=Q=>{jQuery(S.icdt.target).find("#"+E.O.BACKGROUND_GROUP).empty();let D=Tt(E.O.BACKGROUND_GROUP,"g",void 0,S.icdt.target);wt(D,Q),(()=>{let d=window.document.getElementById(null==Q?void 0:Q.id);jQuery(d).find("#"+E.O.BACKGROUND_GROUP).empty();let Z=Tt(E.O.BACKGROUND_GROUP,"g",void 0,d);wt(Z,Q)})()},ft=()=>{let Q=S.icdt.screen.svgViewBox,D=S.icdt.screen.svgSize;S.icdt.target&&(S.icdt.target.setAttributeNS(null,"viewBox",`${Q.x} ${Q.y} ${Q.width} ${Q.height}`),S.icdt.target.style.left=`${D.x}px`,S.icdt.target.style.top=`${D.y}px`,S.icdt.target.style.width=`${D.width}px`,S.icdt.target.style.height=`${D.height}px`)},Y=()=>{jQuery(S.icdt.target).find(">*:not(defs)").remove()},C=(Q,D,d,Z,_t)=>{let pt;return Q?(pt=jQuery(_t||S.icdt.target).find("#"+Q).get(0),pt||(pt=window.document.createElementNS("http://www.w3.org/2000/svg",d),pt.setAttribute("id",Q),D==z.$.FOREIGNOBJECT&&pt.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(pt).appendTo(_t||S.icdt.target))):(pt=window.document.createElementNS("http://www.w3.org/2000/svg",d),jQuery(pt).appendTo(_t||S.icdt.target)),null!=Z&&Z.attribute&&Lt(pt,null==Z?void 0:Z.attribute),null!=Z&&Z.style&&Bt(pt,null==Z?void 0:Z.style),null!=Z&&Z.source&&Dt(pt,D,null==Z?void 0:Z.source),pt},Lt=(Q,D)=>{return jQuery(Q).attr((d=Object.assign({},D||{}),null===(Z=Object.keys(d))||void 0===Z||Z.forEach(St=>{switch(St){case"fill":break;case"stroke":var Kt;Object.assign(d,{"stroke-width":null!==(Kt=d.strokeWidth)&&void 0!==Kt?Kt:null,strokeWidth:null});break;case"strokeLinecap":var jt;Object.assign(d,{"stroke-linecap":null!==(jt=d.strokeLinecap)&&void 0!==jt?jt:null,strokeLinecap:null});break;case"strokeLinejoin":var Ot;Object.assign(d,{"stroke-linejoin":null!==(Ot=d.strokeLinejoin)&&void 0!==Ot?Ot:null,strokeLinejoin:null});break;case"strokeDasharray":var ht;Object.assign(d,{"stroke-dasharray":null!==(ht=d.strokeDasharray)&&void 0!==ht?ht:null,strokeDasharray:null});break;case"strokeDasharrays":var Yt,J;Object.assign(d,{"stroke-dasharray":null!==(Yt=null===(J=d.strokeDasharrays)||void 0===J?void 0:J.join(" "))&&void 0!==Yt?Yt:null,strokeDasharrays:null});break;case"fontFamily":var c;Object.assign(d,{"font-family":null!==(c=d.fontFamily)&&void 0!==c?c:null,fontFamily:null});break;case"fontSize":var U;Object.assign(d,{"font-size":null!==(U=d.fontSize)&&void 0!==U?U:null,fontSize:null});break;case"textLength":Object.assign(d,{textLength:d.textLength?`${d.textLength}px`:null});break;case"transformOrigin":var H;Object.assign(d,{"transform-origin":null!==(H=d.transformOrigin)&&void 0!==H?H:null,transformOrigin:null})}}),Object.assign({},null!=d?d:{},{fill:null!=d&&d.fill?k(d.fill,null!==(_t=null==d?void 0:d.fillOpacity)&&void 0!==_t?_t:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=d&&d.stroke?k(d.stroke,null!==(pt=null==d?void 0:d.strokeOpacity)&&void 0!==pt?pt:1):"rgba(0,0,0,0)",strokeOpacity:null}))),Q;var d,Z,_t,pt},Bt=(Q,D)=>{return jQuery(Q).css((d=Object.assign({},D||{}),null===(Z=Object.keys(d))||void 0===Z||Z.forEach(_t=>{switch(_t){case"padding":Object.assign(d,{padding:d.padding?`${d.padding}px`:null});break;case"borderWidth":var pt;Object.assign(d,d.borderWidth&&d.borderStyle&&d.borderColor?{"border-width":`${d.borderWidth}px`,"border-style":d.borderStyle,"border-color":k(d.borderColor,null!==(pt=d.borderOpacity)&&void 0!==pt?pt:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(d,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(d,{"border-radius":d.borderRadius?`${d.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var St;d.backgroundColor&&Object.assign(d,{"background-color":k(d.backgroundColor,null!==(St=d.backgroundOpacity)&&void 0!==St?St:1)}),Object.assign(d,{backgroundColor:null,backgroundOpacity:null})}}),d)),Q;var d,Z},Dt=(Q,D,d)=>{switch(D){case z.$.TEXT:var Z,_t;jQuery(Q).text(null!==(Z=null==d||null===(_t=d.text)||void 0===_t?void 0:_t.textContent)&&void 0!==Z?Z:"");break;case z.$.IMAGE:var pt,St,Kt,jt,Ot;jQuery(Q).attr("href",(null==d||null===(pt=d.image)||void 0===pt?void 0:pt.base64)||(null!=d&&null!==(St=d.image)&&void 0!==St&&St.path?(null===(Kt=S.icdt.config)||void 0===Kt?void 0:Kt.readfileuploadurl)+(null==d||null===(jt=d.image)||void 0===jt?void 0:jt.path):null==d||null===(Ot=d.image)||void 0===Ot?void 0:Ot.url)||"");break;case z.$.FOREIGNOBJECT:switch(null==d?void 0:d.type){case"text":var ht,Yt;if(null!==(ht=d.text)&&void 0!==ht&&ht.variableKeywords&&null!==(Yt=d.text)&&void 0!==Yt&&Yt.variableKeywords.length){var J;let g=S.icdt.variable.getKeys(),v=(null===(J=d.text)||void 0===J?void 0:J.textContent)||"";d.text.variableKeywords.forEach(T=>{var _=T.replace(/[^a-zA-Z0-9_]/gm,"");if(g.indexOf(_)>=0){var K=S.icdt.variable.getValue(_);v=v.replace(T,K)}}),jQuery(Q).text(v)}else{var c;jQuery(Q).text((null===(c=d.text)||void 0===c?void 0:c.textContent)||"")}break;case"html":{var U,H,W;let g=(null==d||null===(U=d.html)||void 0===U?void 0:U.htmlContent)||"";if(null!==(H=d.html)&&void 0!==H&&H.variableKeywords&&null!==(W=d.html)&&void 0!==W&&W.variableKeywords.length){let v=S.icdt.variable.getKeys();d.html.variableKeywords.forEach(T=>{var _=T.replace(/[^a-zA-Z0-9_]/gm,"");if(v.indexOf(_)>=0){var K=S.icdt.variable.getValue(_);g=g.replace(T,K)}})}jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${g}</div>`).find("img[path],video[path],iframe[path]").each((v,T)=>{var _,K;T.setAttribute("src",(null!==(_=null===(K=S.icdt.config)||void 0===K?void 0:K.readfileuploadurl)&&void 0!==_?_:"")+T.getAttribute("path")),T.removeAttribute("path")});break}case"input":var R,B,tt,I;if(null!==(R=d.input)&&void 0!==R&&R.input)jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(tt=null===(I=d.input)||void 0===I?void 0:I.placeholder)&&void 0!==tt?tt:""}" maxlength="100" /></div>`);else if(null!==(B=d.input)&&void 0!==B&&B.textarea){var V,yt;jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(V=null===(yt=d.input)||void 0===yt?void 0:yt.placeholder)&&void 0!==V?V:""}" maxlength="1000"></textarea></div>`)}break;case"image":var It,bt,Nt,Zt,Ut;jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(It=d.image)||void 0===It?void 0:It.base64)||(null!==(bt=d.image)&&void 0!==bt&&bt.path?(null===(Nt=S.icdt.config)||void 0===Nt?void 0:Nt.readfileuploadurl)+(null===(Zt=d.image)||void 0===Zt?void 0:Zt.path):null===(Ut=d.image)||void 0===Ut?void 0:Ut.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var Xt,Wt,ie,pe;jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${(null!==(Xt=d.iframe)&&void 0!==Xt&&Xt.path?(null===(Wt=S.icdt.config)||void 0===Wt?void 0:Wt.readfileuploadurl)+(null===(ie=d.iframe)||void 0===ie?void 0:ie.path):null===(pe=d.iframe)||void 0===pe?void 0:pe.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var ce,fe,Me,qe,We,ni;let g=(0,O.e)({readfileuploadurl:null===(ce=S.icdt.config)||void 0===ce?void 0:ce.readfileuploadurl,type:null===(fe=d.embed)||void 0===fe?void 0:fe.type,oss:null===(Me=d.embed)||void 0===Me?void 0:Me.oss,path:null===(qe=d.embed)||void 0===qe?void 0:qe.path,pathExtract:null===(We=d.embed)||void 0===We?void 0:We.pathExtract,url:null===(ni=d.embed)||void 0===ni?void 0:ni.url});jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${g}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var ri,vi;jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(ri=null===(vi=d.svg)||void 0===vi?void 0:vi.svgContent)&&void 0!==ri?ri:""}</div>`);break;case"test":{var Te,li,Ue,Je;let g=(null==d||null===(Te=d.html)||void 0===Te?void 0:Te.htmlContent)||"";if(null!==(li=d.html)&&void 0!==li&&li.variableKeywords&&null!==(Ue=d.html)&&void 0!==Ue&&Ue.variableKeywords.length){let v=S.icdt.variable.getKeys();d.html.variableKeywords.forEach(T=>{var _=T.replace(/[^a-zA-Z0-9_]/gm,"");if(v.indexOf(_)>=0){var K=S.icdt.variable.getValue(_);g=g.replace(T,K)}})}switch(null==d||null===(Je=d.test)||void 0===Je?void 0:Je.type){case"truefalse":var ai;jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(ai=d.test.truefalse)&&void 0!==ai&&ai.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"singlechoice":var oi;jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(oi=d.test.singlechoice)&&void 0!==oi&&oi.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"multichoice":var ti;jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(ti=d.test.multichoice)&&void 0!==ti&&ti.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"matching-empty":var Ze;jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty" data-key="${null==d||null===(Ze=d.test.matching)||void 0===Ze?void 0:Ze.key}"></div>`);break;case"matching-content":var si,xt,A;jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content" data-key="${null==d||null===(si=d.test.matching)||void 0===si?void 0:si.key}"><div class="ondrag-item" data-key="${null!==(xt=null==d||null===(A=d.test)||void 0===A||null===(A=A.matching)||void 0===A?void 0:A.key)&&void 0!==xt?xt:"KIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div></div>`);break;case"fill":var i;((null===(i=d.html)||void 0===i?void 0:i.fillKeywords)||[]).forEach(v=>{var T=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${v.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;g=g.replace(new RegExp(v.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),T)}),jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"speech":jQuery(Q).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var n,r,a,o,y;jQuery(Q).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(n=null!==(r=d.image)&&void 0!==r&&r.path?(null===(a=S.icdt.config)||void 0===a?void 0:a.readfileuploadurl)+(null===(o=d.image)||void 0===o?void 0:o.path):null===(y=d.image)||void 0===y?void 0:y.url)&&void 0!==n?n:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(Q).find("img[path],video[path],iframe[path]").each((v,T)=>{var _,K;T.setAttribute("src",(null!==(_=null===(K=S.icdt.config)||void 0===K?void 0:K.readfileuploadurl)&&void 0!==_?_:"")+T.getAttribute("path")),T.removeAttribute("path")})}}}},Tt=(Q,D,d,Z)=>{let _t=jQuery(Z||S.icdt.target).find("#"+Q).get(0);return _t||(_t=window.document.createElementNS("http://www.w3.org/2000/svg",D),_t.setAttribute("id",Q),jQuery(_t).appendTo(Z||S.icdt.target)),jQuery(_t).attr((null==d?void 0:d.attribute)||{}),jQuery(_t).css((null==d?void 0:d.style)||{}),_t},Ft=(Q,D)=>{let d=(0,x.v)(2),Z={fill:m.S3.fill,stroke:m.S3.stroke,"stroke-width":(0,x.v)(m.S3.strokeWidth)};return[{element:Tt("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:D.x-d,y:D.y-d,width:D.width+2*d,height:D.height+2*d},Z)},Q),posType:"rect-center"}]},ut=(Q,D)=>{let{size:d}=D,Z=(0,x.v)(1),_t=(0,x.v)(2),pt=(0,x.v)(5),St={stroke:m.NV.stroke,"stroke-width":(0,x.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},Kt={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,x.v)(m.Mo.strokeWidth)},jt={fill:m.In.fill,stroke:m.In.stroke,"stroke-width":(0,x.v)(m.In.strokeWidth),width:(0,x.v)(m.In.width),height:(0,x.v)(m.In.height)};return Tt("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:d.x-Z,y1:d.y,x2:d.x-Z,y2:d.y+d.height},St)},Q),Tt("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-Z,x2:d.x+d.width,y2:d.y-Z},St)},Q),Tt("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:d.x+d.width+Z,y1:d.y,x2:d.x+d.width+Z,y2:d.y+d.height},St)},Q),Tt("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+Z,x2:d.x+d.width,y2:d.y+d.height+Z},St)},Q),[{element:Tt("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},Kt),style:{cursor:"move"}},Q),posType:"rect-center"},{element:Tt("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:d.x-pt,y:d.y-pt},jt),style:{cursor:"nw-resize"}},Q),posType:"rect-top-left"},{element:Tt("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:d.x+d.width-_t,y:d.y-pt},jt),style:{cursor:"ne-resize"}},Q),posType:"rect-top-right"},{element:Tt("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:d.x-pt,y:d.y+d.height-_t},jt),style:{cursor:"sw-resize"}},Q),posType:"rect-bottom-left"},{element:Tt("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:d.x+d.width-_t,y:d.y+d.height-_t},jt),style:{cursor:"se-resize"}},Q),posType:"rect-bottom-right"}]},X=(Q,D,d)=>{let Z=(0,x.v)(1),_t={stroke:m.NV.stroke,"stroke-width":(0,x.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},pt={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,x.v)(m.Mo.strokeWidth)},St={fill:m.dt.fill,stroke:m.dt.stroke,"stroke-width":(0,x.v)(m.dt.strokeWidth)},Yt=(Tt("icdt-temp-select-line-left","line",{attribute:Object.assign({x1:d.x-Z,y1:d.y,x2:d.x-Z,y2:d.y+d.height},_t)},Q),Tt("icdt-temp-select-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-Z,x2:d.x+d.width,y2:d.y-Z},_t)},Q),Tt("icdt-temp-select-line-right","line",{attribute:Object.assign({x1:d.x+d.width+Z,y1:d.y,x2:d.x+d.width+Z,y2:d.y+d.height},_t)},Q),Tt("icdt-temp-select-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+Z,x2:d.x+d.width,y2:d.y+d.height+Z},_t)},Q),Tt("icdt-temp-select-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},pt)},Q));return D.forEach(J=>{let{size:c}=J;Tt("icdt-temp-select-rect-node-"+J.id,"rect",{attribute:Object.assign({x:c.x,y:c.y,width:c.width,height:c.height},St)},Q)}),[{element:Yt,posType:"rect-center"}]},Et=(Q,D)=>{let d=(0,x.v)(1),Z={stroke:m.NV.stroke,"stroke-width":(0,x.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},_t={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,x.v)(m.Mo.strokeWidth)};return Tt("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:D.x-d,y1:D.y,x2:D.x-d,y2:D.y+D.height},Z)},Q),Tt("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:D.x,y1:D.y-d,x2:D.x+D.width,y2:D.y-d},Z)},Q),Tt("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:D.x+D.width+d,y1:D.y,x2:D.x+D.width+d,y2:D.y+D.height},Z)},Q),Tt("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:D.x,y1:D.y+D.height+d,x2:D.x+D.width,y2:D.y+D.height+d},Z)},Q),[{element:Tt("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:D.x,y:D.y,width:D.width,height:D.height},_t)},Q),posType:"rect-center"}]},kt=(Q,D)=>{let d=(0,x.v)(-1),Z={stroke:m.h8.stroke,"stroke-width":(0,x.v)(m.h8.strokeWidth),"stroke-linecap":m.h8.strokeLinecap,"stroke-dasharray":(0,x.v)(m.h8.strokeDasharray)},_t={fill:m.MA.fill};return Tt("icdt-temp-interactive-line-left","line",{attribute:Object.assign({x1:D.x-d,y1:D.y,x2:D.x-d,y2:D.y+D.height},Z)},Q),Tt("icdt-temp-interactive-line-top","line",{attribute:Object.assign({x1:D.x,y1:D.y-d,x2:D.x+D.width,y2:D.y-d},Z)},Q),Tt("icdt-temp-interactive-line-right","line",{attribute:Object.assign({x1:D.x+D.width+d,y1:D.y,x2:D.x+D.width+d,y2:D.y+D.height},Z)},Q),Tt("icdt-temp-interactive-line-bottom","line",{attribute:Object.assign({x1:D.x,y1:D.y+D.height+d,x2:D.x+D.width,y2:D.y+D.height+d},Z)},Q),Tt("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:D.x,y:D.y,width:D.width,height:D.height},_t)},Q),[]},Ht=(Q,D)=>{let d={fill:m.k0.fill,stroke:m.k0.stroke,"stroke-width":(0,x.v)(m.k0.strokeWidth),"stroke-dasharray":(0,x.v)(m.k0.strokeDasharray)};jQuery(Q).empty(),D.forEach(Z=>{var _t,pt;let{size:St}=Z;if(!Z.idx)return;Tt("icdt-temp-index-rect-node-"+Z.id,"rect",{attribute:Object.assign({x:St.x-5,y:St.y-5,width:St.width+10,height:St.height+10},d)},Q);let{element:Kt}=(0,M.e)(Math.ceil(1e9*Math.random()),{size:{x:St.x-76,y:St.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(_t=Z.idx)&&void 0!==_t?_t:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(pt=Z.time)&&void 0!==pt?pt:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},Q);Kt.classList.add("node-input"),jQuery(Kt).on("change",'input[name="idx"]',jt=>{var Ot;Z.idx=parseInt(null!==(Ot=jt.target.value)&&void 0!==Ot?Ot:"0")}).on("change",'input[name="time"]',jt=>{var Ot;Z.time=parseFloat(null!==(Ot=jt.target.value)&&void 0!==Ot?Ot:"0")}).on("click",'button[name="remove"]',jt=>{Z.idx=0,Z.time=null,Ht(Q,D)})})},wt=(Q,D)=>{var d,Z,_t,pt,St,Kt;let{color:jt,opacity:Ot,path:ht,url:Yt,base64:J}=null!==(d=null==D||null===(Z=D.svg)||void 0===Z?void 0:Z.background)&&void 0!==d?d:{},{x:c,y:U,width:H,height:W}=null!==(_t=null==D||null===(pt=D.svg)||void 0===pt?void 0:pt.viewBox)&&void 0!==_t?_t:{x:0,y:0,width:0,height:0};(0,q.$)(void 0,{size:{x:0,y:-7,width:H,height:W},attribute:{fill:"#999",fontSize:14,class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(St=null!==(Kt=null==D?void 0:D.name)&&void 0!==Kt?Kt:null==D?void 0:D.code)&&void 0!==St?St:void 0}}},Q),(0,nt.f)(void 0,{size:{x:c,y:U,width:H,height:W},attribute:{fill:"#fff",stroke:"#999",strokeWidth:1,strokeDasharray:10,class:"hide-on-viewer"}},Q),jt&&(0,nt.f)(void 0,{size:{x:c,y:U,width:H,height:W},attribute:{fill:jt,fillOpacity:Ot}},Q),ht&&(0,N.G)(void 0,{size:{x:c,y:U,width:H,height:W},source:{type:"image",image:{path:ht,url:Yt,base64:J}}},Q)},re=(Q,D)=>{var d;switch(jQuery(Q).empty(),null===(d=D.test)||void 0===d?void 0:d.type){case"truefalse":{var Z,_t,pt;let U=null==D||null===(Z=D.test)||void 0===Z||null===(Z=Z.answer)||void 0===Z||null===(Z=Z.truefalse)||void 0===Z?void 0:Z.value;null===(_t=D.svg)||void 0===_t||_t.nodes.filter(H=>{var W;return"truefalse"==(null===(W=H.source)||void 0===W||null===(W=W.test)||void 0===W?void 0:W.type)&&H.id!=U}).forEach(H=>{var W;let{x:B,y:tt,width:I,height:V}=null!==(W=null==H?void 0:H.size)&&void 0!==W?W:{x:0,y:0,width:0,height:0};(0,F._)(Math.ceil(1e9*Math.random()),{size:{x:B-.5,y:tt-.5,width:I+1,height:V+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},Q)}),null!=D&&null!==(pt=D.test)&&void 0!==pt&&null!==(pt=pt.answer)&&void 0!==pt&&pt.truefalse&&U&&(H=>{let W=rt.$.findNode(U),{x:B,y:tt,width:I,height:V}=null!==(H=null==W?void 0:W.size)&&void 0!==H?H:{x:0,y:0,width:0,height:0};(0,F._)(Math.ceil(1e9*Math.random()),{size:{x:B-2,y:tt-2,width:I+4,height:V+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},Q)})();break}case"singlechoice":{var St,Kt,jt;let U=null==D||null===(St=D.test)||void 0===St||null===(St=St.answer)||void 0===St||null===(St=St.singlechoice)||void 0===St?void 0:St.value;null===(Kt=D.svg)||void 0===Kt||Kt.nodes.filter(H=>{var W;return"singlechoice"==(null===(W=H.source)||void 0===W||null===(W=W.test)||void 0===W?void 0:W.type)&&H.id!=U}).forEach(H=>{var W;let{x:B,y:tt,width:I,height:V}=null!==(W=null==H?void 0:H.size)&&void 0!==W?W:{x:0,y:0,width:0,height:0};(0,F._)(Math.ceil(1e9*Math.random()),{size:{x:B-.5,y:tt-.5,width:I+1,height:V+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},Q)}),null!=D&&null!==(jt=D.test)&&void 0!==jt&&null!==(jt=jt.answer)&&void 0!==jt&&jt.singlechoice&&U&&(H=>{let W=rt.$.findNode(U),{x:B,y:tt,width:I,height:V}=null!==(H=null==W?void 0:W.size)&&void 0!==H?H:{x:0,y:0,width:0,height:0};(0,F._)(Math.ceil(1e9*Math.random()),{size:{x:B-2,y:tt-2,width:I+4,height:V+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},Q)})();break}case"multichoice":{var Ot,ht,Yt,J;let U=null!==(Ot=null==D||null===(ht=D.test)||void 0===ht||null===(ht=ht.answer)||void 0===ht||null===(ht=ht.multichoice)||void 0===ht?void 0:ht.map(H=>H.value))&&void 0!==Ot?Ot:[];var c;null===(Yt=D.svg)||void 0===Yt||Yt.nodes.filter(H=>{var W;return"multichoice"==(null===(W=H.source)||void 0===W||null===(W=W.test)||void 0===W?void 0:W.type)&&!U.includes(H.id)}).forEach(H=>{var W;let{x:B,y:tt,width:I,height:V}=null!==(W=null==H?void 0:H.size)&&void 0!==W?W:{x:0,y:0,width:0,height:0};(0,nt.f)(Math.ceil(1e9*Math.random()),{size:{x:B-.5,y:tt-.5,width:I+1,height:V+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},Q)}),null!=D&&null!==(J=D.test)&&void 0!==J&&null!==(J=J.answer)&&void 0!==J&&J.multichoice&&U.length&&(null==D||null===(c=D.test)||void 0===c||null===(c=c.answer)||void 0===c||c.multichoice.forEach(H=>{var W;let R=rt.$.findNode(H.value),{x:tt,y:I,width:V,height:yt}=null!==(W=null==R?void 0:R.size)&&void 0!==W?W:{x:0,y:0,width:0,height:0};(0,nt.f)(Math.ceil(1e9*Math.random()),{size:{x:tt-2,y:I-2,width:V+4,height:yt+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},Q)}));break}}}},370:(le,At,f)=>{f.d(At,{e:()=>dt});const dt=h=>{switch(null==h?void 0:h.type){case 901:return"assets/iframe/lib/mk-image-viewer/viewer.html?url="+h.readfileuploadurl+h.path;case 902:return"assets/iframe/lib/mk-audio-player/player.html?url="+h.readfileuploadurl+h.path;case 903:return"assets/iframe/lib/mk-video-player/player.html?url="+h.readfileuploadurl+h.path;case 908:return"https://view.officeapps.live.com/op/view.aspx?src="+h.readfileuploadurl+h.path;case 909:return"assets/iframe/lib/PDFReader/web/viewer.html?file="+h.readfileuploadurl+h.path;case 906:case 911:case 910:return""+h.readfileuploadurl+h.path;case 905:var p;return"imsmanifest.xml"==(null===(p=h.pathExtract)||void 0===p||null===(p=p.split("/"))||void 0===p?void 0:p.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+h.readfileuploadurl+h.pathExtract:""+h.readfileuploadurl+h.path;case 907:case 900:return""+h.readfileuploadurl+h.path;case 904:switch(h.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+h.url;case 1002:var k;return null!==(k=P(h.url))&&void 0!==k?k:"";case 1005:var O;return null!==(O=h.url)&&void 0!==O?O:"";default:var m;return null!==(m=h.url)&&void 0!==m?m:""}default:return""+h.readfileuploadurl+h.path}},P=h=>{let p=it(h);return p?"https://www.youtube.com/embed/"+p+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},it=h=>{let p=null==h?void 0:h.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return p&&p.length>=2?p[1]:null}},511:(le,At,f)=>{function z(){}function E(t){return null==t?z:function(){return this.querySelector(t)}}function it(){return[]}function h(t){return null==t?it:function(){return this.querySelectorAll(t)}}function O(t){return function(){return this.matches(t)}}function m(t){return function(e){return e.matches(t)}}f.d(At,{$0Z:()=>aa,jvg:()=>la});var S=Array.prototype.find;function nt(){return this.firstElementChild}var F=Array.prototype.filter;function rt(){return Array.from(this.children)}function gt(t){return new Array(t.length)}function Y(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Lt(t,e,l,s,u,w){for(var L,b=0,j=e.length,lt=w.length;b<lt;++b)(L=e[b])?(L.__data__=w[b],s[b]=L):l[b]=new Y(t,w[b]);for(;b<j;++b)(L=e[b])&&(u[b]=L)}function Bt(t,e,l,s,u,w,b){var L,j,Vt,lt=new Map,st=e.length,Pt=w.length,Rt=new Array(st);for(L=0;L<st;++L)(j=e[L])&&(Rt[L]=Vt=b.call(j,j.__data__,L,e)+"",lt.has(Vt)?u[L]=j:lt.set(Vt,j));for(L=0;L<Pt;++L)Vt=b.call(t,w[L],L,w)+"",(j=lt.get(Vt))?(s[L]=j,j.__data__=w[L],lt.delete(Vt)):l[L]=new Y(t,w[L]);for(L=0;L<st;++L)(j=e[L])&&lt.get(Rt[L])===j&&(u[L]=j)}function Dt(t){return t.__data__}function Tt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ht(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Y.prototype={constructor:Y,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var _t="http://www.w3.org/1999/xhtml";const pt={svg:"http://www.w3.org/2000/svg",xhtml:_t,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function St(t){var e=t+="",l=e.indexOf(":");return l>=0&&"xmlns"!==(e=t.slice(0,l))&&(t=t.slice(l+1)),pt.hasOwnProperty(e)?{space:pt[e],local:t}:t}function Kt(t){return function(){this.removeAttribute(t)}}function jt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ot(t,e){return function(){this.setAttribute(t,e)}}function ht(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Yt(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttribute(t):this.setAttribute(t,l)}}function J(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,l)}}function U(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function H(t){return function(){this.style.removeProperty(t)}}function W(t,e,l){return function(){this.style.setProperty(t,e,l)}}function R(t,e,l){return function(){var s=e.apply(this,arguments);null==s?this.style.removeProperty(t):this.style.setProperty(t,s,l)}}function tt(t,e){return t.style.getPropertyValue(e)||U(t).getComputedStyle(t,null).getPropertyValue(e)}function I(t){return function(){delete this[t]}}function V(t,e){return function(){this[t]=e}}function yt(t,e){return function(){var l=e.apply(this,arguments);null==l?delete this[t]:this[t]=l}}function bt(t){return t.trim().split(/^|\s+/)}function Nt(t){return t.classList||new Zt(t)}function Zt(t){this._node=t,this._names=bt(t.getAttribute("class")||"")}function Ut(t,e){for(var l=Nt(t),s=-1,u=e.length;++s<u;)l.add(e[s])}function Xt(t,e){for(var l=Nt(t),s=-1,u=e.length;++s<u;)l.remove(e[s])}function Wt(t){return function(){Ut(this,t)}}function ie(t){return function(){Xt(this,t)}}function pe(t,e){return function(){(e.apply(this,arguments)?Ut:Xt)(this,t)}}function fe(){this.textContent=""}function Me(t){return function(){this.textContent=t}}function qe(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ni(){this.innerHTML=""}function ri(t){return function(){this.innerHTML=t}}function vi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function li(){this.nextSibling&&this.parentNode.appendChild(this)}function Je(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function oi(t){return function(){var e=this.ownerDocument,l=this.namespaceURI;return l===_t&&e.documentElement.namespaceURI===_t?e.createElement(t):e.createElementNS(l,t)}}function ti(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ze(t){var e=St(t);return(e.local?ti:oi)(e)}function xt(){return null}function i(){var t=this.parentNode;t&&t.removeChild(this)}function r(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function a(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function T(t){return function(){var e=this.__on;if(e){for(var w,l=0,s=-1,u=e.length;l<u;++l)w=e[l],t.type&&w.type!==t.type||w.name!==t.name?e[++s]=w:this.removeEventListener(w.type,w.listener,w.options);++s?e.length=s:delete this.__on}}}function _(t,e,l){return function(){var u,s=this.__on,w=function g(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var b=0,L=s.length;b<L;++b)if((u=s[b]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.options),this.addEventListener(u.type,u.listener=w,u.options=l),void(u.value=e);this.addEventListener(t.type,w,l),u={type:t.type,name:t.name,value:e,listener:w,options:l},s?s.push(u):this.__on=[u]}}function G(t,e,l){var s=U(t),u=s.CustomEvent;"function"==typeof u?u=new u(e,l):(u=s.document.createEvent("Event"),l?(u.initEvent(e,l.bubbles,l.cancelable),u.detail=l.detail):u.initEvent(e,!1,!1)),t.dispatchEvent(u)}function at(t,e){return function(){return G(this,t,e)}}function ct(t,e){return function(){return G(this,t,e.apply(this,arguments))}}Zt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var oe=[null];function he(t,e){this._groups=t,this._parents=e}function ge(){return new he([[document.documentElement]],oe)}he.prototype=ge.prototype={constructor:he,select:function dt(t){"function"!=typeof t&&(t=E(t));for(var e=this._groups,l=e.length,s=new Array(l),u=0;u<l;++u)for(var j,lt,w=e[u],b=w.length,L=s[u]=new Array(b),st=0;st<b;++st)(j=w[st])&&(lt=t.call(j,j.__data__,st,w))&&("__data__"in j&&(lt.__data__=j.__data__),L[st]=lt);return new he(s,this._parents)},selectAll:function k(t){t="function"==typeof t?function p(t){return function(){return function P(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):h(t);for(var e=this._groups,l=e.length,s=[],u=[],w=0;w<l;++w)for(var j,b=e[w],L=b.length,lt=0;lt<L;++lt)(j=b[lt])&&(s.push(t.call(j,j.__data__,lt,b)),u.push(j));return new he(s,u)},selectChild:function N(t){return this.select(null==t?nt:function x(t){return function(){return S.call(this.children,t)}}("function"==typeof t?t:m(t)))},selectChildren:function q(t){return this.selectAll(null==t?rt:function M(t){return function(){return F.call(this.children,t)}}("function"==typeof t?t:m(t)))},filter:function vt(t){"function"!=typeof t&&(t=O(t));for(var e=this._groups,l=e.length,s=new Array(l),u=0;u<l;++u)for(var j,w=e[u],b=w.length,L=s[u]=[],lt=0;lt<b;++lt)(j=w[lt])&&t.call(j,j.__data__,lt,w)&&L.push(j);return new he(s,this._parents)},data:function ae(t,e){if(!arguments.length)return Array.from(this,Dt);var l=e?Bt:Lt,s=this._parents,u=this._groups;"function"!=typeof t&&(t=function C(t){return function(){return t}}(t));for(var w=u.length,b=new Array(w),L=new Array(w),j=new Array(w),lt=0;lt<w;++lt){var st=s[lt],Pt=u[lt],Rt=Pt.length,Vt=Tt(t.call(st,st&&st.__data__,lt,s)),me=Vt.length,xe=L[lt]=new Array(me),Ct=b[lt]=new Array(me);l(st,Pt,xe,Ct,j[lt]=new Array(Rt),Vt,e);for(var se,ve,te=0,Jt=0;te<me;++te)if(se=xe[te]){for(te>=Jt&&(Jt=te+1);!(ve=Ct[Jt])&&++Jt<me;);se._next=ve||null}}return(b=new he(b,s))._enter=L,b._exit=j,b},enter:function ft(){return new he(this._enter||this._groups.map(gt),this._parents)},exit:function Ft(){return new he(this._exit||this._groups.map(gt),this._parents)},join:function ut(t,e,l){var s=this.enter(),u=this,w=this.exit();return"function"==typeof t?(s=t(s))&&(s=s.selection()):s=s.append(t+""),null!=e&&(u=e(u))&&(u=u.selection()),null==l?w.remove():l(w),s&&u?s.merge(u).order():u},merge:function X(t){for(var e=t.selection?t.selection():t,l=this._groups,s=e._groups,u=l.length,b=Math.min(u,s.length),L=new Array(u),j=0;j<b;++j)for(var Vt,lt=l[j],st=s[j],Pt=lt.length,Rt=L[j]=new Array(Pt),me=0;me<Pt;++me)(Vt=lt[me]||st[me])&&(Rt[me]=Vt);for(;j<u;++j)L[j]=l[j];return new he(L,this._parents)},selection:function we(){return this},order:function Et(){for(var t=this._groups,e=-1,l=t.length;++e<l;)for(var b,s=t[e],u=s.length-1,w=s[u];--u>=0;)(b=s[u])&&(w&&4^b.compareDocumentPosition(w)&&w.parentNode.insertBefore(b,w),w=b);return this},sort:function kt(t){function e(Pt,Rt){return Pt&&Rt?t(Pt.__data__,Rt.__data__):!Pt-!Rt}t||(t=Ht);for(var l=this._groups,s=l.length,u=new Array(s),w=0;w<s;++w){for(var lt,b=l[w],L=b.length,j=u[w]=new Array(L),st=0;st<L;++st)(lt=b[st])&&(j[st]=lt);j.sort(e)}return new he(u,this._parents).order()},call:function wt(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function re(){return Array.from(this)},node:function Q(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var s=t[e],u=0,w=s.length;u<w;++u){var b=s[u];if(b)return b}return null},size:function D(){let t=0;for(const e of this)++t;return t},empty:function d(){return!this.node()},each:function Z(t){for(var e=this._groups,l=0,s=e.length;l<s;++l)for(var L,u=e[l],w=0,b=u.length;w<b;++w)(L=u[w])&&t.call(L,L.__data__,w,u);return this},attr:function c(t,e){var l=St(t);if(arguments.length<2){var s=this.node();return l.local?s.getAttributeNS(l.space,l.local):s.getAttribute(l)}return this.each((null==e?l.local?jt:Kt:"function"==typeof e?l.local?J:Yt:l.local?ht:Ot)(l,e))},style:function B(t,e,l){return arguments.length>1?this.each((null==e?H:"function"==typeof e?R:W)(t,e,null==l?"":l)):tt(this.node(),t)},property:function It(t,e){return arguments.length>1?this.each((null==e?I:"function"==typeof e?yt:V)(t,e)):this.node()[t]},classed:function ce(t,e){var l=bt(t+"");if(arguments.length<2){for(var s=Nt(this.node()),u=-1,w=l.length;++u<w;)if(!s.contains(l[u]))return!1;return!0}return this.each(("function"==typeof e?pe:e?Wt:ie)(l,e))},text:function We(t){return arguments.length?this.each(null==t?fe:("function"==typeof t?qe:Me)(t)):this.node().textContent},html:function Te(t){return arguments.length?this.each(null==t?ni:("function"==typeof t?vi:ri)(t)):this.node().innerHTML},raise:function Ue(){return this.each(li)},lower:function ai(){return this.each(Je)},append:function si(t){var e="function"==typeof t?t:Ze(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function A(t,e){var l="function"==typeof t?t:Ze(t),s=null==e?xt:"function"==typeof e?e:E(e);return this.select(function(){return this.insertBefore(l.apply(this,arguments),s.apply(this,arguments)||null)})},remove:function n(){return this.each(i)},clone:function o(t){return this.select(t?a:r)},datum:function y(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function K(t,e,l){var u,b,s=function v(t){return t.trim().split(/^|\s+/).map(function(e){var l="",s=e.indexOf(".");return s>=0&&(l=e.slice(s+1),e=e.slice(0,s)),{type:e,name:l}})}(t+""),w=s.length;if(!(arguments.length<2)){for(L=e?_:T,u=0;u<w;++u)this.each(L(s[u],e,l));return this}var L=this.node().__on;if(L)for(var st,j=0,lt=L.length;j<lt;++j)for(u=0,st=L[j];u<w;++u)if((b=s[u]).type===st.type&&b.name===st.name)return st.value},dispatch:function ot(t,e){return this.each(("function"==typeof e?ct:at)(t,e))},[Symbol.iterator]:function*Gt(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var b,s=t[e],u=0,w=s.length;u<w;++u)(b=s[u])&&(yield b)}};const ye=ge;var Ee={value:()=>{}};function vn(){for(var s,t=0,e=arguments.length,l={};t<e;++t){if(!(s=arguments[t]+"")||s in l||/[\s.]/.test(s))throw new Error("illegal type: "+s);l[s]=[]}return new Ni(l)}function Ni(t){this._=t}function ar(t,e){for(var u,l=0,s=t.length;l<s;++l)if((u=t[l]).name===e)return u.value}function gn(t,e,l){for(var s=0,u=t.length;s<u;++s)if(t[s].name===e){t[s]=Ee,t=t.slice(0,s).concat(t.slice(s+1));break}return null!=l&&t.push({name:e,value:l}),t}Ni.prototype=vn.prototype={constructor:Ni,on:function(t,e){var u,l=this._,s=function lr(t,e){return t.trim().split(/^|\s+/).map(function(l){var s="",u=l.indexOf(".");if(u>=0&&(s=l.slice(u+1),l=l.slice(0,u)),l&&!e.hasOwnProperty(l))throw new Error("unknown type: "+l);return{type:l,name:s}})}(t+"",l),w=-1,b=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++w<b;)if(u=(t=s[w]).type)l[u]=gn(l[u],t.name,e);else if(null==e)for(u in l)l[u]=gn(l[u],t.name,null);return this}for(;++w<b;)if((u=(t=s[w]).type)&&(u=ar(l[u],t.name)))return u},copy:function(){var t={},e=this._;for(var l in e)t[l]=e[l].slice();return new Ni(t)},call:function(t,e){if((u=arguments.length-2)>0)for(var u,w,l=new Array(u),s=0;s<u;++s)l[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,u=(w=this._[t]).length;s<u;++s)w[s].value.apply(e,l)},apply:function(t,e,l){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],u=0,w=s.length;u<w;++u)s[u].value.apply(e,l)}};const or=vn;var Ri,Oi,gi=0,xi=0,Ei=0,yn=1e3,Li=0,di=0,Di=0,Si="object"==typeof performance&&performance.now?performance:Date,pn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Xi(){return di||(pn(sr),di=Si.now()+Di)}function sr(){di=0}function ji(){this._call=this._time=this._next=null}function mn(t,e,l){var s=new ji;return s.restart(t,e,l),s}function _n(){di=(Li=Si.now())+Di,gi=xi=0;try{!function dr(){Xi(),++gi;for(var e,t=Ri;t;)(e=di-t._time)>=0&&t._call.call(void 0,e),t=t._next;--gi}()}finally{gi=0,function hr(){for(var t,l,e=Ri,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(l=e._next,e._next=null,e=t?t._next=l:Ri=l);Oi=t,Yi(s)}(),di=0}}function ur(){var t=Si.now(),e=t-Li;e>yn&&(Di-=e,Li=t)}function Yi(t){gi||(xi&&(xi=clearTimeout(xi)),t-di>24?(t<1/0&&(xi=setTimeout(_n,t-Si.now()-Di)),Ei&&(Ei=clearInterval(Ei))):(Ei||(Li=Si.now(),Ei=setInterval(ur,yn)),gi=1,pn(_n)))}function wn(t,e,l){var s=new ji;return s.restart(u=>{s.stop(),t(u+e)},e=null==e?0:+e,l),s}ji.prototype=mn.prototype={constructor:ji,restart:function(t,e,l){if("function"!=typeof t)throw new TypeError("callback is not a function");l=(null==l?Xi():+l)+(null==e?0:+e),!this._next&&Oi!==this&&(Oi?Oi._next=this:Ri=this,Oi=this),this._call=t,this._time=l,Yi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yi())}};var cr=or("start","end","cancel","interrupt"),fr=[],bn=0,zi=3;function Ki(t,e,l,s,u,w){var b=t.__transition;if(b){if(l in b)return}else t.__transition={};!function vr(t,e,l){var u,s=t.__transition;function b(lt){var st,Pt,Rt,Vt;if(1!==l.state)return j();for(st in s)if((Vt=s[st]).name===l.name){if(Vt.state===zi)return wn(b);4===Vt.state?(Vt.state=6,Vt.timer.stop(),Vt.on.call("interrupt",t,t.__data__,Vt.index,Vt.group),delete s[st]):+st<e&&(Vt.state=6,Vt.timer.stop(),Vt.on.call("cancel",t,t.__data__,Vt.index,Vt.group),delete s[st])}if(wn(function(){l.state===zi&&(l.state=4,l.timer.restart(L,l.delay,l.time),L(lt))}),l.state=2,l.on.call("start",t,t.__data__,l.index,l.group),2===l.state){for(l.state=zi,u=new Array(Rt=l.tween.length),st=0,Pt=-1;st<Rt;++st)(Vt=l.tween[st].value.call(t,t.__data__,l.index,l.group))&&(u[++Pt]=Vt);u.length=Pt+1}}function L(lt){for(var st=lt<l.duration?l.ease.call(null,lt/l.duration):(l.timer.restart(j),l.state=5,1),Pt=-1,Rt=u.length;++Pt<Rt;)u[Pt].call(t,st);5===l.state&&(l.on.call("end",t,t.__data__,l.index,l.group),j())}function j(){for(var lt in l.state=6,l.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=l,l.timer=mn(function w(lt){l.state=1,l.timer.restart(b,l.delay,l.time),l.delay<=lt&&b(lt-l.delay)},0,l.time)}(t,l,{name:e,index:s,group:u,on:cr,tween:fr,time:w.time,delay:w.delay,duration:w.duration,ease:w.ease,timer:null,state:bn})}function tn(t,e){var l=Ge(t,e);if(l.state>bn)throw new Error("too late; already scheduled");return l}function Qe(t,e){var l=Ge(t,e);if(l.state>zi)throw new Error("too late; already running");return l}function Ge(t,e){var l=t.__transition;if(!l||!(l=l[e]))throw new Error("transition not found");return l}function ei(t,e){return t=+t,e=+e,function(l){return t*(1-l)+e*l}}var Wi,On=180/Math.PI,en={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Sn(t,e,l,s,u,w){var b,L,j;return(b=Math.sqrt(t*t+e*e))&&(t/=b,e/=b),(j=t*l+e*s)&&(l-=t*j,s-=e*j),(L=Math.sqrt(l*l+s*s))&&(l/=L,s/=L,j/=L),t*s<e*l&&(t=-t,e=-e,j=-j,b=-b),{translateX:u,translateY:w,rotate:Math.atan2(e,t)*On,skewX:Math.atan(j)*On,scaleX:b,scaleY:L}}function kn(t,e,l,s){function u(lt){return lt.length?lt.pop()+" ":""}return function(lt,st){var Pt=[],Rt=[];return lt=t(lt),st=t(st),function w(lt,st,Pt,Rt,Vt,me){if(lt!==Pt||st!==Rt){var xe=Vt.push("translate(",null,e,null,l);me.push({i:xe-4,x:ei(lt,Pt)},{i:xe-2,x:ei(st,Rt)})}else(Pt||Rt)&&Vt.push("translate("+Pt+e+Rt+l)}(lt.translateX,lt.translateY,st.translateX,st.translateY,Pt,Rt),function b(lt,st,Pt,Rt){lt!==st?(lt-st>180?st+=360:st-lt>180&&(lt+=360),Rt.push({i:Pt.push(u(Pt)+"rotate(",null,s)-2,x:ei(lt,st)})):st&&Pt.push(u(Pt)+"rotate("+st+s)}(lt.rotate,st.rotate,Pt,Rt),function L(lt,st,Pt,Rt){lt!==st?Rt.push({i:Pt.push(u(Pt)+"skewX(",null,s)-2,x:ei(lt,st)}):st&&Pt.push(u(Pt)+"skewX("+st+s)}(lt.skewX,st.skewX,Pt,Rt),function j(lt,st,Pt,Rt,Vt,me){if(lt!==Pt||st!==Rt){var xe=Vt.push(u(Vt)+"scale(",null,",",null,")");me.push({i:xe-4,x:ei(lt,Pt)},{i:xe-2,x:ei(st,Rt)})}else(1!==Pt||1!==Rt)&&Vt.push(u(Vt)+"scale("+Pt+","+Rt+")")}(lt.scaleX,lt.scaleY,st.scaleX,st.scaleY,Pt,Rt),lt=st=null,function(Vt){for(var Ct,me=-1,xe=Rt.length;++me<xe;)Pt[(Ct=Rt[me]).i]=Ct.x(Vt);return Pt.join("")}}}var _r=kn(function pr(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?en:Sn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),wr=kn(function mr(t){return null!=t&&(Wi||(Wi=document.createElementNS("http://www.w3.org/2000/svg","g")),Wi.setAttribute("transform",t),t=Wi.transform.baseVal.consolidate())?Sn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):en},", ",")",")");function br(t,e){var l,s;return function(){var u=Qe(this,t),w=u.tween;if(w!==l)for(var b=0,L=(s=l=w).length;b<L;++b)if(s[b].name===e){(s=s.slice()).splice(b,1);break}u.tween=s}}function xr(t,e,l){var s,u;if("function"!=typeof l)throw new Error;return function(){var w=Qe(this,t),b=w.tween;if(b!==s){u=(s=b).slice();for(var L={name:e,value:l},j=0,lt=u.length;j<lt;++j)if(u[j].name===e){u[j]=L;break}j===lt&&u.push(L)}w.tween=u}}function nn(t,e,l){var s=t._id;return t.each(function(){var u=Qe(this,s);(u.value||(u.value={}))[e]=l.apply(this,arguments)}),function(u){return Ge(u,s).value[e]}}function rn(t,e,l){t.prototype=e.prototype=l,l.constructor=t}function Mn(t,e){var l=Object.create(t.prototype);for(var s in e)l[s]=e[s];return l}function ki(){}var Ui=1/.7,yi="\\s*([+-]?\\d+)\\s*",Ti="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",He="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Or=/^#([0-9a-f]{3,8})$/,Sr=new RegExp(`^rgb\\(${yi},${yi},${yi}\\)$`),kr=new RegExp(`^rgb\\(${He},${He},${He}\\)$`),Mr=new RegExp(`^rgba\\(${yi},${yi},${yi},${Ti}\\)$`),Tr=new RegExp(`^rgba\\(${He},${He},${He},${Ti}\\)$`),Cr=new RegExp(`^hsl\\(${Ti},${He},${He}\\)$`),Ar=new RegExp(`^hsla\\(${Ti},${He},${He},${Ti}\\)$`),Tn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Cn(){return this.rgb().formatHex()}function An(){return this.rgb().formatRgb()}function Ci(t){var e,l;return t=(t+"").trim().toLowerCase(),(e=Or.exec(t))?(l=e[1].length,e=parseInt(e[1],16),6===l?In(e):3===l?new De(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===l?Gi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===l?Gi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Sr.exec(t))?new De(e[1],e[2],e[3],1):(e=kr.exec(t))?new De(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Mr.exec(t))?Gi(e[1],e[2],e[3],e[4]):(e=Tr.exec(t))?Gi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Cr.exec(t))?Rn(e[1],e[2]/100,e[3]/100,1):(e=Ar.exec(t))?Rn(e[1],e[2]/100,e[3]/100,e[4]):Tn.hasOwnProperty(t)?In(Tn[t]):"transparent"===t?new De(NaN,NaN,NaN,0):null}function In(t){return new De(t>>16&255,t>>8&255,255&t,1)}function Gi(t,e,l,s){return s<=0&&(t=e=l=NaN),new De(t,e,l,s)}function Fi(t,e,l,s){return 1===arguments.length?function Nr(t){return t instanceof ki||(t=Ci(t)),t?new De((t=t.rgb()).r,t.g,t.b,t.opacity):new De}(t):new De(t,e,l,null==s?1:s)}function De(t,e,l,s){this.r=+t,this.g=+e,this.b=+l,this.opacity=+s}function Pn(){return`#${hi(this.r)}${hi(this.g)}${hi(this.b)}`}function Nn(){const t=Qi(this.opacity);return`${1===t?"rgb(":"rgba("}${ui(this.r)}, ${ui(this.g)}, ${ui(this.b)}${1===t?")":`, ${t})`}`}function Qi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ui(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function hi(t){return((t=ui(t))<16?"0":"")+t.toString(16)}function Rn(t,e,l,s){return s<=0?t=e=l=NaN:l<=0||l>=1?t=e=NaN:e<=0&&(t=NaN),new Fe(t,e,l,s)}function Ln(t){if(t instanceof Fe)return new Fe(t.h,t.s,t.l,t.opacity);if(t instanceof ki||(t=Ci(t)),!t)return new Fe;if(t instanceof Fe)return t;var e=(t=t.rgb()).r/255,l=t.g/255,s=t.b/255,u=Math.min(e,l,s),w=Math.max(e,l,s),b=NaN,L=w-u,j=(w+u)/2;return L?(b=e===w?(l-s)/L+6*(l<s):l===w?(s-e)/L+2:(e-l)/L+4,L/=j<.5?w+u:2-w-u,b*=60):L=j>0&&j<1?0:b,new Fe(b,L,j,t.opacity)}function Fe(t,e,l,s){this.h=+t,this.s=+e,this.l=+l,this.opacity=+s}function Dn(t){return(t=(t||0)%360)<0?t+360:t}function Hi(t){return Math.max(0,Math.min(1,t||0))}function ln(t,e,l){return 255*(t<60?e+(l-e)*t/60:t<180?l:t<240?e+(l-e)*(240-t)/60:e)}function jn(t,e,l,s,u){var w=t*t,b=w*t;return((1-3*t+3*w-b)*e+(4-6*w+3*b)*l+(1+3*t+3*w-3*b)*s+b*u)/6}rn(ki,Ci,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Cn,formatHex:Cn,formatHex8:function Ir(){return this.rgb().formatHex8()},formatHsl:function Pr(){return Ln(this).formatHsl()},formatRgb:An,toString:An}),rn(De,Fi,Mn(ki,{brighter(t){return t=null==t?Ui:Math.pow(Ui,t),new De(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new De(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new De(ui(this.r),ui(this.g),ui(this.b),Qi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pn,formatHex:Pn,formatHex8:function Rr(){return`#${hi(this.r)}${hi(this.g)}${hi(this.b)}${hi(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Nn,toString:Nn})),rn(Fe,function Lr(t,e,l,s){return 1===arguments.length?Ln(t):new Fe(t,e,l,null==s?1:s)},Mn(ki,{brighter(t){return t=null==t?Ui:Math.pow(Ui,t),new Fe(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Fe(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,l=this.l,s=l+(l<.5?l:1-l)*e,u=2*l-s;return new De(ln(t>=240?t-240:t+120,u,s),ln(t,u,s),ln(t<120?t+240:t-120,u,s),this.opacity)},clamp(){return new Fe(Dn(this.h),Hi(this.s),Hi(this.l),Qi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qi(this.opacity);return`${1===t?"hsl(":"hsla("}${Dn(this.h)}, ${100*Hi(this.s)}%, ${100*Hi(this.l)}%${1===t?")":`, ${t})`}`}}));const zn=t=>()=>t;function Kn(t,e){var l=e-t;return l?function Bn(t,e){return function(l){return t+l*e}}(t,l):zn(isNaN(t)?e:t)}const Wn=function t(e){var l=function Br(t){return 1==(t=+t)?Kn:function(e,l){return l-e?function zr(t,e,l){return t=Math.pow(t,l),e=Math.pow(e,l)-t,l=1/l,function(s){return Math.pow(t+s*e,l)}}(e,l,t):zn(isNaN(e)?l:e)}}(e);function s(u,w){var b=l((u=Fi(u)).r,(w=Fi(w)).r),L=l(u.g,w.g),j=l(u.b,w.b),lt=Kn(u.opacity,w.opacity);return function(st){return u.r=b(st),u.g=L(st),u.b=j(st),u.opacity=lt(st),u+""}}return s.gamma=t,s}(1);function Un(t){return function(e){var b,L,l=e.length,s=new Array(l),u=new Array(l),w=new Array(l);for(b=0;b<l;++b)L=Fi(e[b]),s[b]=L.r||0,u[b]=L.g||0,w[b]=L.b||0;return s=t(s),u=t(u),w=t(w),L.opacity=1,function(j){return L.r=s(j),L.g=u(j),L.b=w(j),L+""}}}Un(function Dr(t){var e=t.length-1;return function(l){var s=l<=0?l=0:l>=1?(l=1,e-1):Math.floor(l*e),u=t[s],w=t[s+1];return jn((l-s/e)*e,s>0?t[s-1]:2*u-w,u,w,s<e-1?t[s+2]:2*w-u)}}),Un(function jr(t){var e=t.length;return function(l){var s=Math.floor(((l%=1)<0?++l:l)*e);return jn((l-s/e)*e,t[(s+e-1)%e],t[s%e],t[(s+1)%e],t[(s+2)%e])}});var an=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,on=new RegExp(an.source,"g");function Ur(t,e){var s,u,w,l=an.lastIndex=on.lastIndex=0,b=-1,L=[],j=[];for(t+="",e+="";(s=an.exec(t))&&(u=on.exec(e));)(w=u.index)>l&&(w=e.slice(l,w),L[b]?L[b]+=w:L[++b]=w),(s=s[0])===(u=u[0])?L[b]?L[b]+=u:L[++b]=u:(L[++b]=null,j.push({i:b,x:ei(s,u)})),l=on.lastIndex;return l<e.length&&(w=e.slice(l),L[b]?L[b]+=w:L[++b]=w),L.length<2?j[0]?function Wr(t){return function(e){return t(e)+""}}(j[0].x):function Kr(t){return function(){return t}}(e):(e=j.length,function(lt){for(var Pt,st=0;st<e;++st)L[(Pt=j[st]).i]=Pt.x(lt);return L.join("")})}function Gn(t,e){var l;return("number"==typeof e?ei:e instanceof Ci?Wn:(l=Ci(e))?(e=l,Wn):Ur)(t,e)}function Gr(t){return function(){this.removeAttribute(t)}}function Fr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qr(t,e,l){var s,w,u=l+"";return function(){var b=this.getAttribute(t);return b===u?null:b===s?w:w=e(s=b,l)}}function Hr(t,e,l){var s,w,u=l+"";return function(){var b=this.getAttributeNS(t.space,t.local);return b===u?null:b===s?w:w=e(s=b,l)}}function Vr(t,e,l){var s,u,w;return function(){var b,j,L=l(this);return null==L?void this.removeAttribute(t):(b=this.getAttribute(t))===(j=L+"")?null:b===s&&j===u?w:(u=j,w=e(s=b,L))}}function Jr(t,e,l){var s,u,w;return function(){var b,j,L=l(this);return null==L?void this.removeAttributeNS(t.space,t.local):(b=this.getAttributeNS(t.space,t.local))===(j=L+"")?null:b===s&&j===u?w:(u=j,w=e(s=b,L))}}function $r(t,e){var l,s;function u(){var w=e.apply(this,arguments);return w!==s&&(l=(s=w)&&function Yr(t,e){return function(l){this.setAttributeNS(t.space,t.local,e.call(this,l))}}(t,w)),l}return u._value=e,u}function qr(t,e){var l,s;function u(){var w=e.apply(this,arguments);return w!==s&&(l=(s=w)&&function Xr(t,e){return function(l){this.setAttribute(t,e.call(this,l))}}(t,w)),l}return u._value=e,u}function el(t,e){return function(){tn(this,t).delay=+e.apply(this,arguments)}}function il(t,e){return e=+e,function(){tn(this,t).delay=e}}function rl(t,e){return function(){Qe(this,t).duration=+e.apply(this,arguments)}}function ll(t,e){return e=+e,function(){Qe(this,t).duration=e}}var wl=ye.prototype.constructor;function Fn(t){return function(){this.style.removeProperty(t)}}var zl=0;function Xe(t,e,l,s){this._groups=t,this._parents=e,this._name=l,this._id=s}function Qn(){return++zl}var Ye=ye.prototype;Xe.prototype=function Bl(t){return ye().transition(t)}.prototype={constructor:Xe,select:function ml(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=E(t));for(var s=this._groups,u=s.length,w=new Array(u),b=0;b<u;++b)for(var st,Pt,L=s[b],j=L.length,lt=w[b]=new Array(j),Rt=0;Rt<j;++Rt)(st=L[Rt])&&(Pt=t.call(st,st.__data__,Rt,L))&&("__data__"in st&&(Pt.__data__=st.__data__),lt[Rt]=Pt,Ki(lt[Rt],e,l,Rt,lt,Ge(st,l)));return new Xe(w,this._parents,e,l)},selectAll:function _l(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=h(t));for(var s=this._groups,u=s.length,w=[],b=[],L=0;L<u;++L)for(var st,j=s[L],lt=j.length,Pt=0;Pt<lt;++Pt)if(st=j[Pt]){for(var Vt,Rt=t.call(st,st.__data__,Pt,j),me=Ge(st,l),xe=0,Ct=Rt.length;xe<Ct;++xe)(Vt=Rt[xe])&&Ki(Vt,e,l,xe,Rt,me);w.push(Rt),b.push(st)}return new Xe(w,b,e,l)},selectChild:Ye.selectChild,selectChildren:Ye.selectChildren,filter:function hl(t){"function"!=typeof t&&(t=O(t));for(var e=this._groups,l=e.length,s=new Array(l),u=0;u<l;++u)for(var j,w=e[u],b=w.length,L=s[u]=[],lt=0;lt<b;++lt)(j=w[lt])&&t.call(j,j.__data__,lt,w)&&L.push(j);return new Xe(s,this._parents,this._name,this._id)},merge:function cl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,l=t._groups,s=e.length,w=Math.min(s,l.length),b=new Array(s),L=0;L<w;++L)for(var Rt,j=e[L],lt=l[L],st=j.length,Pt=b[L]=new Array(st),Vt=0;Vt<st;++Vt)(Rt=j[Vt]||lt[Vt])&&(Pt[Vt]=Rt);for(;L<s;++L)b[L]=e[L];return new Xe(b,this._parents,this._name,this._id)},selection:function bl(){return new wl(this._groups,this._parents)},transition:function Dl(){for(var t=this._name,e=this._id,l=Qn(),s=this._groups,u=s.length,w=0;w<u;++w)for(var j,b=s[w],L=b.length,lt=0;lt<L;++lt)if(j=b[lt]){var st=Ge(j,e);Ki(j,t,l,lt,b,{time:st.time+st.delay+st.duration,delay:0,duration:st.duration,ease:st.ease})}return new Xe(s,this._parents,t,l)},call:Ye.call,nodes:Ye.nodes,node:Ye.node,size:Ye.size,empty:Ye.empty,each:Ye.each,on:function gl(t,e){var l=this._id;return arguments.length<2?Ge(this.node(),l).on.on(t):this.each(function vl(t,e,l){var s,u,w=function fl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var l=e.indexOf(".");return l>=0&&(e=e.slice(0,l)),!e||"start"===e})}(e)?tn:Qe;return function(){var b=w(this,t),L=b.on;L!==s&&(u=(s=L).copy()).on(e,l),b.on=u}}(l,t,e))},attr:function Zr(t,e){var l=St(t),s="transform"===l?wr:Gn;return this.attrTween(t,"function"==typeof e?(l.local?Jr:Vr)(l,s,nn(this,"attr."+t,e)):null==e?(l.local?Fr:Gr)(l):(l.local?Hr:Qr)(l,s,e))},attrTween:function tl(t,e){var l="attr."+t;if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==e)return this.tween(l,null);if("function"!=typeof e)throw new Error;var s=St(t);return this.tween(l,(s.local?$r:qr)(s,e))},style:function kl(t,e,l){var s="transform"==(t+="")?_r:Gn;return null==e?this.styleTween(t,function xl(t,e){var l,s,u;return function(){var w=tt(this,t),b=(this.style.removeProperty(t),tt(this,t));return w===b?null:w===l&&b===s?u:u=e(l=w,s=b)}}(t,s)).on("end.style."+t,Fn(t)):"function"==typeof e?this.styleTween(t,function Ol(t,e,l){var s,u,w;return function(){var b=tt(this,t),L=l(this),j=L+"";return null==L&&(this.style.removeProperty(t),j=L=tt(this,t)),b===j?null:b===s&&j===u?w:(u=j,w=e(s=b,L))}}(t,s,nn(this,"style."+t,e))).each(function Sl(t,e){var l,s,u,L,w="style."+e,b="end."+w;return function(){var j=Qe(this,t),lt=j.on,st=null==j.value[w]?L||(L=Fn(e)):void 0;(lt!==l||u!==st)&&(s=(l=lt).copy()).on(b,u=st),j.on=s}}(this._id,t)):this.styleTween(t,function El(t,e,l){var s,w,u=l+"";return function(){var b=tt(this,t);return b===u?null:b===s?w:w=e(s=b,l)}}(t,s,e),l).on("end.style."+t,null)},styleTween:function Cl(t,e,l){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(null==e)return this.tween(s,null);if("function"!=typeof e)throw new Error;return this.tween(s,function Tl(t,e,l){var s,u;function w(){var b=e.apply(this,arguments);return b!==u&&(s=(u=b)&&function Ml(t,e,l){return function(s){this.style.setProperty(t,e.call(this,s),l)}}(t,b,l)),s}return w._value=e,w}(t,e,null==l?"":l))},text:function Pl(t){return this.tween("text","function"==typeof t?function Il(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(nn(this,"text",t)):function Al(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function Ll(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function Rl(t){var e,l;function s(){var u=t.apply(this,arguments);return u!==l&&(e=(l=u)&&function Nl(t){return function(e){this.textContent=t.call(this,e)}}(u)),e}return s._value=t,s}(t))},remove:function pl(){return this.on("end.remove",function yl(t){return function(){var e=this.parentNode;for(var l in this.__transition)if(+l!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function Er(t,e){var l=this._id;if(t+="",arguments.length<2){for(var b,s=Ge(this.node(),l).tween,u=0,w=s.length;u<w;++u)if((b=s[u]).name===t)return b.value;return null}return this.each((null==e?br:xr)(l,t,e))},delay:function nl(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?el:il)(e,t)):Ge(this.node(),e).delay},duration:function al(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?rl:ll)(e,t)):Ge(this.node(),e).duration},ease:function sl(t){var e=this._id;return arguments.length?this.each(function ol(t,e){if("function"!=typeof e)throw new Error;return function(){Qe(this,t).ease=e}}(e,t)):Ge(this.node(),e).ease},easeVarying:function ul(t){if("function"!=typeof t)throw new Error;return this.each(function dl(t,e){return function(){var l=e.apply(this,arguments);if("function"!=typeof l)throw new Error;Qe(this,t).ease=l}}(this._id,t))},end:function jl(){var t,e,l=this,s=l._id,u=l.size();return new Promise(function(w,b){var L={value:b},j={value:function(){0==--u&&w()}};l.each(function(){var lt=Qe(this,s),st=lt.on;st!==t&&((e=(t=st).copy())._.cancel.push(L),e._.interrupt.push(L),e._.end.push(j)),lt.on=e}),0===u&&w()})},[Symbol.iterator]:Ye[Symbol.iterator]};var Wl={time:null,delay:0,duration:250,ease:function Kl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Ul(t,e){for(var l;!(l=t.__transition)||!(l=l[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return l}ye.prototype.interrupt=function yr(t){return this.each(function(){!function gr(t,e){var s,u,b,l=t.__transition,w=!0;if(l){for(b in e=null==e?null:e+"",l)(s=l[b]).name===e?(u=s.state>2&&s.state<5,s.state=6,s.timer.stop(),s.on.call(u?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete l[b]):w=!1;w&&delete t.__transition}}(this,t)})},ye.prototype.transition=function Gl(t){var e,l;t instanceof Xe?(e=t._id,t=t._name):(e=Qn(),(l=Wl).time=Xi(),t=null==t?null:t+"");for(var s=this._groups,u=s.length,w=0;w<u;++w)for(var j,b=s[w],L=b.length,lt=0;lt<L;++lt)(j=b[lt])&&Ki(j,t,e,lt,b,l||Ul(j,e));return new Xe(s,this._parents,t,e)};Math;function Ai(t){return{type:t}}function _i(t){return function(){return t}}function Yn(t){this._context=t}function $l(t){return new Yn(t)}["w","e"].map(Ai),["n","s"].map(Ai),["n","w","e","s","nw","ne","sw","se"].map(Ai),Yn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const cn=Math.PI,fn=2*cn,ci=1e-6,ql=fn-ci;function $n(t){this._+=t[0];for(let e=1,l=t.length;e<l;++e)this._+=arguments[e]+t[e]}class Zi{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?$n:function ta(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return $n;const l=10**e;return function(s){this._+=s[0];for(let u=1,w=s.length;u<w;++u)this._+=Math.round(arguments[u]*l)/l+s[u]}}(e)}moveTo(e,l){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,l){this._append`L${this._x1=+e},${this._y1=+l}`}quadraticCurveTo(e,l,s,u){this._append`Q${+e},${+l},${this._x1=+s},${this._y1=+u}`}bezierCurveTo(e,l,s,u,w,b){this._append`C${+e},${+l},${+s},${+u},${this._x1=+w},${this._y1=+b}`}arcTo(e,l,s,u,w){if(e=+e,l=+l,s=+s,u=+u,(w=+w)<0)throw new Error(`negative radius: ${w}`);let b=this._x1,L=this._y1,j=s-e,lt=u-l,st=b-e,Pt=L-l,Rt=st*st+Pt*Pt;if(null===this._x1)this._append`M${this._x1=e},${this._y1=l}`;else if(Rt>ci)if(Math.abs(Pt*j-lt*st)>ci&&w){let Vt=s-b,me=u-L,xe=j*j+lt*lt,Ct=Vt*Vt+me*me,Mt=Math.sqrt(xe),te=Math.sqrt(Rt),Jt=w*Math.tan((cn-Math.acos((xe+Rt-Ct)/(2*Mt*te)))/2),se=Jt/te,ve=Jt/Mt;Math.abs(se-1)>ci&&this._append`L${e+se*st},${l+se*Pt}`,this._append`A${w},${w},0,0,${+(Pt*Vt>st*me)},${this._x1=e+ve*j},${this._y1=l+ve*lt}`}else this._append`L${this._x1=e},${this._y1=l}`}arc(e,l,s,u,w,b){if(e=+e,l=+l,b=!!b,(s=+s)<0)throw new Error(`negative radius: ${s}`);let L=s*Math.cos(u),j=s*Math.sin(u),lt=e+L,st=l+j,Pt=1^b,Rt=b?u-w:w-u;null===this._x1?this._append`M${lt},${st}`:(Math.abs(this._x1-lt)>ci||Math.abs(this._y1-st)>ci)&&this._append`L${lt},${st}`,s&&(Rt<0&&(Rt=Rt%fn+fn),Rt>ql?this._append`A${s},${s},0,1,${Pt},${e-L},${l-j}A${s},${s},0,1,${Pt},${this._x1=lt},${this._y1=st}`:Rt>ci&&this._append`A${s},${s},0,${+(Rt>=cn)},${Pt},${this._x1=e+s*Math.cos(w)},${this._y1=l+s*Math.sin(w)}`)}rect(e,l,s,u){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}h${s=+s}v${+u}h${-s}Z`}toString(){return this._}}function na(t){return t[0]}function ra(t){return t[1]}function la(t,e){var l=_i(!0),s=null,u=$l,w=null,b=function ia(t){let e=3;return t.digits=function(l){if(!arguments.length)return e;if(null==l)e=null;else{const s=Math.floor(l);if(!(s>=0))throw new RangeError(`invalid digits: ${l}`);e=s}return t},()=>new Zi(e)}(L);function L(j){var lt,Pt,Vt,st=(j=function Yl(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(j)).length,Rt=!1;for(null==s&&(w=u(Vt=b())),lt=0;lt<=st;++lt)!(lt<st&&l(Pt=j[lt],lt,j))===Rt&&((Rt=!Rt)?w.lineStart():w.lineEnd()),Rt&&w.point(+t(Pt,lt,j),+e(Pt,lt,j));if(Vt)return w=null,Vt+""||null}return t="function"==typeof t?t:void 0===t?na:_i(t),e="function"==typeof e?e:void 0===e?ra:_i(e),L.x=function(j){return arguments.length?(t="function"==typeof j?j:_i(+j),L):t},L.y=function(j){return arguments.length?(e="function"==typeof j?j:_i(+j),L):e},L.defined=function(j){return arguments.length?(l="function"==typeof j?j:_i(!!j),L):l},L.curve=function(j){return arguments.length?(u=j,null!=s&&(w=u(s)),L):u},L.context=function(j){return arguments.length?(null==j?s=w=null:w=u(s=j),L):s},L}function qn(t,e,l){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+l)/6)}function tr(t){this._context=t}function aa(t){return new tr(t)}function wi(t,e,l){this.k=t,this.x=e,this.y=l}tr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:qn(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:qn(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},wi.prototype={constructor:wi,scale:function(t){return 1===t?this:new wi(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new wi(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new wi(1,0,0)}}]);