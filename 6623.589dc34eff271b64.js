"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6623],{6623:(dl,D,H)=>{H.d(D,{w:()=>al,I:()=>R});var $=H(5811),_=/^#[a-fA-F0-9]+$/i,ll=/^rgba\((\d+),(\d+),(\d+),(\d+)\)$/i,il=/^rgb\((\d+),(\d+),(\d+)\)$/i;const P=a=>{let N=null,Q=null;if(a)if("transparent"==a)N="#000000",Q=0;else if(a.match(_))N=a;else{let u=(a=a.replace(/\s+/g,"")).match(ll);if(u)N="#"+(256|u[1]).toString(16).slice(1)+(256|u[2]).toString(16).slice(1)+(256|u[3]).toString(16).slice(1),Q=(0,$.q)(parseFloat(u[4]),100);else{let K=a.match(il);K&&(N="#"+(256|K[1]).toString(16).slice(1)+(256|K[2]).toString(16).slice(1)+(256|K[3]).toString(16).slice(1))}}return{hex:N,alpha:Q}};var S=H(9054),U=H(4981);const R=a=>C(null==a?void 0:a.url,null==a?void 0:a.path,null==a?void 0:a.src);var C=(a,N,Q)=>{var u,K;let E,x,f,n;var T,X;return a&&(E=a.replace(/\\/g,"/")),N&&(x=N.replace(/\\/g,"/")),Q&&(f=Q.replace(/\\/g,"/")),x&&!E&&(E=(null===(T=U.icdt.config)||void 0===T?void 0:T.readfileuploadurl)+x),!f||x||E||(x=f.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),E=(null===(X=U.icdt.config)||void 0===X?void 0:X.readfileuploadurl)+x),n=(null!==(u=E)&&void 0!==u?u:"").split("/").pop()||(null!==(K=x)&&void 0!==K?K:"").split("/").pop()||"",{url:E,path:x,name:n}};const al=a=>{let N={x:0,y:0,width:a.screen.w,height:a.screen.h},Q=[];return a.data.forEach((u,K)=>{var E;let x={id:U.icdt.data.newSlideId,code:`${u.id}`||void 0,name:"string"==typeof u.id?u.id:`Trang ${K+1}`,svg:{viewBox:N,nodes:[]},test:(f=u.test2,f?(f.audiotrue&&(f.audiotrue=R({path:f.audiotrue.path})),f.audiofalse&&(f.audiofalse=R({path:f.audiofalse.path})),f.effecttrue&&(f.effecttrue=R({path:f.effecttrue.path})),f.effectfalse&&(f.effectfalse=R({path:f.effectfalse.path})),f.icontrue&&(f.icontrue=R({path:f.icontrue.path})),f.iconfalse&&(f.iconfalse=R({path:f.iconfalse.path})),f):{})};var f;u.background&&x.svg&&(x.svg.background=function(a){return a&&(null!==a.match(/#([a-zA-Z0-9]+)/)||null!==a.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==a.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9]+\)/))}(u.background)?{color:u.background}:function(a){return a&&null!==a.match(/data:[^;]+;base64,/)}(u.background)?{base64:u.background}:function(a){return a&&null!==a.match(/http(s)?:\/\//)}(u.background)?C(u.background):C(void 0,u.background)),jQuery(null!==(E=u.svg)&&void 0!==E?E:"").find(".svg-node").each((f,n)=>{var T,X;let O=jQuery(n).parents(".indexs"),q=O.attr("data-index"),V=O.attr("data-time"),z=null!==(T=n.getAttribute("id"))&&void 0!==T?T:"0",sl={id:parseInt(z),code:`${n.nodeName}-${n.getAttribute("id")}`,name:n.nodeName,idx:q?parseInt(q):0,time:V?parseFloat(V):0,type:(()=>{switch(n.nodeName){case"polygon":return S.$.POLYGON;case"circle":return S.$.CIRCLE;case"ellipse":return S.$.ELLIPSE;case"line":return S.$.LINE;case"rect":return S.$.RECT;case"foreignObject":return S.$.FOREIGNOBJECT}return 0})(),size:(i=>{let d=0,o=0,s=0,l=0,g=null,c=null,p=parseFloat((null===(i=n.getAttribute("transform"))||void 0===i?void 0:i.replace("rotate(","").replace(")",""))||"0")||null;switch(n.nodeName){case"polygon":{var y,k;let h=[],r=[],v=999999999,b=999999999,j=0,t=0;g=JSON.parse(n.getAttribute("ratios")||"[]"),c=null!==(y=null===(k=n.getAttribute("points"))||void 0===k?void 0:k.split(",").map(function(e){return e.split(" ").map(function(m){return parseFloat(m)})}))&&void 0!==y?y:[],c.forEach(function(e){h.push(e[0]),r.push(e[1])}),v=Math.min.apply(null,h),b=Math.min.apply(null,r),j=Math.max.apply(null,h),t=Math.max.apply(null,r),d=v,o=b,s=j-d,l=t-o;break}case"circle":{let h=parseFloat(n.getAttribute("cx")||"0"),r=parseFloat(n.getAttribute("cy")||"0"),v=parseFloat(n.getAttribute("r")||"0");d=h-v,o=r-v,s=2*v,l=2*v;break}case"ellipse":{let h=parseFloat(n.getAttribute("cx")||"0"),r=parseFloat(n.getAttribute("cy")||"0"),v=parseFloat(n.getAttribute("rx")||"0"),b=parseFloat(n.getAttribute("ry")||"0");d=h-v,o=r-b,s=2*v,l=2*b;break}case"line":{let h=parseFloat(n.getAttribute("x1")||"0"),r=parseFloat(n.getAttribute("y1")||"0"),v=parseFloat(n.getAttribute("x2")||"0"),b=parseFloat(n.getAttribute("y2")||"0"),j=999999999,t=999999999,e=0,m=0;j=Math.min(h,v),t=Math.min(r,b),e=Math.max(h,v),m=Math.max(r,b),d=j,o=t,s=e-d,l=m-o,g=[[(h-d)/(s||1),(r-o)/(l||1)],[(v-d)/(s||1),(b-o)/(l||1)]];break}case"rect":case"foreignObject":d=parseFloat(n.getAttribute("x")||"0"),o=parseFloat(n.getAttribute("y")||"0"),s=parseFloat(n.getAttribute("width")||"0"),l=parseFloat(n.getAttribute("height")||"0")}return Object.assign({},{x:d,y:o,width:s,height:l,ratios:g,points:c,rotate:p})})(),attribute:(()=>{let i={};switch(n.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var d,o,s,l,g,c;let p=null!==(d=n.getAttribute("fill"))&&void 0!==d?d:null,y=null!==(o=n.getAttribute("stroke"))&&void 0!==o?o:null,k=null!==(s=parseFloat(n.getAttribute("stroke-width")||"0"))&&void 0!==s?s:null,h=null!==(l=n.getAttribute("stroke-linecap"))&&void 0!==l?l:null,r=null!==(g=n.getAttribute("stroke-linejoin"))&&void 0!==g?g:null,v=null!==(c=parseFloat(n.getAttribute("stroke-dasharray")||"0"))&&void 0!==c?c:null;Object.assign(i,{fill:p,stroke:y,strokeWidth:k,strokeLinecap:h,strokeLinejoin:r,strokeDasharray:v});break}}return i})(),style:(()=>{let i={};switch(n.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let g=jQuery(n).find(".svg-container");if(g.length){var d,o;let p=null!==(d=parseFloat(g.css("border-width")||"0"))&&void 0!==d?d:null,y=null!==(o=g.css("border-style"))&&void 0!==o?o:null,k=g.css("border-color")||null,h=null,r=g.css("background-color")||null,v=null;(()=>{let{hex:b,alpha:j}=P(k);k=b,h=j})(),(()=>{let{hex:b,alpha:j}=P(r);r=b,v=j})(),Object.assign(i,{borderWidth:p,borderStyle:y,borderColor:k,borderOpacity:h,backgroundColor:r,backgroundOpacity:v})}let c=jQuery(n).find(".svg-editor-content");if(c.length){var s,l;let p=JSON.parse((c.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:y,alpha:k}=P(p.TextColor);Object.assign(i,{fontFamily:null!==(s=p.FontFamily)&&void 0!==s?s:null,fontSize:null!==(l=p.FontSize)&&void 0!==l?l:null,color:y,opacity:k})}break}}return i})(),source:(()=>{let i={};switch(n.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(O.hasClass("editors")){let t=jQuery(n).find(".svg-editor-content");if(t.length){var d;let e=t.html(),m=null!==(d=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==d?d:[];Object.assign(i,{type:"html",html:{htmlContent:e,variableKeywords:m}})}}else if(O.hasClass("inputs")||O.hasClass("textareas"))Object.assign(i,{type:"input",input:{input:!!jQuery(n).find("input").length,textarea:!!jQuery(n).find("textarea").length}});else if(O.hasClass("tests")){let t=jQuery(n).find(".svg-test");if(O.hasClass("tests-truefalse")){var o,s;let e=t.find(".svg-editor-content").html(),m=null!==(o=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==o?o:[];Object.assign(i,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(s=u.test2.truefalse)||void 0===s?void 0:s.includes(z)}},html:{htmlContent:e,variableKeywords:m}})}else if(O.hasClass("tests-singlechoice")){var l,g;let e=t.find(".svg-editor-content").html(),m=null!==(l=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==l?l:[];Object.assign(i,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(g=u.test2.singlechoice)||void 0===g?void 0:g.includes(z)}},html:{htmlContent:e,variableKeywords:m}})}else if(O.hasClass("tests-multichoice")){var c,p;let e=t.find(".svg-editor-content").html(),m=null!==(c=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==c?c:[];Object.assign(i,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(p=u.test2.multichoice)||void 0===p?void 0:p.includes(z)}},html:{htmlContent:e,variableKeywords:m}})}else if(O.hasClass("tests-fill")){var y,k;let e=t.find(".svg-editor-content").html(),m=null!==(y=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==y?y:[],F=null!==(k=(null!=e?e:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==k?k:[];F=F.filter((I,w,A)=>A.indexOf(I)==w),Object.assign(i,{type:"test",test:{type:"fill",fill:F.map(I=>{var w;return{key:I,value:null===(w=u.test2.fill)||void 0===w||null===(w=w.find(A=>A.id==z))||void 0===w||null===(w=w.vals)||void 0===w?void 0:w.map(A=>A.text).filter(A=>!["",null,void 0,NaN].includes(A))}})},html:{htmlContent:e,variableKeywords:m,fillKeywords:F}})}else if(O.hasClass("tests-matching")){if(t.hasClass("svg-test-empty"))Object.assign(i,{type:"test",test:{type:"matching-empty",matching:{key:t.attr("data-name")||null}}});else if(t.hasClass("svg-test-content")){var h;let e=t.find(".svg-editor-content").html(),m=null!==(h=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==h?h:[];Object.assign(i,{type:"test",test:{type:"matching-content",matching:{key:t.attr("data-name")||null}},html:{htmlContent:e,variableKeywords:m}})}}else if(O.hasClass("tests-speech")){var r;Object.assign(i,{type:"speech",speech:{value:null===(r=u.test2.speech)||void 0===r||null===(r=r.find(e=>e.id==z))||void 0===r||null===(r=r.vals)||void 0===r?void 0:r.map(e=>e.text).filter(e=>!["",null,void 0,NaN].includes(e))}})}else if(O.hasClass("tests-submit")){let e=jQuery(n).find(".svg-container img");Object.assign(i,{type:"test",test:{type:"submit"},image:C(e.attr("url"),e.attr("path"),e.attr("src"))})}}else if(O.hasClass("images")){let t=jQuery(n).find(".svg-editor-content img");if(t.length)Object.assign(i,{type:"image",image:C(t.attr("url"),t.attr("path"),t.attr("src"))});else{let e=jQuery(n).find("iframe");Object.assign(i,{type:"iframe",iframe:C(e.attr("url"),e.attr("path"),e.attr("src"))})}}else if(O.hasClass("sounds")){let t=jQuery(n).find(".svg-editor-content img");t.length&&Object.assign(i,{type:"image",image:C(t.attr("url"),t.attr("path"),t.attr("src"))})}else if(O.hasClass("htmls")){let t=jQuery(n).find("iframe");t.length&&Object.assign(i,{type:"iframe",iframe:C(t.attr("url"),t.attr("path"),t.attr("src"))})}else if(O.hasClass("svgs")){let t=jQuery(n).find("svg");var v,b;t.length&&Object.assign(i,{type:"svg",svg:Object.assign(C(t.attr("url"),t.attr("path"),t.attr("src")),{svgContent:null!==(v=null===(b=t.get(0))||void 0===b?void 0:b.outerHTML)&&void 0!==v?v:null})})}else if(O.hasClass("medias")){let t=jQuery(n).find(".media-item");if(t.length)switch(t.attr("type")){case"audio":Object.assign(i,{type:"audio",audio:C(t.attr("url"),t.attr("path"),t.attr("src"))});break;case"video":Object.assign(i,{type:"video",video:C(t.attr("url"),t.attr("path"),t.attr("src"))});break;case"file":Object.assign(i,{type:"file",file:C(t.attr("url"),t.attr("path"),t.attr("src"))});break;default:var j;Object.assign(i,{type:"link",link:{url:null!==(j=t.attr("url"))&&void 0!==j?j:null}})}let e=jQuery(n).find("img");e.length&&(Object.assign(i,{image:C(e.attr("url"),e.attr("path"),e.attr("src"))}),i.type||Object.assign(i,{type:"image"}))}}return i})(),animate:(i=>{let d={},o=null===(i=u.animates)||void 0===i?void 0:i.find(s=>s.elementId==z);return o&&Object.assign(d,{value:o.value}),d})(),interactive:(()=>{let i={},d=u.actions.show.filter(s=>s.elementId==z&&s.active);d.length&&(i.show={},d.forEach(s=>{let{source:l}=s;switch(null==l?void 0:l.type){case"work":var g,c,p,y,k;i.show.action={},Object.assign(i.show.action,{value:null!==(g=l.value)&&void 0!==g?g:null,iteration:null!==(c=l.iteration)&&void 0!==c?c:null,finish:null!==(p=l.end)&&void 0!==p?p:null,time:null!==(y=l.time)&&void 0!==y?y:null,points:null!==(k=l.points)&&void 0!==k?k:null});break;case"audio":var h,r,v;i.show.audio={},Object.assign(i.show.audio,{source:C(null,null,l.url),iteration:null!==(h=l.iteration)&&void 0!==h?h:null,finish:null!==(r=l.end)&&void 0!==r?r:null,time:null!==(v=l.time)&&void 0!==v?v:null,async:-1==l.iteration?"change-slide":"change-node"});break;case"node":case"node2":var b,j,t,e,m,F,I,w,A,G,M,B,L,Y,J;l.options.includes("show")&&(i.show.triggershow={},Object.assign(i.show.triggershow,{id:null!==(b=parseInt(null!==(j=l.id)&&void 0!==j?j:"0"))&&void 0!==b?b:null,ids:null===(t=l.ids)||void 0===t?void 0:t.map(Z=>parseInt(Z)),async:null!==(e=l.async)&&void 0!==e?e:null,time:null!==(m=l.time)&&void 0!==m?m:null})),l.options.includes("run")&&(i.show.triggerrun={},Object.assign(i.show.triggerrun,{id:null!==(F=parseInt(null!==(I=l.id)&&void 0!==I?I:"0"))&&void 0!==F?F:null,ids:null===(w=l.ids)||void 0===w?void 0:w.map(Z=>parseInt(Z)),async:null!==(A=l.async)&&void 0!==A?A:null,time:null!==(G=l.time)&&void 0!==G?G:null})),l.options.includes("hide")&&(i.show.triggerhide={},Object.assign(i.show.triggerhide,{id:null!==(M=parseInt(null!==(B=l.id)&&void 0!==B?B:"0"))&&void 0!==M?M:null,ids:null===(L=l.ids)||void 0===L?void 0:L.map(Z=>parseInt(Z)),async:null!==(Y=l.async)&&void 0!==Y?Y:null,time:null!==(J=l.time)&&void 0!==J?J:null}))}}));let o=u.actions.click.filter(s=>s.elementId==z&&s.active);return o&&(i.click={},o.forEach(s=>{let{source:l}=s;switch(null==l?void 0:l.type){case"work":var g,c,p,y,k;i.click.action={},Object.assign(i.click.action,{value:null!==(g=l.value)&&void 0!==g?g:null,iteration:null!==(c=l.iteration)&&void 0!==c?c:null,finish:null!==(p=l.end)&&void 0!==p?p:null,time:null!==(y=l.time)&&void 0!==y?y:null,points:null!==(k=l.points)&&void 0!==k?k:null});break;case"audio":var h,r,v;i.click.audio={},Object.assign(i.click.audio,{source:C(null,null,l.url),iteration:null!==(h=l.iteration)&&void 0!==h?h:null,finish:null!==(r=l.end)&&void 0!==r?r:null,time:null!==(v=l.time)&&void 0!==v?v:null,async:-1==l.iteration?"change-slide":"change-node"});break;case"node":case"node2":var b,j,t,e,m,F,I,w,A,G,M,B,L,Y,J;l.options.includes("show")&&(i.click.triggershow={},Object.assign(i.click.triggershow,{id:null!==(b=parseInt(null!==(j=l.id)&&void 0!==j?j:"0"))&&void 0!==b?b:null,ids:null===(t=l.ids)||void 0===t?void 0:t.map(W=>parseInt(W)),async:null!==(e=l.async)&&void 0!==e?e:null,time:null!==(m=l.time)&&void 0!==m?m:null})),l.options.includes("run")&&(i.click.triggerrun={},Object.assign(i.click.triggerrun,{id:null!==(F=parseInt(null!==(I=l.id)&&void 0!==I?I:"0"))&&void 0!==F?F:null,ids:null===(w=l.ids)||void 0===w?void 0:w.map(W=>parseInt(W)),async:null!==(A=l.async)&&void 0!==A?A:null,time:null!==(G=l.time)&&void 0!==G?G:null})),l.options.includes("hide")&&(i.click.triggerhide={},Object.assign(i.click.triggerhide,{id:null!==(M=parseInt(null!==(B=l.id)&&void 0!==B?B:"0"))&&void 0!==M?M:null,ids:null===(L=l.ids)||void 0===L?void 0:L.map(W=>parseInt(W)),async:null!==(Y=l.async)&&void 0!==Y?Y:null,time:null!==(J=l.time)&&void 0!==J?J:null}));break;case"slide":var Z;i.click.slide={},Object.assign(i.click.slide,{id:parseInt(null!==(Z=l.id)&&void 0!==Z?Z:"0")||l.num||null,code:l.id})}})),i})(),variable:(i=>{let d={};var o;n.getAttribute("data-variable")&&(d.input={},Object.assign(d.input,{variable:null!==(o=n.getAttribute("data-variable"))&&void 0!==o?o:null}));let s=null===(i=u.nodes)||void 0===i||null===(i=i.find(y=>y.id==z))||void 0===i?void 0:i.variable;var l,g,c,p;return s&&(d.click={},Object.assign(d.click,{variable:null!==(l=s.variable)&&void 0!==l?l:null,operator:null!==(g=s.operator)&&void 0!==g?g:null,valuetype:null!==(c=s.valuetype)&&void 0!==c?c:null,value:null!==(p=s.value)&&void 0!==p?p:null})),d})()};null===(X=x.svg)||void 0===X||X.nodes.push(sl)}),Q.push(x)}),console.log(Q),{screen:{width:a.screen.w,height:a.screen.h},data:{slides:Q},variable:a.variable}}}}]);